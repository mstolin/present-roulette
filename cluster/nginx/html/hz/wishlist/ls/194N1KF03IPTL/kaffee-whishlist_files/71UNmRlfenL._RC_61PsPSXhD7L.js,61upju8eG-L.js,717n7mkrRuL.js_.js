(function(pa){var qa=window.AmazonUIPageJS||window.P,ta=qa._namespace||qa.attributeErrors,y=ta?ta("CampfireCryptoJS_AUIBuild",""):qa;y.guardFatal?y.guardFatal(pa)(y,window):y.execute(function(){pa(y,window)})})(function(pa,qa,ta){pa.register("3p-CryptoJS",function(){var y=y||function(d,k){var e={},g=e.lib={},p=function(){},q=g.Base={extend:function(a){p.prototype=this;var f=new p;a&&f.mixIn(a);f.hasOwnProperty("init")||(f.init=function(){f.$super.init.apply(this,arguments)});f.init.prototype=f;f.$super=
this;return f},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var f in a)a.hasOwnProperty(f)&&(this[f]=a[f]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},u=g.WordArray=q.extend({init:function(a,f){a=this.words=a||[];this.sigBytes=f!=k?f:4*a.length},toString:function(a){return(a||r).stringify(this)},concat:function(a){var f=this.words,t=a.words,h=this.sigBytes;
a=a.sigBytes;this.clamp();if(h%4)for(var b=0;b<a;b++)f[h+b>>>2]|=(t[b>>>2]>>>24-b%4*8&255)<<24-(h+b)%4*8;else if(65535<t.length)for(b=0;b<a;b+=4)f[h+b>>>2]=t[b>>>2];else f.push.apply(f,t);this.sigBytes+=a;return this},clamp:function(){var a=this.words,f=this.sigBytes;a[f>>>2]&=4294967295<<32-f%4*8;a.length=d.ceil(f/4)},clone:function(){var a=q.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var f=[],t=0;t<a;t+=4)f.push(4294967296*d.random()|0);return new u.init(f,a)}}),
v=e.enc={},r=v.Hex={stringify:function(a){var f=a.words;a=a.sigBytes;for(var t=[],h=0;h<a;h++){var b=f[h>>>2]>>>24-h%4*8&255;t.push((b>>>4).toString(16));t.push((b&15).toString(16))}return t.join("")},parse:function(a){for(var f=a.length,t=[],h=0;h<f;h+=2)t[h>>>3]|=parseInt(a.substr(h,2),16)<<24-h%8*4;return new u.init(t,f/2)}},c=v.Latin1={stringify:function(a){var f=a.words;a=a.sigBytes;for(var t=[],h=0;h<a;h++)t.push(String.fromCharCode(f[h>>>2]>>>24-h%4*8&255));return t.join("")},parse:function(a){for(var f=
a.length,t=[],h=0;h<f;h++)t[h>>>2]|=(a.charCodeAt(h)&255)<<24-h%4*8;return new u.init(t,f)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(f){throw Error("Malformed UTF-8 data");}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},w=g.BufferedBlockAlgorithm=q.extend({reset:function(){this._data=new u.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var f=
this._data,t=f.words,h=f.sigBytes,b=this.blockSize,c=h/(4*b),c=a?d.ceil(c):d.max((c|0)-this._minBufferSize,0);a=c*b;h=d.min(4*a,h);if(a){for(var e=0;e<a;e+=b)this._doProcessBlock(t,e);e=t.splice(0,a);f.sigBytes-=h}return new u.init(e,h)},clone:function(){var a=q.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});g.Hasher=w.extend({cfg:q.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);
this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(f,t){return(new a.init(t)).finalize(f)}},_createHmacHelper:function(a){return function(f,t){return(new b.HMAC.init(a,t)).finalize(f)}}});var b=e.algo={};return e}(Math);(function(){var d=y,k=d.lib,e=k.WordArray,g=k.Hasher,k=d.algo,p=e.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,
5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),q=e.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),u=e.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),
v=e.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),r=e.create([0,1518500249,1859775393,2400959708,2840853838]),c=e.create([1352829926,1548603684,1836072691,2053994217,0]),k=k.RIPEMD160=g.extend({_doReset:function(){this._hash=e.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,d){for(var b=0;16>
b;b++){var a=d+b,f=e[a];e[a]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360}var a=this._hash.words,f=r.words,t=c.words,h=p.words,J=q.words,g=u.words,k=v.words,ha,Q,T,C,N,F,D,B,y,m;F=ha=a[0];D=Q=a[1];B=T=a[2];y=C=a[3];m=N=a[4];for(var l,b=0;80>b;b+=1)l=ha+e[d+h[b]]|0,l=16>b?l+((Q^T^C)+f[0]):32>b?l+((Q&T|~Q&C)+f[1]):48>b?l+(((Q|~T)^C)+f[2]):64>b?l+((Q&C|T&~C)+f[3]):l+((Q^(T|~C))+f[4]),l|=0,l=l<<g[b]|l>>>32-g[b],l=l+N|0,ha=N,N=C,C=T<<10|T>>>22,T=Q,Q=l,l=F+e[d+J[b]]|0,l=16>b?l+((D^(B|~y))+t[0]):32>b?
l+((D&y|B&~y)+t[1]):48>b?l+(((D|~B)^y)+t[2]):64>b?l+((D&B|~D&y)+t[3]):l+((D^B^y)+t[4]),l|=0,l=l<<k[b]|l>>>32-k[b],l=l+m|0,F=m,m=y,y=B<<10|B>>>22,B=D,D=l;l=a[1]+T+y|0;a[1]=a[2]+C+m|0;a[2]=a[3]+N+F|0;a[3]=a[4]+ha+D|0;a[4]=a[0]+Q+B|0;a[0]=l},_doFinalize:function(){var c=this._data,e=c.words,b=8*this._nDataBytes,a=8*c.sigBytes;e[a>>>5]|=128<<24-a%32;e[(a+64>>>9<<4)+14]=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360;c.sigBytes=4*(e.length+1);this._process();c=this._hash;e=c.words;for(b=0;5>b;b++)a=e[b],
e[b]=(a<<8|a>>>24)&16711935|(a<<24|a>>>8)&4278255360;return c},clone:function(){var c=g.clone.call(this);c._hash=this._hash.clone();return c}});d.RIPEMD160=g._createHelper(k);d.HmacRIPEMD160=g._createHmacHelper(k)})(Math);(function(){var d=y,k=d.enc.Utf8;d.algo.HMAC=d.lib.Base.extend({init:function(e,d){e=this._hasher=new e.init;"string"==typeof d&&(d=k.parse(d));var p=e.blockSize,q=4*p;d.sigBytes>q&&(d=e.finalize(d));d.clamp();e=this._oKey=d.clone();d=this._iKey=d.clone();for(var u=e.words,v=d.words,
r=0;r<p;r++)u[r]^=1549556828,v[r]^=909522486;e.sigBytes=d.sigBytes=q;this.reset()},reset:function(){var e=this._hasher;e.reset();e.update(this._iKey)},update:function(e){this._hasher.update(e);return this},finalize:function(e){var d=this._hasher;e=d.finalize(e);d.reset();return d.finalize(this._oKey.clone().concat(e))}})})();y=y||function(d,k){var e={},g=e.lib={},p=function(){},q=g.Base={extend:function(a){p.prototype=this;var f=new p;a&&f.mixIn(a);f.hasOwnProperty("init")||(f.init=function(){f.$super.init.apply(this,
arguments)});f.init.prototype=f;f.$super=this;return f},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var f in a)a.hasOwnProperty(f)&&(this[f]=a[f]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},u=g.WordArray=q.extend({init:function(a,f){a=this.words=a||[];this.sigBytes=f!=k?f:4*a.length},toString:function(a){return(a||r).stringify(this)},concat:function(a){var f=
this.words,t=a.words,h=this.sigBytes;a=a.sigBytes;this.clamp();if(h%4)for(var b=0;b<a;b++)f[h+b>>>2]|=(t[b>>>2]>>>24-b%4*8&255)<<24-(h+b)%4*8;else if(65535<t.length)for(b=0;b<a;b+=4)f[h+b>>>2]=t[b>>>2];else f.push.apply(f,t);this.sigBytes+=a;return this},clamp:function(){var a=this.words,f=this.sigBytes;a[f>>>2]&=4294967295<<32-f%4*8;a.length=d.ceil(f/4)},clone:function(){var a=q.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var f=[],t=0;t<a;t+=4)f.push(4294967296*
d.random()|0);return new u.init(f,a)}}),v=e.enc={},r=v.Hex={stringify:function(a){var f=a.words;a=a.sigBytes;for(var t=[],h=0;h<a;h++){var b=f[h>>>2]>>>24-h%4*8&255;t.push((b>>>4).toString(16));t.push((b&15).toString(16))}return t.join("")},parse:function(a){for(var f=a.length,t=[],h=0;h<f;h+=2)t[h>>>3]|=parseInt(a.substr(h,2),16)<<24-h%8*4;return new u.init(t,f/2)}},c=v.Latin1={stringify:function(a){var f=a.words;a=a.sigBytes;for(var t=[],h=0;h<a;h++)t.push(String.fromCharCode(f[h>>>2]>>>24-h%4*
8&255));return t.join("")},parse:function(a){for(var f=a.length,t=[],h=0;h<f;h++)t[h>>>2]|=(a.charCodeAt(h)&255)<<24-h%4*8;return new u.init(t,f)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(f){throw Error("Malformed UTF-8 data");}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},w=g.BufferedBlockAlgorithm=q.extend({reset:function(){this._data=new u.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=x.parse(a));
this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var f=this._data,t=f.words,h=f.sigBytes,b=this.blockSize,c=h/(4*b),c=a?d.ceil(c):d.max((c|0)-this._minBufferSize,0);a=c*b;h=d.min(4*a,h);if(a){for(var e=0;e<a;e+=b)this._doProcessBlock(t,e);e=t.splice(0,a);f.sigBytes-=h}return new u.init(e,h)},clone:function(){var a=q.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});g.Hasher=w.extend({cfg:q.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},
reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(f,t){return(new a.init(t)).finalize(f)}},_createHmacHelper:function(a){return function(f,t){return(new b.HMAC.init(a,t)).finalize(f)}}});var b=e.algo={};return e}(Math);(function(){var d=y,k=d.lib,e=k.WordArray,g=k.Hasher,k=d.algo,p=e.create([0,1,2,3,4,5,6,7,8,9,
10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),q=e.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),u=e.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,
12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),v=e.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),r=e.create([0,1518500249,1859775393,2400959708,2840853838]),c=e.create([1352829926,1548603684,1836072691,2053994217,0]),k=k.RIPEMD160=g.extend({_doReset:function(){this._hash=e.create([1732584193,4023233417,
2562383102,271733878,3285377520])},_doProcessBlock:function(e,d){for(var b=0;16>b;b++){var a=d+b,f=e[a];e[a]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360}var a=this._hash.words,f=r.words,t=c.words,h=p.words,J=q.words,g=u.words,k=v.words,ha,Q,T,C,N,F,y,B,E,m;F=ha=a[0];y=Q=a[1];B=T=a[2];E=C=a[3];m=N=a[4];for(var l,b=0;80>b;b+=1)l=ha+e[d+h[b]]|0,l=16>b?l+((Q^T^C)+f[0]):32>b?l+((Q&T|~Q&C)+f[1]):48>b?l+(((Q|~T)^C)+f[2]):64>b?l+((Q&C|T&~C)+f[3]):l+((Q^(T|~C))+f[4]),l|=0,l=l<<g[b]|l>>>32-g[b],l=l+N|0,
ha=N,N=C,C=T<<10|T>>>22,T=Q,Q=l,l=F+e[d+J[b]]|0,l=16>b?l+((y^(B|~E))+t[0]):32>b?l+((y&E|B&~E)+t[1]):48>b?l+(((y|~B)^E)+t[2]):64>b?l+((y&B|~y&E)+t[3]):l+((y^B^E)+t[4]),l|=0,l=l<<k[b]|l>>>32-k[b],l=l+m|0,F=m,m=E,E=B<<10|B>>>22,B=y,y=l;l=a[1]+T+E|0;a[1]=a[2]+C+m|0;a[2]=a[3]+N+F|0;a[3]=a[4]+ha+y|0;a[4]=a[0]+Q+B|0;a[0]=l},_doFinalize:function(){var c=this._data,e=c.words,b=8*this._nDataBytes,a=8*c.sigBytes;e[a>>>5]|=128<<24-a%32;e[(a+64>>>9<<4)+14]=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360;c.sigBytes=
4*(e.length+1);this._process();c=this._hash;e=c.words;for(b=0;5>b;b++)a=e[b],e[b]=(a<<8|a>>>24)&16711935|(a<<24|a>>>8)&4278255360;return c},clone:function(){var c=g.clone.call(this);c._hash=this._hash.clone();return c}});d.RIPEMD160=g._createHelper(k);d.HmacRIPEMD160=g._createHmacHelper(k)})(Math);y=y||function(d,k){var e={},g=e.lib={},p=function(){},q=g.Base={extend:function(a){p.prototype=this;var f=new p;a&&f.mixIn(a);f.hasOwnProperty("init")||(f.init=function(){f.$super.init.apply(this,arguments)});
f.init.prototype=f;f.$super=this;return f},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var f in a)a.hasOwnProperty(f)&&(this[f]=a[f]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},u=g.WordArray=q.extend({init:function(a,f){a=this.words=a||[];this.sigBytes=f!=k?f:4*a.length},toString:function(a){return(a||r).stringify(this)},concat:function(a){var f=this.words,
t=a.words,h=this.sigBytes;a=a.sigBytes;this.clamp();if(h%4)for(var b=0;b<a;b++)f[h+b>>>2]|=(t[b>>>2]>>>24-b%4*8&255)<<24-(h+b)%4*8;else if(65535<t.length)for(b=0;b<a;b+=4)f[h+b>>>2]=t[b>>>2];else f.push.apply(f,t);this.sigBytes+=a;return this},clamp:function(){var a=this.words,f=this.sigBytes;a[f>>>2]&=4294967295<<32-f%4*8;a.length=d.ceil(f/4)},clone:function(){var a=q.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var f=[],t=0;t<a;t+=4)f.push(4294967296*d.random()|
0);return new u.init(f,a)}}),v=e.enc={},r=v.Hex={stringify:function(a){var f=a.words;a=a.sigBytes;for(var t=[],h=0;h<a;h++){var b=f[h>>>2]>>>24-h%4*8&255;t.push((b>>>4).toString(16));t.push((b&15).toString(16))}return t.join("")},parse:function(a){for(var f=a.length,t=[],h=0;h<f;h+=2)t[h>>>3]|=parseInt(a.substr(h,2),16)<<24-h%8*4;return new u.init(t,f/2)}},c=v.Latin1={stringify:function(a){var f=a.words;a=a.sigBytes;for(var t=[],h=0;h<a;h++)t.push(String.fromCharCode(f[h>>>2]>>>24-h%4*8&255));return t.join("")},
parse:function(a){for(var f=a.length,t=[],h=0;h<f;h++)t[h>>>2]|=(a.charCodeAt(h)&255)<<24-h%4*8;return new u.init(t,f)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(f){throw Error("Malformed UTF-8 data");}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},w=g.BufferedBlockAlgorithm=q.extend({reset:function(){this._data=new u.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=x.parse(a));this._data.concat(a);this._nDataBytes+=
a.sigBytes},_process:function(a){var f=this._data,t=f.words,h=f.sigBytes,b=this.blockSize,c=h/(4*b),c=a?d.ceil(c):d.max((c|0)-this._minBufferSize,0);a=c*b;h=d.min(4*a,h);if(a){for(var e=0;e<a;e+=b)this._doProcessBlock(t,e);e=t.splice(0,a);f.sigBytes-=h}return new u.init(e,h)},clone:function(){var a=q.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});g.Hasher=w.extend({cfg:q.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){w.reset.call(this);
this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(f,t){return(new a.init(t)).finalize(f)}},_createHmacHelper:function(a){return function(f,t){return(new b.HMAC.init(a,t)).finalize(f)}}});var b=e.algo={};return e}(Math);(function(){var d=y,k=d.lib.WordArray;d.enc.Base64={stringify:function(e){var d=e.words,p=e.sigBytes,q=this._map;e.clamp();e=[];for(var u=
0;u<p;u+=3)for(var v=(d[u>>>2]>>>24-u%4*8&255)<<16|(d[u+1>>>2]>>>24-(u+1)%4*8&255)<<8|d[u+2>>>2]>>>24-(u+2)%4*8&255,r=0;4>r&&u+.75*r<p;r++)e.push(q.charAt(v>>>6*(3-r)&63));if(d=q.charAt(64))for(;e.length%4;)e.push(d);return e.join("")},parse:function(e){var d=e.length,p=this._map,q=p.charAt(64);q&&(q=e.indexOf(q),-1!=q&&(d=q));for(var q=[],u=0,v=0;v<d;v++)if(v%4){var r=p.indexOf(e.charAt(v-1))<<v%4*2,c=p.indexOf(e.charAt(v))>>>6-v%4*2;q[u>>>2]|=(r|c)<<24-u%4*8;u++}return k.create(q,u)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"}})();
(function(d){function k(c,b,a,f,t,h,J){c=c+(b&a|~b&f)+t+J;return(c<<h|c>>>32-h)+b}function e(c,b,a,f,t,h,J){c=c+(b&f|a&~f)+t+J;return(c<<h|c>>>32-h)+b}function g(c,b,a,f,t,h,J){c=c+(b^a^f)+t+J;return(c<<h|c>>>32-h)+b}function p(c,b,a,f,t,h,J){c=c+(a^(b|~f))+t+J;return(c<<h|c>>>32-h)+b}for(var q=y,u=q.lib,v=u.WordArray,r=u.Hasher,u=q.algo,c=[],x=0;64>x;x++)c[x]=4294967296*d.abs(d.sin(x+1))|0;u=u.MD5=r.extend({_doReset:function(){this._hash=new v.init([1732584193,4023233417,2562383102,271733878])},
_doProcessBlock:function(d,b){for(var a=0;16>a;a++){var f=b+a,t=d[f];d[f]=(t<<8|t>>>24)&16711935|(t<<24|t>>>8)&4278255360}var a=this._hash.words,f=d[b+0],t=d[b+1],h=d[b+2],J=d[b+3],q=d[b+4],v=d[b+5],u=d[b+6],r=d[b+7],x=d[b+8],C=d[b+9],y=d[b+10],F=d[b+11],D=d[b+12],B=d[b+13],E=d[b+14];d=d[b+15];b=a[0];var m=a[1],l=a[2],n=a[3];b=k(b,m,l,n,f,7,c[0]);n=k(n,b,m,l,t,12,c[1]);l=k(l,n,b,m,h,17,c[2]);m=k(m,l,n,b,J,22,c[3]);b=k(b,m,l,n,q,7,c[4]);n=k(n,b,m,l,v,12,c[5]);l=k(l,n,b,m,u,17,c[6]);m=k(m,l,n,b,r,22,
c[7]);b=k(b,m,l,n,x,7,c[8]);n=k(n,b,m,l,C,12,c[9]);l=k(l,n,b,m,y,17,c[10]);m=k(m,l,n,b,F,22,c[11]);b=k(b,m,l,n,D,7,c[12]);n=k(n,b,m,l,B,12,c[13]);l=k(l,n,b,m,E,17,c[14]);m=k(m,l,n,b,d,22,c[15]);b=e(b,m,l,n,t,5,c[16]);n=e(n,b,m,l,u,9,c[17]);l=e(l,n,b,m,F,14,c[18]);m=e(m,l,n,b,f,20,c[19]);b=e(b,m,l,n,v,5,c[20]);n=e(n,b,m,l,y,9,c[21]);l=e(l,n,b,m,d,14,c[22]);m=e(m,l,n,b,q,20,c[23]);b=e(b,m,l,n,C,5,c[24]);n=e(n,b,m,l,E,9,c[25]);l=e(l,n,b,m,J,14,c[26]);m=e(m,l,n,b,x,20,c[27]);b=e(b,m,l,n,B,5,c[28]);n=
e(n,b,m,l,h,9,c[29]);l=e(l,n,b,m,r,14,c[30]);m=e(m,l,n,b,D,20,c[31]);b=g(b,m,l,n,v,4,c[32]);n=g(n,b,m,l,x,11,c[33]);l=g(l,n,b,m,F,16,c[34]);m=g(m,l,n,b,E,23,c[35]);b=g(b,m,l,n,t,4,c[36]);n=g(n,b,m,l,q,11,c[37]);l=g(l,n,b,m,r,16,c[38]);m=g(m,l,n,b,y,23,c[39]);b=g(b,m,l,n,B,4,c[40]);n=g(n,b,m,l,f,11,c[41]);l=g(l,n,b,m,J,16,c[42]);m=g(m,l,n,b,u,23,c[43]);b=g(b,m,l,n,C,4,c[44]);n=g(n,b,m,l,D,11,c[45]);l=g(l,n,b,m,d,16,c[46]);m=g(m,l,n,b,h,23,c[47]);b=p(b,m,l,n,f,6,c[48]);n=p(n,b,m,l,r,10,c[49]);l=p(l,
n,b,m,E,15,c[50]);m=p(m,l,n,b,v,21,c[51]);b=p(b,m,l,n,D,6,c[52]);n=p(n,b,m,l,J,10,c[53]);l=p(l,n,b,m,y,15,c[54]);m=p(m,l,n,b,t,21,c[55]);b=p(b,m,l,n,x,6,c[56]);n=p(n,b,m,l,d,10,c[57]);l=p(l,n,b,m,u,15,c[58]);m=p(m,l,n,b,B,21,c[59]);b=p(b,m,l,n,q,6,c[60]);n=p(n,b,m,l,F,10,c[61]);l=p(l,n,b,m,h,15,c[62]);m=p(m,l,n,b,C,21,c[63]);a[0]=a[0]+b|0;a[1]=a[1]+m|0;a[2]=a[2]+l|0;a[3]=a[3]+n|0},_doFinalize:function(){var c=this._data,b=c.words,a=8*this._nDataBytes,f=8*c.sigBytes;b[f>>>5]|=128<<24-f%32;var t=d.floor(a/
4294967296);b[(f+64>>>9<<4)+15]=(t<<8|t>>>24)&16711935|(t<<24|t>>>8)&4278255360;b[(f+64>>>9<<4)+14]=(a<<8|a>>>24)&16711935|(a<<24|a>>>8)&4278255360;c.sigBytes=4*(b.length+1);this._process();c=this._hash;b=c.words;for(a=0;4>a;a++)f=b[a],b[a]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360;return c},clone:function(){var c=r.clone.call(this);c._hash=this._hash.clone();return c}});q.MD5=r._createHelper(u);q.HmacMD5=r._createHmacHelper(u)})(Math);(function(){var d=y,k=d.lib,e=k.Base,g=k.WordArray,k=d.algo,
p=k.EvpKDF=e.extend({cfg:e.extend({keySize:4,hasher:k.MD5,iterations:1}),init:function(d){this.cfg=this.cfg.extend(d)},compute:function(d,e){for(var v=this.cfg,r=v.hasher.create(),c=g.create(),p=c.words,w=v.keySize,v=v.iterations;p.length<w;){b&&r.update(b);var b=r.update(d).finalize(e);r.reset();for(var a=1;a<v;a++)b=r.finalize(b),r.reset();c.concat(b)}c.sigBytes=4*w;return c}});d.EvpKDF=function(d,e,g){return p.create(g).compute(d,e)}})();y.lib.Cipher||function(d){var k=y,e=k.lib,g=e.Base,p=e.WordArray,
q=e.BufferedBlockAlgorithm,u=k.enc.Base64,v=k.algo.EvpKDF,r=e.Cipher=q.extend({cfg:g.extend(),createEncryptor:function(a,h){return this.create(this._ENC_XFORM_MODE,a,h)},createDecryptor:function(a,h){return this.create(this._DEC_XFORM_MODE,a,h)},init:function(a,h,f){this.cfg=this.cfg.extend(f);this._xformMode=a;this._key=h;this.reset()},reset:function(){q.reset.call(this);this._doReset()},process:function(a){this._append(a);return this._process()},finalize:function(a){a&&this._append(a);return this._doFinalize()},
keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(t){return{encrypt:function(h,b,c){return("string"==typeof b?f:a).encrypt(t,h,b,c)},decrypt:function(h,b,c){return("string"==typeof b?f:a).decrypt(t,h,b,c)}}}});e.StreamCipher=r.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var c=k.mode={},x=function(a,h,f){var b=this._iv;b?this._iv=d:b=this._prevBlock;for(var c=0;c<f;c++)a[h+c]^=b[c]},w=(e.BlockCipherMode=g.extend({createEncryptor:function(a,h){return this.Encryptor.create(a,
h)},createDecryptor:function(a,h){return this.Decryptor.create(a,h)},init:function(a,h){this._cipher=a;this._iv=h}})).extend();w.Encryptor=w.extend({processBlock:function(a,h){var f=this._cipher,b=f.blockSize;x.call(this,a,h,b);f.encryptBlock(a,h);this._prevBlock=a.slice(h,h+b)}});w.Decryptor=w.extend({processBlock:function(a,h){var f=this._cipher,b=f.blockSize,c=a.slice(h,h+b);f.decryptBlock(a,h);x.call(this,a,h,b);this._prevBlock=c}});c=c.CBC=w;w=(k.pad={}).Pkcs7={pad:function(a,h){h*=4;h-=a.sigBytes%
h;for(var f=h<<24|h<<16|h<<8|h,b=[],c=0;c<h;c+=4)b.push(f);h=p.create(b,h);a.concat(h)},unpad:function(a){a.sigBytes-=a.words[a.sigBytes-1>>>2]&255}};e.BlockCipher=r.extend({cfg:r.cfg.extend({mode:c,padding:w}),reset:function(){r.reset.call(this);var a=this.cfg,h=a.iv,a=a.mode;if(this._xformMode==this._ENC_XFORM_MODE)var f=a.createEncryptor;else f=a.createDecryptor,this._minBufferSize=1;this._mode=f.call(a,this,h&&h.words)},_doProcessBlock:function(a,h){this._mode.processBlock(a,h)},_doFinalize:function(){var a=
this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){a.pad(this._data,this.blockSize);var h=this._process(!0)}else h=this._process(!0),a.unpad(h);return h},blockSize:4});var b=e.CipherParams=g.extend({init:function(a){this.mixIn(a)},toString:function(a){return(a||this.formatter).stringify(this)}}),c=(k.format={}).OpenSSL={stringify:function(a){var h=a.ciphertext;a=a.salt;return(a?p.create([1398893684,1701076831]).concat(a).concat(h):h).toString(u)},parse:function(a){a=u.parse(a);var h=a.words;
if(1398893684==h[0]&&1701076831==h[1]){var f=p.create(h.slice(2,4));h.splice(0,4);a.sigBytes-=16}return b.create({ciphertext:a,salt:f})}},a=e.SerializableCipher=g.extend({cfg:g.extend({format:c}),encrypt:function(a,h,f,c){c=this.cfg.extend(c);var d=a.createEncryptor(f,c);h=d.finalize(h);d=d.cfg;return b.create({ciphertext:h,key:f,iv:d.iv,algorithm:a,mode:d.mode,padding:d.padding,blockSize:a.blockSize,formatter:c.format})},decrypt:function(a,h,f,b){b=this.cfg.extend(b);h=this._parse(h,b.format);return a.createDecryptor(f,
b).finalize(h.ciphertext)},_parse:function(a,h){return"string"==typeof a?h.parse(a,this):a}}),k=(k.kdf={}).OpenSSL={execute:function(a,h,f,c){c||(c=p.random(8));a=v.create({keySize:h+f}).compute(a,c);f=p.create(a.words.slice(h),4*f);a.sigBytes=4*h;return b.create({key:a,iv:f,salt:c})}},f=e.PasswordBasedCipher=a.extend({cfg:a.cfg.extend({kdf:k}),encrypt:function(f,h,b,c){c=this.cfg.extend(c);b=c.kdf.execute(b,f.keySize,f.ivSize);c.iv=b.iv;f=a.encrypt.call(this,f,h,b.key,c);f.mixIn(b);return f},decrypt:function(f,
h,b,c){c=this.cfg.extend(c);h=this._parse(h,c.format);b=c.kdf.execute(b,f.keySize,f.ivSize,h.salt);c.iv=b.iv;return a.decrypt.call(this,f,h,b.key,c)}})}();(function(){function d(){for(var d=this._S,e=this._i,g=this._j,r=0,c=0;4>c;c++){var e=(e+1)%256,g=(g+d[e])%256,p=d[e];d[e]=d[g];d[g]=p;r|=d[(d[e]+d[g])%256]<<24-8*c}this._i=e;this._j=g;return r}var k=y,e=k.lib.StreamCipher,g=k.algo,p=g.RC4=e.extend({_doReset:function(){for(var d=this._key,e=d.words,d=d.sigBytes,g=this._S=[],r=0;256>r;r++)g[r]=r;
for(var c=r=0;256>r;r++){var p=r%d,c=(c+g[r]+(e[p>>>2]>>>24-p%4*8&255))%256,p=g[r];g[r]=g[c];g[c]=p}this._i=this._j=0},_doProcessBlock:function(e,g){e[g]^=d.call(this)},keySize:8,ivSize:0});k.RC4=e._createHelper(p);g=g.RC4Drop=p.extend({cfg:p.cfg.extend({drop:192}),_doReset:function(){p._doReset.call(this);for(var e=this.cfg.drop;0<e;e--)d.call(this)}});k.RC4Drop=e._createHelper(g)})();y=y||function(d,k){var e={},g=e.lib={},p=function(){},q=g.Base={extend:function(a){p.prototype=this;var f=new p;
a&&f.mixIn(a);f.hasOwnProperty("init")||(f.init=function(){f.$super.init.apply(this,arguments)});f.init.prototype=f;f.$super=this;return f},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var f in a)a.hasOwnProperty(f)&&(this[f]=a[f]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},u=g.WordArray=q.extend({init:function(a,f){a=this.words=a||[];this.sigBytes=f!=k?f:
4*a.length},toString:function(a){return(a||r).stringify(this)},concat:function(a){var f=this.words,t=a.words,h=this.sigBytes;a=a.sigBytes;this.clamp();if(h%4)for(var b=0;b<a;b++)f[h+b>>>2]|=(t[b>>>2]>>>24-b%4*8&255)<<24-(h+b)%4*8;else if(65535<t.length)for(b=0;b<a;b+=4)f[h+b>>>2]=t[b>>>2];else f.push.apply(f,t);this.sigBytes+=a;return this},clamp:function(){var a=this.words,f=this.sigBytes;a[f>>>2]&=4294967295<<32-f%4*8;a.length=d.ceil(f/4)},clone:function(){var a=q.clone.call(this);a.words=this.words.slice(0);
return a},random:function(a){for(var f=[],t=0;t<a;t+=4)f.push(4294967296*d.random()|0);return new u.init(f,a)}}),v=e.enc={},r=v.Hex={stringify:function(a){var f=a.words;a=a.sigBytes;for(var t=[],h=0;h<a;h++){var b=f[h>>>2]>>>24-h%4*8&255;t.push((b>>>4).toString(16));t.push((b&15).toString(16))}return t.join("")},parse:function(a){for(var f=a.length,t=[],h=0;h<f;h+=2)t[h>>>3]|=parseInt(a.substr(h,2),16)<<24-h%8*4;return new u.init(t,f/2)}},c=v.Latin1={stringify:function(a){var f=a.words;a=a.sigBytes;
for(var t=[],h=0;h<a;h++)t.push(String.fromCharCode(f[h>>>2]>>>24-h%4*8&255));return t.join("")},parse:function(a){for(var f=a.length,t=[],h=0;h<f;h++)t[h>>>2]|=(a.charCodeAt(h)&255)<<24-h%4*8;return new u.init(t,f)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(f){throw Error("Malformed UTF-8 data");}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},w=g.BufferedBlockAlgorithm=q.extend({reset:function(){this._data=new u.init;this._nDataBytes=
0},_append:function(a){"string"==typeof a&&(a=x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var f=this._data,t=f.words,h=f.sigBytes,b=this.blockSize,c=h/(4*b),c=a?d.ceil(c):d.max((c|0)-this._minBufferSize,0);a=c*b;h=d.min(4*a,h);if(a){for(var e=0;e<a;e+=b)this._doProcessBlock(t,e);e=t.splice(0,a);f.sigBytes-=h}return new u.init(e,h)},clone:function(){var a=q.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});g.Hasher=w.extend({cfg:q.extend(),
init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(f,t){return(new a.init(t)).finalize(f)}},_createHmacHelper:function(a){return function(f,t){return(new b.HMAC.init(a,t)).finalize(f)}}});var b=e.algo={};return e}(Math);(function(d){var k=y,e=k.lib,g=e.Base,
p=e.WordArray,k=k.x64={};k.Word=g.extend({init:function(d,e){this.high=d;this.low=e}});k.WordArray=g.extend({init:function(e,g){e=this.words=e||[];this.sigBytes=g!=d?g:8*e.length},toX32:function(){for(var d=this.words,e=d.length,g=[],r=0;r<e;r++){var c=d[r];g.push(c.high);g.push(c.low)}return p.create(g,this.sigBytes)},clone:function(){for(var d=g.clone.call(this),e=d.words=this.words.slice(0),v=e.length,r=0;r<v;r++)e[r]=e[r].clone();return d}})})();(function(){function d(){return p.create.apply(p,
arguments)}for(var k=y,e=k.lib.Hasher,g=k.x64,p=g.Word,q=g.WordArray,g=k.algo,u=[d(1116352408,3609767458),d(1899447441,602891725),d(3049323471,3964484399),d(3921009573,2173295548),d(961987163,4081628472),d(1508970993,3053834265),d(2453635748,2937671579),d(2870763221,3664609560),d(3624381080,2734883394),d(310598401,1164996542),d(607225278,1323610764),d(1426881987,3590304994),d(1925078388,4068182383),d(2162078206,991336113),d(2614888103,633803317),d(3248222580,3479774868),d(3835390401,2666613458),d(4022224774,
944711139),d(264347078,2341262773),d(604807628,2007800933),d(770255983,1495990901),d(1249150122,1856431235),d(1555081692,3175218132),d(1996064986,2198950837),d(2554220882,3999719339),d(2821834349,766784016),d(2952996808,2566594879),d(3210313671,3203337956),d(3336571891,1034457026),d(3584528711,2466948901),d(113926993,3758326383),d(338241895,168717936),d(666307205,1188179964),d(773529912,1546045734),d(1294757372,1522805485),d(1396182291,2643833823),d(1695183700,2343527390),d(1986661051,1014477480),
d(2177026350,1206759142),d(2456956037,344077627),d(2730485921,1290863460),d(2820302411,3158454273),d(3259730800,3505952657),d(3345764771,106217008),d(3516065817,3606008344),d(3600352804,1432725776),d(4094571909,1467031594),d(275423344,851169720),d(430227734,3100823752),d(506948616,1363258195),d(659060556,3750685593),d(883997877,3785050280),d(958139571,3318307427),d(1322822218,3812723403),d(1537002063,2003034995),d(1747873779,3602036899),d(1955562222,1575990012),d(2024104815,1125592928),d(2227730452,
2716904306),d(2361852424,442776044),d(2428436474,593698344),d(2756734187,3733110249),d(3204031479,2999351573),d(3329325298,3815920427),d(3391569614,3928383900),d(3515267271,566280711),d(3940187606,3454069534),d(4118630271,4000239992),d(116418474,1914138554),d(174292421,2731055270),d(289380356,3203993006),d(460393269,320620315),d(685471733,587496836),d(852142971,1086792851),d(1017036298,365543100),d(1126000580,2618297676),d(1288033470,3409855158),d(1501505948,4234509866),d(1607167915,987167468),d(1816402316,
1246189591)],v=[],r=0;80>r;r++)v[r]=d();g=g.SHA512=e.extend({_doReset:function(){this._hash=new q.init([new p.init(1779033703,4089235720),new p.init(3144134277,2227873595),new p.init(1013904242,4271175723),new p.init(2773480762,1595750129),new p.init(1359893119,2917565137),new p.init(2600822924,725511199),new p.init(528734635,4215389547),new p.init(1541459225,327033209)])},_doProcessBlock:function(c,d){for(var e=this._hash.words,b=e[0],a=e[1],f=e[2],t=e[3],h=e[4],J=e[5],g=e[6],e=e[7],q=b.high,r=b.low,
p=a.high,k=a.low,C=f.high,y=f.low,F=t.high,D=t.low,B=h.high,E=h.low,m=J.high,l=J.low,n=g.high,da=g.low,la=e.high,ea=e.low,K=q,G=r,X=p,V=k,Y=C,W=y,ia=F,Z=D,L=B,H=E,fa=m,aa=l,ga=n,ba=da,ja=la,ca=ea,M=0;80>M;M++){var R=v[M];if(16>M)var I=R.high=c[d+2*M]|0,z=R.low=c[d+2*M+1]|0;else{var I=v[M-15],z=I.high,O=I.low,I=(z>>>1|O<<31)^(z>>>8|O<<24)^z>>>7,O=(O>>>1|z<<31)^(O>>>8|z<<24)^(O>>>7|z<<25),U=v[M-2],z=U.high,A=U.low,U=(z>>>19|A<<13)^(z<<3|A>>>29)^z>>>6,A=(A>>>19|z<<13)^(A<<3|z>>>29)^(A>>>6|z<<26),z=v[M-
7],ka=z.high,S=v[M-16],P=S.high,S=S.low,z=O+z.low,I=I+ka+(z>>>0<O>>>0?1:0),z=z+A,I=I+U+(z>>>0<A>>>0?1:0),z=z+S,I=I+P+(z>>>0<S>>>0?1:0);R.high=I;R.low=z}var ka=L&fa^~L&ga,S=H&aa^~H&ba,R=K&X^K&Y^X&Y,na=G&V^G&W^V&W,O=(K>>>28|G<<4)^(K<<30|G>>>2)^(K<<25|G>>>7),U=(G>>>28|K<<4)^(G<<30|K>>>2)^(G<<25|K>>>7),A=u[M],oa=A.high,ma=A.low,A=ca+((H>>>14|L<<18)^(H>>>18|L<<14)^(H<<23|L>>>9)),P=ja+((L>>>14|H<<18)^(L>>>18|H<<14)^(L<<23|H>>>9))+(A>>>0<ca>>>0?1:0),A=A+S,P=P+ka+(A>>>0<S>>>0?1:0),A=A+ma,P=P+oa+(A>>>0<ma>>>
0?1:0),A=A+z,P=P+I+(A>>>0<z>>>0?1:0),z=U+na,R=O+R+(z>>>0<U>>>0?1:0),ja=ga,ca=ba,ga=fa,ba=aa,fa=L,aa=H,H=Z+A|0,L=ia+P+(H>>>0<Z>>>0?1:0)|0,ia=Y,Z=W,Y=X,W=V,X=K,V=G,G=A+z|0,K=P+R+(G>>>0<A>>>0?1:0)|0}r=b.low=r+G;b.high=q+K+(r>>>0<G>>>0?1:0);k=a.low=k+V;a.high=p+X+(k>>>0<V>>>0?1:0);y=f.low=y+W;f.high=C+Y+(y>>>0<W>>>0?1:0);D=t.low=D+Z;t.high=F+ia+(D>>>0<Z>>>0?1:0);E=h.low=E+H;h.high=B+L+(E>>>0<H>>>0?1:0);l=J.low=l+aa;J.high=m+fa+(l>>>0<aa>>>0?1:0);da=g.low=da+ba;g.high=n+ga+(da>>>0<ba>>>0?1:0);ea=e.low=
ea+ca;e.high=la+ja+(ea>>>0<ca>>>0?1:0)},_doFinalize:function(){var c=this._data,e=c.words,d=8*this._nDataBytes,b=8*c.sigBytes;e[b>>>5]|=128<<24-b%32;e[(b+128>>>10<<5)+30]=Math.floor(d/4294967296);e[(b+128>>>10<<5)+31]=d;c.sigBytes=4*e.length;this._process();return this._hash.toX32()},clone:function(){var c=e.clone.call(this);c._hash=this._hash.clone();return c},blockSize:32});k.SHA512=e._createHelper(g);k.HmacSHA512=e._createHmacHelper(g)})();(function(){var d=y,k=d.x64,e=k.Word,g=k.WordArray,k=d.algo,
p=k.SHA512,k=k.SHA384=p.extend({_doReset:function(){this._hash=new g.init([new e.init(3418070365,3238371032),new e.init(1654270250,914150663),new e.init(2438529370,812702999),new e.init(355462360,4144912697),new e.init(1731405415,4290775857),new e.init(2394180231,1750603025),new e.init(3675008525,1694076839),new e.init(1203062813,3204075428)])},_doFinalize:function(){var e=p._doFinalize.call(this);e.sigBytes-=16;return e}});d.SHA384=p._createHelper(k);d.HmacSHA384=p._createHmacHelper(k)})();y=y||
function(d,k){var e={},g=e.lib={},p=function(){},q=g.Base={extend:function(a){p.prototype=this;var f=new p;a&&f.mixIn(a);f.hasOwnProperty("init")||(f.init=function(){f.$super.init.apply(this,arguments)});f.init.prototype=f;f.$super=this;return f},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var f in a)a.hasOwnProperty(f)&&(this[f]=a[f]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},
u=g.WordArray=q.extend({init:function(a,f){a=this.words=a||[];this.sigBytes=f!=k?f:4*a.length},toString:function(a){return(a||r).stringify(this)},concat:function(a){var f=this.words,t=a.words,h=this.sigBytes;a=a.sigBytes;this.clamp();if(h%4)for(var b=0;b<a;b++)f[h+b>>>2]|=(t[b>>>2]>>>24-b%4*8&255)<<24-(h+b)%4*8;else if(65535<t.length)for(b=0;b<a;b+=4)f[h+b>>>2]=t[b>>>2];else f.push.apply(f,t);this.sigBytes+=a;return this},clamp:function(){var a=this.words,f=this.sigBytes;a[f>>>2]&=4294967295<<32-
f%4*8;a.length=d.ceil(f/4)},clone:function(){var a=q.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var f=[],t=0;t<a;t+=4)f.push(4294967296*d.random()|0);return new u.init(f,a)}}),v=e.enc={},r=v.Hex={stringify:function(a){var f=a.words;a=a.sigBytes;for(var t=[],h=0;h<a;h++){var b=f[h>>>2]>>>24-h%4*8&255;t.push((b>>>4).toString(16));t.push((b&15).toString(16))}return t.join("")},parse:function(a){for(var f=a.length,t=[],h=0;h<f;h+=2)t[h>>>3]|=parseInt(a.substr(h,2),16)<<
24-h%8*4;return new u.init(t,f/2)}},c=v.Latin1={stringify:function(a){var f=a.words;a=a.sigBytes;for(var t=[],h=0;h<a;h++)t.push(String.fromCharCode(f[h>>>2]>>>24-h%4*8&255));return t.join("")},parse:function(a){for(var f=a.length,t=[],h=0;h<f;h++)t[h>>>2]|=(a.charCodeAt(h)&255)<<24-h%4*8;return new u.init(t,f)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(f){throw Error("Malformed UTF-8 data");}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},
w=g.BufferedBlockAlgorithm=q.extend({reset:function(){this._data=new u.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var f=this._data,t=f.words,h=f.sigBytes,b=this.blockSize,c=h/(4*b),c=a?d.ceil(c):d.max((c|0)-this._minBufferSize,0);a=c*b;h=d.min(4*a,h);if(a){for(var e=0;e<a;e+=b)this._doProcessBlock(t,e);e=t.splice(0,a);f.sigBytes-=h}return new u.init(e,h)},clone:function(){var a=q.clone.call(this);
a._data=this._data.clone();return a},_minBufferSize:0});g.Hasher=w.extend({cfg:q.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(f,t){return(new a.init(t)).finalize(f)}},_createHmacHelper:function(a){return function(f,t){return(new b.HMAC.init(a,
t)).finalize(f)}}});var b=e.algo={};return e}(Math);(function(d){for(var k=y,e=k.lib,g=e.WordArray,p=e.Hasher,e=k.algo,q=[],u=[],v=function(a){return 4294967296*(a-(a|0))|0},r=2,c=0;64>c;){var x;a:{x=r;for(var w=d.sqrt(x),b=2;b<=w;b++)if(!(x%b)){x=!1;break a}x=!0}x&&(8>c&&(q[c]=v(d.pow(r,.5))),u[c]=v(d.pow(r,1/3)),c++);r++}var a=[],e=e.SHA256=p.extend({_doReset:function(){this._hash=new g.init(q.slice(0))},_doProcessBlock:function(f,t){for(var h=this._hash.words,b=h[0],c=h[1],e=h[2],d=h[3],g=h[4],
w=h[5],q=h[6],v=h[7],r=0;64>r;r++){if(16>r)a[r]=f[t+r]|0;else{var p=a[r-15],k=a[r-2];a[r]=((p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3)+a[r-7]+((k<<15|k>>>17)^(k<<13|k>>>19)^k>>>10)+a[r-16]}p=v+((g<<26|g>>>6)^(g<<21|g>>>11)^(g<<7|g>>>25))+(g&w^~g&q)+u[r]+a[r];k=((b<<30|b>>>2)^(b<<19|b>>>13)^(b<<10|b>>>22))+(b&c^b&e^c&e);v=q;q=w;w=g;g=d+p|0;d=e;e=c;c=b;b=p+k|0}h[0]=h[0]+b|0;h[1]=h[1]+c|0;h[2]=h[2]+e|0;h[3]=h[3]+d|0;h[4]=h[4]+g|0;h[5]=h[5]+w|0;h[6]=h[6]+q|0;h[7]=h[7]+v|0},_doFinalize:function(){var a=this._data,
t=a.words,h=8*this._nDataBytes,b=8*a.sigBytes;t[b>>>5]|=128<<24-b%32;t[(b+64>>>9<<4)+14]=d.floor(h/4294967296);t[(b+64>>>9<<4)+15]=h;a.sigBytes=4*t.length;this._process();return this._hash},clone:function(){var a=p.clone.call(this);a._hash=this._hash.clone();return a}});k.SHA256=p._createHelper(e);k.HmacSHA256=p._createHmacHelper(e)})(Math);y=y||function(d,k){var e={},g=e.lib={},p=function(){},q=g.Base={extend:function(a){p.prototype=this;var f=new p;a&&f.mixIn(a);f.hasOwnProperty("init")||(f.init=
function(){f.$super.init.apply(this,arguments)});f.init.prototype=f;f.$super=this;return f},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var f in a)a.hasOwnProperty(f)&&(this[f]=a[f]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},u=g.WordArray=q.extend({init:function(a,f){a=this.words=a||[];this.sigBytes=f!=k?f:4*a.length},toString:function(a){return(a||r).stringify(this)},
concat:function(a){var f=this.words,t=a.words,h=this.sigBytes;a=a.sigBytes;this.clamp();if(h%4)for(var b=0;b<a;b++)f[h+b>>>2]|=(t[b>>>2]>>>24-b%4*8&255)<<24-(h+b)%4*8;else if(65535<t.length)for(b=0;b<a;b+=4)f[h+b>>>2]=t[b>>>2];else f.push.apply(f,t);this.sigBytes+=a;return this},clamp:function(){var a=this.words,f=this.sigBytes;a[f>>>2]&=4294967295<<32-f%4*8;a.length=d.ceil(f/4)},clone:function(){var a=q.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var f=[],t=0;t<
a;t+=4)f.push(4294967296*d.random()|0);return new u.init(f,a)}}),v=e.enc={},r=v.Hex={stringify:function(a){var f=a.words;a=a.sigBytes;for(var t=[],h=0;h<a;h++){var b=f[h>>>2]>>>24-h%4*8&255;t.push((b>>>4).toString(16));t.push((b&15).toString(16))}return t.join("")},parse:function(a){for(var f=a.length,t=[],h=0;h<f;h+=2)t[h>>>3]|=parseInt(a.substr(h,2),16)<<24-h%8*4;return new u.init(t,f/2)}},c=v.Latin1={stringify:function(a){var f=a.words;a=a.sigBytes;for(var t=[],h=0;h<a;h++)t.push(String.fromCharCode(f[h>>>
2]>>>24-h%4*8&255));return t.join("")},parse:function(a){for(var f=a.length,t=[],h=0;h<f;h++)t[h>>>2]|=(a.charCodeAt(h)&255)<<24-h%4*8;return new u.init(t,f)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(f){throw Error("Malformed UTF-8 data");}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},w=g.BufferedBlockAlgorithm=q.extend({reset:function(){this._data=new u.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=
x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var f=this._data,t=f.words,h=f.sigBytes,b=this.blockSize,c=h/(4*b),c=a?d.ceil(c):d.max((c|0)-this._minBufferSize,0);a=c*b;h=d.min(4*a,h);if(a){for(var e=0;e<a;e+=b)this._doProcessBlock(t,e);e=t.splice(0,a);f.sigBytes-=h}return new u.init(e,h)},clone:function(){var a=q.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});g.Hasher=w.extend({cfg:q.extend(),init:function(a){this.cfg=this.cfg.extend(a);
this.reset()},reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(f,t){return(new a.init(t)).finalize(f)}},_createHmacHelper:function(a){return function(f,t){return(new b.HMAC.init(a,t)).finalize(f)}}});var b=e.algo={};return e}(Math);(function(d){function k(c,b,a,f,t,h,e){c=c+(b&a|~b&f)+t+e;return(c<<h|c>>>32-h)+
b}function e(c,b,a,f,t,h,e){c=c+(b&f|a&~f)+t+e;return(c<<h|c>>>32-h)+b}function g(c,b,a,f,t,h,e){c=c+(b^a^f)+t+e;return(c<<h|c>>>32-h)+b}function p(c,b,a,f,t,h,e){c=c+(a^(b|~f))+t+e;return(c<<h|c>>>32-h)+b}for(var q=y,u=q.lib,v=u.WordArray,r=u.Hasher,u=q.algo,c=[],x=0;64>x;x++)c[x]=4294967296*d.abs(d.sin(x+1))|0;u=u.MD5=r.extend({_doReset:function(){this._hash=new v.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(d,b){for(var a=0;16>a;a++){var f=b+a,t=d[f];d[f]=(t<<8|
t>>>24)&16711935|(t<<24|t>>>8)&4278255360}var a=this._hash.words,f=d[b+0],t=d[b+1],h=d[b+2],J=d[b+3],q=d[b+4],v=d[b+5],r=d[b+6],u=d[b+7],x=d[b+8],C=d[b+9],y=d[b+10],F=d[b+11],D=d[b+12],B=d[b+13],E=d[b+14];d=d[b+15];b=a[0];var m=a[1],l=a[2],n=a[3];b=k(b,m,l,n,f,7,c[0]);n=k(n,b,m,l,t,12,c[1]);l=k(l,n,b,m,h,17,c[2]);m=k(m,l,n,b,J,22,c[3]);b=k(b,m,l,n,q,7,c[4]);n=k(n,b,m,l,v,12,c[5]);l=k(l,n,b,m,r,17,c[6]);m=k(m,l,n,b,u,22,c[7]);b=k(b,m,l,n,x,7,c[8]);n=k(n,b,m,l,C,12,c[9]);l=k(l,n,b,m,y,17,c[10]);m=k(m,
l,n,b,F,22,c[11]);b=k(b,m,l,n,D,7,c[12]);n=k(n,b,m,l,B,12,c[13]);l=k(l,n,b,m,E,17,c[14]);m=k(m,l,n,b,d,22,c[15]);b=e(b,m,l,n,t,5,c[16]);n=e(n,b,m,l,r,9,c[17]);l=e(l,n,b,m,F,14,c[18]);m=e(m,l,n,b,f,20,c[19]);b=e(b,m,l,n,v,5,c[20]);n=e(n,b,m,l,y,9,c[21]);l=e(l,n,b,m,d,14,c[22]);m=e(m,l,n,b,q,20,c[23]);b=e(b,m,l,n,C,5,c[24]);n=e(n,b,m,l,E,9,c[25]);l=e(l,n,b,m,J,14,c[26]);m=e(m,l,n,b,x,20,c[27]);b=e(b,m,l,n,B,5,c[28]);n=e(n,b,m,l,h,9,c[29]);l=e(l,n,b,m,u,14,c[30]);m=e(m,l,n,b,D,20,c[31]);b=g(b,m,l,n,
v,4,c[32]);n=g(n,b,m,l,x,11,c[33]);l=g(l,n,b,m,F,16,c[34]);m=g(m,l,n,b,E,23,c[35]);b=g(b,m,l,n,t,4,c[36]);n=g(n,b,m,l,q,11,c[37]);l=g(l,n,b,m,u,16,c[38]);m=g(m,l,n,b,y,23,c[39]);b=g(b,m,l,n,B,4,c[40]);n=g(n,b,m,l,f,11,c[41]);l=g(l,n,b,m,J,16,c[42]);m=g(m,l,n,b,r,23,c[43]);b=g(b,m,l,n,C,4,c[44]);n=g(n,b,m,l,D,11,c[45]);l=g(l,n,b,m,d,16,c[46]);m=g(m,l,n,b,h,23,c[47]);b=p(b,m,l,n,f,6,c[48]);n=p(n,b,m,l,u,10,c[49]);l=p(l,n,b,m,E,15,c[50]);m=p(m,l,n,b,v,21,c[51]);b=p(b,m,l,n,D,6,c[52]);n=p(n,b,m,l,J,10,
c[53]);l=p(l,n,b,m,y,15,c[54]);m=p(m,l,n,b,t,21,c[55]);b=p(b,m,l,n,x,6,c[56]);n=p(n,b,m,l,d,10,c[57]);l=p(l,n,b,m,r,15,c[58]);m=p(m,l,n,b,B,21,c[59]);b=p(b,m,l,n,q,6,c[60]);n=p(n,b,m,l,F,10,c[61]);l=p(l,n,b,m,h,15,c[62]);m=p(m,l,n,b,C,21,c[63]);a[0]=a[0]+b|0;a[1]=a[1]+m|0;a[2]=a[2]+l|0;a[3]=a[3]+n|0},_doFinalize:function(){var c=this._data,b=c.words,a=8*this._nDataBytes,f=8*c.sigBytes;b[f>>>5]|=128<<24-f%32;var t=d.floor(a/4294967296);b[(f+64>>>9<<4)+15]=(t<<8|t>>>24)&16711935|(t<<24|t>>>8)&4278255360;
b[(f+64>>>9<<4)+14]=(a<<8|a>>>24)&16711935|(a<<24|a>>>8)&4278255360;c.sigBytes=4*(b.length+1);this._process();c=this._hash;b=c.words;for(a=0;4>a;a++)f=b[a],b[a]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360;return c},clone:function(){var c=r.clone.call(this);c._hash=this._hash.clone();return c}});q.MD5=r._createHelper(u);q.HmacMD5=r._createHmacHelper(u)})(Math);(function(){var d=y,k=d.enc.Utf8;d.algo.HMAC=d.lib.Base.extend({init:function(e,d){e=this._hasher=new e.init;"string"==typeof d&&(d=k.parse(d));
var p=e.blockSize,q=4*p;d.sigBytes>q&&(d=e.finalize(d));d.clamp();e=this._oKey=d.clone();d=this._iKey=d.clone();for(var u=e.words,v=d.words,r=0;r<p;r++)u[r]^=1549556828,v[r]^=909522486;e.sigBytes=d.sigBytes=q;this.reset()},reset:function(){var d=this._hasher;d.reset();d.update(this._iKey)},update:function(d){this._hasher.update(d);return this},finalize:function(d){var g=this._hasher;d=g.finalize(d);g.reset();return g.finalize(this._oKey.clone().concat(d))}})})();y=y||function(d,k){var e={},g=e.lib=
{},p=function(){},q=g.Base={extend:function(a){p.prototype=this;var f=new p;a&&f.mixIn(a);f.hasOwnProperty("init")||(f.init=function(){f.$super.init.apply(this,arguments)});f.init.prototype=f;f.$super=this;return f},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var f in a)a.hasOwnProperty(f)&&(this[f]=a[f]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},u=g.WordArray=
q.extend({init:function(a,f){a=this.words=a||[];this.sigBytes=f!=k?f:4*a.length},toString:function(a){return(a||r).stringify(this)},concat:function(a){var f=this.words,t=a.words,h=this.sigBytes;a=a.sigBytes;this.clamp();if(h%4)for(var b=0;b<a;b++)f[h+b>>>2]|=(t[b>>>2]>>>24-b%4*8&255)<<24-(h+b)%4*8;else if(65535<t.length)for(b=0;b<a;b+=4)f[h+b>>>2]=t[b>>>2];else f.push.apply(f,t);this.sigBytes+=a;return this},clamp:function(){var a=this.words,f=this.sigBytes;a[f>>>2]&=4294967295<<32-f%4*8;a.length=
d.ceil(f/4)},clone:function(){var a=q.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var f=[],b=0;b<a;b+=4)f.push(4294967296*d.random()|0);return new u.init(f,a)}}),v=e.enc={},r=v.Hex={stringify:function(a){var f=a.words;a=a.sigBytes;for(var b=[],h=0;h<a;h++){var c=f[h>>>2]>>>24-h%4*8&255;b.push((c>>>4).toString(16));b.push((c&15).toString(16))}return b.join("")},parse:function(a){for(var f=a.length,b=[],h=0;h<f;h+=2)b[h>>>3]|=parseInt(a.substr(h,2),16)<<24-h%8*4;return new u.init(b,
f/2)}},c=v.Latin1={stringify:function(a){var f=a.words;a=a.sigBytes;for(var b=[],h=0;h<a;h++)b.push(String.fromCharCode(f[h>>>2]>>>24-h%4*8&255));return b.join("")},parse:function(a){for(var f=a.length,b=[],h=0;h<f;h++)b[h>>>2]|=(a.charCodeAt(h)&255)<<24-h%4*8;return new u.init(b,f)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(f){throw Error("Malformed UTF-8 data");}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},w=g.BufferedBlockAlgorithm=
q.extend({reset:function(){this._data=new u.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var f=this._data,b=f.words,h=f.sigBytes,c=this.blockSize,e=h/(4*c),e=a?d.ceil(e):d.max((e|0)-this._minBufferSize,0);a=e*c;h=d.min(4*a,h);if(a){for(var g=0;g<a;g+=c)this._doProcessBlock(b,g);g=b.splice(0,a);f.sigBytes-=h}return new u.init(g,h)},clone:function(){var a=q.clone.call(this);a._data=this._data.clone();
return a},_minBufferSize:0});g.Hasher=w.extend({cfg:q.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(f,b){return(new a.init(b)).finalize(f)}},_createHmacHelper:function(a){return function(f,t){return(new b.HMAC.init(a,t)).finalize(f)}}});var b=
e.algo={};return e}(Math);(function(d){var k=y,e=k.lib,g=e.Base,p=e.WordArray,k=k.x64={};k.Word=g.extend({init:function(d,e){this.high=d;this.low=e}});k.WordArray=g.extend({init:function(e,g){e=this.words=e||[];this.sigBytes=g!=d?g:8*e.length},toX32:function(){for(var d=this.words,e=d.length,g=[],r=0;r<e;r++){var c=d[r];g.push(c.high);g.push(c.low)}return p.create(g,this.sigBytes)},clone:function(){for(var d=g.clone.call(this),e=d.words=this.words.slice(0),v=e.length,r=0;r<v;r++)e[r]=e[r].clone();
return d}})})();(function(){function d(){return p.create.apply(p,arguments)}for(var k=y,e=k.lib.Hasher,g=k.x64,p=g.Word,q=g.WordArray,g=k.algo,u=[d(1116352408,3609767458),d(1899447441,602891725),d(3049323471,3964484399),d(3921009573,2173295548),d(961987163,4081628472),d(1508970993,3053834265),d(2453635748,2937671579),d(2870763221,3664609560),d(3624381080,2734883394),d(310598401,1164996542),d(607225278,1323610764),d(1426881987,3590304994),d(1925078388,4068182383),d(2162078206,991336113),d(2614888103,
633803317),d(3248222580,3479774868),d(3835390401,2666613458),d(4022224774,944711139),d(264347078,2341262773),d(604807628,2007800933),d(770255983,1495990901),d(1249150122,1856431235),d(1555081692,3175218132),d(1996064986,2198950837),d(2554220882,3999719339),d(2821834349,766784016),d(2952996808,2566594879),d(3210313671,3203337956),d(3336571891,1034457026),d(3584528711,2466948901),d(113926993,3758326383),d(338241895,168717936),d(666307205,1188179964),d(773529912,1546045734),d(1294757372,1522805485),
d(1396182291,2643833823),d(1695183700,2343527390),d(1986661051,1014477480),d(2177026350,1206759142),d(2456956037,344077627),d(2730485921,1290863460),d(2820302411,3158454273),d(3259730800,3505952657),d(3345764771,106217008),d(3516065817,3606008344),d(3600352804,1432725776),d(4094571909,1467031594),d(275423344,851169720),d(430227734,3100823752),d(506948616,1363258195),d(659060556,3750685593),d(883997877,3785050280),d(958139571,3318307427),d(1322822218,3812723403),d(1537002063,2003034995),d(1747873779,
3602036899),d(1955562222,1575990012),d(2024104815,1125592928),d(2227730452,2716904306),d(2361852424,442776044),d(2428436474,593698344),d(2756734187,3733110249),d(3204031479,2999351573),d(3329325298,3815920427),d(3391569614,3928383900),d(3515267271,566280711),d(3940187606,3454069534),d(4118630271,4000239992),d(116418474,1914138554),d(174292421,2731055270),d(289380356,3203993006),d(460393269,320620315),d(685471733,587496836),d(852142971,1086792851),d(1017036298,365543100),d(1126000580,2618297676),d(1288033470,
3409855158),d(1501505948,4234509866),d(1607167915,987167468),d(1816402316,1246189591)],v=[],r=0;80>r;r++)v[r]=d();g=g.SHA512=e.extend({_doReset:function(){this._hash=new q.init([new p.init(1779033703,4089235720),new p.init(3144134277,2227873595),new p.init(1013904242,4271175723),new p.init(2773480762,1595750129),new p.init(1359893119,2917565137),new p.init(2600822924,725511199),new p.init(528734635,4215389547),new p.init(1541459225,327033209)])},_doProcessBlock:function(c,d){for(var e=this._hash.words,
b=e[0],a=e[1],f=e[2],t=e[3],h=e[4],J=e[5],g=e[6],e=e[7],q=b.high,r=b.low,p=a.high,k=a.low,C=f.high,y=f.low,F=t.high,D=t.low,B=h.high,E=h.low,m=J.high,l=J.low,n=g.high,da=g.low,la=e.high,ea=e.low,K=q,G=r,X=p,V=k,Y=C,W=y,ia=F,Z=D,L=B,H=E,fa=m,aa=l,ga=n,ba=da,ja=la,ca=ea,M=0;80>M;M++){var R=v[M];if(16>M)var I=R.high=c[d+2*M]|0,z=R.low=c[d+2*M+1]|0;else{var I=v[M-15],z=I.high,O=I.low,I=(z>>>1|O<<31)^(z>>>8|O<<24)^z>>>7,O=(O>>>1|z<<31)^(O>>>8|z<<24)^(O>>>7|z<<25),U=v[M-2],z=U.high,A=U.low,U=(z>>>19|A<<
13)^(z<<3|A>>>29)^z>>>6,A=(A>>>19|z<<13)^(A<<3|z>>>29)^(A>>>6|z<<26),z=v[M-7],ka=z.high,S=v[M-16],P=S.high,S=S.low,z=O+z.low,I=I+ka+(z>>>0<O>>>0?1:0),z=z+A,I=I+U+(z>>>0<A>>>0?1:0),z=z+S,I=I+P+(z>>>0<S>>>0?1:0);R.high=I;R.low=z}var ka=L&fa^~L&ga,S=H&aa^~H&ba,R=K&X^K&Y^X&Y,na=G&V^G&W^V&W,O=(K>>>28|G<<4)^(K<<30|G>>>2)^(K<<25|G>>>7),U=(G>>>28|K<<4)^(G<<30|K>>>2)^(G<<25|K>>>7),A=u[M],oa=A.high,ma=A.low,A=ca+((H>>>14|L<<18)^(H>>>18|L<<14)^(H<<23|L>>>9)),P=ja+((L>>>14|H<<18)^(L>>>18|H<<14)^(L<<23|H>>>9))+
(A>>>0<ca>>>0?1:0),A=A+S,P=P+ka+(A>>>0<S>>>0?1:0),A=A+ma,P=P+oa+(A>>>0<ma>>>0?1:0),A=A+z,P=P+I+(A>>>0<z>>>0?1:0),z=U+na,R=O+R+(z>>>0<U>>>0?1:0),ja=ga,ca=ba,ga=fa,ba=aa,fa=L,aa=H,H=Z+A|0,L=ia+P+(H>>>0<Z>>>0?1:0)|0,ia=Y,Z=W,Y=X,W=V,X=K,V=G,G=A+z|0,K=P+R+(G>>>0<A>>>0?1:0)|0}r=b.low=r+G;b.high=q+K+(r>>>0<G>>>0?1:0);k=a.low=k+V;a.high=p+X+(k>>>0<V>>>0?1:0);y=f.low=y+W;f.high=C+Y+(y>>>0<W>>>0?1:0);D=t.low=D+Z;t.high=F+ia+(D>>>0<Z>>>0?1:0);E=h.low=E+H;h.high=B+L+(E>>>0<H>>>0?1:0);l=J.low=l+aa;J.high=m+fa+
(l>>>0<aa>>>0?1:0);da=g.low=da+ba;g.high=n+ga+(da>>>0<ba>>>0?1:0);ea=e.low=ea+ca;e.high=la+ja+(ea>>>0<ca>>>0?1:0)},_doFinalize:function(){var c=this._data,d=c.words,e=8*this._nDataBytes,b=8*c.sigBytes;d[b>>>5]|=128<<24-b%32;d[(b+128>>>10<<5)+30]=Math.floor(e/4294967296);d[(b+128>>>10<<5)+31]=e;c.sigBytes=4*d.length;this._process();return this._hash.toX32()},clone:function(){var c=e.clone.call(this);c._hash=this._hash.clone();return c},blockSize:32});k.SHA512=e._createHelper(g);k.HmacSHA512=e._createHmacHelper(g)})();
(function(){var d=y,k=d.x64,e=k.Word,g=k.WordArray,k=d.algo,p=k.SHA512,k=k.SHA384=p.extend({_doReset:function(){this._hash=new g.init([new e.init(3418070365,3238371032),new e.init(1654270250,914150663),new e.init(2438529370,812702999),new e.init(355462360,4144912697),new e.init(1731405415,4290775857),new e.init(2394180231,1750603025),new e.init(3675008525,1694076839),new e.init(1203062813,3204075428)])},_doFinalize:function(){var d=p._doFinalize.call(this);d.sigBytes-=16;return d}});d.SHA384=p._createHelper(k);
d.HmacSHA384=p._createHmacHelper(k)})();(function(){var d=y,k=d.enc.Utf8;d.algo.HMAC=d.lib.Base.extend({init:function(d,g){d=this._hasher=new d.init;"string"==typeof g&&(g=k.parse(g));var p=d.blockSize,q=4*p;g.sigBytes>q&&(g=d.finalize(g));g.clamp();d=this._oKey=g.clone();g=this._iKey=g.clone();for(var u=d.words,v=g.words,r=0;r<p;r++)u[r]^=1549556828,v[r]^=909522486;d.sigBytes=g.sigBytes=q;this.reset()},reset:function(){var d=this._hasher;d.reset();d.update(this._iKey)},update:function(d){this._hasher.update(d);
return this},finalize:function(d){var g=this._hasher;d=g.finalize(d);g.reset();return g.finalize(this._oKey.clone().concat(d))}})})();y=y||function(d,k){var e={},g=e.lib={},p=function(){},q=g.Base={extend:function(a){p.prototype=this;var f=new p;a&&f.mixIn(a);f.hasOwnProperty("init")||(f.init=function(){f.$super.init.apply(this,arguments)});f.init.prototype=f;f.$super=this;return f},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var f in a)a.hasOwnProperty(f)&&
(this[f]=a[f]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},u=g.WordArray=q.extend({init:function(a,f){a=this.words=a||[];this.sigBytes=f!=k?f:4*a.length},toString:function(a){return(a||r).stringify(this)},concat:function(a){var f=this.words,b=a.words,h=this.sigBytes;a=a.sigBytes;this.clamp();if(h%4)for(var c=0;c<a;c++)f[h+c>>>2]|=(b[c>>>2]>>>24-c%4*8&255)<<24-(h+c)%4*8;else if(65535<b.length)for(c=0;c<a;c+=4)f[h+c>>>2]=b[c>>>
2];else f.push.apply(f,b);this.sigBytes+=a;return this},clamp:function(){var a=this.words,f=this.sigBytes;a[f>>>2]&=4294967295<<32-f%4*8;a.length=d.ceil(f/4)},clone:function(){var a=q.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var f=[],b=0;b<a;b+=4)f.push(4294967296*d.random()|0);return new u.init(f,a)}}),v=e.enc={},r=v.Hex={stringify:function(a){var f=a.words;a=a.sigBytes;for(var b=[],h=0;h<a;h++){var c=f[h>>>2]>>>24-h%4*8&255;b.push((c>>>4).toString(16));b.push((c&
15).toString(16))}return b.join("")},parse:function(a){for(var f=a.length,b=[],h=0;h<f;h+=2)b[h>>>3]|=parseInt(a.substr(h,2),16)<<24-h%8*4;return new u.init(b,f/2)}},c=v.Latin1={stringify:function(a){var f=a.words;a=a.sigBytes;for(var b=[],h=0;h<a;h++)b.push(String.fromCharCode(f[h>>>2]>>>24-h%4*8&255));return b.join("")},parse:function(a){for(var f=a.length,b=[],h=0;h<f;h++)b[h>>>2]|=(a.charCodeAt(h)&255)<<24-h%4*8;return new u.init(b,f)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(f){throw Error("Malformed UTF-8 data");
}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},w=g.BufferedBlockAlgorithm=q.extend({reset:function(){this._data=new u.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var f=this._data,b=f.words,h=f.sigBytes,c=this.blockSize,e=h/(4*c),e=a?d.ceil(e):d.max((e|0)-this._minBufferSize,0);a=e*c;h=d.min(4*a,h);if(a){for(var g=0;g<a;g+=c)this._doProcessBlock(b,g);g=b.splice(0,a);f.sigBytes-=
h}return new u.init(g,h)},clone:function(){var a=q.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});g.Hasher=w.extend({cfg:q.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(f,b){return(new a.init(b)).finalize(f)}},_createHmacHelper:function(a){return function(f,
t){return(new b.HMAC.init(a,t)).finalize(f)}}});var b=e.algo={};return e}(Math);(function(d){for(var k=y,e=k.lib,g=e.WordArray,p=e.Hasher,e=k.algo,q=[],u=[],v=function(a){return 4294967296*(a-(a|0))|0},r=2,c=0;64>c;){var x;a:{x=r;for(var w=d.sqrt(x),b=2;b<=w;b++)if(!(x%b)){x=!1;break a}x=!0}x&&(8>c&&(q[c]=v(d.pow(r,.5))),u[c]=v(d.pow(r,1/3)),c++);r++}var a=[],e=e.SHA256=p.extend({_doReset:function(){this._hash=new g.init(q.slice(0))},_doProcessBlock:function(f,b){for(var h=this._hash.words,c=h[0],
d=h[1],e=h[2],g=h[3],r=h[4],v=h[5],q=h[6],w=h[7],p=0;64>p;p++){if(16>p)a[p]=f[b+p]|0;else{var k=a[p-15],x=a[p-2];a[p]=((k<<25|k>>>7)^(k<<14|k>>>18)^k>>>3)+a[p-7]+((x<<15|x>>>17)^(x<<13|x>>>19)^x>>>10)+a[p-16]}k=w+((r<<26|r>>>6)^(r<<21|r>>>11)^(r<<7|r>>>25))+(r&v^~r&q)+u[p]+a[p];x=((c<<30|c>>>2)^(c<<19|c>>>13)^(c<<10|c>>>22))+(c&d^c&e^d&e);w=q;q=v;v=r;r=g+k|0;g=e;e=d;d=c;c=k+x|0}h[0]=h[0]+c|0;h[1]=h[1]+d|0;h[2]=h[2]+e|0;h[3]=h[3]+g|0;h[4]=h[4]+r|0;h[5]=h[5]+v|0;h[6]=h[6]+q|0;h[7]=h[7]+w|0},_doFinalize:function(){var a=
this._data,b=a.words,h=8*this._nDataBytes,c=8*a.sigBytes;b[c>>>5]|=128<<24-c%32;b[(c+64>>>9<<4)+14]=d.floor(h/4294967296);b[(c+64>>>9<<4)+15]=h;a.sigBytes=4*b.length;this._process();return this._hash},clone:function(){var a=p.clone.call(this);a._hash=this._hash.clone();return a}});k.SHA256=p._createHelper(e);k.HmacSHA256=p._createHmacHelper(e)})(Math);(function(){var d=y,k=d.lib.WordArray,e=d.algo,g=e.SHA256,e=e.SHA224=g.extend({_doReset:function(){this._hash=new k.init([3238371032,914150663,812702999,
4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var d=g._doFinalize.call(this);d.sigBytes-=4;return d}});d.SHA224=g._createHelper(e);d.HmacSHA224=g._createHmacHelper(e)})();(function(){var d=y,k=d.enc.Utf8;d.algo.HMAC=d.lib.Base.extend({init:function(d,g){d=this._hasher=new d.init;"string"==typeof g&&(g=k.parse(g));var p=d.blockSize,q=4*p;g.sigBytes>q&&(g=d.finalize(g));g.clamp();d=this._oKey=g.clone();g=this._iKey=g.clone();for(var u=d.words,v=g.words,r=0;r<p;r++)u[r]^=
1549556828,v[r]^=909522486;d.sigBytes=g.sigBytes=q;this.reset()},reset:function(){var d=this._hasher;d.reset();d.update(this._iKey)},update:function(d){this._hasher.update(d);return this},finalize:function(d){var g=this._hasher;d=g.finalize(d);g.reset();return g.finalize(this._oKey.clone().concat(d))}})})();y=y||function(d,k){var e={},g=e.lib={},p=function(){},q=g.Base={extend:function(a){p.prototype=this;var f=new p;a&&f.mixIn(a);f.hasOwnProperty("init")||(f.init=function(){f.$super.init.apply(this,
arguments)});f.init.prototype=f;f.$super=this;return f},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var f in a)a.hasOwnProperty(f)&&(this[f]=a[f]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},u=g.WordArray=q.extend({init:function(a,f){a=this.words=a||[];this.sigBytes=f!=k?f:4*a.length},toString:function(a){return(a||r).stringify(this)},concat:function(a){var f=
this.words,b=a.words,h=this.sigBytes;a=a.sigBytes;this.clamp();if(h%4)for(var c=0;c<a;c++)f[h+c>>>2]|=(b[c>>>2]>>>24-c%4*8&255)<<24-(h+c)%4*8;else if(65535<b.length)for(c=0;c<a;c+=4)f[h+c>>>2]=b[c>>>2];else f.push.apply(f,b);this.sigBytes+=a;return this},clamp:function(){var a=this.words,f=this.sigBytes;a[f>>>2]&=4294967295<<32-f%4*8;a.length=d.ceil(f/4)},clone:function(){var a=q.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var f=[],b=0;b<a;b+=4)f.push(4294967296*
d.random()|0);return new u.init(f,a)}}),v=e.enc={},r=v.Hex={stringify:function(a){var f=a.words;a=a.sigBytes;for(var b=[],h=0;h<a;h++){var c=f[h>>>2]>>>24-h%4*8&255;b.push((c>>>4).toString(16));b.push((c&15).toString(16))}return b.join("")},parse:function(a){for(var f=a.length,b=[],h=0;h<f;h+=2)b[h>>>3]|=parseInt(a.substr(h,2),16)<<24-h%8*4;return new u.init(b,f/2)}},c=v.Latin1={stringify:function(a){var f=a.words;a=a.sigBytes;for(var b=[],h=0;h<a;h++)b.push(String.fromCharCode(f[h>>>2]>>>24-h%4*
8&255));return b.join("")},parse:function(a){for(var f=a.length,b=[],h=0;h<f;h++)b[h>>>2]|=(a.charCodeAt(h)&255)<<24-h%4*8;return new u.init(b,f)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(f){throw Error("Malformed UTF-8 data");}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},w=g.BufferedBlockAlgorithm=q.extend({reset:function(){this._data=new u.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=x.parse(a));
this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var f=this._data,b=f.words,h=f.sigBytes,c=this.blockSize,e=h/(4*c),e=a?d.ceil(e):d.max((e|0)-this._minBufferSize,0);a=e*c;h=d.min(4*a,h);if(a){for(var g=0;g<a;g+=c)this._doProcessBlock(b,g);g=b.splice(0,a);f.sigBytes-=h}return new u.init(g,h)},clone:function(){var a=q.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});g.Hasher=w.extend({cfg:q.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},
reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(f,b){return(new a.init(b)).finalize(f)}},_createHmacHelper:function(a){return function(f,t){return(new b.HMAC.init(a,t)).finalize(f)}}});var b=e.algo={};return e}(Math);(function(d){var k=y,e=k.lib,g=e.Base,p=e.WordArray,k=k.x64={};k.Word=g.extend({init:function(d,
e){this.high=d;this.low=e}});k.WordArray=g.extend({init:function(e,g){e=this.words=e||[];this.sigBytes=g!=d?g:8*e.length},toX32:function(){for(var d=this.words,e=d.length,g=[],r=0;r<e;r++){var c=d[r];g.push(c.high);g.push(c.low)}return p.create(g,this.sigBytes)},clone:function(){for(var d=g.clone.call(this),e=d.words=this.words.slice(0),v=e.length,r=0;r<v;r++)e[r]=e[r].clone();return d}})})();(function(d){for(var k=y,e=k.lib,g=e.WordArray,p=e.Hasher,q=k.x64.Word,e=k.algo,u=[],v=[],r=[],c=1,x=0,w=
0;24>w;w++){u[c+5*x]=(w+1)*(w+2)/2%64;var b=(2*c+3*x)%5,c=x%5,x=b}for(c=0;5>c;c++)for(x=0;5>x;x++)v[c+5*x]=x+(2*c+3*x)%5*5;c=1;for(x=0;24>x;x++){for(var a=b=w=0;7>a;a++){if(c&1){var f=(1<<a)-1;32>f?b^=1<<f:w^=1<<f-32}c=c&128?c<<1^113:c<<1}r[x]=q.create(w,b)}for(var t=[],c=0;25>c;c++)t[c]=q.create();e=e.SHA3=p.extend({cfg:p.cfg.extend({outputLength:512}),_doReset:function(){for(var a=this._state=[],f=0;25>f;f++)a[f]=new q.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(a,
f){for(var b=this._state,c=this.blockSize/2,d=0;d<c;d++){var e=a[f+2*d],g=a[f+2*d+1],e=(e<<8|e>>>24)&16711935|(e<<24|e>>>8)&4278255360,g=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360,w=b[d];w.high^=g;w.low^=e}for(c=0;24>c;c++){for(d=0;5>d;d++){var q=e=0;for(a=0;5>a;a++)w=b[d+5*a],e^=w.high,q^=w.low;w=t[d];w.high=e;w.low=q}for(d=0;5>d;d++)for(w=t[(d+4)%5],e=t[(d+1)%5],g=e.high,a=e.low,e=w.high^(g<<1|a>>>31),q=w.low^(a<<1|g>>>31),a=0;5>a;a++)w=b[d+5*a],w.high^=e,w.low^=q;for(g=1;25>g;g++)w=b[g],d=
w.high,w=w.low,a=u[g],32>a?(e=d<<a|w>>>32-a,q=w<<a|d>>>32-a):(e=w<<a-32|d>>>64-a,q=d<<a-32|w>>>64-a),w=t[v[g]],w.high=e,w.low=q;w=t[0];d=b[0];w.high=d.high;w.low=d.low;for(d=0;5>d;d++)for(a=0;5>a;a++)g=d+5*a,w=b[g],e=t[g],g=t[(d+1)%5+5*a],q=t[(d+2)%5+5*a],w.high=e.high^~g.high&q.high,w.low=e.low^~g.low&q.low;w=b[0];d=r[c];w.high^=d.high;w.low^=d.low}},_doFinalize:function(){var a=this._data,f=a.words,b=8*a.sigBytes,t=32*this.blockSize;f[b>>>5]|=1<<24-b%32;f[(d.ceil((b+1)/t)*t>>>5)-1]|=128;a.sigBytes=
4*f.length;this._process();for(var a=this._state,f=this.cfg.outputLength/8,b=f/8,t=[],c=0;c<b;c++){var e=a[c],w=e.high,e=e.low,w=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360,e=(e<<8|e>>>24)&16711935|(e<<24|e>>>8)&4278255360;t.push(e);t.push(w)}return new g.init(t,f)},clone:function(){for(var a=p.clone.call(this),f=a._state=this._state.slice(0),b=0;25>b;b++)f[b]=f[b].clone();return a}});k.SHA3=p._createHelper(e);k.HmacSHA3=p._createHmacHelper(e)})(Math);y=y||function(d,k){var e={},g=e.lib={},p=
function(){},q=g.Base={extend:function(a){p.prototype=this;var f=new p;a&&f.mixIn(a);f.hasOwnProperty("init")||(f.init=function(){f.$super.init.apply(this,arguments)});f.init.prototype=f;f.$super=this;return f},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var f in a)a.hasOwnProperty(f)&&(this[f]=a[f]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},u=g.WordArray=
q.extend({init:function(a,f){a=this.words=a||[];this.sigBytes=f!=k?f:4*a.length},toString:function(a){return(a||r).stringify(this)},concat:function(a){var f=this.words,b=a.words,h=this.sigBytes;a=a.sigBytes;this.clamp();if(h%4)for(var c=0;c<a;c++)f[h+c>>>2]|=(b[c>>>2]>>>24-c%4*8&255)<<24-(h+c)%4*8;else if(65535<b.length)for(c=0;c<a;c+=4)f[h+c>>>2]=b[c>>>2];else f.push.apply(f,b);this.sigBytes+=a;return this},clamp:function(){var a=this.words,f=this.sigBytes;a[f>>>2]&=4294967295<<32-f%4*8;a.length=
d.ceil(f/4)},clone:function(){var a=q.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var f=[],b=0;b<a;b+=4)f.push(4294967296*d.random()|0);return new u.init(f,a)}}),v=e.enc={},r=v.Hex={stringify:function(a){var f=a.words;a=a.sigBytes;for(var b=[],h=0;h<a;h++){var c=f[h>>>2]>>>24-h%4*8&255;b.push((c>>>4).toString(16));b.push((c&15).toString(16))}return b.join("")},parse:function(a){for(var f=a.length,b=[],h=0;h<f;h+=2)b[h>>>3]|=parseInt(a.substr(h,2),16)<<24-h%8*4;return new u.init(b,
f/2)}},c=v.Latin1={stringify:function(a){var f=a.words;a=a.sigBytes;for(var b=[],h=0;h<a;h++)b.push(String.fromCharCode(f[h>>>2]>>>24-h%4*8&255));return b.join("")},parse:function(a){for(var f=a.length,b=[],h=0;h<f;h++)b[h>>>2]|=(a.charCodeAt(h)&255)<<24-h%4*8;return new u.init(b,f)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(f){throw Error("Malformed UTF-8 data");}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},w=g.BufferedBlockAlgorithm=
q.extend({reset:function(){this._data=new u.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var f=this._data,b=f.words,h=f.sigBytes,c=this.blockSize,e=h/(4*c),e=a?d.ceil(e):d.max((e|0)-this._minBufferSize,0);a=e*c;h=d.min(4*a,h);if(a){for(var g=0;g<a;g+=c)this._doProcessBlock(b,g);g=b.splice(0,a);f.sigBytes-=h}return new u.init(g,h)},clone:function(){var a=q.clone.call(this);a._data=this._data.clone();
return a},_minBufferSize:0});g.Hasher=w.extend({cfg:q.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(f,b){return(new a.init(b)).finalize(f)}},_createHmacHelper:function(a){return function(f,t){return(new b.HMAC.init(a,t)).finalize(f)}}});var b=
e.algo={};return e}(Math);(function(d){var k=y,e=k.lib,g=e.Base,p=e.WordArray,k=k.x64={};k.Word=g.extend({init:function(d,e){this.high=d;this.low=e}});k.WordArray=g.extend({init:function(e,g){e=this.words=e||[];this.sigBytes=g!=d?g:8*e.length},toX32:function(){for(var d=this.words,e=d.length,g=[],r=0;r<e;r++){var c=d[r];g.push(c.high);g.push(c.low)}return p.create(g,this.sigBytes)},clone:function(){for(var d=g.clone.call(this),e=d.words=this.words.slice(0),v=e.length,r=0;r<v;r++)e[r]=e[r].clone();
return d}})})();(function(){function d(){return p.create.apply(p,arguments)}for(var k=y,e=k.lib.Hasher,g=k.x64,p=g.Word,q=g.WordArray,g=k.algo,u=[d(1116352408,3609767458),d(1899447441,602891725),d(3049323471,3964484399),d(3921009573,2173295548),d(961987163,4081628472),d(1508970993,3053834265),d(2453635748,2937671579),d(2870763221,3664609560),d(3624381080,2734883394),d(310598401,1164996542),d(607225278,1323610764),d(1426881987,3590304994),d(1925078388,4068182383),d(2162078206,991336113),d(2614888103,
633803317),d(3248222580,3479774868),d(3835390401,2666613458),d(4022224774,944711139),d(264347078,2341262773),d(604807628,2007800933),d(770255983,1495990901),d(1249150122,1856431235),d(1555081692,3175218132),d(1996064986,2198950837),d(2554220882,3999719339),d(2821834349,766784016),d(2952996808,2566594879),d(3210313671,3203337956),d(3336571891,1034457026),d(3584528711,2466948901),d(113926993,3758326383),d(338241895,168717936),d(666307205,1188179964),d(773529912,1546045734),d(1294757372,1522805485),
d(1396182291,2643833823),d(1695183700,2343527390),d(1986661051,1014477480),d(2177026350,1206759142),d(2456956037,344077627),d(2730485921,1290863460),d(2820302411,3158454273),d(3259730800,3505952657),d(3345764771,106217008),d(3516065817,3606008344),d(3600352804,1432725776),d(4094571909,1467031594),d(275423344,851169720),d(430227734,3100823752),d(506948616,1363258195),d(659060556,3750685593),d(883997877,3785050280),d(958139571,3318307427),d(1322822218,3812723403),d(1537002063,2003034995),d(1747873779,
3602036899),d(1955562222,1575990012),d(2024104815,1125592928),d(2227730452,2716904306),d(2361852424,442776044),d(2428436474,593698344),d(2756734187,3733110249),d(3204031479,2999351573),d(3329325298,3815920427),d(3391569614,3928383900),d(3515267271,566280711),d(3940187606,3454069534),d(4118630271,4000239992),d(116418474,1914138554),d(174292421,2731055270),d(289380356,3203993006),d(460393269,320620315),d(685471733,587496836),d(852142971,1086792851),d(1017036298,365543100),d(1126000580,2618297676),d(1288033470,
3409855158),d(1501505948,4234509866),d(1607167915,987167468),d(1816402316,1246189591)],v=[],r=0;80>r;r++)v[r]=d();g=g.SHA512=e.extend({_doReset:function(){this._hash=new q.init([new p.init(1779033703,4089235720),new p.init(3144134277,2227873595),new p.init(1013904242,4271175723),new p.init(2773480762,1595750129),new p.init(1359893119,2917565137),new p.init(2600822924,725511199),new p.init(528734635,4215389547),new p.init(1541459225,327033209)])},_doProcessBlock:function(c,d){for(var e=this._hash.words,
b=e[0],a=e[1],f=e[2],t=e[3],h=e[4],g=e[5],r=e[6],e=e[7],q=b.high,p=b.low,k=a.high,y=a.low,C=f.high,N=f.low,F=t.high,D=t.low,B=h.high,E=h.low,m=g.high,l=g.low,n=r.high,da=r.low,la=e.high,ea=e.low,K=q,G=p,X=k,V=y,Y=C,W=N,ia=F,Z=D,L=B,H=E,fa=m,aa=l,ga=n,ba=da,ja=la,ca=ea,M=0;80>M;M++){var R=v[M];if(16>M)var I=R.high=c[d+2*M]|0,z=R.low=c[d+2*M+1]|0;else{var I=v[M-15],z=I.high,O=I.low,I=(z>>>1|O<<31)^(z>>>8|O<<24)^z>>>7,O=(O>>>1|z<<31)^(O>>>8|z<<24)^(O>>>7|z<<25),U=v[M-2],z=U.high,A=U.low,U=(z>>>19|A<<
13)^(z<<3|A>>>29)^z>>>6,A=(A>>>19|z<<13)^(A<<3|z>>>29)^(A>>>6|z<<26),z=v[M-7],ka=z.high,S=v[M-16],P=S.high,S=S.low,z=O+z.low,I=I+ka+(z>>>0<O>>>0?1:0),z=z+A,I=I+U+(z>>>0<A>>>0?1:0),z=z+S,I=I+P+(z>>>0<S>>>0?1:0);R.high=I;R.low=z}var ka=L&fa^~L&ga,S=H&aa^~H&ba,R=K&X^K&Y^X&Y,na=G&V^G&W^V&W,O=(K>>>28|G<<4)^(K<<30|G>>>2)^(K<<25|G>>>7),U=(G>>>28|K<<4)^(G<<30|K>>>2)^(G<<25|K>>>7),A=u[M],oa=A.high,ma=A.low,A=ca+((H>>>14|L<<18)^(H>>>18|L<<14)^(H<<23|L>>>9)),P=ja+((L>>>14|H<<18)^(L>>>18|H<<14)^(L<<23|H>>>9))+
(A>>>0<ca>>>0?1:0),A=A+S,P=P+ka+(A>>>0<S>>>0?1:0),A=A+ma,P=P+oa+(A>>>0<ma>>>0?1:0),A=A+z,P=P+I+(A>>>0<z>>>0?1:0),z=U+na,R=O+R+(z>>>0<U>>>0?1:0),ja=ga,ca=ba,ga=fa,ba=aa,fa=L,aa=H,H=Z+A|0,L=ia+P+(H>>>0<Z>>>0?1:0)|0,ia=Y,Z=W,Y=X,W=V,X=K,V=G,G=A+z|0,K=P+R+(G>>>0<A>>>0?1:0)|0}p=b.low=p+G;b.high=q+K+(p>>>0<G>>>0?1:0);y=a.low=y+V;a.high=k+X+(y>>>0<V>>>0?1:0);N=f.low=N+W;f.high=C+Y+(N>>>0<W>>>0?1:0);D=t.low=D+Z;t.high=F+ia+(D>>>0<Z>>>0?1:0);E=h.low=E+H;h.high=B+L+(E>>>0<H>>>0?1:0);l=g.low=l+aa;g.high=m+fa+
(l>>>0<aa>>>0?1:0);da=r.low=da+ba;r.high=n+ga+(da>>>0<ba>>>0?1:0);ea=e.low=ea+ca;e.high=la+ja+(ea>>>0<ca>>>0?1:0)},_doFinalize:function(){var c=this._data,d=c.words,e=8*this._nDataBytes,b=8*c.sigBytes;d[b>>>5]|=128<<24-b%32;d[(b+128>>>10<<5)+30]=Math.floor(e/4294967296);d[(b+128>>>10<<5)+31]=e;c.sigBytes=4*d.length;this._process();return this._hash.toX32()},clone:function(){var c=e.clone.call(this);c._hash=this._hash.clone();return c},blockSize:32});k.SHA512=e._createHelper(g);k.HmacSHA512=e._createHmacHelper(g)})();
y=y||function(d,k){var e={},g=e.lib={},p=function(){},q=g.Base={extend:function(a){p.prototype=this;var f=new p;a&&f.mixIn(a);f.hasOwnProperty("init")||(f.init=function(){f.$super.init.apply(this,arguments)});f.init.prototype=f;f.$super=this;return f},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var f in a)a.hasOwnProperty(f)&&(this[f]=a[f]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},
u=g.WordArray=q.extend({init:function(a,f){a=this.words=a||[];this.sigBytes=f!=k?f:4*a.length},toString:function(a){return(a||r).stringify(this)},concat:function(a){var f=this.words,b=a.words,h=this.sigBytes;a=a.sigBytes;this.clamp();if(h%4)for(var c=0;c<a;c++)f[h+c>>>2]|=(b[c>>>2]>>>24-c%4*8&255)<<24-(h+c)%4*8;else if(65535<b.length)for(c=0;c<a;c+=4)f[h+c>>>2]=b[c>>>2];else f.push.apply(f,b);this.sigBytes+=a;return this},clamp:function(){var a=this.words,f=this.sigBytes;a[f>>>2]&=4294967295<<32-
f%4*8;a.length=d.ceil(f/4)},clone:function(){var a=q.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var f=[],b=0;b<a;b+=4)f.push(4294967296*d.random()|0);return new u.init(f,a)}}),v=e.enc={},r=v.Hex={stringify:function(a){var f=a.words;a=a.sigBytes;for(var b=[],h=0;h<a;h++){var c=f[h>>>2]>>>24-h%4*8&255;b.push((c>>>4).toString(16));b.push((c&15).toString(16))}return b.join("")},parse:function(a){for(var f=a.length,b=[],h=0;h<f;h+=2)b[h>>>3]|=parseInt(a.substr(h,2),16)<<
24-h%8*4;return new u.init(b,f/2)}},c=v.Latin1={stringify:function(a){var f=a.words;a=a.sigBytes;for(var b=[],h=0;h<a;h++)b.push(String.fromCharCode(f[h>>>2]>>>24-h%4*8&255));return b.join("")},parse:function(a){for(var f=a.length,b=[],h=0;h<f;h++)b[h>>>2]|=(a.charCodeAt(h)&255)<<24-h%4*8;return new u.init(b,f)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(f){throw Error("Malformed UTF-8 data");}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},
w=g.BufferedBlockAlgorithm=q.extend({reset:function(){this._data=new u.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var f=this._data,b=f.words,h=f.sigBytes,c=this.blockSize,e=h/(4*c),e=a?d.ceil(e):d.max((e|0)-this._minBufferSize,0);a=e*c;h=d.min(4*a,h);if(a){for(var g=0;g<a;g+=c)this._doProcessBlock(b,g);g=b.splice(0,a);f.sigBytes-=h}return new u.init(g,h)},clone:function(){var a=q.clone.call(this);
a._data=this._data.clone();return a},_minBufferSize:0});g.Hasher=w.extend({cfg:q.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(f,b){return(new a.init(b)).finalize(f)}},_createHmacHelper:function(a){return function(f,t){return(new b.HMAC.init(a,
t)).finalize(f)}}});var b=e.algo={};return e}(Math);(function(d){var k=y,e=k.lib,g=e.Base,p=e.WordArray,k=k.x64={};k.Word=g.extend({init:function(d,e){this.high=d;this.low=e}});k.WordArray=g.extend({init:function(e,g){e=this.words=e||[];this.sigBytes=g!=d?g:8*e.length},toX32:function(){for(var d=this.words,e=d.length,g=[],r=0;r<e;r++){var c=d[r];g.push(c.high);g.push(c.low)}return p.create(g,this.sigBytes)},clone:function(){for(var d=g.clone.call(this),e=d.words=this.words.slice(0),v=e.length,r=0;r<
v;r++)e[r]=e[r].clone();return d}})})();(function(d){for(var k=y,e=k.lib,g=e.WordArray,p=e.Hasher,q=k.x64.Word,e=k.algo,u=[],v=[],r=[],c=1,x=0,w=0;24>w;w++){u[c+5*x]=(w+1)*(w+2)/2%64;var b=(2*c+3*x)%5,c=x%5,x=b}for(c=0;5>c;c++)for(x=0;5>x;x++)v[c+5*x]=x+(2*c+3*x)%5*5;c=1;for(x=0;24>x;x++){for(var a=b=w=0;7>a;a++){if(c&1){var f=(1<<a)-1;32>f?b^=1<<f:w^=1<<f-32}c=c&128?c<<1^113:c<<1}r[x]=q.create(w,b)}for(var t=[],c=0;25>c;c++)t[c]=q.create();e=e.SHA3=p.extend({cfg:p.cfg.extend({outputLength:512}),
_doReset:function(){for(var a=this._state=[],f=0;25>f;f++)a[f]=new q.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(a,f){for(var b=this._state,c=this.blockSize/2,d=0;d<c;d++){var e=a[f+2*d],g=a[f+2*d+1],e=(e<<8|e>>>24)&16711935|(e<<24|e>>>8)&4278255360,g=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360,w=b[d];w.high^=g;w.low^=e}for(c=0;24>c;c++){for(d=0;5>d;d++){var q=e=0;for(a=0;5>a;a++)w=b[d+5*a],e^=w.high,q^=w.low;w=t[d];w.high=e;w.low=q}for(d=0;5>d;d++)for(w=t[(d+
4)%5],e=t[(d+1)%5],g=e.high,a=e.low,e=w.high^(g<<1|a>>>31),q=w.low^(a<<1|g>>>31),a=0;5>a;a++)w=b[d+5*a],w.high^=e,w.low^=q;for(g=1;25>g;g++)w=b[g],d=w.high,w=w.low,a=u[g],32>a?(e=d<<a|w>>>32-a,q=w<<a|d>>>32-a):(e=w<<a-32|d>>>64-a,q=d<<a-32|w>>>64-a),w=t[v[g]],w.high=e,w.low=q;w=t[0];d=b[0];w.high=d.high;w.low=d.low;for(d=0;5>d;d++)for(a=0;5>a;a++)g=d+5*a,w=b[g],e=t[g],g=t[(d+1)%5+5*a],q=t[(d+2)%5+5*a],w.high=e.high^~g.high&q.high,w.low=e.low^~g.low&q.low;w=b[0];d=r[c];w.high^=d.high;w.low^=d.low}},
_doFinalize:function(){var a=this._data,f=a.words,b=8*a.sigBytes,t=32*this.blockSize;f[b>>>5]|=1<<24-b%32;f[(d.ceil((b+1)/t)*t>>>5)-1]|=128;a.sigBytes=4*f.length;this._process();for(var a=this._state,f=this.cfg.outputLength/8,b=f/8,t=[],c=0;c<b;c++){var e=a[c],w=e.high,e=e.low,w=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360,e=(e<<8|e>>>24)&16711935|(e<<24|e>>>8)&4278255360;t.push(e);t.push(w)}return new g.init(t,f)},clone:function(){for(var a=p.clone.call(this),f=a._state=this._state.slice(0),b=
0;25>b;b++)f[b]=f[b].clone();return a}});k.SHA3=p._createHelper(e);k.HmacSHA3=p._createHmacHelper(e)})(Math);(function(){var d=y,k=d.enc.Utf8;d.algo.HMAC=d.lib.Base.extend({init:function(d,g){d=this._hasher=new d.init;"string"==typeof g&&(g=k.parse(g));var p=d.blockSize,q=4*p;g.sigBytes>q&&(g=d.finalize(g));g.clamp();d=this._oKey=g.clone();g=this._iKey=g.clone();for(var u=d.words,v=g.words,r=0;r<p;r++)u[r]^=1549556828,v[r]^=909522486;d.sigBytes=g.sigBytes=q;this.reset()},reset:function(){var d=this._hasher;
d.reset();d.update(this._iKey)},update:function(d){this._hasher.update(d);return this},finalize:function(d){var g=this._hasher;d=g.finalize(d);g.reset();return g.finalize(this._oKey.clone().concat(d))}})})();y=y||function(d,k){var e={},g=e.lib={},p=function(){},q=g.Base={extend:function(a){p.prototype=this;var f=new p;a&&f.mixIn(a);f.hasOwnProperty("init")||(f.init=function(){f.$super.init.apply(this,arguments)});f.init.prototype=f;f.$super=this;return f},create:function(){var a=this.extend();a.init.apply(a,
arguments);return a},init:function(){},mixIn:function(a){for(var f in a)a.hasOwnProperty(f)&&(this[f]=a[f]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},u=g.WordArray=q.extend({init:function(a,f){a=this.words=a||[];this.sigBytes=f!=k?f:4*a.length},toString:function(a){return(a||r).stringify(this)},concat:function(a){var f=this.words,b=a.words,h=this.sigBytes;a=a.sigBytes;this.clamp();if(h%4)for(var c=0;c<a;c++)f[h+c>>>2]|=(b[c>>>
2]>>>24-c%4*8&255)<<24-(h+c)%4*8;else if(65535<b.length)for(c=0;c<a;c+=4)f[h+c>>>2]=b[c>>>2];else f.push.apply(f,b);this.sigBytes+=a;return this},clamp:function(){var a=this.words,f=this.sigBytes;a[f>>>2]&=4294967295<<32-f%4*8;a.length=d.ceil(f/4)},clone:function(){var a=q.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var f=[],b=0;b<a;b+=4)f.push(4294967296*d.random()|0);return new u.init(f,a)}}),v=e.enc={},r=v.Hex={stringify:function(a){var f=a.words;a=a.sigBytes;
for(var b=[],h=0;h<a;h++){var c=f[h>>>2]>>>24-h%4*8&255;b.push((c>>>4).toString(16));b.push((c&15).toString(16))}return b.join("")},parse:function(a){for(var f=a.length,b=[],h=0;h<f;h+=2)b[h>>>3]|=parseInt(a.substr(h,2),16)<<24-h%8*4;return new u.init(b,f/2)}},c=v.Latin1={stringify:function(a){var f=a.words;a=a.sigBytes;for(var b=[],h=0;h<a;h++)b.push(String.fromCharCode(f[h>>>2]>>>24-h%4*8&255));return b.join("")},parse:function(a){for(var f=a.length,b=[],h=0;h<f;h++)b[h>>>2]|=(a.charCodeAt(h)&255)<<
24-h%4*8;return new u.init(b,f)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(f){throw Error("Malformed UTF-8 data");}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},w=g.BufferedBlockAlgorithm=q.extend({reset:function(){this._data=new u.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var f=this._data,b=f.words,h=f.sigBytes,c=
this.blockSize,e=h/(4*c),e=a?d.ceil(e):d.max((e|0)-this._minBufferSize,0);a=e*c;h=d.min(4*a,h);if(a){for(var g=0;g<a;g+=c)this._doProcessBlock(b,g);g=b.splice(0,a);f.sigBytes-=h}return new u.init(g,h)},clone:function(){var a=q.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});g.Hasher=w.extend({cfg:q.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},
finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(f,b){return(new a.init(b)).finalize(f)}},_createHmacHelper:function(a){return function(f,c){return(new b.HMAC.init(a,c)).finalize(f)}}});var b=e.algo={};return e}(Math);(function(){var d=y,k=d.lib.WordArray;d.enc.Base64={stringify:function(d){var g=d.words,p=d.sigBytes,q=this._map;d.clamp();d=[];for(var k=0;k<p;k+=3)for(var v=(g[k>>>2]>>>24-k%4*8&255)<<16|(g[k+1>>>2]>>>24-(k+1)%
4*8&255)<<8|g[k+2>>>2]>>>24-(k+2)%4*8&255,r=0;4>r&&k+.75*r<p;r++)d.push(q.charAt(v>>>6*(3-r)&63));if(g=q.charAt(64))for(;d.length%4;)d.push(g);return d.join("")},parse:function(d){var g=d.length,p=this._map,q=p.charAt(64);q&&(q=d.indexOf(q),-1!=q&&(g=q));for(var q=[],u=0,v=0;v<g;v++)if(v%4){var r=p.indexOf(d.charAt(v-1))<<v%4*2,c=p.indexOf(d.charAt(v))>>>6-v%4*2;q[u>>>2]|=(r|c)<<24-u%4*8;u++}return k.create(q,u)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"}})();(function(d){function k(c,
b,a,f,t,h,d){c=c+(b&a|~b&f)+t+d;return(c<<h|c>>>32-h)+b}function e(c,b,a,f,t,h,d){c=c+(b&f|a&~f)+t+d;return(c<<h|c>>>32-h)+b}function g(c,b,a,f,t,h,d){c=c+(b^a^f)+t+d;return(c<<h|c>>>32-h)+b}function p(c,b,a,f,t,h,d){c=c+(a^(b|~f))+t+d;return(c<<h|c>>>32-h)+b}for(var q=y,u=q.lib,v=u.WordArray,r=u.Hasher,u=q.algo,c=[],x=0;64>x;x++)c[x]=4294967296*d.abs(d.sin(x+1))|0;u=u.MD5=r.extend({_doReset:function(){this._hash=new v.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(d,
b){for(var a=0;16>a;a++){var f=b+a,t=d[f];d[f]=(t<<8|t>>>24)&16711935|(t<<24|t>>>8)&4278255360}var a=this._hash.words,f=d[b+0],t=d[b+1],h=d[b+2],r=d[b+3],q=d[b+4],v=d[b+5],u=d[b+6],x=d[b+7],y=d[b+8],C=d[b+9],N=d[b+10],F=d[b+11],D=d[b+12],B=d[b+13],E=d[b+14];d=d[b+15];b=a[0];var m=a[1],l=a[2],n=a[3];b=k(b,m,l,n,f,7,c[0]);n=k(n,b,m,l,t,12,c[1]);l=k(l,n,b,m,h,17,c[2]);m=k(m,l,n,b,r,22,c[3]);b=k(b,m,l,n,q,7,c[4]);n=k(n,b,m,l,v,12,c[5]);l=k(l,n,b,m,u,17,c[6]);m=k(m,l,n,b,x,22,c[7]);b=k(b,m,l,n,y,7,c[8]);
n=k(n,b,m,l,C,12,c[9]);l=k(l,n,b,m,N,17,c[10]);m=k(m,l,n,b,F,22,c[11]);b=k(b,m,l,n,D,7,c[12]);n=k(n,b,m,l,B,12,c[13]);l=k(l,n,b,m,E,17,c[14]);m=k(m,l,n,b,d,22,c[15]);b=e(b,m,l,n,t,5,c[16]);n=e(n,b,m,l,u,9,c[17]);l=e(l,n,b,m,F,14,c[18]);m=e(m,l,n,b,f,20,c[19]);b=e(b,m,l,n,v,5,c[20]);n=e(n,b,m,l,N,9,c[21]);l=e(l,n,b,m,d,14,c[22]);m=e(m,l,n,b,q,20,c[23]);b=e(b,m,l,n,C,5,c[24]);n=e(n,b,m,l,E,9,c[25]);l=e(l,n,b,m,r,14,c[26]);m=e(m,l,n,b,y,20,c[27]);b=e(b,m,l,n,B,5,c[28]);n=e(n,b,m,l,h,9,c[29]);l=e(l,n,
b,m,x,14,c[30]);m=e(m,l,n,b,D,20,c[31]);b=g(b,m,l,n,v,4,c[32]);n=g(n,b,m,l,y,11,c[33]);l=g(l,n,b,m,F,16,c[34]);m=g(m,l,n,b,E,23,c[35]);b=g(b,m,l,n,t,4,c[36]);n=g(n,b,m,l,q,11,c[37]);l=g(l,n,b,m,x,16,c[38]);m=g(m,l,n,b,N,23,c[39]);b=g(b,m,l,n,B,4,c[40]);n=g(n,b,m,l,f,11,c[41]);l=g(l,n,b,m,r,16,c[42]);m=g(m,l,n,b,u,23,c[43]);b=g(b,m,l,n,C,4,c[44]);n=g(n,b,m,l,D,11,c[45]);l=g(l,n,b,m,d,16,c[46]);m=g(m,l,n,b,h,23,c[47]);b=p(b,m,l,n,f,6,c[48]);n=p(n,b,m,l,x,10,c[49]);l=p(l,n,b,m,E,15,c[50]);m=p(m,l,n,
b,v,21,c[51]);b=p(b,m,l,n,D,6,c[52]);n=p(n,b,m,l,r,10,c[53]);l=p(l,n,b,m,N,15,c[54]);m=p(m,l,n,b,t,21,c[55]);b=p(b,m,l,n,y,6,c[56]);n=p(n,b,m,l,d,10,c[57]);l=p(l,n,b,m,u,15,c[58]);m=p(m,l,n,b,B,21,c[59]);b=p(b,m,l,n,q,6,c[60]);n=p(n,b,m,l,F,10,c[61]);l=p(l,n,b,m,h,15,c[62]);m=p(m,l,n,b,C,21,c[63]);a[0]=a[0]+b|0;a[1]=a[1]+m|0;a[2]=a[2]+l|0;a[3]=a[3]+n|0},_doFinalize:function(){var c=this._data,b=c.words,a=8*this._nDataBytes,f=8*c.sigBytes;b[f>>>5]|=128<<24-f%32;var t=d.floor(a/4294967296);b[(f+64>>>
9<<4)+15]=(t<<8|t>>>24)&16711935|(t<<24|t>>>8)&4278255360;b[(f+64>>>9<<4)+14]=(a<<8|a>>>24)&16711935|(a<<24|a>>>8)&4278255360;c.sigBytes=4*(b.length+1);this._process();c=this._hash;b=c.words;for(a=0;4>a;a++)f=b[a],b[a]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360;return c},clone:function(){var c=r.clone.call(this);c._hash=this._hash.clone();return c}});q.MD5=r._createHelper(u);q.HmacMD5=r._createHmacHelper(u)})(Math);(function(){var d=y,k=d.lib,e=k.Base,g=k.WordArray,k=d.algo,p=k.EvpKDF=e.extend({cfg:e.extend({keySize:4,
hasher:k.MD5,iterations:1}),init:function(d){this.cfg=this.cfg.extend(d)},compute:function(d,e){for(var v=this.cfg,r=v.hasher.create(),c=g.create(),k=c.words,w=v.keySize,v=v.iterations;k.length<w;){b&&r.update(b);var b=r.update(d).finalize(e);r.reset();for(var a=1;a<v;a++)b=r.finalize(b),r.reset();c.concat(b)}c.sigBytes=4*w;return c}});d.EvpKDF=function(d,e,g){return p.create(g).compute(d,e)}})();y.lib.Cipher||function(d){var k=y,e=k.lib,g=e.Base,p=e.WordArray,q=e.BufferedBlockAlgorithm,u=k.enc.Base64,
v=k.algo.EvpKDF,r=e.Cipher=q.extend({cfg:g.extend(),createEncryptor:function(a,f){return this.create(this._ENC_XFORM_MODE,a,f)},createDecryptor:function(a,f){return this.create(this._DEC_XFORM_MODE,a,f)},init:function(a,f,b){this.cfg=this.cfg.extend(b);this._xformMode=a;this._key=f;this.reset()},reset:function(){q.reset.call(this);this._doReset()},process:function(a){this._append(a);return this._process()},finalize:function(a){a&&this._append(a);return this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,
_DEC_XFORM_MODE:2,_createHelper:function(b){return{encrypt:function(h,c,d){return("string"==typeof c?f:a).encrypt(b,h,c,d)},decrypt:function(h,c,d){return("string"==typeof c?f:a).decrypt(b,h,c,d)}}}});e.StreamCipher=r.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var c=k.mode={},x=function(a,f,b){var c=this._iv;c?this._iv=d:c=this._prevBlock;for(var e=0;e<b;e++)a[f+e]^=c[e]},w=(e.BlockCipherMode=g.extend({createEncryptor:function(a,f){return this.Encryptor.create(a,f)},createDecryptor:function(a,
f){return this.Decryptor.create(a,f)},init:function(a,f){this._cipher=a;this._iv=f}})).extend();w.Encryptor=w.extend({processBlock:function(a,f){var b=this._cipher,c=b.blockSize;x.call(this,a,f,c);b.encryptBlock(a,f);this._prevBlock=a.slice(f,f+c)}});w.Decryptor=w.extend({processBlock:function(a,f){var b=this._cipher,c=b.blockSize,d=a.slice(f,f+c);b.decryptBlock(a,f);x.call(this,a,f,c);this._prevBlock=d}});c=c.CBC=w;w=(k.pad={}).Pkcs7={pad:function(a,f){f*=4;f-=a.sigBytes%f;for(var b=f<<24|f<<16|
f<<8|f,c=[],d=0;d<f;d+=4)c.push(b);f=p.create(c,f);a.concat(f)},unpad:function(a){a.sigBytes-=a.words[a.sigBytes-1>>>2]&255}};e.BlockCipher=r.extend({cfg:r.cfg.extend({mode:c,padding:w}),reset:function(){r.reset.call(this);var a=this.cfg,f=a.iv,a=a.mode;if(this._xformMode==this._ENC_XFORM_MODE)var b=a.createEncryptor;else b=a.createDecryptor,this._minBufferSize=1;this._mode=b.call(a,this,f&&f.words)},_doProcessBlock:function(a,f){this._mode.processBlock(a,f)},_doFinalize:function(){var a=this.cfg.padding;
if(this._xformMode==this._ENC_XFORM_MODE){a.pad(this._data,this.blockSize);var f=this._process(!0)}else f=this._process(!0),a.unpad(f);return f},blockSize:4});var b=e.CipherParams=g.extend({init:function(a){this.mixIn(a)},toString:function(a){return(a||this.formatter).stringify(this)}}),c=(k.format={}).OpenSSL={stringify:function(a){var f=a.ciphertext;a=a.salt;return(a?p.create([1398893684,1701076831]).concat(a).concat(f):f).toString(u)},parse:function(a){a=u.parse(a);var f=a.words;if(1398893684==
f[0]&&1701076831==f[1]){var c=p.create(f.slice(2,4));f.splice(0,4);a.sigBytes-=16}return b.create({ciphertext:a,salt:c})}},a=e.SerializableCipher=g.extend({cfg:g.extend({format:c}),encrypt:function(a,f,c,d){d=this.cfg.extend(d);var e=a.createEncryptor(c,d);f=e.finalize(f);e=e.cfg;return b.create({ciphertext:f,key:c,iv:e.iv,algorithm:a,mode:e.mode,padding:e.padding,blockSize:a.blockSize,formatter:d.format})},decrypt:function(a,f,b,c){c=this.cfg.extend(c);f=this._parse(f,c.format);return a.createDecryptor(b,
c).finalize(f.ciphertext)},_parse:function(a,f){return"string"==typeof a?f.parse(a,this):a}}),k=(k.kdf={}).OpenSSL={execute:function(a,f,c,d){d||(d=p.random(8));a=v.create({keySize:f+c}).compute(a,d);c=p.create(a.words.slice(f),4*c);a.sigBytes=4*f;return b.create({key:a,iv:c,salt:d})}},f=e.PasswordBasedCipher=a.extend({cfg:a.cfg.extend({kdf:k}),encrypt:function(f,b,c,d){d=this.cfg.extend(d);c=d.kdf.execute(c,f.keySize,f.ivSize);d.iv=c.iv;f=a.encrypt.call(this,f,b,c.key,d);f.mixIn(c);return f},decrypt:function(f,
b,c,d){d=this.cfg.extend(d);b=this._parse(b,d.format);c=d.kdf.execute(c,f.keySize,f.ivSize,b.salt);d.iv=c.iv;return a.decrypt.call(this,f,b,c.key,d)}})}();(function(){function d(b,a){a&=this._lBlock>>>b^this._rBlock;this._rBlock^=a;this._lBlock^=a<<b}function k(b,a){a&=this._rBlock>>>b^this._lBlock;this._lBlock^=a;this._rBlock^=a<<b}var e=y,g=e.lib,p=g.WordArray,g=g.BlockCipher,q=e.algo,u=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,
46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],v=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],r=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],c=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,
134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,
3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,
184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,
402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,
5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,
23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,
458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,
1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,
32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,
110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,
128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,
6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,
320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,
2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,
2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],x=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],w=q.DES=g.extend({_doReset:function(){for(var b=this._key.words,a=[],f=0;56>f;f++){var c=u[f]-1;a[f]=b[c>>>5]>>>31-c%32&1}b=this._subKeys=[];for(c=0;16>c;c++){for(var h=b[c]=[],d=r[c],f=0;24>f;f++)h[f/6|0]|=
a[(v[f]-1+d)%28]<<31-f%6,h[4+(f/6|0)]|=a[28+(v[f+24]-1+d)%28]<<31-f%6;h[0]=h[0]<<1|h[0]>>>31;for(f=1;7>f;f++)h[f]>>>=4*(f-1)+3;h[7]=h[7]<<5|h[7]>>>27}a=this._invSubKeys=[];for(f=0;16>f;f++)a[f]=b[15-f]},encryptBlock:function(b,a){this._doCryptBlock(b,a,this._subKeys)},decryptBlock:function(b,a){this._doCryptBlock(b,a,this._invSubKeys)},_doCryptBlock:function(b,a,f){this._lBlock=b[a];this._rBlock=b[a+1];d.call(this,4,252645135);d.call(this,16,65535);k.call(this,2,858993459);k.call(this,8,16711935);
d.call(this,1,1431655765);for(var t=0;16>t;t++){for(var h=f[t],e=this._lBlock,g=this._rBlock,r=0,w=0;8>w;w++)r|=c[w][((g^h[w])&x[w])>>>0];this._lBlock=g;this._rBlock=e^r}f=this._lBlock;this._lBlock=this._rBlock;this._rBlock=f;d.call(this,1,1431655765);k.call(this,8,16711935);k.call(this,2,858993459);d.call(this,16,65535);d.call(this,4,252645135);b[a]=this._lBlock;b[a+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});e.DES=g._createHelper(w);q=q.TripleDES=g.extend({_doReset:function(){var b=this._key.words;
this._des1=w.createEncryptor(p.create(b.slice(0,2)));this._des2=w.createEncryptor(p.create(b.slice(2,4)));this._des3=w.createEncryptor(p.create(b.slice(4,6)))},encryptBlock:function(b,a){this._des1.encryptBlock(b,a);this._des2.decryptBlock(b,a);this._des3.encryptBlock(b,a)},decryptBlock:function(b,a){this._des3.decryptBlock(b,a);this._des2.encryptBlock(b,a);this._des1.decryptBlock(b,a)},keySize:6,ivSize:2,blockSize:2});e.TripleDES=g._createHelper(q)})();y=y||function(d,k){var e={},g=e.lib={},p=function(){},
q=g.Base={extend:function(a){p.prototype=this;var f=new p;a&&f.mixIn(a);f.hasOwnProperty("init")||(f.init=function(){f.$super.init.apply(this,arguments)});f.init.prototype=f;f.$super=this;return f},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var f in a)a.hasOwnProperty(f)&&(this[f]=a[f]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},u=g.WordArray=q.extend({init:function(a,
f){a=this.words=a||[];this.sigBytes=f!=k?f:4*a.length},toString:function(a){return(a||r).stringify(this)},concat:function(a){var f=this.words,b=a.words,h=this.sigBytes;a=a.sigBytes;this.clamp();if(h%4)for(var c=0;c<a;c++)f[h+c>>>2]|=(b[c>>>2]>>>24-c%4*8&255)<<24-(h+c)%4*8;else if(65535<b.length)for(c=0;c<a;c+=4)f[h+c>>>2]=b[c>>>2];else f.push.apply(f,b);this.sigBytes+=a;return this},clamp:function(){var a=this.words,f=this.sigBytes;a[f>>>2]&=4294967295<<32-f%4*8;a.length=d.ceil(f/4)},clone:function(){var a=
q.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var f=[],b=0;b<a;b+=4)f.push(4294967296*d.random()|0);return new u.init(f,a)}}),v=e.enc={},r=v.Hex={stringify:function(a){var f=a.words;a=a.sigBytes;for(var b=[],h=0;h<a;h++){var c=f[h>>>2]>>>24-h%4*8&255;b.push((c>>>4).toString(16));b.push((c&15).toString(16))}return b.join("")},parse:function(a){for(var f=a.length,b=[],h=0;h<f;h+=2)b[h>>>3]|=parseInt(a.substr(h,2),16)<<24-h%8*4;return new u.init(b,f/2)}},c=v.Latin1=
{stringify:function(a){var f=a.words;a=a.sigBytes;for(var b=[],h=0;h<a;h++)b.push(String.fromCharCode(f[h>>>2]>>>24-h%4*8&255));return b.join("")},parse:function(a){for(var f=a.length,b=[],h=0;h<f;h++)b[h>>>2]|=(a.charCodeAt(h)&255)<<24-h%4*8;return new u.init(b,f)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(f){throw Error("Malformed UTF-8 data");}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},w=g.BufferedBlockAlgorithm=q.extend({reset:function(){this._data=
new u.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var f=this._data,b=f.words,h=f.sigBytes,c=this.blockSize,e=h/(4*c),e=a?d.ceil(e):d.max((e|0)-this._minBufferSize,0);a=e*c;h=d.min(4*a,h);if(a){for(var g=0;g<a;g+=c)this._doProcessBlock(b,g);g=b.splice(0,a);f.sigBytes-=h}return new u.init(g,h)},clone:function(){var a=q.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});g.Hasher=
w.extend({cfg:q.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(f,b){return(new a.init(b)).finalize(f)}},_createHmacHelper:function(a){return function(f,c){return(new b.HMAC.init(a,c)).finalize(f)}}});var b=e.algo={};return e}(Math);(function(d){for(var k=
y,e=k.lib,g=e.WordArray,p=e.Hasher,e=k.algo,q=[],u=[],v=function(a){return 4294967296*(a-(a|0))|0},r=2,c=0;64>c;){var x;a:{x=r;for(var w=d.sqrt(x),b=2;b<=w;b++)if(!(x%b)){x=!1;break a}x=!0}x&&(8>c&&(q[c]=v(d.pow(r,.5))),u[c]=v(d.pow(r,1/3)),c++);r++}var a=[],e=e.SHA256=p.extend({_doReset:function(){this._hash=new g.init(q.slice(0))},_doProcessBlock:function(f,b){for(var h=this._hash.words,c=h[0],d=h[1],e=h[2],g=h[3],w=h[4],r=h[5],v=h[6],q=h[7],k=0;64>k;k++){if(16>k)a[k]=f[b+k]|0;else{var p=a[k-15],
x=a[k-2];a[k]=((p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3)+a[k-7]+((x<<15|x>>>17)^(x<<13|x>>>19)^x>>>10)+a[k-16]}p=q+((w<<26|w>>>6)^(w<<21|w>>>11)^(w<<7|w>>>25))+(w&r^~w&v)+u[k]+a[k];x=((c<<30|c>>>2)^(c<<19|c>>>13)^(c<<10|c>>>22))+(c&d^c&e^d&e);q=v;v=r;r=w;w=g+p|0;g=e;e=d;d=c;c=p+x|0}h[0]=h[0]+c|0;h[1]=h[1]+d|0;h[2]=h[2]+e|0;h[3]=h[3]+g|0;h[4]=h[4]+w|0;h[5]=h[5]+r|0;h[6]=h[6]+v|0;h[7]=h[7]+q|0},_doFinalize:function(){var a=this._data,b=a.words,h=8*this._nDataBytes,c=8*a.sigBytes;b[c>>>5]|=128<<24-c%32;b[(c+
64>>>9<<4)+14]=d.floor(h/4294967296);b[(c+64>>>9<<4)+15]=h;a.sigBytes=4*b.length;this._process();return this._hash},clone:function(){var a=p.clone.call(this);a._hash=this._hash.clone();return a}});k.SHA256=p._createHelper(e);k.HmacSHA256=p._createHmacHelper(e)})(Math);(function(){var d=y,k=d.enc.Utf8;d.algo.HMAC=d.lib.Base.extend({init:function(d,g){d=this._hasher=new d.init;"string"==typeof g&&(g=k.parse(g));var p=d.blockSize,q=4*p;g.sigBytes>q&&(g=d.finalize(g));g.clamp();d=this._oKey=g.clone();
g=this._iKey=g.clone();for(var u=d.words,v=g.words,r=0;r<p;r++)u[r]^=1549556828,v[r]^=909522486;d.sigBytes=g.sigBytes=q;this.reset()},reset:function(){var d=this._hasher;d.reset();d.update(this._iKey)},update:function(d){this._hasher.update(d);return this},finalize:function(d){var g=this._hasher;d=g.finalize(d);g.reset();return g.finalize(this._oKey.clone().concat(d))}})})();y=y||function(d,k){var e={},g=e.lib={},p=function(){},q=g.Base={extend:function(a){p.prototype=this;var f=new p;a&&f.mixIn(a);
f.hasOwnProperty("init")||(f.init=function(){f.$super.init.apply(this,arguments)});f.init.prototype=f;f.$super=this;return f},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var f in a)a.hasOwnProperty(f)&&(this[f]=a[f]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},u=g.WordArray=q.extend({init:function(a,f){a=this.words=a||[];this.sigBytes=f!=k?f:4*a.length},toString:function(a){return(a||
r).stringify(this)},concat:function(a){var f=this.words,b=a.words,h=this.sigBytes;a=a.sigBytes;this.clamp();if(h%4)for(var c=0;c<a;c++)f[h+c>>>2]|=(b[c>>>2]>>>24-c%4*8&255)<<24-(h+c)%4*8;else if(65535<b.length)for(c=0;c<a;c+=4)f[h+c>>>2]=b[c>>>2];else f.push.apply(f,b);this.sigBytes+=a;return this},clamp:function(){var a=this.words,f=this.sigBytes;a[f>>>2]&=4294967295<<32-f%4*8;a.length=d.ceil(f/4)},clone:function(){var a=q.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var f=
[],b=0;b<a;b+=4)f.push(4294967296*d.random()|0);return new u.init(f,a)}}),v=e.enc={},r=v.Hex={stringify:function(a){var f=a.words;a=a.sigBytes;for(var b=[],h=0;h<a;h++){var c=f[h>>>2]>>>24-h%4*8&255;b.push((c>>>4).toString(16));b.push((c&15).toString(16))}return b.join("")},parse:function(a){for(var b=a.length,c=[],h=0;h<b;h+=2)c[h>>>3]|=parseInt(a.substr(h,2),16)<<24-h%8*4;return new u.init(c,b/2)}},c=v.Latin1={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],h=0;h<a;h++)c.push(String.fromCharCode(b[h>>>
2]>>>24-h%4*8&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],h=0;h<b;h++)c[h>>>2]|=(a.charCodeAt(h)&255)<<24-h%4*8;return new u.init(c,b)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data");}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},w=g.BufferedBlockAlgorithm=q.extend({reset:function(){this._data=new u.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=
x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var b=this._data,c=b.words,h=b.sigBytes,e=this.blockSize,g=h/(4*e),g=a?d.ceil(g):d.max((g|0)-this._minBufferSize,0);a=g*e;h=d.min(4*a,h);if(a){for(var w=0;w<a;w+=e)this._doProcessBlock(c,w);w=c.splice(0,a);b.sigBytes-=h}return new u.init(w,h)},clone:function(){var a=q.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});g.Hasher=w.extend({cfg:q.extend(),init:function(a){this.cfg=this.cfg.extend(a);
this.reset()},reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return(new a.init(c)).finalize(b)}},_createHmacHelper:function(a){return function(f,c){return(new b.HMAC.init(a,c)).finalize(f)}}});var b=e.algo={};return e}(Math);(function(){var d=y,k=d.lib.WordArray;d.enc.Base64={stringify:function(d){var g=
d.words,k=d.sigBytes,q=this._map;d.clamp();d=[];for(var u=0;u<k;u+=3)for(var v=(g[u>>>2]>>>24-u%4*8&255)<<16|(g[u+1>>>2]>>>24-(u+1)%4*8&255)<<8|g[u+2>>>2]>>>24-(u+2)%4*8&255,r=0;4>r&&u+.75*r<k;r++)d.push(q.charAt(v>>>6*(3-r)&63));if(g=q.charAt(64))for(;d.length%4;)d.push(g);return d.join("")},parse:function(d){var g=d.length,p=this._map,q=p.charAt(64);q&&(q=d.indexOf(q),-1!=q&&(g=q));for(var q=[],u=0,v=0;v<g;v++)if(v%4){var r=p.indexOf(d.charAt(v-1))<<v%4*2,c=p.indexOf(d.charAt(v))>>>6-v%4*2;q[u>>>
2]|=(r|c)<<24-u%4*8;u++}return k.create(q,u)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"}})();(function(d){function k(c,b,a,f,d,h,e){c=c+(b&a|~b&f)+d+e;return(c<<h|c>>>32-h)+b}function e(c,b,a,f,d,h,e){c=c+(b&f|a&~f)+d+e;return(c<<h|c>>>32-h)+b}function g(c,b,a,f,d,h,e){c=c+(b^a^f)+d+e;return(c<<h|c>>>32-h)+b}function p(c,b,a,f,d,h,e){c=c+(a^(b|~f))+d+e;return(c<<h|c>>>32-h)+b}for(var q=y,u=q.lib,v=u.WordArray,r=u.Hasher,u=q.algo,c=[],x=0;64>x;x++)c[x]=4294967296*
d.abs(d.sin(x+1))|0;u=u.MD5=r.extend({_doReset:function(){this._hash=new v.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(d,b){for(var a=0;16>a;a++){var f=b+a,t=d[f];d[f]=(t<<8|t>>>24)&16711935|(t<<24|t>>>8)&4278255360}var a=this._hash.words,f=d[b+0],t=d[b+1],h=d[b+2],r=d[b+3],v=d[b+4],q=d[b+5],u=d[b+6],x=d[b+7],y=d[b+8],C=d[b+9],N=d[b+10],F=d[b+11],D=d[b+12],B=d[b+13],E=d[b+14];d=d[b+15];b=a[0];var m=a[1],l=a[2],n=a[3];b=k(b,m,l,n,f,7,c[0]);n=k(n,b,m,l,t,12,c[1]);l=
k(l,n,b,m,h,17,c[2]);m=k(m,l,n,b,r,22,c[3]);b=k(b,m,l,n,v,7,c[4]);n=k(n,b,m,l,q,12,c[5]);l=k(l,n,b,m,u,17,c[6]);m=k(m,l,n,b,x,22,c[7]);b=k(b,m,l,n,y,7,c[8]);n=k(n,b,m,l,C,12,c[9]);l=k(l,n,b,m,N,17,c[10]);m=k(m,l,n,b,F,22,c[11]);b=k(b,m,l,n,D,7,c[12]);n=k(n,b,m,l,B,12,c[13]);l=k(l,n,b,m,E,17,c[14]);m=k(m,l,n,b,d,22,c[15]);b=e(b,m,l,n,t,5,c[16]);n=e(n,b,m,l,u,9,c[17]);l=e(l,n,b,m,F,14,c[18]);m=e(m,l,n,b,f,20,c[19]);b=e(b,m,l,n,q,5,c[20]);n=e(n,b,m,l,N,9,c[21]);l=e(l,n,b,m,d,14,c[22]);m=e(m,l,n,b,v,
20,c[23]);b=e(b,m,l,n,C,5,c[24]);n=e(n,b,m,l,E,9,c[25]);l=e(l,n,b,m,r,14,c[26]);m=e(m,l,n,b,y,20,c[27]);b=e(b,m,l,n,B,5,c[28]);n=e(n,b,m,l,h,9,c[29]);l=e(l,n,b,m,x,14,c[30]);m=e(m,l,n,b,D,20,c[31]);b=g(b,m,l,n,q,4,c[32]);n=g(n,b,m,l,y,11,c[33]);l=g(l,n,b,m,F,16,c[34]);m=g(m,l,n,b,E,23,c[35]);b=g(b,m,l,n,t,4,c[36]);n=g(n,b,m,l,v,11,c[37]);l=g(l,n,b,m,x,16,c[38]);m=g(m,l,n,b,N,23,c[39]);b=g(b,m,l,n,B,4,c[40]);n=g(n,b,m,l,f,11,c[41]);l=g(l,n,b,m,r,16,c[42]);m=g(m,l,n,b,u,23,c[43]);b=g(b,m,l,n,C,4,c[44]);
n=g(n,b,m,l,D,11,c[45]);l=g(l,n,b,m,d,16,c[46]);m=g(m,l,n,b,h,23,c[47]);b=p(b,m,l,n,f,6,c[48]);n=p(n,b,m,l,x,10,c[49]);l=p(l,n,b,m,E,15,c[50]);m=p(m,l,n,b,q,21,c[51]);b=p(b,m,l,n,D,6,c[52]);n=p(n,b,m,l,r,10,c[53]);l=p(l,n,b,m,N,15,c[54]);m=p(m,l,n,b,t,21,c[55]);b=p(b,m,l,n,y,6,c[56]);n=p(n,b,m,l,d,10,c[57]);l=p(l,n,b,m,u,15,c[58]);m=p(m,l,n,b,B,21,c[59]);b=p(b,m,l,n,v,6,c[60]);n=p(n,b,m,l,F,10,c[61]);l=p(l,n,b,m,h,15,c[62]);m=p(m,l,n,b,C,21,c[63]);a[0]=a[0]+b|0;a[1]=a[1]+m|0;a[2]=a[2]+l|0;a[3]=a[3]+
n|0},_doFinalize:function(){var c=this._data,b=c.words,a=8*this._nDataBytes,f=8*c.sigBytes;b[f>>>5]|=128<<24-f%32;var t=d.floor(a/4294967296);b[(f+64>>>9<<4)+15]=(t<<8|t>>>24)&16711935|(t<<24|t>>>8)&4278255360;b[(f+64>>>9<<4)+14]=(a<<8|a>>>24)&16711935|(a<<24|a>>>8)&4278255360;c.sigBytes=4*(b.length+1);this._process();c=this._hash;b=c.words;for(a=0;4>a;a++)f=b[a],b[a]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360;return c},clone:function(){var c=r.clone.call(this);c._hash=this._hash.clone();return c}});
q.MD5=r._createHelper(u);q.HmacMD5=r._createHmacHelper(u)})(Math);(function(){var d=y,k=d.lib,e=k.Base,g=k.WordArray,k=d.algo,p=k.EvpKDF=e.extend({cfg:e.extend({keySize:4,hasher:k.MD5,iterations:1}),init:function(d){this.cfg=this.cfg.extend(d)},compute:function(d,e){for(var v=this.cfg,r=v.hasher.create(),c=g.create(),k=c.words,w=v.keySize,v=v.iterations;k.length<w;){b&&r.update(b);var b=r.update(d).finalize(e);r.reset();for(var a=1;a<v;a++)b=r.finalize(b),r.reset();c.concat(b)}c.sigBytes=4*w;return c}});
d.EvpKDF=function(d,e,g){return p.create(g).compute(d,e)}})();y.lib.Cipher||function(d){var k=y,e=k.lib,g=e.Base,p=e.WordArray,q=e.BufferedBlockAlgorithm,u=k.enc.Base64,v=k.algo.EvpKDF,r=e.Cipher=q.extend({cfg:g.extend(),createEncryptor:function(a,b){return this.create(this._ENC_XFORM_MODE,a,b)},createDecryptor:function(a,b){return this.create(this._DEC_XFORM_MODE,a,b)},init:function(a,b,f){this.cfg=this.cfg.extend(f);this._xformMode=a;this._key=b;this.reset()},reset:function(){q.reset.call(this);
this._doReset()},process:function(a){this._append(a);return this._process()},finalize:function(a){a&&this._append(a);return this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(b){return{encrypt:function(h,c,d){return("string"==typeof c?f:a).encrypt(b,h,c,d)},decrypt:function(h,c,d){return("string"==typeof c?f:a).decrypt(b,h,c,d)}}}});e.StreamCipher=r.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var c=k.mode={},x=function(a,b,
f){var c=this._iv;c?this._iv=d:c=this._prevBlock;for(var e=0;e<f;e++)a[b+e]^=c[e]},w=(e.BlockCipherMode=g.extend({createEncryptor:function(a,b){return this.Encryptor.create(a,b)},createDecryptor:function(a,b){return this.Decryptor.create(a,b)},init:function(a,b){this._cipher=a;this._iv=b}})).extend();w.Encryptor=w.extend({processBlock:function(a,b){var f=this._cipher,c=f.blockSize;x.call(this,a,b,c);f.encryptBlock(a,b);this._prevBlock=a.slice(b,b+c)}});w.Decryptor=w.extend({processBlock:function(a,
b){var f=this._cipher,c=f.blockSize,d=a.slice(b,b+c);f.decryptBlock(a,b);x.call(this,a,b,c);this._prevBlock=d}});c=c.CBC=w;w=(k.pad={}).Pkcs7={pad:function(a,b){b*=4;b-=a.sigBytes%b;for(var f=b<<24|b<<16|b<<8|b,c=[],d=0;d<b;d+=4)c.push(f);b=p.create(c,b);a.concat(b)},unpad:function(a){a.sigBytes-=a.words[a.sigBytes-1>>>2]&255}};e.BlockCipher=r.extend({cfg:r.cfg.extend({mode:c,padding:w}),reset:function(){r.reset.call(this);var a=this.cfg,b=a.iv,a=a.mode;if(this._xformMode==this._ENC_XFORM_MODE)var f=
a.createEncryptor;else f=a.createDecryptor,this._minBufferSize=1;this._mode=f.call(a,this,b&&b.words)},_doProcessBlock:function(a,b){this._mode.processBlock(a,b)},_doFinalize:function(){var a=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){a.pad(this._data,this.blockSize);var b=this._process(!0)}else b=this._process(!0),a.unpad(b);return b},blockSize:4});var b=e.CipherParams=g.extend({init:function(a){this.mixIn(a)},toString:function(a){return(a||this.formatter).stringify(this)}}),c=(k.format=
{}).OpenSSL={stringify:function(a){var b=a.ciphertext;a=a.salt;return(a?p.create([1398893684,1701076831]).concat(a).concat(b):b).toString(u)},parse:function(a){a=u.parse(a);var f=a.words;if(1398893684==f[0]&&1701076831==f[1]){var c=p.create(f.slice(2,4));f.splice(0,4);a.sigBytes-=16}return b.create({ciphertext:a,salt:c})}},a=e.SerializableCipher=g.extend({cfg:g.extend({format:c}),encrypt:function(a,f,c,d){d=this.cfg.extend(d);var e=a.createEncryptor(c,d);f=e.finalize(f);e=e.cfg;return b.create({ciphertext:f,
key:c,iv:e.iv,algorithm:a,mode:e.mode,padding:e.padding,blockSize:a.blockSize,formatter:d.format})},decrypt:function(a,b,f,c){c=this.cfg.extend(c);b=this._parse(b,c.format);return a.createDecryptor(f,c).finalize(b.ciphertext)},_parse:function(a,b){return"string"==typeof a?b.parse(a,this):a}}),k=(k.kdf={}).OpenSSL={execute:function(a,f,c,d){d||(d=p.random(8));a=v.create({keySize:f+c}).compute(a,d);c=p.create(a.words.slice(f),4*c);a.sigBytes=4*f;return b.create({key:a,iv:c,salt:d})}},f=e.PasswordBasedCipher=
a.extend({cfg:a.cfg.extend({kdf:k}),encrypt:function(b,f,c,d){d=this.cfg.extend(d);c=d.kdf.execute(c,b.keySize,b.ivSize);d.iv=c.iv;b=a.encrypt.call(this,b,f,c.key,d);b.mixIn(c);return b},decrypt:function(b,f,c,d){d=this.cfg.extend(d);f=this._parse(f,d.format);c=d.kdf.execute(c,b.keySize,b.ivSize,f.salt);d.iv=c.iv;return a.decrypt.call(this,b,f,c.key,d)}})}();(function(){function d(){for(var d=this._X,e=this._C,c=0;8>c;c++)p[c]=e[c];e[0]=e[0]+1295307597+this._b|0;e[1]=e[1]+3545052371+(e[0]>>>0<p[0]>>>
0?1:0)|0;e[2]=e[2]+886263092+(e[1]>>>0<p[1]>>>0?1:0)|0;e[3]=e[3]+1295307597+(e[2]>>>0<p[2]>>>0?1:0)|0;e[4]=e[4]+3545052371+(e[3]>>>0<p[3]>>>0?1:0)|0;e[5]=e[5]+886263092+(e[4]>>>0<p[4]>>>0?1:0)|0;e[6]=e[6]+1295307597+(e[5]>>>0<p[5]>>>0?1:0)|0;e[7]=e[7]+3545052371+(e[6]>>>0<p[6]>>>0?1:0)|0;this._b=e[7]>>>0<p[7]>>>0?1:0;for(c=0;8>c;c++){var g=d[c]+e[c],k=g&65535,b=g>>>16;q[c]=((k*k>>>17)+k*b>>>15)+b*b^((g&4294901760)*g|0)+((g&65535)*g|0)}d[0]=q[0]+(q[7]<<16|q[7]>>>16)+(q[6]<<16|q[6]>>>16)|0;d[1]=q[1]+
(q[0]<<8|q[0]>>>24)+q[7]|0;d[2]=q[2]+(q[1]<<16|q[1]>>>16)+(q[0]<<16|q[0]>>>16)|0;d[3]=q[3]+(q[2]<<8|q[2]>>>24)+q[1]|0;d[4]=q[4]+(q[3]<<16|q[3]>>>16)+(q[2]<<16|q[2]>>>16)|0;d[5]=q[5]+(q[4]<<8|q[4]>>>24)+q[3]|0;d[6]=q[6]+(q[5]<<16|q[5]>>>16)+(q[4]<<16|q[4]>>>16)|0;d[7]=q[7]+(q[6]<<8|q[6]>>>24)+q[5]|0}var k=y,e=k.lib.StreamCipher,g=[],p=[],q=[],u=k.algo.RabbitLegacy=e.extend({_doReset:function(){for(var e=this._key.words,g=this.cfg.iv,c=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<
16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],e=this._C=[e[2]<<16|e[2]>>>16,e[0]&4294901760|e[1]&65535,e[3]<<16|e[3]>>>16,e[1]&4294901760|e[2]&65535,e[0]<<16|e[0]>>>16,e[2]&4294901760|e[3]&65535,e[1]<<16|e[1]>>>16,e[3]&4294901760|e[0]&65535],k=this._b=0;4>k;k++)d.call(this);for(k=0;8>k;k++)e[k]^=c[k+4&7];if(g){var c=g.words,g=c[0],c=c[1],g=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360,c=(c<<8|c>>>24)&16711935|(c<<24|c>>>8)&4278255360,k=g>>>16|c&4294901760,q=c<<16|g&65535;e[0]^=g;e[1]^=k;e[2]^=c;e[3]^=q;
e[4]^=g;e[5]^=k;e[6]^=c;e[7]^=q;for(k=0;4>k;k++)d.call(this)}},_doProcessBlock:function(e,k){var c=this._X;d.call(this);g[0]=c[0]^c[5]>>>16^c[3]<<16;g[1]=c[2]^c[7]>>>16^c[5]<<16;g[2]=c[4]^c[1]>>>16^c[7]<<16;g[3]=c[6]^c[3]>>>16^c[1]<<16;for(c=0;4>c;c++)g[c]=(g[c]<<8|g[c]>>>24)&16711935|(g[c]<<24|g[c]>>>8)&4278255360,e[k+c]^=g[c]},blockSize:4,ivSize:2});k.RabbitLegacy=e._createHelper(u)})();y=y||function(d,k){var e={},g=e.lib={},p=function(){},q=g.Base={extend:function(a){p.prototype=this;var b=new p;
a&&b.mixIn(a);b.hasOwnProperty("init")||(b.init=function(){b.$super.init.apply(this,arguments)});b.init.prototype=b;b.$super=this;return b},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},u=g.WordArray=q.extend({init:function(a,b){a=this.words=a||[];this.sigBytes=b!=k?b:
4*a.length},toString:function(a){return(a||r).stringify(this)},concat:function(a){var b=this.words,c=a.words,h=this.sigBytes;a=a.sigBytes;this.clamp();if(h%4)for(var d=0;d<a;d++)b[h+d>>>2]|=(c[d>>>2]>>>24-d%4*8&255)<<24-(h+d)%4*8;else if(65535<c.length)for(d=0;d<a;d+=4)b[h+d>>>2]=c[d>>>2];else b.push.apply(b,c);this.sigBytes+=a;return this},clamp:function(){var a=this.words,b=this.sigBytes;a[b>>>2]&=4294967295<<32-b%4*8;a.length=d.ceil(b/4)},clone:function(){var a=q.clone.call(this);a.words=this.words.slice(0);
return a},random:function(a){for(var b=[],c=0;c<a;c+=4)b.push(4294967296*d.random()|0);return new u.init(b,a)}}),v=e.enc={},r=v.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],h=0;h<a;h++){var d=b[h>>>2]>>>24-h%4*8&255;c.push((d>>>4).toString(16));c.push((d&15).toString(16))}return c.join("")},parse:function(a){for(var b=a.length,c=[],h=0;h<b;h+=2)c[h>>>3]|=parseInt(a.substr(h,2),16)<<24-h%8*4;return new u.init(c,b/2)}},c=v.Latin1={stringify:function(a){var b=a.words;a=a.sigBytes;
for(var c=[],h=0;h<a;h++)c.push(String.fromCharCode(b[h>>>2]>>>24-h%4*8&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],h=0;h<b;h++)c[h>>>2]|=(a.charCodeAt(h)&255)<<24-h%4*8;return new u.init(c,b)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data");}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},w=g.BufferedBlockAlgorithm=q.extend({reset:function(){this._data=new u.init;this._nDataBytes=
0},_append:function(a){"string"==typeof a&&(a=x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var b=this._data,c=b.words,h=b.sigBytes,e=this.blockSize,g=h/(4*e),g=a?d.ceil(g):d.max((g|0)-this._minBufferSize,0);a=g*e;h=d.min(4*a,h);if(a){for(var k=0;k<a;k+=e)this._doProcessBlock(c,k);k=c.splice(0,a);b.sigBytes-=h}return new u.init(k,h)},clone:function(){var a=q.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});g.Hasher=w.extend({cfg:q.extend(),
init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return(new a.init(c)).finalize(b)}},_createHmacHelper:function(a){return function(f,c){return(new b.HMAC.init(a,c)).finalize(f)}}});var b=e.algo={};return e}(Math);(function(){var d=y,k=d.lib,e=k.WordArray,
g=k.Hasher,p=[],k=d.algo.SHA1=g.extend({_doReset:function(){this._hash=new e.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(d,e){for(var g=this._hash.words,k=g[0],c=g[1],x=g[2],w=g[3],b=g[4],a=0;80>a;a++){if(16>a)p[a]=d[e+a]|0;else{var f=p[a-3]^p[a-8]^p[a-14]^p[a-16];p[a]=f<<1|f>>>31}f=(k<<5|k>>>27)+b+p[a];f=20>a?f+((c&x|~c&w)+1518500249):40>a?f+((c^x^w)+1859775393):60>a?f+((c&x|c&w|x&w)-1894007588):f+((c^x^w)-899497514);b=w;w=x;x=c<<30|c>>>2;c=k;k=f}g[0]=
g[0]+k|0;g[1]=g[1]+c|0;g[2]=g[2]+x|0;g[3]=g[3]+w|0;g[4]=g[4]+b|0},_doFinalize:function(){var d=this._data,e=d.words,g=8*this._nDataBytes,k=8*d.sigBytes;e[k>>>5]|=128<<24-k%32;e[(k+64>>>9<<4)+14]=Math.floor(g/4294967296);e[(k+64>>>9<<4)+15]=g;d.sigBytes=4*e.length;this._process();return this._hash},clone:function(){var d=g.clone.call(this);d._hash=this._hash.clone();return d}});d.SHA1=g._createHelper(k);d.HmacSHA1=g._createHmacHelper(k)})();(function(){var d=y,k=d.enc.Utf8;d.algo.HMAC=d.lib.Base.extend({init:function(d,
g){d=this._hasher=new d.init;"string"==typeof g&&(g=k.parse(g));var p=d.blockSize,q=4*p;g.sigBytes>q&&(g=d.finalize(g));g.clamp();d=this._oKey=g.clone();g=this._iKey=g.clone();for(var u=d.words,v=g.words,r=0;r<p;r++)u[r]^=1549556828,v[r]^=909522486;d.sigBytes=g.sigBytes=q;this.reset()},reset:function(){var d=this._hasher;d.reset();d.update(this._iKey)},update:function(d){this._hasher.update(d);return this},finalize:function(d){var g=this._hasher;d=g.finalize(d);g.reset();return g.finalize(this._oKey.clone().concat(d))}})})();
(function(){var d=y,k=d.lib,e=k.Base,g=k.WordArray,k=d.algo,p=k.HMAC,q=k.PBKDF2=e.extend({cfg:e.extend({keySize:4,hasher:k.SHA1,iterations:1}),init:function(d){this.cfg=this.cfg.extend(d)},compute:function(d,e){var k=this.cfg;d=p.create(k.hasher,d);for(var c=g.create(),q=g.create([1]),w=c.words,b=q.words,a=k.keySize,k=k.iterations;w.length<a;){var f=d.update(e).finalize(q);d.reset();for(var t=f.words,h=t.length,J=f,y=1;y<k;y++){J=d.finalize(J);d.reset();for(var sa=J.words,ha=0;ha<h;ha++)t[ha]^=sa[ha]}c.concat(f);
b[0]++}c.sigBytes=4*a;return c}});d.PBKDF2=function(d,e,g){return q.create(g).compute(d,e)}})();y=y||function(d,k){var e={},g=e.lib={},p=function(){},q=g.Base={extend:function(a){p.prototype=this;var b=new p;a&&b.mixIn(a);b.hasOwnProperty("init")||(b.init=function(){b.$super.init.apply(this,arguments)});b.init.prototype=b;b.$super=this;return b},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=
a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},u=g.WordArray=q.extend({init:function(a,b){a=this.words=a||[];this.sigBytes=b!=k?b:4*a.length},toString:function(a){return(a||r).stringify(this)},concat:function(a){var b=this.words,c=a.words,h=this.sigBytes;a=a.sigBytes;this.clamp();if(h%4)for(var d=0;d<a;d++)b[h+d>>>2]|=(c[d>>>2]>>>24-d%4*8&255)<<24-(h+d)%4*8;else if(65535<c.length)for(d=0;d<a;d+=4)b[h+d>>>2]=c[d>>>2];else b.push.apply(b,
c);this.sigBytes+=a;return this},clamp:function(){var a=this.words,b=this.sigBytes;a[b>>>2]&=4294967295<<32-b%4*8;a.length=d.ceil(b/4)},clone:function(){var a=q.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var b=[],c=0;c<a;c+=4)b.push(4294967296*d.random()|0);return new u.init(b,a)}}),v=e.enc={},r=v.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],h=0;h<a;h++){var d=b[h>>>2]>>>24-h%4*8&255;c.push((d>>>4).toString(16));c.push((d&15).toString(16))}return c.join("")},
parse:function(a){for(var b=a.length,c=[],h=0;h<b;h+=2)c[h>>>3]|=parseInt(a.substr(h,2),16)<<24-h%8*4;return new u.init(c,b/2)}},c=v.Latin1={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],h=0;h<a;h++)c.push(String.fromCharCode(b[h>>>2]>>>24-h%4*8&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],h=0;h<b;h++)c[h>>>2]|=(a.charCodeAt(h)&255)<<24-h%4*8;return new u.init(c,b)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data");
}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},w=g.BufferedBlockAlgorithm=q.extend({reset:function(){this._data=new u.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var b=this._data,c=b.words,h=b.sigBytes,e=this.blockSize,g=h/(4*e),g=a?d.ceil(g):d.max((g|0)-this._minBufferSize,0);a=g*e;h=d.min(4*a,h);if(a){for(var k=0;k<a;k+=e)this._doProcessBlock(c,k);k=c.splice(0,a);b.sigBytes-=
h}return new u.init(k,h)},clone:function(){var a=q.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});g.Hasher=w.extend({cfg:q.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return(new a.init(c)).finalize(b)}},_createHmacHelper:function(a){return function(f,
c){return(new b.HMAC.init(a,c)).finalize(f)}}});var b=e.algo={};return e}(Math);(function(){var d=y,k=d.lib,e=k.WordArray,g=k.Hasher,p=[],k=d.algo.SHA1=g.extend({_doReset:function(){this._hash=new e.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(d,e){for(var g=this._hash.words,k=g[0],c=g[1],x=g[2],w=g[3],b=g[4],a=0;80>a;a++){if(16>a)p[a]=d[e+a]|0;else{var f=p[a-3]^p[a-8]^p[a-14]^p[a-16];p[a]=f<<1|f>>>31}f=(k<<5|k>>>27)+b+p[a];f=20>a?f+((c&x|~c&w)+1518500249):
40>a?f+((c^x^w)+1859775393):60>a?f+((c&x|c&w|x&w)-1894007588):f+((c^x^w)-899497514);b=w;w=x;x=c<<30|c>>>2;c=k;k=f}g[0]=g[0]+k|0;g[1]=g[1]+c|0;g[2]=g[2]+x|0;g[3]=g[3]+w|0;g[4]=g[4]+b|0},_doFinalize:function(){var d=this._data,e=d.words,g=8*this._nDataBytes,k=8*d.sigBytes;e[k>>>5]|=128<<24-k%32;e[(k+64>>>9<<4)+14]=Math.floor(g/4294967296);e[(k+64>>>9<<4)+15]=g;d.sigBytes=4*e.length;this._process();return this._hash},clone:function(){var d=g.clone.call(this);d._hash=this._hash.clone();return d}});d.SHA1=
g._createHelper(k);d.HmacSHA1=g._createHmacHelper(k)})();(function(){var d=y,k=d.enc.Utf8;d.algo.HMAC=d.lib.Base.extend({init:function(d,g){d=this._hasher=new d.init;"string"==typeof g&&(g=k.parse(g));var p=d.blockSize,q=4*p;g.sigBytes>q&&(g=d.finalize(g));g.clamp();d=this._oKey=g.clone();g=this._iKey=g.clone();for(var u=d.words,v=g.words,r=0;r<p;r++)u[r]^=1549556828,v[r]^=909522486;d.sigBytes=g.sigBytes=q;this.reset()},reset:function(){var d=this._hasher;d.reset();d.update(this._iKey)},update:function(d){this._hasher.update(d);
return this},finalize:function(d){var g=this._hasher;d=g.finalize(d);g.reset();return g.finalize(this._oKey.clone().concat(d))}})})();y=y||function(d,k){var e={},g=e.lib={},p=function(){},q=g.Base={extend:function(a){p.prototype=this;var b=new p;a&&b.mixIn(a);b.hasOwnProperty("init")||(b.init=function(){b.$super.init.apply(this,arguments)});b.init.prototype=b;b.$super=this;return b},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&
(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},u=g.WordArray=q.extend({init:function(a,b){a=this.words=a||[];this.sigBytes=b!=k?b:4*a.length},toString:function(a){return(a||r).stringify(this)},concat:function(a){var b=this.words,c=a.words,h=this.sigBytes;a=a.sigBytes;this.clamp();if(h%4)for(var d=0;d<a;d++)b[h+d>>>2]|=(c[d>>>2]>>>24-d%4*8&255)<<24-(h+d)%4*8;else if(65535<c.length)for(d=0;d<a;d+=4)b[h+d>>>2]=c[d>>>
2];else b.push.apply(b,c);this.sigBytes+=a;return this},clamp:function(){var a=this.words,b=this.sigBytes;a[b>>>2]&=4294967295<<32-b%4*8;a.length=d.ceil(b/4)},clone:function(){var a=q.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var b=[],c=0;c<a;c+=4)b.push(4294967296*d.random()|0);return new u.init(b,a)}}),v=e.enc={},r=v.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],h=0;h<a;h++){var d=b[h>>>2]>>>24-h%4*8&255;c.push((d>>>4).toString(16));c.push((d&
15).toString(16))}return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<24-d%8*4;return new u.init(c,b/2)}},c=v.Latin1={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++)c.push(String.fromCharCode(b[d>>>2]>>>24-d%4*8&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d++)c[d>>>2]|=(a.charCodeAt(d)&255)<<24-d%4*8;return new u.init(c,b)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data");
}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},w=g.BufferedBlockAlgorithm=q.extend({reset:function(){this._data=new u.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var b=this._data,c=b.words,h=b.sigBytes,e=this.blockSize,g=h/(4*e),g=a?d.ceil(g):d.max((g|0)-this._minBufferSize,0);a=g*e;h=d.min(4*a,h);if(a){for(var k=0;k<a;k+=e)this._doProcessBlock(c,k);k=c.splice(0,a);b.sigBytes-=
h}return new u.init(k,h)},clone:function(){var a=q.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});g.Hasher=w.extend({cfg:q.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return(new a.init(c)).finalize(b)}},_createHmacHelper:function(a){return function(c,
d){return(new b.HMAC.init(a,d)).finalize(c)}}});var b=e.algo={};return e}(Math);(function(){var d=y,k=d.lib.WordArray;d.enc.Base64={stringify:function(d){var g=d.words,k=d.sigBytes,q=this._map;d.clamp();d=[];for(var u=0;u<k;u+=3)for(var v=(g[u>>>2]>>>24-u%4*8&255)<<16|(g[u+1>>>2]>>>24-(u+1)%4*8&255)<<8|g[u+2>>>2]>>>24-(u+2)%4*8&255,r=0;4>r&&u+.75*r<k;r++)d.push(q.charAt(v>>>6*(3-r)&63));if(g=q.charAt(64))for(;d.length%4;)d.push(g);return d.join("")},parse:function(d){var g=d.length,p=this._map,q=
p.charAt(64);q&&(q=d.indexOf(q),-1!=q&&(g=q));for(var q=[],u=0,v=0;v<g;v++)if(v%4){var r=p.indexOf(d.charAt(v-1))<<v%4*2,c=p.indexOf(d.charAt(v))>>>6-v%4*2;q[u>>>2]|=(r|c)<<24-u%4*8;u++}return k.create(q,u)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"}})();(function(d){function k(c,b,a,f,d,h,e){c=c+(b&a|~b&f)+d+e;return(c<<h|c>>>32-h)+b}function e(c,b,a,f,d,h,e){c=c+(b&f|a&~f)+d+e;return(c<<h|c>>>32-h)+b}function g(c,b,a,f,d,h,e){c=c+(b^a^f)+d+e;return(c<<h|c>>>32-
h)+b}function p(c,b,a,f,d,h,e){c=c+(a^(b|~f))+d+e;return(c<<h|c>>>32-h)+b}for(var q=y,u=q.lib,v=u.WordArray,r=u.Hasher,u=q.algo,c=[],x=0;64>x;x++)c[x]=4294967296*d.abs(d.sin(x+1))|0;u=u.MD5=r.extend({_doReset:function(){this._hash=new v.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(d,b){for(var a=0;16>a;a++){var f=b+a,t=d[f];d[f]=(t<<8|t>>>24)&16711935|(t<<24|t>>>8)&4278255360}var a=this._hash.words,f=d[b+0],t=d[b+1],h=d[b+2],q=d[b+3],r=d[b+4],v=d[b+5],u=d[b+6],x=d[b+
7],y=d[b+8],C=d[b+9],N=d[b+10],F=d[b+11],D=d[b+12],B=d[b+13],E=d[b+14];d=d[b+15];b=a[0];var m=a[1],l=a[2],n=a[3];b=k(b,m,l,n,f,7,c[0]);n=k(n,b,m,l,t,12,c[1]);l=k(l,n,b,m,h,17,c[2]);m=k(m,l,n,b,q,22,c[3]);b=k(b,m,l,n,r,7,c[4]);n=k(n,b,m,l,v,12,c[5]);l=k(l,n,b,m,u,17,c[6]);m=k(m,l,n,b,x,22,c[7]);b=k(b,m,l,n,y,7,c[8]);n=k(n,b,m,l,C,12,c[9]);l=k(l,n,b,m,N,17,c[10]);m=k(m,l,n,b,F,22,c[11]);b=k(b,m,l,n,D,7,c[12]);n=k(n,b,m,l,B,12,c[13]);l=k(l,n,b,m,E,17,c[14]);m=k(m,l,n,b,d,22,c[15]);b=e(b,m,l,n,t,5,c[16]);
n=e(n,b,m,l,u,9,c[17]);l=e(l,n,b,m,F,14,c[18]);m=e(m,l,n,b,f,20,c[19]);b=e(b,m,l,n,v,5,c[20]);n=e(n,b,m,l,N,9,c[21]);l=e(l,n,b,m,d,14,c[22]);m=e(m,l,n,b,r,20,c[23]);b=e(b,m,l,n,C,5,c[24]);n=e(n,b,m,l,E,9,c[25]);l=e(l,n,b,m,q,14,c[26]);m=e(m,l,n,b,y,20,c[27]);b=e(b,m,l,n,B,5,c[28]);n=e(n,b,m,l,h,9,c[29]);l=e(l,n,b,m,x,14,c[30]);m=e(m,l,n,b,D,20,c[31]);b=g(b,m,l,n,v,4,c[32]);n=g(n,b,m,l,y,11,c[33]);l=g(l,n,b,m,F,16,c[34]);m=g(m,l,n,b,E,23,c[35]);b=g(b,m,l,n,t,4,c[36]);n=g(n,b,m,l,r,11,c[37]);l=g(l,
n,b,m,x,16,c[38]);m=g(m,l,n,b,N,23,c[39]);b=g(b,m,l,n,B,4,c[40]);n=g(n,b,m,l,f,11,c[41]);l=g(l,n,b,m,q,16,c[42]);m=g(m,l,n,b,u,23,c[43]);b=g(b,m,l,n,C,4,c[44]);n=g(n,b,m,l,D,11,c[45]);l=g(l,n,b,m,d,16,c[46]);m=g(m,l,n,b,h,23,c[47]);b=p(b,m,l,n,f,6,c[48]);n=p(n,b,m,l,x,10,c[49]);l=p(l,n,b,m,E,15,c[50]);m=p(m,l,n,b,v,21,c[51]);b=p(b,m,l,n,D,6,c[52]);n=p(n,b,m,l,q,10,c[53]);l=p(l,n,b,m,N,15,c[54]);m=p(m,l,n,b,t,21,c[55]);b=p(b,m,l,n,y,6,c[56]);n=p(n,b,m,l,d,10,c[57]);l=p(l,n,b,m,u,15,c[58]);m=p(m,l,
n,b,B,21,c[59]);b=p(b,m,l,n,r,6,c[60]);n=p(n,b,m,l,F,10,c[61]);l=p(l,n,b,m,h,15,c[62]);m=p(m,l,n,b,C,21,c[63]);a[0]=a[0]+b|0;a[1]=a[1]+m|0;a[2]=a[2]+l|0;a[3]=a[3]+n|0},_doFinalize:function(){var c=this._data,b=c.words,a=8*this._nDataBytes,f=8*c.sigBytes;b[f>>>5]|=128<<24-f%32;var e=d.floor(a/4294967296);b[(f+64>>>9<<4)+15]=(e<<8|e>>>24)&16711935|(e<<24|e>>>8)&4278255360;b[(f+64>>>9<<4)+14]=(a<<8|a>>>24)&16711935|(a<<24|a>>>8)&4278255360;c.sigBytes=4*(b.length+1);this._process();c=this._hash;b=c.words;
for(a=0;4>a;a++)f=b[a],b[a]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360;return c},clone:function(){var c=r.clone.call(this);c._hash=this._hash.clone();return c}});q.MD5=r._createHelper(u);q.HmacMD5=r._createHmacHelper(u)})(Math);(function(){var d=y,k=d.lib,e=k.Base,g=k.WordArray,k=d.algo,p=k.EvpKDF=e.extend({cfg:e.extend({keySize:4,hasher:k.MD5,iterations:1}),init:function(d){this.cfg=this.cfg.extend(d)},compute:function(d,e){for(var k=this.cfg,p=k.hasher.create(),c=g.create(),x=c.words,w=k.keySize,
k=k.iterations;x.length<w;){b&&p.update(b);var b=p.update(d).finalize(e);p.reset();for(var a=1;a<k;a++)b=p.finalize(b),p.reset();c.concat(b)}c.sigBytes=4*w;return c}});d.EvpKDF=function(d,e,g){return p.create(g).compute(d,e)}})();y.lib.Cipher||function(d){var k=y,e=k.lib,g=e.Base,p=e.WordArray,q=e.BufferedBlockAlgorithm,u=k.enc.Base64,v=k.algo.EvpKDF,r=e.Cipher=q.extend({cfg:g.extend(),createEncryptor:function(a,b){return this.create(this._ENC_XFORM_MODE,a,b)},createDecryptor:function(a,b){return this.create(this._DEC_XFORM_MODE,
a,b)},init:function(a,b,c){this.cfg=this.cfg.extend(c);this._xformMode=a;this._key=b;this.reset()},reset:function(){q.reset.call(this);this._doReset()},process:function(a){this._append(a);return this._process()},finalize:function(a){a&&this._append(a);return this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(b){return{encrypt:function(c,d,e){return("string"==typeof d?f:a).encrypt(b,c,d,e)},decrypt:function(c,d,e){return("string"==typeof d?f:a).decrypt(b,
c,d,e)}}}});e.StreamCipher=r.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var c=k.mode={},x=function(a,b,c){var f=this._iv;f?this._iv=d:f=this._prevBlock;for(var e=0;e<c;e++)a[b+e]^=f[e]},w=(e.BlockCipherMode=g.extend({createEncryptor:function(a,b){return this.Encryptor.create(a,b)},createDecryptor:function(a,b){return this.Decryptor.create(a,b)},init:function(a,b){this._cipher=a;this._iv=b}})).extend();w.Encryptor=w.extend({processBlock:function(a,b){var c=this._cipher,
f=c.blockSize;x.call(this,a,b,f);c.encryptBlock(a,b);this._prevBlock=a.slice(b,b+f)}});w.Decryptor=w.extend({processBlock:function(a,b){var c=this._cipher,f=c.blockSize,d=a.slice(b,b+f);c.decryptBlock(a,b);x.call(this,a,b,f);this._prevBlock=d}});c=c.CBC=w;w=(k.pad={}).Pkcs7={pad:function(a,b){b*=4;b-=a.sigBytes%b;for(var c=b<<24|b<<16|b<<8|b,f=[],d=0;d<b;d+=4)f.push(c);b=p.create(f,b);a.concat(b)},unpad:function(a){a.sigBytes-=a.words[a.sigBytes-1>>>2]&255}};e.BlockCipher=r.extend({cfg:r.cfg.extend({mode:c,
padding:w}),reset:function(){r.reset.call(this);var a=this.cfg,b=a.iv,a=a.mode;if(this._xformMode==this._ENC_XFORM_MODE)var c=a.createEncryptor;else c=a.createDecryptor,this._minBufferSize=1;this._mode=c.call(a,this,b&&b.words)},_doProcessBlock:function(a,b){this._mode.processBlock(a,b)},_doFinalize:function(){var a=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){a.pad(this._data,this.blockSize);var b=this._process(!0)}else b=this._process(!0),a.unpad(b);return b},blockSize:4});var b=e.CipherParams=
g.extend({init:function(a){this.mixIn(a)},toString:function(a){return(a||this.formatter).stringify(this)}}),c=(k.format={}).OpenSSL={stringify:function(a){var b=a.ciphertext;a=a.salt;return(a?p.create([1398893684,1701076831]).concat(a).concat(b):b).toString(u)},parse:function(a){a=u.parse(a);var c=a.words;if(1398893684==c[0]&&1701076831==c[1]){var f=p.create(c.slice(2,4));c.splice(0,4);a.sigBytes-=16}return b.create({ciphertext:a,salt:f})}},a=e.SerializableCipher=g.extend({cfg:g.extend({format:c}),
encrypt:function(a,c,f,d){d=this.cfg.extend(d);var e=a.createEncryptor(f,d);c=e.finalize(c);e=e.cfg;return b.create({ciphertext:c,key:f,iv:e.iv,algorithm:a,mode:e.mode,padding:e.padding,blockSize:a.blockSize,formatter:d.format})},decrypt:function(a,b,c,f){f=this.cfg.extend(f);b=this._parse(b,f.format);return a.createDecryptor(c,f).finalize(b.ciphertext)},_parse:function(a,b){return"string"==typeof a?b.parse(a,this):a}}),k=(k.kdf={}).OpenSSL={execute:function(a,c,f,d){d||(d=p.random(8));a=v.create({keySize:c+
f}).compute(a,d);f=p.create(a.words.slice(c),4*f);a.sigBytes=4*c;return b.create({key:a,iv:f,salt:d})}},f=e.PasswordBasedCipher=a.extend({cfg:a.cfg.extend({kdf:k}),encrypt:function(b,c,f,d){d=this.cfg.extend(d);f=d.kdf.execute(f,b.keySize,b.ivSize);d.iv=f.iv;b=a.encrypt.call(this,b,c,f.key,d);b.mixIn(f);return b},decrypt:function(b,c,f,d){d=this.cfg.extend(d);c=this._parse(c,d.format);f=d.kdf.execute(f,b.keySize,b.ivSize,c.salt);d.iv=f.iv;return a.decrypt.call(this,b,c,f.key,d)}})}();(function(){function d(){for(var d=
this._X,e=this._C,c=0;8>c;c++)p[c]=e[c];e[0]=e[0]+1295307597+this._b|0;e[1]=e[1]+3545052371+(e[0]>>>0<p[0]>>>0?1:0)|0;e[2]=e[2]+886263092+(e[1]>>>0<p[1]>>>0?1:0)|0;e[3]=e[3]+1295307597+(e[2]>>>0<p[2]>>>0?1:0)|0;e[4]=e[4]+3545052371+(e[3]>>>0<p[3]>>>0?1:0)|0;e[5]=e[5]+886263092+(e[4]>>>0<p[4]>>>0?1:0)|0;e[6]=e[6]+1295307597+(e[5]>>>0<p[5]>>>0?1:0)|0;e[7]=e[7]+3545052371+(e[6]>>>0<p[6]>>>0?1:0)|0;this._b=e[7]>>>0<p[7]>>>0?1:0;for(c=0;8>c;c++){var g=d[c]+e[c],k=g&65535,b=g>>>16;q[c]=((k*k>>>17)+k*b>>>
15)+b*b^((g&4294901760)*g|0)+((g&65535)*g|0)}d[0]=q[0]+(q[7]<<16|q[7]>>>16)+(q[6]<<16|q[6]>>>16)|0;d[1]=q[1]+(q[0]<<8|q[0]>>>24)+q[7]|0;d[2]=q[2]+(q[1]<<16|q[1]>>>16)+(q[0]<<16|q[0]>>>16)|0;d[3]=q[3]+(q[2]<<8|q[2]>>>24)+q[1]|0;d[4]=q[4]+(q[3]<<16|q[3]>>>16)+(q[2]<<16|q[2]>>>16)|0;d[5]=q[5]+(q[4]<<8|q[4]>>>24)+q[3]|0;d[6]=q[6]+(q[5]<<16|q[5]>>>16)+(q[4]<<16|q[4]>>>16)|0;d[7]=q[7]+(q[6]<<8|q[6]>>>24)+q[5]|0}var k=y,e=k.lib.StreamCipher,g=[],p=[],q=[],u=k.algo.Rabbit=e.extend({_doReset:function(){for(var e=
this._key.words,g=this.cfg.iv,c=0;4>c;c++)e[c]=(e[c]<<8|e[c]>>>24)&16711935|(e[c]<<24|e[c]>>>8)&4278255360;for(var k=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],e=this._C=[e[2]<<16|e[2]>>>16,e[0]&4294901760|e[1]&65535,e[3]<<16|e[3]>>>16,e[1]&4294901760|e[2]&65535,e[0]<<16|e[0]>>>16,e[2]&4294901760|e[3]&65535,e[1]<<16|e[1]>>>16,e[3]&4294901760|e[0]&65535],c=this._b=0;4>c;c++)d.call(this);for(c=0;8>c;c++)e[c]^=k[c+4&7];if(g){var c=g.words,
g=c[0],c=c[1],g=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360,c=(c<<8|c>>>24)&16711935|(c<<24|c>>>8)&4278255360,k=g>>>16|c&4294901760,p=c<<16|g&65535;e[0]^=g;e[1]^=k;e[2]^=c;e[3]^=p;e[4]^=g;e[5]^=k;e[6]^=c;e[7]^=p;for(c=0;4>c;c++)d.call(this)}},_doProcessBlock:function(e,k){var c=this._X;d.call(this);g[0]=c[0]^c[5]>>>16^c[3]<<16;g[1]=c[2]^c[7]>>>16^c[5]<<16;g[2]=c[4]^c[1]>>>16^c[7]<<16;g[3]=c[6]^c[3]>>>16^c[1]<<16;for(c=0;4>c;c++)g[c]=(g[c]<<8|g[c]>>>24)&16711935|(g[c]<<24|g[c]>>>8)&4278255360,
e[k+c]^=g[c]},blockSize:4,ivSize:2});k.Rabbit=e._createHelper(u)})();y=y||function(d,k){var e={},g=e.lib={},p=function(){},q=g.Base={extend:function(a){p.prototype=this;var b=new p;a&&b.mixIn(a);b.hasOwnProperty("init")||(b.init=function(){b.$super.init.apply(this,arguments)});b.init.prototype=b;b.$super=this;return b},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&
(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},u=g.WordArray=q.extend({init:function(a,b){a=this.words=a||[];this.sigBytes=b!=k?b:4*a.length},toString:function(a){return(a||r).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes;a=a.sigBytes;this.clamp();if(d%4)for(var e=0;e<a;e++)b[d+e>>>2]|=(c[e>>>2]>>>24-e%4*8&255)<<24-(d+e)%4*8;else if(65535<c.length)for(e=0;e<a;e+=4)b[d+e>>>2]=c[e>>>2];else b.push.apply(b,c);this.sigBytes+=a;return this},
clamp:function(){var a=this.words,b=this.sigBytes;a[b>>>2]&=4294967295<<32-b%4*8;a.length=d.ceil(b/4)},clone:function(){var a=q.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var b=[],c=0;c<a;c+=4)b.push(4294967296*d.random()|0);return new u.init(b,a)}}),v=e.enc={},r=v.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++){var e=b[d>>>2]>>>24-d%4*8&255;c.push((e>>>4).toString(16));c.push((e&15).toString(16))}return c.join("")},parse:function(a){for(var b=
a.length,c=[],d=0;d<b;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<24-d%8*4;return new u.init(c,b/2)}},c=v.Latin1={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++)c.push(String.fromCharCode(b[d>>>2]>>>24-d%4*8&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d++)c[d>>>2]|=(a.charCodeAt(d)&255)<<24-d%4*8;return new u.init(c,b)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data");
}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},w=g.BufferedBlockAlgorithm=q.extend({reset:function(){this._data=new u.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var b=this._data,c=b.words,h=b.sigBytes,e=this.blockSize,g=h/(4*e),g=a?d.ceil(g):d.max((g|0)-this._minBufferSize,0);a=g*e;h=d.min(4*a,h);if(a){for(var k=0;k<a;k+=e)this._doProcessBlock(c,k);k=c.splice(0,a);b.sigBytes-=
h}return new u.init(k,h)},clone:function(){var a=q.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});g.Hasher=w.extend({cfg:q.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return(new a.init(c)).finalize(b)}},_createHmacHelper:function(a){return function(c,
d){return(new b.HMAC.init(a,d)).finalize(c)}}});var b=e.algo={};return e}(Math);(function(d){var k=y,e=k.lib,g=e.Base,p=e.WordArray,k=k.x64={};k.Word=g.extend({init:function(d,e){this.high=d;this.low=e}});k.WordArray=g.extend({init:function(e,g){e=this.words=e||[];this.sigBytes=g!=d?g:8*e.length},toX32:function(){for(var d=this.words,e=d.length,g=[],k=0;k<e;k++){var c=d[k];g.push(c.high);g.push(c.low)}return p.create(g,this.sigBytes)},clone:function(){for(var d=g.clone.call(this),e=d.words=this.words.slice(0),
k=e.length,p=0;p<k;p++)e[p]=e[p].clone();return d}})})();(function(){function d(){return p.create.apply(p,arguments)}for(var k=y,e=k.lib.Hasher,g=k.x64,p=g.Word,q=g.WordArray,g=k.algo,u=[d(1116352408,3609767458),d(1899447441,602891725),d(3049323471,3964484399),d(3921009573,2173295548),d(961987163,4081628472),d(1508970993,3053834265),d(2453635748,2937671579),d(2870763221,3664609560),d(3624381080,2734883394),d(310598401,1164996542),d(607225278,1323610764),d(1426881987,3590304994),d(1925078388,4068182383),
d(2162078206,991336113),d(2614888103,633803317),d(3248222580,3479774868),d(3835390401,2666613458),d(4022224774,944711139),d(264347078,2341262773),d(604807628,2007800933),d(770255983,1495990901),d(1249150122,1856431235),d(1555081692,3175218132),d(1996064986,2198950837),d(2554220882,3999719339),d(2821834349,766784016),d(2952996808,2566594879),d(3210313671,3203337956),d(3336571891,1034457026),d(3584528711,2466948901),d(113926993,3758326383),d(338241895,168717936),d(666307205,1188179964),d(773529912,
1546045734),d(1294757372,1522805485),d(1396182291,2643833823),d(1695183700,2343527390),d(1986661051,1014477480),d(2177026350,1206759142),d(2456956037,344077627),d(2730485921,1290863460),d(2820302411,3158454273),d(3259730800,3505952657),d(3345764771,106217008),d(3516065817,3606008344),d(3600352804,1432725776),d(4094571909,1467031594),d(275423344,851169720),d(430227734,3100823752),d(506948616,1363258195),d(659060556,3750685593),d(883997877,3785050280),d(958139571,3318307427),d(1322822218,3812723403),
d(1537002063,2003034995),d(1747873779,3602036899),d(1955562222,1575990012),d(2024104815,1125592928),d(2227730452,2716904306),d(2361852424,442776044),d(2428436474,593698344),d(2756734187,3733110249),d(3204031479,2999351573),d(3329325298,3815920427),d(3391569614,3928383900),d(3515267271,566280711),d(3940187606,3454069534),d(4118630271,4000239992),d(116418474,1914138554),d(174292421,2731055270),d(289380356,3203993006),d(460393269,320620315),d(685471733,587496836),d(852142971,1086792851),d(1017036298,
365543100),d(1126000580,2618297676),d(1288033470,3409855158),d(1501505948,4234509866),d(1607167915,987167468),d(1816402316,1246189591)],v=[],r=0;80>r;r++)v[r]=d();g=g.SHA512=e.extend({_doReset:function(){this._hash=new q.init([new p.init(1779033703,4089235720),new p.init(3144134277,2227873595),new p.init(1013904242,4271175723),new p.init(2773480762,1595750129),new p.init(1359893119,2917565137),new p.init(2600822924,725511199),new p.init(528734635,4215389547),new p.init(1541459225,327033209)])},_doProcessBlock:function(c,
d){for(var e=this._hash.words,b=e[0],a=e[1],f=e[2],g=e[3],h=e[4],k=e[5],p=e[6],e=e[7],q=b.high,r=b.low,y=a.high,T=a.low,C=f.high,N=f.low,F=g.high,D=g.low,B=h.high,E=h.low,m=k.high,l=k.low,n=p.high,da=p.low,la=e.high,ea=e.low,K=q,G=r,X=y,V=T,Y=C,W=N,ia=F,Z=D,L=B,H=E,fa=m,aa=l,ga=n,ba=da,ja=la,ca=ea,M=0;80>M;M++){var R=v[M];if(16>M)var I=R.high=c[d+2*M]|0,z=R.low=c[d+2*M+1]|0;else{var I=v[M-15],z=I.high,O=I.low,I=(z>>>1|O<<31)^(z>>>8|O<<24)^z>>>7,O=(O>>>1|z<<31)^(O>>>8|z<<24)^(O>>>7|z<<25),U=v[M-2],
z=U.high,A=U.low,U=(z>>>19|A<<13)^(z<<3|A>>>29)^z>>>6,A=(A>>>19|z<<13)^(A<<3|z>>>29)^(A>>>6|z<<26),z=v[M-7],ka=z.high,S=v[M-16],P=S.high,S=S.low,z=O+z.low,I=I+ka+(z>>>0<O>>>0?1:0),z=z+A,I=I+U+(z>>>0<A>>>0?1:0),z=z+S,I=I+P+(z>>>0<S>>>0?1:0);R.high=I;R.low=z}var ka=L&fa^~L&ga,S=H&aa^~H&ba,R=K&X^K&Y^X&Y,na=G&V^G&W^V&W,O=(K>>>28|G<<4)^(K<<30|G>>>2)^(K<<25|G>>>7),U=(G>>>28|K<<4)^(G<<30|K>>>2)^(G<<25|K>>>7),A=u[M],oa=A.high,ma=A.low,A=ca+((H>>>14|L<<18)^(H>>>18|L<<14)^(H<<23|L>>>9)),P=ja+((L>>>14|H<<18)^
(L>>>18|H<<14)^(L<<23|H>>>9))+(A>>>0<ca>>>0?1:0),A=A+S,P=P+ka+(A>>>0<S>>>0?1:0),A=A+ma,P=P+oa+(A>>>0<ma>>>0?1:0),A=A+z,P=P+I+(A>>>0<z>>>0?1:0),z=U+na,R=O+R+(z>>>0<U>>>0?1:0),ja=ga,ca=ba,ga=fa,ba=aa,fa=L,aa=H,H=Z+A|0,L=ia+P+(H>>>0<Z>>>0?1:0)|0,ia=Y,Z=W,Y=X,W=V,X=K,V=G,G=A+z|0,K=P+R+(G>>>0<A>>>0?1:0)|0}r=b.low=r+G;b.high=q+K+(r>>>0<G>>>0?1:0);T=a.low=T+V;a.high=y+X+(T>>>0<V>>>0?1:0);N=f.low=N+W;f.high=C+Y+(N>>>0<W>>>0?1:0);D=g.low=D+Z;g.high=F+ia+(D>>>0<Z>>>0?1:0);E=h.low=E+H;h.high=B+L+(E>>>0<H>>>
0?1:0);l=k.low=l+aa;k.high=m+fa+(l>>>0<aa>>>0?1:0);da=p.low=da+ba;p.high=n+ga+(da>>>0<ba>>>0?1:0);ea=e.low=ea+ca;e.high=la+ja+(ea>>>0<ca>>>0?1:0)},_doFinalize:function(){var c=this._data,d=c.words,e=8*this._nDataBytes,b=8*c.sigBytes;d[b>>>5]|=128<<24-b%32;d[(b+128>>>10<<5)+30]=Math.floor(e/4294967296);d[(b+128>>>10<<5)+31]=e;c.sigBytes=4*d.length;this._process();return this._hash.toX32()},clone:function(){var c=e.clone.call(this);c._hash=this._hash.clone();return c},blockSize:32});k.SHA512=e._createHelper(g);
k.HmacSHA512=e._createHmacHelper(g)})();(function(){var d=y,k=d.enc.Utf8;d.algo.HMAC=d.lib.Base.extend({init:function(d,g){d=this._hasher=new d.init;"string"==typeof g&&(g=k.parse(g));var p=d.blockSize,q=4*p;g.sigBytes>q&&(g=d.finalize(g));g.clamp();d=this._oKey=g.clone();g=this._iKey=g.clone();for(var u=d.words,v=g.words,r=0;r<p;r++)u[r]^=1549556828,v[r]^=909522486;d.sigBytes=g.sigBytes=q;this.reset()},reset:function(){var d=this._hasher;d.reset();d.update(this._iKey)},update:function(d){this._hasher.update(d);
return this},finalize:function(d){var g=this._hasher;d=g.finalize(d);g.reset();return g.finalize(this._oKey.clone().concat(d))}})})();y=y||function(d,k){var e={},g=e.lib={},p=function(){},q=g.Base={extend:function(a){p.prototype=this;var b=new p;a&&b.mixIn(a);b.hasOwnProperty("init")||(b.init=function(){b.$super.init.apply(this,arguments)});b.init.prototype=b;b.$super=this;return b},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&
(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},u=g.WordArray=q.extend({init:function(a,b){a=this.words=a||[];this.sigBytes=b!=k?b:4*a.length},toString:function(a){return(a||r).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes;a=a.sigBytes;this.clamp();if(d%4)for(var e=0;e<a;e++)b[d+e>>>2]|=(c[e>>>2]>>>24-e%4*8&255)<<24-(d+e)%4*8;else if(65535<c.length)for(e=0;e<a;e+=4)b[d+e>>>2]=c[e>>>
2];else b.push.apply(b,c);this.sigBytes+=a;return this},clamp:function(){var a=this.words,b=this.sigBytes;a[b>>>2]&=4294967295<<32-b%4*8;a.length=d.ceil(b/4)},clone:function(){var a=q.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var b=[],c=0;c<a;c+=4)b.push(4294967296*d.random()|0);return new u.init(b,a)}}),v=e.enc={},r=v.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++){var e=b[d>>>2]>>>24-d%4*8&255;c.push((e>>>4).toString(16));c.push((e&
15).toString(16))}return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<24-d%8*4;return new u.init(c,b/2)}},c=v.Latin1={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++)c.push(String.fromCharCode(b[d>>>2]>>>24-d%4*8&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d++)c[d>>>2]|=(a.charCodeAt(d)&255)<<24-d%4*8;return new u.init(c,b)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data");
}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},w=g.BufferedBlockAlgorithm=q.extend({reset:function(){this._data=new u.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var b=this._data,c=b.words,e=b.sigBytes,g=this.blockSize,k=e/(4*g),k=a?d.ceil(k):d.max((k|0)-this._minBufferSize,0);a=k*g;e=d.min(4*a,e);if(a){for(var p=0;p<a;p+=g)this._doProcessBlock(c,p);p=c.splice(0,a);b.sigBytes-=
e}return new u.init(p,e)},clone:function(){var a=q.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});g.Hasher=w.extend({cfg:q.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return(new a.init(c)).finalize(b)}},_createHmacHelper:function(a){return function(c,
d){return(new b.HMAC.init(a,d)).finalize(c)}}});var b=e.algo={};return e}(Math);(function(){var d=y,k=d.lib.WordArray;d.enc.Base64={stringify:function(d){var g=d.words,k=d.sigBytes,q=this._map;d.clamp();d=[];for(var u=0;u<k;u+=3)for(var v=(g[u>>>2]>>>24-u%4*8&255)<<16|(g[u+1>>>2]>>>24-(u+1)%4*8&255)<<8|g[u+2>>>2]>>>24-(u+2)%4*8&255,r=0;4>r&&u+.75*r<k;r++)d.push(q.charAt(v>>>6*(3-r)&63));if(g=q.charAt(64))for(;d.length%4;)d.push(g);return d.join("")},parse:function(d){var g=d.length,p=this._map,q=
p.charAt(64);q&&(q=d.indexOf(q),-1!=q&&(g=q));for(var q=[],u=0,v=0;v<g;v++)if(v%4){var r=p.indexOf(d.charAt(v-1))<<v%4*2,c=p.indexOf(d.charAt(v))>>>6-v%4*2;q[u>>>2]|=(r|c)<<24-u%4*8;u++}return k.create(q,u)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"}})();(function(d){function k(c,b,a,d,e,h,g){c=c+(b&a|~b&d)+e+g;return(c<<h|c>>>32-h)+b}function e(c,b,a,d,e,h,g){c=c+(b&d|a&~d)+e+g;return(c<<h|c>>>32-h)+b}function g(c,b,a,d,e,h,g){c=c+(b^a^d)+e+g;return(c<<h|c>>>32-
h)+b}function p(c,b,a,d,e,h,g){c=c+(a^(b|~d))+e+g;return(c<<h|c>>>32-h)+b}for(var q=y,u=q.lib,v=u.WordArray,r=u.Hasher,u=q.algo,c=[],x=0;64>x;x++)c[x]=4294967296*d.abs(d.sin(x+1))|0;u=u.MD5=r.extend({_doReset:function(){this._hash=new v.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(d,b){for(var a=0;16>a;a++){var f=b+a,t=d[f];d[f]=(t<<8|t>>>24)&16711935|(t<<24|t>>>8)&4278255360}var a=this._hash.words,f=d[b+0],t=d[b+1],h=d[b+2],q=d[b+3],r=d[b+4],u=d[b+5],v=d[b+6],x=d[b+
7],y=d[b+8],C=d[b+9],N=d[b+10],F=d[b+11],D=d[b+12],B=d[b+13],E=d[b+14];d=d[b+15];b=a[0];var m=a[1],l=a[2],n=a[3];b=k(b,m,l,n,f,7,c[0]);n=k(n,b,m,l,t,12,c[1]);l=k(l,n,b,m,h,17,c[2]);m=k(m,l,n,b,q,22,c[3]);b=k(b,m,l,n,r,7,c[4]);n=k(n,b,m,l,u,12,c[5]);l=k(l,n,b,m,v,17,c[6]);m=k(m,l,n,b,x,22,c[7]);b=k(b,m,l,n,y,7,c[8]);n=k(n,b,m,l,C,12,c[9]);l=k(l,n,b,m,N,17,c[10]);m=k(m,l,n,b,F,22,c[11]);b=k(b,m,l,n,D,7,c[12]);n=k(n,b,m,l,B,12,c[13]);l=k(l,n,b,m,E,17,c[14]);m=k(m,l,n,b,d,22,c[15]);b=e(b,m,l,n,t,5,c[16]);
n=e(n,b,m,l,v,9,c[17]);l=e(l,n,b,m,F,14,c[18]);m=e(m,l,n,b,f,20,c[19]);b=e(b,m,l,n,u,5,c[20]);n=e(n,b,m,l,N,9,c[21]);l=e(l,n,b,m,d,14,c[22]);m=e(m,l,n,b,r,20,c[23]);b=e(b,m,l,n,C,5,c[24]);n=e(n,b,m,l,E,9,c[25]);l=e(l,n,b,m,q,14,c[26]);m=e(m,l,n,b,y,20,c[27]);b=e(b,m,l,n,B,5,c[28]);n=e(n,b,m,l,h,9,c[29]);l=e(l,n,b,m,x,14,c[30]);m=e(m,l,n,b,D,20,c[31]);b=g(b,m,l,n,u,4,c[32]);n=g(n,b,m,l,y,11,c[33]);l=g(l,n,b,m,F,16,c[34]);m=g(m,l,n,b,E,23,c[35]);b=g(b,m,l,n,t,4,c[36]);n=g(n,b,m,l,r,11,c[37]);l=g(l,
n,b,m,x,16,c[38]);m=g(m,l,n,b,N,23,c[39]);b=g(b,m,l,n,B,4,c[40]);n=g(n,b,m,l,f,11,c[41]);l=g(l,n,b,m,q,16,c[42]);m=g(m,l,n,b,v,23,c[43]);b=g(b,m,l,n,C,4,c[44]);n=g(n,b,m,l,D,11,c[45]);l=g(l,n,b,m,d,16,c[46]);m=g(m,l,n,b,h,23,c[47]);b=p(b,m,l,n,f,6,c[48]);n=p(n,b,m,l,x,10,c[49]);l=p(l,n,b,m,E,15,c[50]);m=p(m,l,n,b,u,21,c[51]);b=p(b,m,l,n,D,6,c[52]);n=p(n,b,m,l,q,10,c[53]);l=p(l,n,b,m,N,15,c[54]);m=p(m,l,n,b,t,21,c[55]);b=p(b,m,l,n,y,6,c[56]);n=p(n,b,m,l,d,10,c[57]);l=p(l,n,b,m,v,15,c[58]);m=p(m,l,
n,b,B,21,c[59]);b=p(b,m,l,n,r,6,c[60]);n=p(n,b,m,l,F,10,c[61]);l=p(l,n,b,m,h,15,c[62]);m=p(m,l,n,b,C,21,c[63]);a[0]=a[0]+b|0;a[1]=a[1]+m|0;a[2]=a[2]+l|0;a[3]=a[3]+n|0},_doFinalize:function(){var c=this._data,b=c.words,a=8*this._nDataBytes,f=8*c.sigBytes;b[f>>>5]|=128<<24-f%32;var e=d.floor(a/4294967296);b[(f+64>>>9<<4)+15]=(e<<8|e>>>24)&16711935|(e<<24|e>>>8)&4278255360;b[(f+64>>>9<<4)+14]=(a<<8|a>>>24)&16711935|(a<<24|a>>>8)&4278255360;c.sigBytes=4*(b.length+1);this._process();c=this._hash;b=c.words;
for(a=0;4>a;a++)f=b[a],b[a]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360;return c},clone:function(){var c=r.clone.call(this);c._hash=this._hash.clone();return c}});q.MD5=r._createHelper(u);q.HmacMD5=r._createHmacHelper(u)})(Math);(function(){var d=y,k=d.lib,e=k.Base,g=k.WordArray,k=d.algo,p=k.EvpKDF=e.extend({cfg:e.extend({keySize:4,hasher:k.MD5,iterations:1}),init:function(d){this.cfg=this.cfg.extend(d)},compute:function(d,e){for(var k=this.cfg,p=k.hasher.create(),c=g.create(),x=c.words,w=k.keySize,
k=k.iterations;x.length<w;){b&&p.update(b);var b=p.update(d).finalize(e);p.reset();for(var a=1;a<k;a++)b=p.finalize(b),p.reset();c.concat(b)}c.sigBytes=4*w;return c}});d.EvpKDF=function(d,e,g){return p.create(g).compute(d,e)}})();y.lib.Cipher||function(d){var k=y,e=k.lib,g=e.Base,p=e.WordArray,q=e.BufferedBlockAlgorithm,u=k.enc.Base64,v=k.algo.EvpKDF,r=e.Cipher=q.extend({cfg:g.extend(),createEncryptor:function(a,b){return this.create(this._ENC_XFORM_MODE,a,b)},createDecryptor:function(a,b){return this.create(this._DEC_XFORM_MODE,
a,b)},init:function(a,b,c){this.cfg=this.cfg.extend(c);this._xformMode=a;this._key=b;this.reset()},reset:function(){q.reset.call(this);this._doReset()},process:function(a){this._append(a);return this._process()},finalize:function(a){a&&this._append(a);return this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(b){return{encrypt:function(c,d,e){return("string"==typeof d?f:a).encrypt(b,c,d,e)},decrypt:function(c,d,e){return("string"==typeof d?f:a).decrypt(b,
c,d,e)}}}});e.StreamCipher=r.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var c=k.mode={},x=function(a,b,c){var f=this._iv;f?this._iv=d:f=this._prevBlock;for(var e=0;e<c;e++)a[b+e]^=f[e]},w=(e.BlockCipherMode=g.extend({createEncryptor:function(a,b){return this.Encryptor.create(a,b)},createDecryptor:function(a,b){return this.Decryptor.create(a,b)},init:function(a,b){this._cipher=a;this._iv=b}})).extend();w.Encryptor=w.extend({processBlock:function(a,b){var c=this._cipher,
d=c.blockSize;x.call(this,a,b,d);c.encryptBlock(a,b);this._prevBlock=a.slice(b,b+d)}});w.Decryptor=w.extend({processBlock:function(a,b){var c=this._cipher,d=c.blockSize,f=a.slice(b,b+d);c.decryptBlock(a,b);x.call(this,a,b,d);this._prevBlock=f}});c=c.CBC=w;w=(k.pad={}).Pkcs7={pad:function(a,b){b*=4;b-=a.sigBytes%b;for(var c=b<<24|b<<16|b<<8|b,d=[],f=0;f<b;f+=4)d.push(c);b=p.create(d,b);a.concat(b)},unpad:function(a){a.sigBytes-=a.words[a.sigBytes-1>>>2]&255}};e.BlockCipher=r.extend({cfg:r.cfg.extend({mode:c,
padding:w}),reset:function(){r.reset.call(this);var a=this.cfg,b=a.iv,a=a.mode;if(this._xformMode==this._ENC_XFORM_MODE)var c=a.createEncryptor;else c=a.createDecryptor,this._minBufferSize=1;this._mode=c.call(a,this,b&&b.words)},_doProcessBlock:function(a,b){this._mode.processBlock(a,b)},_doFinalize:function(){var a=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){a.pad(this._data,this.blockSize);var b=this._process(!0)}else b=this._process(!0),a.unpad(b);return b},blockSize:4});var b=e.CipherParams=
g.extend({init:function(a){this.mixIn(a)},toString:function(a){return(a||this.formatter).stringify(this)}}),c=(k.format={}).OpenSSL={stringify:function(a){var b=a.ciphertext;a=a.salt;return(a?p.create([1398893684,1701076831]).concat(a).concat(b):b).toString(u)},parse:function(a){a=u.parse(a);var c=a.words;if(1398893684==c[0]&&1701076831==c[1]){var d=p.create(c.slice(2,4));c.splice(0,4);a.sigBytes-=16}return b.create({ciphertext:a,salt:d})}},a=e.SerializableCipher=g.extend({cfg:g.extend({format:c}),
encrypt:function(a,c,d,f){f=this.cfg.extend(f);var e=a.createEncryptor(d,f);c=e.finalize(c);e=e.cfg;return b.create({ciphertext:c,key:d,iv:e.iv,algorithm:a,mode:e.mode,padding:e.padding,blockSize:a.blockSize,formatter:f.format})},decrypt:function(a,b,c,d){d=this.cfg.extend(d);b=this._parse(b,d.format);return a.createDecryptor(c,d).finalize(b.ciphertext)},_parse:function(a,b){return"string"==typeof a?b.parse(a,this):a}}),k=(k.kdf={}).OpenSSL={execute:function(a,c,d,f){f||(f=p.random(8));a=v.create({keySize:c+
d}).compute(a,f);d=p.create(a.words.slice(c),4*d);a.sigBytes=4*c;return b.create({key:a,iv:d,salt:f})}},f=e.PasswordBasedCipher=a.extend({cfg:a.cfg.extend({kdf:k}),encrypt:function(b,c,d,f){f=this.cfg.extend(f);d=f.kdf.execute(d,b.keySize,b.ivSize);f.iv=d.iv;b=a.encrypt.call(this,b,c,d.key,f);b.mixIn(d);return b},decrypt:function(b,c,d,f){f=this.cfg.extend(f);c=this._parse(c,f.format);d=f.kdf.execute(d,b.keySize,b.ivSize,c.salt);f.iv=d.iv;return a.decrypt.call(this,b,c,d.key,f)}})}();(function(){for(var d=
y,k=d.lib.BlockCipher,e=d.algo,g=[],p=[],q=[],u=[],v=[],r=[],c=[],x=[],w=[],b=[],a=[],f=0;256>f;f++)a[f]=128>f?f<<1:f<<1^283;for(var t=0,h=0,f=0;256>f;f++){var J=h^h<<1^h<<2^h<<3^h<<4,J=J>>>8^J&255^99;g[t]=J;p[J]=t;var ra=a[t],sa=a[ra],ha=a[sa],Q=257*a[J]^16843008*J;q[t]=Q<<24|Q>>>8;u[t]=Q<<16|Q>>>16;v[t]=Q<<8|Q>>>24;r[t]=Q;Q=16843009*ha^65537*sa^257*ra^16843008*t;c[J]=Q<<24|Q>>>8;x[J]=Q<<16|Q>>>16;w[J]=Q<<8|Q>>>24;b[J]=Q;t?(t=ra^a[a[a[ha^ra]]],h^=a[a[h]]):t=h=1}var T=[0,1,2,4,8,16,32,64,128,27,54],
e=e.AES=k.extend({_doReset:function(){for(var a=this._key,d=a.words,f=a.sigBytes/4,a=4*((this._nRounds=f+6)+1),e=this._keySchedule=[],h=0;h<a;h++)if(h<f)e[h]=d[h];else{var k=e[h-1];h%f?6<f&&4==h%f&&(k=g[k>>>24]<<24|g[k>>>16&255]<<16|g[k>>>8&255]<<8|g[k&255]):(k=k<<8|k>>>24,k=g[k>>>24]<<24|g[k>>>16&255]<<16|g[k>>>8&255]<<8|g[k&255],k^=T[h/f|0]<<24);e[h]=e[h-f]^k}d=this._invKeySchedule=[];for(f=0;f<a;f++)h=a-f,k=f%4?e[h]:e[h-4],d[f]=4>f||4>=h?k:c[g[k>>>24]]^x[g[k>>>16&255]]^w[g[k>>>8&255]]^b[g[k&255]]},
encryptBlock:function(a,b){this._doCryptBlock(a,b,this._keySchedule,q,u,v,r,g)},decryptBlock:function(a,d){var f=a[d+1];a[d+1]=a[d+3];a[d+3]=f;this._doCryptBlock(a,d,this._invKeySchedule,c,x,w,b,p);f=a[d+1];a[d+1]=a[d+3];a[d+3]=f},_doCryptBlock:function(a,b,c,d,f,e,h,g){for(var k=this._nRounds,p=a[b]^c[0],t=a[b+1]^c[1],q=a[b+2]^c[2],r=a[b+3]^c[3],u=4,w=1;w<k;w++)var v=d[p>>>24]^f[t>>>16&255]^e[q>>>8&255]^h[r&255]^c[u++],x=d[t>>>24]^f[q>>>16&255]^e[r>>>8&255]^h[p&255]^c[u++],y=d[q>>>24]^f[r>>>16&255]^
e[p>>>8&255]^h[t&255]^c[u++],r=d[r>>>24]^f[p>>>16&255]^e[t>>>8&255]^h[q&255]^c[u++],p=v,t=x,q=y;v=(g[p>>>24]<<24|g[t>>>16&255]<<16|g[q>>>8&255]<<8|g[r&255])^c[u++];x=(g[t>>>24]<<24|g[q>>>16&255]<<16|g[r>>>8&255]<<8|g[p&255])^c[u++];y=(g[q>>>24]<<24|g[r>>>16&255]<<16|g[p>>>8&255]<<8|g[t&255])^c[u++];r=(g[r>>>24]<<24|g[p>>>16&255]<<16|g[t>>>8&255]<<8|g[q&255])^c[u++];a[b]=v;a[b+1]=x;a[b+2]=y;a[b+3]=r},keySize:8});d.AES=k._createHelper(e)})();y=y||function(d,k){var e={},g=e.lib={},p=function(){},q=g.Base=
{extend:function(a){p.prototype=this;var b=new p;a&&b.mixIn(a);b.hasOwnProperty("init")||(b.init=function(){b.$super.init.apply(this,arguments)});b.init.prototype=b;b.$super=this;return b},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},u=g.WordArray=q.extend({init:function(a,
b){a=this.words=a||[];this.sigBytes=b!=k?b:4*a.length},toString:function(a){return(a||r).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes;a=a.sigBytes;this.clamp();if(d%4)for(var e=0;e<a;e++)b[d+e>>>2]|=(c[e>>>2]>>>24-e%4*8&255)<<24-(d+e)%4*8;else if(65535<c.length)for(e=0;e<a;e+=4)b[d+e>>>2]=c[e>>>2];else b.push.apply(b,c);this.sigBytes+=a;return this},clamp:function(){var a=this.words,b=this.sigBytes;a[b>>>2]&=4294967295<<32-b%4*8;a.length=d.ceil(b/4)},clone:function(){var a=
q.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var b=[],c=0;c<a;c+=4)b.push(4294967296*d.random()|0);return new u.init(b,a)}}),v=e.enc={},r=v.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++){var e=b[d>>>2]>>>24-d%4*8&255;c.push((e>>>4).toString(16));c.push((e&15).toString(16))}return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<24-d%8*4;return new u.init(c,b/2)}},c=v.Latin1=
{stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++)c.push(String.fromCharCode(b[d>>>2]>>>24-d%4*8&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d++)c[d>>>2]|=(a.charCodeAt(d)&255)<<24-d%4*8;return new u.init(c,b)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data");}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},w=g.BufferedBlockAlgorithm=q.extend({reset:function(){this._data=
new u.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var b=this._data,c=b.words,e=b.sigBytes,g=this.blockSize,k=e/(4*g),k=a?d.ceil(k):d.max((k|0)-this._minBufferSize,0);a=k*g;e=d.min(4*a,e);if(a){for(var p=0;p<a;p+=g)this._doProcessBlock(c,p);p=c.splice(0,a);b.sigBytes-=e}return new u.init(p,e)},clone:function(){var a=q.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});g.Hasher=
w.extend({cfg:q.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return(new a.init(c)).finalize(b)}},_createHmacHelper:function(a){return function(c,d){return(new b.HMAC.init(a,d)).finalize(c)}}});var b=e.algo={};return e}(Math);(function(d){function k(c,
b,a,d,e,h,g){c=c+(b&a|~b&d)+e+g;return(c<<h|c>>>32-h)+b}function e(c,b,a,d,e,h,g){c=c+(b&d|a&~d)+e+g;return(c<<h|c>>>32-h)+b}function g(c,b,a,d,e,h,g){c=c+(b^a^d)+e+g;return(c<<h|c>>>32-h)+b}function p(c,b,a,d,e,h,g){c=c+(a^(b|~d))+e+g;return(c<<h|c>>>32-h)+b}for(var q=y,u=q.lib,v=u.WordArray,r=u.Hasher,u=q.algo,c=[],x=0;64>x;x++)c[x]=4294967296*d.abs(d.sin(x+1))|0;u=u.MD5=r.extend({_doReset:function(){this._hash=new v.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(d,
b){for(var a=0;16>a;a++){var f=b+a,q=d[f];d[f]=(q<<8|q>>>24)&16711935|(q<<24|q>>>8)&4278255360}var a=this._hash.words,f=d[b+0],q=d[b+1],h=d[b+2],r=d[b+3],u=d[b+4],v=d[b+5],x=d[b+6],y=d[b+7],T=d[b+8],C=d[b+9],N=d[b+10],F=d[b+11],D=d[b+12],B=d[b+13],E=d[b+14];d=d[b+15];b=a[0];var m=a[1],l=a[2],n=a[3];b=k(b,m,l,n,f,7,c[0]);n=k(n,b,m,l,q,12,c[1]);l=k(l,n,b,m,h,17,c[2]);m=k(m,l,n,b,r,22,c[3]);b=k(b,m,l,n,u,7,c[4]);n=k(n,b,m,l,v,12,c[5]);l=k(l,n,b,m,x,17,c[6]);m=k(m,l,n,b,y,22,c[7]);b=k(b,m,l,n,T,7,c[8]);
n=k(n,b,m,l,C,12,c[9]);l=k(l,n,b,m,N,17,c[10]);m=k(m,l,n,b,F,22,c[11]);b=k(b,m,l,n,D,7,c[12]);n=k(n,b,m,l,B,12,c[13]);l=k(l,n,b,m,E,17,c[14]);m=k(m,l,n,b,d,22,c[15]);b=e(b,m,l,n,q,5,c[16]);n=e(n,b,m,l,x,9,c[17]);l=e(l,n,b,m,F,14,c[18]);m=e(m,l,n,b,f,20,c[19]);b=e(b,m,l,n,v,5,c[20]);n=e(n,b,m,l,N,9,c[21]);l=e(l,n,b,m,d,14,c[22]);m=e(m,l,n,b,u,20,c[23]);b=e(b,m,l,n,C,5,c[24]);n=e(n,b,m,l,E,9,c[25]);l=e(l,n,b,m,r,14,c[26]);m=e(m,l,n,b,T,20,c[27]);b=e(b,m,l,n,B,5,c[28]);n=e(n,b,m,l,h,9,c[29]);l=e(l,n,
b,m,y,14,c[30]);m=e(m,l,n,b,D,20,c[31]);b=g(b,m,l,n,v,4,c[32]);n=g(n,b,m,l,T,11,c[33]);l=g(l,n,b,m,F,16,c[34]);m=g(m,l,n,b,E,23,c[35]);b=g(b,m,l,n,q,4,c[36]);n=g(n,b,m,l,u,11,c[37]);l=g(l,n,b,m,y,16,c[38]);m=g(m,l,n,b,N,23,c[39]);b=g(b,m,l,n,B,4,c[40]);n=g(n,b,m,l,f,11,c[41]);l=g(l,n,b,m,r,16,c[42]);m=g(m,l,n,b,x,23,c[43]);b=g(b,m,l,n,C,4,c[44]);n=g(n,b,m,l,D,11,c[45]);l=g(l,n,b,m,d,16,c[46]);m=g(m,l,n,b,h,23,c[47]);b=p(b,m,l,n,f,6,c[48]);n=p(n,b,m,l,y,10,c[49]);l=p(l,n,b,m,E,15,c[50]);m=p(m,l,n,
b,v,21,c[51]);b=p(b,m,l,n,D,6,c[52]);n=p(n,b,m,l,r,10,c[53]);l=p(l,n,b,m,N,15,c[54]);m=p(m,l,n,b,q,21,c[55]);b=p(b,m,l,n,T,6,c[56]);n=p(n,b,m,l,d,10,c[57]);l=p(l,n,b,m,x,15,c[58]);m=p(m,l,n,b,B,21,c[59]);b=p(b,m,l,n,u,6,c[60]);n=p(n,b,m,l,F,10,c[61]);l=p(l,n,b,m,h,15,c[62]);m=p(m,l,n,b,C,21,c[63]);a[0]=a[0]+b|0;a[1]=a[1]+m|0;a[2]=a[2]+l|0;a[3]=a[3]+n|0},_doFinalize:function(){var c=this._data,b=c.words,a=8*this._nDataBytes,f=8*c.sigBytes;b[f>>>5]|=128<<24-f%32;var e=d.floor(a/4294967296);b[(f+64>>>
9<<4)+15]=(e<<8|e>>>24)&16711935|(e<<24|e>>>8)&4278255360;b[(f+64>>>9<<4)+14]=(a<<8|a>>>24)&16711935|(a<<24|a>>>8)&4278255360;c.sigBytes=4*(b.length+1);this._process();c=this._hash;b=c.words;for(a=0;4>a;a++)f=b[a],b[a]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360;return c},clone:function(){var c=r.clone.call(this);c._hash=this._hash.clone();return c}});q.MD5=r._createHelper(u);q.HmacMD5=r._createHmacHelper(u)})(Math);y=y||function(d,k){var e={},g=e.lib={},p=function(){},q=g.Base={extend:function(a){p.prototype=
this;var b=new p;a&&b.mixIn(a);b.hasOwnProperty("init")||(b.init=function(){b.$super.init.apply(this,arguments)});b.init.prototype=b;b.$super=this;return b},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},u=g.WordArray=q.extend({init:function(a,b){a=this.words=a||[];this.sigBytes=
b!=k?b:4*a.length},toString:function(a){return(a||r).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes;a=a.sigBytes;this.clamp();if(d%4)for(var e=0;e<a;e++)b[d+e>>>2]|=(c[e>>>2]>>>24-e%4*8&255)<<24-(d+e)%4*8;else if(65535<c.length)for(e=0;e<a;e+=4)b[d+e>>>2]=c[e>>>2];else b.push.apply(b,c);this.sigBytes+=a;return this},clamp:function(){var a=this.words,b=this.sigBytes;a[b>>>2]&=4294967295<<32-b%4*8;a.length=d.ceil(b/4)},clone:function(){var a=q.clone.call(this);a.words=
this.words.slice(0);return a},random:function(a){for(var b=[],c=0;c<a;c+=4)b.push(4294967296*d.random()|0);return new u.init(b,a)}}),v=e.enc={},r=v.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++){var e=b[d>>>2]>>>24-d%4*8&255;c.push((e>>>4).toString(16));c.push((e&15).toString(16))}return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<24-d%8*4;return new u.init(c,b/2)}},c=v.Latin1={stringify:function(a){var b=
a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++)c.push(String.fromCharCode(b[d>>>2]>>>24-d%4*8&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d++)c[d>>>2]|=(a.charCodeAt(d)&255)<<24-d%4*8;return new u.init(c,b)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data");}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},w=g.BufferedBlockAlgorithm=q.extend({reset:function(){this._data=
new u.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var b=this._data,c=b.words,e=b.sigBytes,g=this.blockSize,k=e/(4*g),k=a?d.ceil(k):d.max((k|0)-this._minBufferSize,0);a=k*g;e=d.min(4*a,e);if(a){for(var p=0;p<a;p+=g)this._doProcessBlock(c,p);p=c.splice(0,a);b.sigBytes-=e}return new u.init(p,e)},clone:function(){var a=q.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});g.Hasher=
w.extend({cfg:q.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return(new a.init(c)).finalize(b)}},_createHmacHelper:function(a){return function(c,d){return(new b.HMAC.init(a,d)).finalize(c)}}});var b=e.algo={};return e}(Math);(function(){var d=
y,k=d.lib,e=k.WordArray,g=k.Hasher,p=[],k=d.algo.SHA1=g.extend({_doReset:function(){this._hash=new e.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(d,e){for(var g=this._hash.words,k=g[0],c=g[1],x=g[2],w=g[3],b=g[4],a=0;80>a;a++){if(16>a)p[a]=d[e+a]|0;else{var f=p[a-3]^p[a-8]^p[a-14]^p[a-16];p[a]=f<<1|f>>>31}f=(k<<5|k>>>27)+b+p[a];f=20>a?f+((c&x|~c&w)+1518500249):40>a?f+((c^x^w)+1859775393):60>a?f+((c&x|c&w|x&w)-1894007588):f+((c^x^w)-899497514);b=w;w=x;x=c<<
30|c>>>2;c=k;k=f}g[0]=g[0]+k|0;g[1]=g[1]+c|0;g[2]=g[2]+x|0;g[3]=g[3]+w|0;g[4]=g[4]+b|0},_doFinalize:function(){var d=this._data,e=d.words,g=8*this._nDataBytes,k=8*d.sigBytes;e[k>>>5]|=128<<24-k%32;e[(k+64>>>9<<4)+14]=Math.floor(g/4294967296);e[(k+64>>>9<<4)+15]=g;d.sigBytes=4*e.length;this._process();return this._hash},clone:function(){var d=g.clone.call(this);d._hash=this._hash.clone();return d}});d.SHA1=g._createHelper(k);d.HmacSHA1=g._createHmacHelper(k)})();y=y||function(d,k){var e={},g=e.lib=
{},p=function(){},q=g.Base={extend:function(a){p.prototype=this;var b=new p;a&&b.mixIn(a);b.hasOwnProperty("init")||(b.init=function(){b.$super.init.apply(this,arguments)});b.init.prototype=b;b.$super=this;return b},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},u=g.WordArray=
q.extend({init:function(a,b){a=this.words=a||[];this.sigBytes=b!=k?b:4*a.length},toString:function(a){return(a||r).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes;a=a.sigBytes;this.clamp();if(d%4)for(var e=0;e<a;e++)b[d+e>>>2]|=(c[e>>>2]>>>24-e%4*8&255)<<24-(d+e)%4*8;else if(65535<c.length)for(e=0;e<a;e+=4)b[d+e>>>2]=c[e>>>2];else b.push.apply(b,c);this.sigBytes+=a;return this},clamp:function(){var a=this.words,b=this.sigBytes;a[b>>>2]&=4294967295<<32-b%4*8;a.length=
d.ceil(b/4)},clone:function(){var a=q.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var b=[],c=0;c<a;c+=4)b.push(4294967296*d.random()|0);return new u.init(b,a)}}),v=e.enc={},r=v.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++){var e=b[d>>>2]>>>24-d%4*8&255;c.push((e>>>4).toString(16));c.push((e&15).toString(16))}return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<24-d%8*4;return new u.init(c,
b/2)}},c=v.Latin1={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++)c.push(String.fromCharCode(b[d>>>2]>>>24-d%4*8&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d++)c[d>>>2]|=(a.charCodeAt(d)&255)<<24-d%4*8;return new u.init(c,b)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data");}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},w=g.BufferedBlockAlgorithm=
q.extend({reset:function(){this._data=new u.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var b=this._data,c=b.words,e=b.sigBytes,g=this.blockSize,k=e/(4*g),k=a?d.ceil(k):d.max((k|0)-this._minBufferSize,0);a=k*g;e=d.min(4*a,e);if(a){for(var p=0;p<a;p+=g)this._doProcessBlock(c,p);p=c.splice(0,a);b.sigBytes-=e}return new u.init(p,e)},clone:function(){var a=q.clone.call(this);a._data=this._data.clone();
return a},_minBufferSize:0});g.Hasher=w.extend({cfg:q.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return(new a.init(c)).finalize(b)}},_createHmacHelper:function(a){return function(c,d){return(new b.HMAC.init(a,d)).finalize(c)}}});var b=
e.algo={};return e}(Math);(function(d){for(var k=y,e=k.lib,g=e.WordArray,p=e.Hasher,e=k.algo,q=[],u=[],v=function(a){return 4294967296*(a-(a|0))|0},r=2,c=0;64>c;){var x;a:{x=r;for(var w=d.sqrt(x),b=2;b<=w;b++)if(!(x%b)){x=!1;break a}x=!0}x&&(8>c&&(q[c]=v(d.pow(r,.5))),u[c]=v(d.pow(r,1/3)),c++);r++}var a=[],e=e.SHA256=p.extend({_doReset:function(){this._hash=new g.init(q.slice(0))},_doProcessBlock:function(b,c){for(var d=this._hash.words,e=d[0],g=d[1],k=d[2],p=d[3],q=d[4],r=d[5],v=d[6],w=d[7],x=0;64>
x;x++){if(16>x)a[x]=b[c+x]|0;else{var y=a[x-15],B=a[x-2];a[x]=((y<<25|y>>>7)^(y<<14|y>>>18)^y>>>3)+a[x-7]+((B<<15|B>>>17)^(B<<13|B>>>19)^B>>>10)+a[x-16]}y=w+((q<<26|q>>>6)^(q<<21|q>>>11)^(q<<7|q>>>25))+(q&r^~q&v)+u[x]+a[x];B=((e<<30|e>>>2)^(e<<19|e>>>13)^(e<<10|e>>>22))+(e&g^e&k^g&k);w=v;v=r;r=q;q=p+y|0;p=k;k=g;g=e;e=y+B|0}d[0]=d[0]+e|0;d[1]=d[1]+g|0;d[2]=d[2]+k|0;d[3]=d[3]+p|0;d[4]=d[4]+q|0;d[5]=d[5]+r|0;d[6]=d[6]+v|0;d[7]=d[7]+w|0},_doFinalize:function(){var a=this._data,b=a.words,c=8*this._nDataBytes,
e=8*a.sigBytes;b[e>>>5]|=128<<24-e%32;b[(e+64>>>9<<4)+14]=d.floor(c/4294967296);b[(e+64>>>9<<4)+15]=c;a.sigBytes=4*b.length;this._process();return this._hash},clone:function(){var a=p.clone.call(this);a._hash=this._hash.clone();return a}});k.SHA256=p._createHelper(e);k.HmacSHA256=p._createHmacHelper(e)})(Math);(function(){var d=y,k=d.lib.WordArray,e=d.algo,g=e.SHA256,e=e.SHA224=g.extend({_doReset:function(){this._hash=new k.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,
3204075428])},_doFinalize:function(){var d=g._doFinalize.call(this);d.sigBytes-=4;return d}});d.SHA224=g._createHelper(e);d.HmacSHA224=g._createHmacHelper(e)})();return y})});
/* ******** */
/*
 2013-2015 Amazon.com. All Rights Reserved.
 Long.js (c) 2013 Daniel Wirtz <dcode@dcode.io>
 Released under the Apache License, Version 2.0
 Derived from goog.math.Long from the Closure Library
 see: https://github.com/dcodeIO/Long.js for details
 ByteBuffer.js (c) 2013 Daniel Wirtz <dcode@dcode.io>
 Released under the Apache License, Version 2.0
 see: https://github.com/dcodeIO/ByteBuffer.js for details
 ProtoBuf.js (c) 2013 Daniel Wirtz <dcode@dcode.io>
 Released under the Apache License, Version 2.0
 see: https://github.com/dcodeIO/ProtoBuf.js for details
*/
(function(C){var n=window.AmazonUIPageJS||window.P,F=n._namespace||n.attributeErrors,A=F?F("CampfireDCMetrics_AUIBuild",""):n;A.guardFatal?A.guardFatal(C)(A,window):A.execute(function(){C(A,window)})})(function(C,n,F){C.when("Long","ByteBuffer","ProtoBuf").register("3p-Dcm",function(A,f,B){(function(f){function d(a){this.totalElapsedTime=this.lastUpdatedTime=this.totalSamplesCount=this.runningCount=0;this.allowRunningTimers=a||!1;return this}function m(a,b,e,c){if("COUNTER"!==c&&"TIMER"!==c&&"STRING"!==
c&&"CLICKSTREAM"!==c)throw"MetricDataPoint: Type not Recognized";if(0>e)throw"MetricDataPoint: samples \x3c 0";this.name=a;this.value=b;this.samples=e;this.type=c;return this}function a(){try{return"localStorage"in n&&null!==n.localStorage&&localStorage}catch(a){return!1}}function c(a,b,e,c){this.program=a;this.source=b;this.dataPoints=e;this.timeStamp=c}function e(a,e,c,k,u){b(e);b(c);var p=e+"_"+c+"_DEVICE_CLIENT_METRICS_LOCAL_KEYS_"+a,l=k||f.MetricEventType.DEFAULT,z=u||!0,t={},q={},w={},E={},
n=function(a){b(a);a=q[a];null==a&&(a=new d(z));return a};this.updateLocalStorage=function(a){g.updateKeyValuePair(p,a,this.getDataPoint(a))};this.getProgram=function(){return e};this.getSource=function(){return c};this.getType=function(){return l};this.incrementCounter=function(a,e){e=e||1;b(a);h(e);t[a]=e+(t[a]&&null!=t[a]?t[a]:0);this.updateLocalStorage(a);return this};this.removeCounter=function(a){b(a);t[a]=null;this.updateLocalStorage(a);return this};this.addTimer=function(a,e,c){b(a);q[a]=
n(a).addTime(e,c);this.updateLocalStorage(a);return this};this.startTimer=function(a,e){b(a);if(q[a]&&null!=q[a]&&e&&0<q[a].runningCount)return this;q[a]=n(a).startTimer();return this};this.stopTimer=function(a){b(a);return null!=q[a]&&0<q[a].runningCount?(q[a].stopTimer(),this.updateLocalStorage(a),this):null};this.removeTimer=function(a){b(a);q[a]=null;this.updateLocalStorage(a);return this};this.appendStrings=function(a,e){b(a);e instanceof Array||(e=[e]);null==w[a]&&(w[a]=[]);w[a]=w[a].concat(e);
this.updateLocalStorage(a);return this};this.appendString=function(a,e){b(a);b(e);null==w[a]&&(w[a]=[]);w[a].push(e);this.updateLocalStorage(a);return this};this.removeString=function(a){w[a]=null;this.updateLocalStorage(a);return this};this.clear=function(){t={};q={};w={};g.clearLocalStorage(p);return this};this.addDataPoint=function(a){if(a&&null!=a){switch(a.type){case f.MetricDataPointType.COUNTER:this.incrementCounter(a.name,parseFloat(a.value));break;case f.MetricDataPointType.TIMER:l==f.MetricEventType.AGGREGATING?
this.addTimer(a.name,1E3*parseFloat(a.value),a.samples):l==f.MetricEventType.AVERAGING&&this.addTimer(a.name,1E3*parseFloat(a.value)*a.samples,a.samples);break;case f.MetricDataPointType.STRING:this.appendStrings(a.name,a.value);break;case f.MetricDataPointType.CLICKSTREAM:this.addClickStreamData(a.name,a.value);break;default:throw"Invalid MetricDataPointType";}return this}};this.addDataPoints=function(a){if(a instanceof Array)for(var b in a)this.addDataPoint(a[b]);return this};this.getDataPoint=
function(a){b(a);var e=null;a in t&&(e=new m(a,t[a].toString(),1,f.MetricDataPointType.COUNTER));if(a in q){if(null!=e)throw"Name Used For Multiple MetricDataPoint Types";if(l===f.MetricEventType.AGGREGATING)e=new m(a,q[a].getElapsedTime().toString()/1E3,q[a].getSamples(),f.MetricDataPointType.TIMER);else if(l===f.MetricEventType.AVERAGING)e=q[a].getElapsedTime()/q[a].getSamples(),e=new m(a,e.toString()/1E3,q[a].getSamples(),f.MetricDataPointType.TIMER);else throw"Unknown Metric Event Type";}if(a in
w){if(null!=e)throw"Name Used For Multiple MetricDataPoint Types";e=new m(a,w[a],1,f.MetricDataPointType.STRING)}if(a in E){if(null!=e)throw"Name Used For Multiple MetricDataPoint Types";e=new m(a,E[a],1,f.MetricDataPointType.CLICKSTREAM)}return e};this.getAllDataPoints=function(){var a=[],b;for(b in t)a.push(new m(b,t[b].toString(),1,f.MetricDataPointType.COUNTER));for(b in q)if(0!=q[b].getSamples()){var e;if(l===f.MetricEventType.AGGREGATING)e=new m(b,(q[b].getElapsedTime()/1E3).toString(),q[b].getSamples(),
f.MetricDataPointType.TIMER);else if(l===f.MetricEventType.AVERAGING)e=q[b].getElapsedTime()/q[b].getSamples(),e=new m(b,(e/1E3).toString(),q[b].getSamples(),f.MetricDataPointType.TIMER);else throw"Unknown Metric Event Type";a.push(e)}for(b in w)a.push(new m(b,w[b],1,f.MetricDataPointType.STRING));for(b in E)a.push(new m(b,E[b],1,f.MetricDataPointType.CLICKSTREAM));return a};this.addDataPoints(g.getValues(p));return this}var b=function(a){if(!a||null==a||"string"!=typeof a||0==a.length)throw"String formatted incorrectly";
},h=function(a){if(!a||null==a||a!==parseInt(a))throw"Int formatted incorrectly";},k=function(){var a=navigator.userAgent,b,e=a.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(/trident/i.test(e[1]))return b=/\brv[ :]+(\d+)/g.exec(a)||[],"IE "+(b[1]||"");if("Chrome"===e[1]&&(b=a.match(/\bOPR\/(\d+)/),null!=b))return"Opera "+b[1];e=e[2]?[e[1],e[2]]:[navigator.appName,navigator.appVersion,"-?"];null!=(b=a.match(/version\/(\d+)/i))&&e.splice(1,1,b[1]);return e[0]},p=function(){var a=
navigator.userAgent,b,e=a.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(/trident/i.test(e[1]))return b=/\brv[ :]+(\d+)/g.exec(a)||[],"IE "+(b[1]||"");if("Chrome"===e[1]&&(b=a.match(/\bOPR\/(\d+)/),null!=b))return"Opera "+b[1];e=e[2]?[e[1],e[2]]:[navigator.appName,navigator.appVersion,"-?"];null!=(b=a.match(/version\/(\d+)/i))&&e.splice(1,1,b[1]);return e[1]},l=!0;d.prototype.startTimer=function(){var a=(new Date).getTime();0<this.runningCount&&(this.totalElapsedTime+=
this.runningCount*(a-this.lastUpdatedTime));this.lastUpdatedTime=a;this.runningCount++;return this};d.prototype.stopTimer=function(){var a=(new Date).getTime();0<this.runningCount&&(this.totalElapsedTime+=this.runningCount*(a-this.lastUpdatedTime),this.runningCount--,this.lastUpdatedTime=a,this.totalSamplesCount++);return this};d.prototype.addTime=function(a,b){this.totalElapsedTime+=a;this.totalSamplesCount+=b;return this};d.prototype.getElapsedTime=function(){if(!this.allowRunningTimers&&0<this.runningCount)throw"Cannot get elapsed time - "+
this.runningCount+" start calls not matched with stop.";return this.totalElapsedTime};d.prototype.getSamples=function(){return this.totalSamplesCount};d.prototype.getRunningTimersCount=function(){return this.runningCount};var g=function(){var b={};b.isLocalStorageEnabled=a();b.getValues=function(a){a=JSON.parse(localStorage.getItem(a));var b=[],e;for(e in a)null!=localStorage.getItem(a[e])&&b.push(JSON.parse(localStorage.getItem(a[e])));return b};b.updateKeys=function(a,b,e){if(this.isLocalStorageEnabled){e=
e||!1;var c=JSON.parse(localStorage.getItem(a));null==c&&(c=[]);if(-1!=c.indexOf(b)&&e){temp=[];for(var h in c)c[h]!==b&&_temp.push(c[h]);localStorage.setItem(a,JSON.stringify(_temp))}else-1!=c.indexOf(b)||e||(c.push(b),localStorage.setItem(a,JSON.stringify(c)))}};b.updateKeyValuePair=function(a,b,e){if(!b||null==b)throw"_Key cannot be null";e=e||null;this.updateKeys(a,b,null==e);null==e?localStorage.removeItem(b):localStorage.setItem(b,JSON.stringify(e))};b.clearLocalStorage=function(a){var b=JSON.parse(localStorage.getItem(a)),
e;for(e in b)localStorage.removeItem(b[e]);localStorage.removeItem(a)};return b}(),u=function(){var a=n.dcodeIO.ProtoBuf.loadProto("message MetricBatchMessage {                            required string deviceSerialNumber \x3d 1;                            optional string deviceType \x3d 2;                            optional string tag \x3d 3;                            repeated KeyValue metadata \x3d 4;                            repeated MetricEntryMessage metricEntry \x3d 5;                        }                        message MetricEntryMessage {                            required int64 timestamp \x3d 1;                            required string program \x3d 2;                            required string source \x3d 3;                            repeated DataPointMessage dataPoint \x3d 4;                        }                        message DataPointMessage {                            required string name \x3d 1;                            required string value \x3d 2;                            required int32 SampleSize \x3d 3;                                                        enum DataType {                                COUNTER \x3d 0;                                TIMER \x3d 1;                                DISCRETE \x3d 2;                                CLICKSTREAM \x3d 3;                            }                            required DataType type \x3d 4;                        }                        message KeyValue {                            required string key \x3d 1;                            required string value \x3d 2;                        }"),
b=a.result.MetricBatchMessage,e=a.result.MetricEntryMessage,c=a.result.DataPointMessage,h=a.result.KeyValue,g=function(a,b,e,c){a=new Uint8Array(a);var h=b();null==h?(b="x-credential-token",h=f.MetricsConfiguration.getSecondaryUrlEndpoint()):(b="x-amz-access-token",e=h,h=f.MetricsConfiguration.getPrimaryUrlEndpoint());var g=new XMLHttpRequest;g.open("POST",h,!0);g.setRequestHeader("Content-type","application/octect-stream");g.setRequestHeader(b,e);g.setRequestHeader("x-codec-version","1.0");g.setRequestHeader("x-codec-format",
"ProtocolBuffers");g.onreadystatechange=function(){l&&console.log("Response Status: "+g.status);"function"===typeof c&&c(g.status)};g.send(a);b=e="";for(h=0;h<a.length;h++)0==h%10&&(e+="\n"+b+"\n\n",b=""),e+=(1==a[h].toString(16).length?"0":"")+a[h].toString(16)+" ",b=10==a[h]||13==a[h]?b+"?  ":b+(String.fromCharCode(a[h])+"  ");e+="\n"+b;l&&console.log("Upload Metrics Request Sent")},k={packData:function(a,g,k,d){if(0!=a.length){var u=[],m=[],p;for(p in g)u.push(new h(p,g[p]));for(var x in a){g=
[];p=a[x];var l=p.dataPoints||[];if(0!=l.length){for(var r in l)if(l[r].type===f.MetricDataPointType.CLICKSTREAM)u.push(new h(l[r].name,l[r].value));else{var n;switch(l[r].type){case f.MetricDataPointType.COUNTER:n=c.DataType.COUNTER;break;case f.MetricDataPointType.TIMER:n=c.DataType.TIMER;break;case f.MetricDataPointType.STRING:n=c.DataType.DISCRETE;break;case f.MetricDataPointType.CLICKSTREAM:n=c.DataType.CLICKSTREAM;break;default:throw"PackData: Type Not Recognized";}g.push(new c(l[r].name,l[r].value.toString(),
l[r].samples,n))}m.push(new e(p.timeStamp,p.program,p.source,g))}}return(new b(k,d,"0",u,m)).encode().toArrayBuffer()}},publish:function(a,b,e,c,h,d){g(k.packData(a,b,e,c),h,c,d)}};return k}();f.MetricsConfiguration=function(){var a={primaryUrlEndpoint:"https://device-metrics-us.amazon.com:443/metricsBatch",secondaryUrlEndpoint:"https://device-metrics-us-2.amazon.com:443/metricsBatch"},e={maxBatchQueueCapacityBytes:5242880,maxBatchQueueEntries:2048,transmissionPeriodMillis:6E5},c={maxSizePerBatchBytes:65536,
maxBatchQueueEntries:2048,transmissionPeriodMillis:18E4},g={setPrimaryUrlEndpoint:function(a){b(a);g.networkConfiguration.primaryUrlEndpoint=a},setSecondaryUrlEndpoint:function(a){b(a);g.networkConfiguration.secondaryUrlEndpoint=a},getPrimaryUrlEndpoint:function(){return a.primaryUrlEndpoint},getSecondaryUrlEndpoint:function(){return a.secondaryUrlEndpoint},configureNormalPipeline:function(a,b,c){h(a);h(b);h(c);if(6E4>c)throw"If you really need to upload metrics more than once every minute, simply use a manual call to MetricsFactory.uploadMetrics()";
e.maxBatchQueueCapacityBytes=a;e.maxBatchQueueEntries=b;e.transmissionPeriodMillis=c},configureHighPipeline:function(a,b,e){h(a);h(b);h(e);if(6E4>e)throw"If you really need to upload metrics more than once every minute, simply use a manual call to MetricsFactory.uploadMetrics()";c.maxBatchQueueCapacityBytes=a;c.maxBatchQueueEntries=b;c.transmissionPeriodMillis=e},getMaxBatchQueueCapacityBytes:function(a){if(a===f.MetricPriority.NORMAL)return e.maxBatchQueueCapacityBytes;if(a===f.MetricPriority.HIGH)return c.maxBatchQueueCapacityBytes;
throw"Unrecognized priority: \x3c"+a+"\x3e";},getMaxBatchQueueEntries:function(a){if(a===f.MetricPriority.NORMAL)return e.maxBatchQueueEntries;if(a===f.MetricPriority.HIGH)return c.maxBatchQueueEntries;throw"Unrecognized priority: \x3c"+a+"\x3e";},getTransmissionPeriodMillis:function(a){if(a===f.MetricPriority.NORMAL)return e.transmissionPeriodMillis;if(a===f.MetricPriority.HIGH)return c.transmissionPeriodMillis;throw"Unrecognized priority: \x3c"+a+"\x3e";},setLogEnabled:function(a){l=a}};return g}();
f.MetricMetadata={MODEL:"model",PLATFORM:"platform",SOFTWARE_VERSION:"softwareVersion",COUNTRY_OF_RESIDENCE:"countryOfResidence",PREFERRED_MARKETPLACE:"MarketplaceID",DEVICE_LANGUAGE:"deviceLanguage",SESSION_ID:"Session",CUSTOMER_ID:"CustomerId",USER_AGENT:"HTTP_USER_AGENT",REMOTE_IP:"REMOTE_ADDR",PAGE_TYPE:"page-type",HIT_TYPE:"hitType",TEAM_NAME:"team-name",SITE_VARIANT:"site_variant",PAGE_ACTION:"page-action",SUB_PAGE_TYPE:"sub-page-type",PAGE_TYPE_ID:"page-type-id",TAB_ID:"tab-id",PAGE_ASSEMBLY_TYPE:"pageAssemblyType",
IS_CUSTOMER_HIT:"is-customer-hit",IS_PRIME_CUSTOMER:"is-prime-customer",GROUPING_ASIN:"groupingASIN",PRODUCT_GLID:"ProductGlId",IMPRESSION_PROGRAM_GROUP:"programGroup",IMPRESSION_TYPE:"impressionType",IMPRESSION_DATA:"impressionData",IMPRESSION_METADATA:"impressionMetadata",ECOMMERCE_PAGE_ACTION:"ecommerce-page-action",ORDER_DATA:"order-data",IS_PRIME_ELIGIBLE_ITEM:"is-prime-eligible-item",IS_GLANCE_VIEW:"is-glance-view",CUSTOMER_ID_KEY:"CMICustomerID",SESSION_ID_KEY:"CMISessionID",contains:function(a){for(var b in f.MetricMetadata)if(a===
f.MetricMetadata[b])return!0;return!1}};f.MetricPriority={NORMAL:"NORMAL",HIGH:"HIGH"};f.MetricEventType={AVERAGING:"AVERAGING",AGGREGATING:"AGGREGATING",DEFAULT:"AGGREGATING"};f.MetricDataPointType={COUNTER:"COUNTER",TIMER:"TIMER",STRING:"STRING",CLICKSTREAM:"CLICKSTREAM"};f.MetricsFactory=function(){var h={},g=null,d=null,m=null,v=!1,r={setDeviceTypeId:function(a){b(a);m=a},setDeviceSerialNumber:function(a){if("string"!==typeof a)throw"MetricsFactory: _deviceSerialNumber must be a function";d=a},
setOAuthTokenProvider:function(a){if("function"!==typeof a)throw"MetricsFactory: _ouathTokenProvider must be a function";g=a},createMetricEvent:function(a,b,c,h,g){return new e(a,b,c,h,g)},recordMetricEvent:function(a,b){if(!(a instanceof e))throw"MetricsFactory: _metricEvent must be an instance of MetricEvent";b=b||f.MetricPriority.NORMAL;var g=b===f.MetricPriority.HIGH?"METRICS_FACTORY_CRITICAL_RECORD_KEY":"METRICS_FACTORY_DEFAULT_RECORD_KEY",k=b===f.MetricPriority.HIGH?"METRICS_FACTORY_CRITICAL_COUNT_KEY":
"METRICS_FACTORY_DEFAULT_COUNT_KEY",d=b===f.MetricPriority.HIGH?"METRICS_FACTORY_CRITICAL_BUFFER_SIZE_KEY":"METRICS_FACTORY_DEFAULT_BUFFER_SIZE_KEY",m=a.getAllDataPoints();if(0<m.length){var p=JSON.parse(localStorage.getItem(g))||[],z=parseInt(localStorage.getItem(d)||"0")+(new Uint8Array(u.packData([a],h,"",""))).length,l=parseInt(localStorage.getItem(k)||"0")+m.length;z>f.MetricsConfiguration.getMaxBatchQueueCapacityBytes(b)||l>f.MetricsConfiguration.getMaxBatchQueueEntries(b)?v?n.setTimeout(function(){r.recordMetricEvent(a,
b)},1E4):(v=!0,B(function(b){b=JSON.parse(localStorage.getItem(g))||[];b.push(new c(a.getProgram(),a.getSource(),a.getAllDataPoints(),(new Date).getTime()/1E3));localStorage.setItem(g,JSON.stringify(b));localStorage.setItem(d,z-parseInt(localStorage.getItem(d)||"0"));localStorage.setItem(k,l-parseInt(localStorage.getItem(k)||"0"));a.clear();v=!1},[g])):(p.push(new c(a.getProgram(),a.getSource(),a.getAllDataPoints(),(new Date).getTime()/1E3)),localStorage.setItem(g,JSON.stringify(p)),localStorage.setItem(d,
z),localStorage.setItem(k,l),a.clear())}}},B=function(a,b){if(!m||null==m)throw"Failed to upload metrics: DeviceTypeId must be set.";if(null==d)throw"Failed to upload metrics: DeviceSerialNumber must be set.";if(!g||null==g)throw"Failed to upload metrics: OAuthTokenProvider must be set.";if(!(b instanceof Array))throw"Failed to upload metrics: _recordKeys must be an Array";var e=[],c;for(c in b)var k=JSON.parse(localStorage.getItem(b[c]))||[],e=e.concat(k);0<e.length?u.publish(e,h,d,m,g,function(e){if(200==
e)for(var c in b)localStorage.removeItem(b[c]);a&&a()}):v=!1};r.uploadMetrics=function(){v?n.setTimeout(r.uploadMetrics,1E4):(v=!0,B(function(){v=!1},["METRICS_FACTORY_DEFAULT_RECORD_KEY","METRICS_FACTORY_CRITICAL_RECORD_KEY"]))};r.addMetadata=function(a,b){if(!f.MetricMetadata.contains(a))throw"Unknown Metadata Key. Please add as Clickstream Event";h[a]=b};r.removeMetadata=function(a){h[a]=null};r.addMetadata(f.MetricMetadata.PLATFORM,k());r.addMetadata(f.MetricMetadata.SOFTWARE_VERSION,p());var z=
function(){if(a()){var b=parseInt(localStorage.getItem("TRANSMISSION_TIMESTAMP_NORMAL")||"0"),e=(new Date).getTime(),c=f.MetricsConfiguration.getTransmissionPeriodMillis(f.MetricPriority.NORMAL);e-b>c?v?(l&&console.log("Waiting: Normal Timer"),n.setTimeout(z,1E4)):(0<b&&(v=!0,B(function(){v=!1},["METRICS_FACTORY_DEFAULT_RECORD_KEY"])),localStorage.setItem("TRANSMISSION_TIMESTAMP_NORMAL",e),l&&console.log("Started Normal Timer"),n.setTimeout(z,c)):(n.setTimeout(z,c-(e-b)),l&&console.log("Restarted Normal Timer"))}},
t=function(){if(a()){var b=parseInt(localStorage.getItem("TRANSMISSION_TIMESTAMP_HIGH")||"0"),e=(new Date).getTime(),c=f.MetricsConfiguration.getTransmissionPeriodMillis(f.MetricPriority.HIGH);e-b>c?v?(l&&console.log("Waiting: High Timer"),n.setTimeout(t,1E4)):(0<b&&(v=!0,B(function(){v=!1},["METRICS_FACTORY_CRITICAL_RECORD_KEY"])),localStorage.setItem("TRANSMISSION_TIMESTAMP_HIGH",e),n.setTimeout(t,c),l&&console.log("Started High Timer")):(n.setTimeout(t,c-(e-b)),l&&console.log("Restarted High Timer"))}};
n.setTimeout(z,1E4);n.setTimeout(t,1E4);return r}()})(this);return this});C.register("Long",function(){(function(A){var f=function(a,b,c){a&&"object"===typeof a&&(b=a.high,c=a.unsigned,a=a.low);this.low=a|0;this.high=b|0;this.unsigned=!!c},B={},G={};f.fromInt=function(a,b){if(b){a>>>=0;if(0<=a&&256>a&&(b=G[a]))return b;b=new f(a,0>(a|0)?-1:0,!0);0<=a&&256>a&&(G[a]=b)}else{a|=0;if(-128<=a&&128>a&&(b=B[a]))return b;b=new f(a,0>a?-1:0,!1);-128<=a&&128>a&&(B[a]=b)}return b};f.fromNumber=function(e,b){b=
!!b;return isNaN(e)||!isFinite(e)?f.ZERO:!b&&e<=-a?f.MIN_SIGNED_VALUE:b&&0>=e?f.MIN_UNSIGNED_VALUE:!b&&e+1>=a?f.MAX_SIGNED_VALUE:b&&e>=m?f.MAX_UNSIGNED_VALUE:0>e?f.fromNumber(-e,!1).negate():new f(e%d|0,e/d|0,b)};f.fromBits=function(a,b,c){return new f(a,b,c)};f.from28Bits=function(a,b,c,k){return f.fromBits(a|b<<28,b>>>4|c<<24,k)};f.fromString=function(a,b,c){if(0==a.length)throw Error("number format error: empty string");if("NaN"===a||"Infinity"===a||"+Infinity"===a||"-Infinity"===a)return f.ZERO;
"number"===typeof b&&(c=b,b=!1);c=c||10;if(2>c||36<c)throw Error("radix out of range: "+c);if("-"==a.charAt(0))return f.fromString(a.substring(1),b,c).negate();if(0<=a.indexOf("-"))throw Error('number format error: interior "-" character: '+a);for(var k=f.fromNumber(Math.pow(c,8)),d=f.ZERO,m=0;m<a.length;m+=8){var g=Math.min(8,a.length-m),u=parseInt(a.substring(m,m+g),c);8>g?(g=f.fromNumber(Math.pow(c,g)),d=d.multiply(g).add(f.fromNumber(u))):(d=d.multiply(k),d=d.add(f.fromNumber(u)))}d.unsigned=
b;return d};var d=4294967296,m=d*d,a=m/2,c=f.fromInt(16777216);f.ZERO=f.fromInt(0);f.UZERO=f.fromInt(0,!0);f.ONE=f.fromInt(1);f.UONE=f.fromInt(1,!0);f.NEG_ONE=f.fromInt(-1);f.MAX_SIGNED_VALUE=f.fromBits(-1,2147483647,!1);f.MAX_UNSIGNED_VALUE=f.fromBits(-1,-1,!0);f.MAX_VALUE=f.MAX_SIGNED_VALUE;f.MIN_SIGNED_VALUE=f.fromBits(0,-2147483648,!1);f.MIN_UNSIGNED_VALUE=f.fromBits(0,0,!0);f.MIN_VALUE=f.MIN_SIGNED_VALUE;f.prototype.toInt=function(){return this.unsigned?this.low>>>0:this.low};f.prototype.toNumber=
function(){return this.unsigned?(this.high>>>0)*d+(this.low>>>0):this.high*d+(this.low>>>0)};f.prototype.toString=function(a){a=a||10;if(2>a||36<a)throw Error("radix out of range: "+a);if(this.isZero())return"0";var b;if(this.isNegative()){if(this.equals(f.MIN_SIGNED_VALUE)){b=f.fromNumber(a);var c=this.div(b);b=c.multiply(b).subtract(this);return c.toString(a)+b.toInt().toString(a)}return"-"+this.negate().toString(a)}c=f.fromNumber(Math.pow(a,6));b=this;for(var d="";;){var m=b.div(c),l=b.subtract(m.multiply(c)).toInt().toString(a);
b=m;if(b.isZero())return l+d;for(;6>l.length;)l="0"+l;d=""+l+d}};f.prototype.getHighBits=function(){return this.high};f.prototype.getHighBitsUnsigned=function(){return this.high>>>0};f.prototype.getLowBits=function(){return this.low};f.prototype.getLowBitsUnsigned=function(){return this.low>>>0};f.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.equals(f.MIN_SIGNED_VALUE)?64:this.negate().getNumBitsAbs();for(var a=0!=this.high?this.high:this.low,b=31;0<b&&0==(a&1<<b);b--);return 0!=
this.high?b+33:b+1};f.prototype.isZero=function(){return 0==this.high&&0==this.low};f.prototype.isNegative=function(){return!this.unsigned&&0>this.high};f.prototype.isOdd=function(){return 1==(this.low&1)};f.prototype.isEven=function(){return 0==(this.low&1)};f.prototype.equals=function(a){return this.unsigned!=a.unsigned&&this.high>>>31!=a.high>>>31?!1:this.high==a.high&&this.low==a.low};f.prototype.notEquals=function(a){return!this.equals(a)};f.prototype.lessThan=function(a){return 0>this.compare(a)};
f.prototype.lessThanOrEqual=function(a){return 0>=this.compare(a)};f.prototype.greaterThan=function(a){return 0<this.compare(a)};f.prototype.greaterThanOrEqual=function(a){return 0<=this.compare(a)};f.prototype.compare=function(a){if(this.equals(a))return 0;var b=this.isNegative(),c=a.isNegative();return b&&!c?-1:!b&&c?1:this.unsigned?a.high>>>0>this.high>>>0||a.high==this.high&&a.low>>>0>this.low>>>0?-1:1:this.subtract(a).isNegative()?-1:1};f.prototype.negate=function(){return!this.unsigned&&this.equals(f.MIN_SIGNED_VALUE)?
f.MIN_SIGNED_VALUE:this.not().add(f.ONE)};f.prototype.add=function(a){var b=this.high>>>16,c=this.high&65535,d=this.low>>>16,m=a.high>>>16,l=a.high&65535,g=a.low>>>16;a=0+((this.low&65535)+(a.low&65535));g=0+(a>>>16)+(d+g);d=0+(g>>>16);d+=c+l;b=0+(d>>>16)+(b+m)&65535;return f.fromBits((g&65535)<<16|a&65535,b<<16|d&65535,this.unsigned)};f.prototype.subtract=function(a){return this.add(a.negate())};f.prototype.multiply=function(a){if(this.isZero()||a.isZero())return f.ZERO;if(this.equals(f.MIN_VALUE))return a.isOdd()?
f.MIN_VALUE:f.ZERO;if(a.equals(f.MIN_VALUE))return this.isOdd()?f.MIN_VALUE:f.ZERO;if(this.isNegative())return a.isNegative()?this.negate().multiply(a.negate()):this.negate().multiply(a).negate();if(a.isNegative())return this.multiply(a.negate()).negate();if(this.lessThan(c)&&a.lessThan(c))return f.fromNumber(this.toNumber()*a.toNumber(),this.unsigned);var b=this.high>>>16,h=this.high&65535,d=this.low>>>16,m=this.low&65535,l=a.high>>>16,g=a.high&65535,u=a.low>>>16;a=a.low&65535;var x,y,D,n;n=0+m*
a;D=0+(n>>>16)+d*a;y=0+(D>>>16);D=(D&65535)+m*u;y+=D>>>16;y+=h*a;x=0+(y>>>16);y=(y&65535)+d*u;x+=y>>>16;y=(y&65535)+m*g;x=x+(y>>>16)+(b*a+h*u+d*g+m*l)&65535;return f.fromBits((D&65535)<<16|n&65535,x<<16|y&65535,this.unsigned)};f.prototype.div=function(a){if(a.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?f.UZERO:f.ZERO;var b,c,d;if(this.equals(f.MIN_SIGNED_VALUE)){if(a.equals(f.ONE)||a.equals(f.NEG_ONE))return f.MIN_SIGNED_VALUE;if(a.equals(f.MIN_SIGNED_VALUE))return f.ONE;
b=this.shiftRight(1).div(a).shiftLeft(1);if(b.equals(f.ZERO))return a.isNegative()?f.ONE:f.NEG_ONE;c=this.subtract(a.multiply(b));return d=b.add(c.div(a))}if(a.equals(f.MIN_SIGNED_VALUE))return this.unsigned?f.UZERO:f.ZERO;if(this.isNegative())return a.isNegative()?this.negate().div(a.negate()):this.negate().div(a).negate();if(a.isNegative())return this.div(a.negate()).negate();d=f.ZERO;for(c=this;c.greaterThanOrEqual(a);){b=Math.max(1,Math.floor(c.toNumber()/a.toNumber()));for(var m=Math.ceil(Math.log(b)/
Math.LN2),m=48>=m?1:Math.pow(2,m-48),l=f.fromNumber(b,this.unsigned),g=l.multiply(a);g.isNegative()||g.greaterThan(c);)b-=m,l=f.fromNumber(b,this.unsigned),g=l.multiply(a);l.isZero()&&(l=f.ONE);d=d.add(l);c=c.subtract(g)}return d};f.prototype.modulo=function(a){return this.subtract(this.div(a).multiply(a))};f.prototype.not=function(){return f.fromBits(~this.low,~this.high,this.unsigned)};f.prototype.and=function(a){return f.fromBits(this.low&a.low,this.high&a.high,this.unsigned)};f.prototype.or=function(a){return f.fromBits(this.low|
a.low,this.high|a.high,this.unsigned)};f.prototype.xor=function(a){return f.fromBits(this.low^a.low,this.high^a.high,this.unsigned)};f.prototype.shiftLeft=function(a){a&=63;if(0==a)return this;var b=this.low;return 32>a?f.fromBits(b<<a,this.high<<a|b>>>32-a,this.unsigned):f.fromBits(0,b<<a-32,this.unsigned)};f.prototype.shiftRight=function(a){a&=63;if(0==a)return this;var b=this.high;return 32>a?f.fromBits(this.low>>>a|b<<32-a,b>>a,this.unsigned):f.fromBits(b>>a-32,0<=b?0:-1,this.unsigned)};f.prototype.shiftRightUnsigned=
function(a){a&=63;if(0==a)return this;var b=this.high;return 32>a?f.fromBits(this.low>>>a|b<<32-a,b>>>a,this.unsigned):32==a?f.fromBits(b,0,this.unsigned):f.fromBits(b>>>a-32,0,this.unsigned)};f.prototype.toSigned=function(){var a=this.clone();a.unsigned=!1;return a};f.prototype.toUnsigned=function(){var a=this.clone();a.unsigned=!0;return a};f.prototype.clone=function(){return new f(this.low,this.high,this.unsigned)};n.dcodeIO||(n.dcodeIO={});n.dcodeIO.Long=f})(this)});C.when("Long").register("ByteBuffer",
function(A){(function(f){n.dcodeIO||(n.dcodeIO={});n.dcodeIO.ByteBuffer=function(f){var n=null;if("function"===typeof require)try{n=null}catch(a){}var d=function(a,c,e){a="undefined"!==typeof a?parseInt(a,10):d.DEFAULT_CAPACITY;1>a&&(a=d.DEFAULT_CAPACITY);this.array=e?null:new ArrayBuffer(a);this.view=e?null:new DataView(this.array);this.offset=0;this.markedOffset=-1;this.length=0;this.littleEndian="undefined"!=typeof c?!!c:!1};d.VERSION="2.3.1";d.DEFAULT_CAPACITY=16;d.LITTLE_ENDIAN=!0;d.BIG_ENDIAN=
!1;d.Long=f||null;d.isByteBuffer=function(a){return a&&(a instanceof d||"object"===typeof a&&(null===a.array||a.array instanceof ArrayBuffer)&&(null===a.view||a.view instanceof DataView)&&"number"===typeof a.offset&&"number"===typeof a.markedOffset&&"number"===typeof a.length&&"boolean"===typeof a.littleEndian)};d.allocate=function(a,c){return new d(a,c)};d.wrap=function(a,c,e){"boolean"===typeof c&&(e=c,c="utf8");if("string"===typeof a)switch(c){case "base64":return d.decode64(a,e);case "hex":return d.decodeHex(a,
e);case "binary":return d.decodeBinary(a,e);default:return(new d(d.DEFAULT_CAPACITY,e)).writeUTF8String(a).flip()}if(n&&n.isBuffer(a)){c=(new Uint8Array(a)).buffer;if(c===a){c=new ArrayBuffer(a.length);for(var b=new Uint8Array(c),h=0,k=a.length;h<k;++h)b[h]=a[h]}a=c}if(null===a||"object"!==typeof a)throw Error("Cannot wrap null or non-object");if(d.isByteBuffer(a))return d.prototype.clone.call(a);a.array?a=a.array:a.buffer&&(a=a.buffer);if(!(a instanceof ArrayBuffer))throw Error("Cannot wrap buffer of type "+
typeof a+", "+a.constructor.name);c=new d(0,e,!0);c.array=a;c.view=0<c.array.byteLength?new DataView(c.array):null;c.offset=0;c.length=a.byteLength;return c};d.prototype.LE=function(a){this.littleEndian="undefined"!==typeof a?!!a:!0;return this};d.prototype.BE=function(a){this.littleEndian="undefined"!==typeof a?!a:!1;return this};d.prototype.resize=function(a){if(1>a)return!1;null===this.array&&(this.array=new ArrayBuffer(a),this.view=new DataView(this.array));if(this.array.byteLength<a){var c=new Uint8Array(this.array);
a=new ArrayBuffer(a);(new Uint8Array(a)).set(c);this.array=a;this.view=new DataView(a)}return this};d.prototype.slice=function(a,c){if(null==this.array)throw Error(this+" cannot be sliced: Already destroyed");"undefined"===typeof a&&(a=this.offset);"undefined"===typeof c&&(c=this.length);if(c<=a){var e=c;c=a;a=e}if(0>a||a>this.array.byteLength||1>c||c>this.array.byteLength)throw Error(this+" cannot be sliced: Index out of bounds (0-"+this.array.byteLength+" -\x3e "+a+"-"+c+")");e=this.clone();e.offset=
a;e.length=c;return e};d.prototype.ensureCapacity=function(a){return null===this.array?this.resize(a):this.array.byteLength<a?this.resize(2*this.array.byteLength>=a?2*this.array.byteLength:a):this};d.prototype.flip=function(){this.length=null==this.array?0:this.offset;this.offset=0;return this};d.prototype.mark=function(a){if(null==this.array)throw Error(this+" cannot be marked: Already destroyed");a="undefined"!==typeof a?parseInt(a,10):this.offset;if(0>a||a>this.array.byteLength)throw Error(this+
" cannot be marked: Offset to mark is less than 0 or bigger than the capacity ("+this.array.byteLength+"): "+a);this.markedOffset=a;return this};d.prototype.reset=function(){if(null===this.array)throw Error(this+" cannot be reset: Already destroyed");0<=this.markedOffset?(this.offset=this.markedOffset,this.markedOffset=-1):this.length=this.offset=0;return this};d.prototype.clone=function(){var a=new d(-1,this.littleEndian,!0);a.array=this.array;a.view=this.view;a.offset=this.offset;a.markedOffset=
this.markedOffset;a.length=this.length;return a};d.prototype.copy=function(){if(null==this.array)return this.clone();var a=new d(this.array.byteLength,this.littleEndian),c=new Uint8Array(this.array);(new Uint8Array(a.array)).set(c);a.offset=this.offset;a.markedOffset=this.markedOffset;a.length=this.length;return a};d.prototype.remaining=function(){return null===this.array?0:this.length-this.offset};d.prototype.capacity=function(){return null!=this.array?this.array.byteLength:0};d.prototype.compact=
function(){if(null==this.array)throw Error(this+" cannot be compacted: Already destroyed");this.offset>this.length&&this.flip();if(this.offset===this.length)return this.array=new ArrayBuffer(0),this.view=null,this;if(0===this.offset&&this.length===this.array.byteLength)return this;var a=new Uint8Array(this.array),c=new ArrayBuffer(this.length-this.offset);(new Uint8Array(c)).set(a.subarray(this.offset,this.length));this.array=c;this.markedOffset=this.markedOffset>=this.offset?this.markedOffset-this.offset:
-1;this.offset=0;this.length=this.array.byteLength;return this};d.prototype.destroy=function(){null!==this.array&&(this.view=this.array=null,this.offset=0,this.markedOffset=-1,this.length=0);return this};d.prototype.reverse=function(){if(null===this.array)throw Error(this+" cannot be reversed: Already destroyed");Array.prototype.reverse.call(new Uint8Array(this.array));var a=this.offset;this.offset=this.array.byteLength-this.length;this.markedOffset=-1;this.length=this.array.byteLength-a;this.view=
new DataView(this.array);return this};d.prototype.append=function(a,c){a instanceof d||(a=d.wrap(a));if(null===a.array)throw Error(a+" cannot be appended to "+this+": Already destroyed");var e=a.length-a.offset;if(0==e)return this;0>e&&(a=a.clone().flip(),e=a.length-a.offset);c="undefined"!==typeof c?c:(this.offset+=e)-e;this.ensureCapacity(c+e);e=new Uint8Array(a.array);(new Uint8Array(this.array)).set(e.subarray(a.offset,a.length),c);return this};d.prototype.prepend=function(a,c){a instanceof d||
(a=d.wrap(a));if(null===a.array)throw a+" cannot be prepended to "+this+": Already destroyed";var e=a.length-a.offset;if(0==e)return this;0>e&&(a=a.clone().flip(),e=a.length-a.offset);var b="undefined"===typeof c;c="undefined"!==typeof c?c:this.offset;var h=e-c;0<h?(this.ensureCapacity(this.length+h),this.append(this,e),this.offset+=h,this.length+=h,this.append(a,0)):this.append(a,c-e);b&&(this.offset-=e);return this};d.prototype.writeInt8=function(a,c){c="undefined"!=typeof c?c:(this.offset+=1)-
1;this.ensureCapacity(c+1);this.view.setInt8(c,a);return this};d.prototype.readInt8=function(a){a="undefined"!==typeof a?a:(this.offset+=1)-1;if(a>=this.array.byteLength)throw Error("Cannot read int8 from "+this+" at "+a+": Capacity overflow");return this.view.getInt8(a)};d.prototype.writeByte=d.prototype.writeInt8;d.prototype.readByte=d.prototype.readInt8;d.prototype.writeUint8=function(a,c){c="undefined"!==typeof c?c:(this.offset+=1)-1;this.ensureCapacity(c+1);this.view.setUint8(c,a);return this};
d.prototype.readUint8=function(a){a="undefined"!==typeof a?a:(this.offset+=1)-1;if(a+1>this.array.byteLength)throw Error("Cannot read uint8 from "+this+" at "+a+": Capacity overflow");return this.view.getUint8(a)};d.prototype.writeInt16=function(a,c){c="undefined"!==typeof c?c:(this.offset+=2)-2;this.ensureCapacity(c+2);this.view.setInt16(c,a,this.littleEndian);return this};d.prototype.readInt16=function(a){a="undefined"!==typeof a?a:(this.offset+=2)-2;if(a+2>this.array.byteLength)throw Error("Cannot read int16 from "+
this+" at "+a+": Capacity overflow");return this.view.getInt16(a,this.littleEndian)};d.prototype.writeShort=d.prototype.writeInt16;d.prototype.readShort=d.prototype.readInt16;d.prototype.writeUint16=function(a,c){c="undefined"!==typeof c?c:(this.offset+=2)-2;this.ensureCapacity(c+2);this.view.setUint16(c,a,this.littleEndian);return this};d.prototype.readUint16=function(a){a="undefined"!==typeof a?a:(this.offset+=2)-2;if(a+2>this.array.byteLength)throw Error("Cannot read int16 from "+this+" at "+a+
": Capacity overflow");return this.view.getUint16(a,this.littleEndian)};d.prototype.writeInt32=function(a,c){c="undefined"!==typeof c?c:(this.offset+=4)-4;this.ensureCapacity(c+4);this.view.setInt32(c,a,this.littleEndian);return this};d.prototype.readInt32=function(a){a="undefined"!==typeof a?a:(this.offset+=4)-4;if(a+4>this.array.byteLength)throw Error("Cannot read int32 from "+this+" at "+a+": Capacity overflow");return this.view.getInt32(a,this.littleEndian)};d.prototype.writeInt=d.prototype.writeInt32;
d.prototype.readInt=d.prototype.readInt32;d.prototype.writeUint32=function(a,c){c="undefined"!=typeof c?c:(this.offset+=4)-4;this.ensureCapacity(c+4);this.view.setUint32(c,a,this.littleEndian);return this};d.prototype.readUint32=function(a){a="undefined"!==typeof a?a:(this.offset+=4)-4;if(a+4>this.array.byteLength)throw Error("Cannot read uint32 from "+this+" at "+a+": Capacity overflow");return this.view.getUint32(a,this.littleEndian)};d.prototype.writeFloat32=function(a,c){c="undefined"!==typeof c?
c:(this.offset+=4)-4;this.ensureCapacity(c+4);this.view.setFloat32(c,a,this.littleEndian);return this};d.prototype.readFloat32=function(a){a="undefined"!==typeof a?a:(this.offset+=4)-4;if(null===this.array||a+4>this.array.byteLength)throw Error("Cannot read float32 from "+this+" at "+a+": Capacity overflow");return this.view.getFloat32(a,this.littleEndian)};d.prototype.writeFloat=d.prototype.writeFloat32;d.prototype.readFloat=d.prototype.readFloat32;d.prototype.writeFloat64=function(a,c){c="undefined"!==
typeof c?c:(this.offset+=8)-8;this.ensureCapacity(c+8);this.view.setFloat64(c,a,this.littleEndian);return this};d.prototype.readFloat64=function(a){a="undefined"!==typeof a?a:(this.offset+=8)-8;if(null===this.array||a+8>this.array.byteLength)throw Error("Cannot read float64 from "+this+" at "+a+": Capacity overflow");return this.view.getFloat64(a,this.littleEndian)};d.prototype.writeDouble=d.prototype.writeFloat64;d.prototype.readDouble=d.prototype.readFloat64;f&&(d.prototype.writeInt64=function(a,
c){c="undefined"!==typeof c?c:(this.offset+=8)-8;"object"===typeof a&&a instanceof f||(a=f.fromNumber(a,!1));this.ensureCapacity(c+8);this.littleEndian?(this.view.setInt32(c,a.getLowBits(),!0),this.view.setInt32(c+4,a.getHighBits(),!0)):(this.view.setInt32(c,a.getHighBits(),!1),this.view.setInt32(c+4,a.getLowBits(),!1));return this},d.prototype.readInt64=function(a){a="undefined"!==typeof a?a:(this.offset+=8)-8;if(null===this.array||a+8>this.array.byteLength)throw this.offset-=8,Error("Cannot read int64 from "+
this+" at "+a+": Capacity overflow");return this.littleEndian?f.fromBits(this.view.getInt32(a,!0),this.view.getInt32(a+4,!0),!1):f.fromBits(this.view.getInt32(a+4,!1),this.view.getInt32(a,!1),!1)},d.prototype.writeUint64=function(a,c){c="undefined"!==typeof c?c:(this.offset+=8)-8;"object"===typeof a&&a instanceof f||(a=f.fromNumber(a,!0));this.ensureCapacity(c+8);this.littleEndian?(this.view.setUint32(c,a.getLowBitsUnsigned(),!0),this.view.setUint32(c+4,a.getHighBitsUnsigned(),!0)):(this.view.setUint32(c,
a.getHighBitsUnsigned(),!1),this.view.setUint32(c+4,a.getLowBitsUnsigned(),!1));return this},d.prototype.readUint64=function(a){a="undefined"!==typeof a?a:(this.offset+=8)-8;if(null===this.array||a+8>this.array.byteLength)throw this.offset-=8,Error("Cannot read int64 from "+this+" at "+a+": Capacity overflow");return this.littleEndian?f.fromBits(this.view.getUint32(a,!0),this.view.getUint32(a+4,!0),!0):f.fromBits(this.view.getUint32(a+4,!1),this.view.getUint32(a,!1),!0)},d.prototype.writeLong=d.prototype.writeInt64,
d.prototype.readLong=d.prototype.readInt64);d.MAX_VARINT32_BYTES=5;d.prototype.writeVarint32=function(a,c){var e="undefined"===typeof c;c="undefined"!==typeof c?c:this.offset;a>>>=0;this.ensureCapacity(c+d.calculateVarint32(a));var b=this.view;b.setUint8(c,a|128);128<=a?(b.setUint8(c+1,a>>7|128),16384<=a?(b.setUint8(c+2,a>>14|128),2097152<=a?(b.setUint8(c+3,a>>21|128),268435456<=a?(b.setUint8(c+4,a>>28&127),a=5):(b.setUint8(c+3,b.getUint8(c+3)&127),a=4)):(b.setUint8(c+2,b.getUint8(c+2)&127),a=3)):
(b.setUint8(c+1,b.getUint8(c+1)&127),a=2)):(b.setUint8(c,b.getUint8(c)&127),a=1);return e?(this.offset+=a,this):a};d.prototype.readVarint32=function(a){var c="undefined"===typeof a;a="undefined"!==typeof a?a:this.offset;var e=0,b,h=this.view,k=0;do b=h.getUint8(a+e),e<d.MAX_VARINT32_BYTES&&(k|=(b&127)<<7*e>>>0),++e;while(b&128);k|=0;return c?(this.offset+=e,k):{value:k,length:e}};d.prototype.writeZigZagVarint32=function(a,c){return this.writeVarint32(d.zigZagEncode32(a),c)};d.prototype.readZigZagVarint32=
function(a){a=this.readVarint32(a);return"object"===typeof a?(a.value=d.zigZagDecode32(a.value),a):d.zigZagDecode32(a)};d.MAX_VARINT64_BYTES=10;f&&(d.prototype.writeVarint64=function(a,c){var e="undefined"===typeof c;c="undefined"!==typeof c?c:this.offset;"object"===typeof a&&a instanceof f||(a=f.fromNumber(a,!1));var b=a.toInt()>>>0,h=a.shiftRightUnsigned(28).toInt()>>>0,k=a.shiftRightUnsigned(56).toInt()>>>0;a=d.calculateVarint64(a);this.ensureCapacity(c+a);var m=this.view;switch(a){case 10:m.setUint8(c+
9,k>>>7|128);case 9:m.setUint8(c+8,k|128);case 8:m.setUint8(c+7,h>>>21|128);case 7:m.setUint8(c+6,h>>>14|128);case 6:m.setUint8(c+5,h>>>7|128);case 5:m.setUint8(c+4,h|128);case 4:m.setUint8(c+3,b>>>21|128);case 3:m.setUint8(c+2,b>>>14|128);case 2:m.setUint8(c+1,b>>>7|128);case 1:m.setUint8(c+0,b|128)}m.setUint8(c+a-1,m.getUint8(c+a-1)&127);return e?(this.offset+=a,this):a},d.prototype.readVarint64=function(a){var c="undefined"===typeof a,e=a="undefined"!==typeof a?a:this.offset,b=this.view,h,d=0,
m=0,l;l=b.getUint8(a++);h=l&127;if(l&128&&(l=b.getUint8(a++),h|=(l&127)<<7,l&128&&(l=b.getUint8(a++),h|=(l&127)<<14,l&128&&(l=b.getUint8(a++),h|=(l&127)<<21,l&128&&(l=b.getUint8(a++),d=l&127,l&128&&(l=b.getUint8(a++),d|=(l&127)<<7,l&128&&(l=b.getUint8(a++),d|=(l&127)<<14,l&128&&(l=b.getUint8(a++),d|=(l&127)<<21,l&128&&(l=b.getUint8(a++),m=l&127,l&128&&(l=b.getUint8(a++),m|=(l&127)<<7,l&128))))))))))throw Error("Data must be corrupt: Buffer overrun");b=f.from28Bits(h,d,m,!1);return c?(this.offset=
a,b):{value:b,length:a-e}},d.prototype.writeZigZagVarint64=function(a,c){return this.writeVarint64(d.zigZagEncode64(a),c)},d.prototype.readZigZagVarint64=function(a){a=this.readVarint64(a);return"object"!==typeof a||a instanceof f?d.zigZagDecode64(a):(a.value=d.zigZagDecode64(a.value),a)});d.prototype.writeVarint=d.prototype.writeVarint32;d.prototype.readVarint=d.prototype.readVarint32;d.prototype.writeZigZagVarint=d.prototype.writeZigZagVarint32;d.prototype.readZigZagVarint=d.prototype.readZigZagVarint32;
d.calculateVarint32=function(a){a>>>=0;return 128>a?1:16384>a?2:2097152>a?3:268435456>a?4:5};f&&(d.calculateVarint64=function(a){"object"===typeof a&&a instanceof f||(a=f.fromNumber(a,!1));var c=a.toInt()>>>0,e=a.shiftRightUnsigned(28).toInt()>>>0;a=a.shiftRightUnsigned(56).toInt()>>>0;return 0==a?0==e?16384>c?128>c?1:2:2097152>c?3:4:16384>e?128>e?5:6:2097152>e?7:8:128>a?9:10});d.zigZagEncode32=function(a){return((a|=0)<<1^a>>31)>>>0};d.zigZagDecode32=function(a){return a>>>1^-(a&1)|0};f&&(d.zigZagEncode64=
function(a){"object"===typeof a&&a instanceof f?a.unsigned&&(a=a.toSigned()):a=f.fromNumber(a,!1);return a.shiftLeft(1).xor(a.shiftRight(63)).toUnsigned()},d.zigZagDecode64=function(a){"object"===typeof a&&a instanceof f?a.unsigned||(a=a.toUnsigned()):a=f.fromNumber(a,!0);return a.shiftRightUnsigned(1).xor(a.and(f.ONE).toSigned().negate()).toSigned()});d.decodeUTF8Char=function(a,c){var e=a.readUint8(c),b,h,d,m,f=c;if(0==(e&128))c+=1;else if(192==(e&224))b=a.readUint8(c+1),e=(e&31)<<6|b&63,c+=2;else if(224==
(e&240))b=a.readUint8(c+1),h=a.readUint8(c+2),e=(e&15)<<12|(b&63)<<6|h&63,c+=3;else if(240==(e&248))b=a.readUint8(c+1),h=a.readUint8(c+2),d=a.readUint8(c+3),e=(e&7)<<18|(b&63)<<12|(h&63)<<6|d&63,c+=4;else if(248==(e&252))b=a.readUint8(c+1),h=a.readUint8(c+2),d=a.readUint8(c+3),m=a.readUint8(c+4),e=(e&3)<<24|(b&63)<<18|(h&63)<<12|(d&63)<<6|m&63,c+=5;else if(252==(e&254))b=a.readUint8(c+1),h=a.readUint8(c+2),d=a.readUint8(c+3),m=a.readUint8(c+4),a=a.readUint8(c+5),e=(e&1)<<30|(b&63)<<24|(h&63)<<18|
(d&63)<<12|(m&63)<<6|a&63,c+=6;else throw Error("Cannot decode UTF8 character at offset "+c+": charCode (0x"+e.toString(16)+") is invalid");return{"char":e,length:c-f}};d.encodeUTF8Char=function(a,c,e){var b=e;if(0>a)throw Error("Cannot encode UTF8 character: charCode ("+a+") is negative");if(128>a)c.writeUint8(a&127,e),e+=1;else if(2048>a)c.writeUint8(a>>6&31|192,e).writeUint8(a&63|128,e+1),e+=2;else if(65536>a)c.writeUint8(a>>12&15|224,e).writeUint8(a>>6&63|128,e+1).writeUint8(a&63|128,e+2),e+=
3;else if(2097152>a)c.writeUint8(a>>18&7|240,e).writeUint8(a>>12&63|128,e+1).writeUint8(a>>6&63|128,e+2).writeUint8(a&63|128,e+3),e+=4;else if(67108864>a)c.writeUint8(a>>24&3|248,e).writeUint8(a>>18&63|128,e+1).writeUint8(a>>12&63|128,e+2).writeUint8(a>>6&63|128,e+3).writeUint8(a&63|128,e+4),e+=5;else if(2147483648>a)c.writeUint8(a>>30&1|252,e).writeUint8(a>>24&63|128,e+1).writeUint8(a>>18&63|128,e+2).writeUint8(a>>12&63|128,e+3).writeUint8(a>>6&63|128,e+4).writeUint8(a&63|128,e+5),e+=6;else throw Error("Cannot encode UTF8 character: charCode (0x"+
a.toString(16)+") is too large (\x3e\x3d 0x80000000)");return e-b};d.calculateUTF8Char=function(a){if(0>a)throw Error("Cannot calculate length of UTF8 character: charCode ("+a+") is negative");if(128>a)return 1;if(2048>a)return 2;if(65536>a)return 3;if(2097152>a)return 4;if(67108864>a)return 5;if(2147483648>a)return 6;throw Error("Cannot calculate length of UTF8 character: charCode (0x"+a.toString(16)+") is too large (\x3e\x3d 0x80000000)");};d.calculateUTF8String=function(a){a=""+a;for(var c=0,e=
0,b=a.length;e<b;++e)c+=d.calculateUTF8Char(a.charCodeAt(e));return c};var m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d",m=m+"";d.encode64=function(a){a instanceof d?a.length<a.offset&&(a=a.clone().flip()):a=d.wrap(a);var c,e,b,h,k=a.offset,f=0,l=[];do c=a.readUint8(k++),e=a.length>k?a.readUint8(k++):0,b=a.length>k?a.readUint8(k++):0,h=c<<16|e<<8|b,c=h>>18&63,e=h>>12&63,b=h>>6&63,h&=63,l[f++]=m.charAt(c)+m.charAt(e)+m.charAt(b)+m.charAt(h);while(k<a.length);k=l.join("");
a=(a.length-a.offset)%3;return(a?k.slice(0,a-3):k)+"\x3d\x3d\x3d".slice(a||3)};d.decode64=function(a,c){if("string"!==typeof a)throw Error("Illegal argument: Not a string");var e,b,h,k,f=0,l=new d(Math.ceil(a.length/3),c);do{e=m.indexOf(a.charAt(f++));b=m.indexOf(a.charAt(f++));c=m.indexOf(a.charAt(f++));k=m.indexOf(a.charAt(f++));if(0>e||0>b||0>c||0>k)throw Error("Illegal argument: Not a valid base64 encoded string");h=e<<18|b<<12|c<<6|k;e=h>>16&255;b=h>>8&255;h&=255;64==c?l.writeUint8(e):64==k?
l.writeUint8(e).writeUint8(b):l.writeUint8(e).writeUint8(b).writeUint8(h)}while(f<a.length);return l.flip()};d.encodeHex=function(a){a instanceof d?a.length<a.offset&&(a=a.clone().flip()):a=d.wrap(a);if(null===a.array)return"";for(var c,e=[],b=a.offset,h=a.length;b<h;++b)c=a.view.getUint8(b).toString(16).toUpperCase(),2>c.length&&(c="0"+c),e.push(c);return e.join("")};d.decodeHex=function(a,c){if("string"!==typeof a)throw Error("Illegal argument: Not a string");if(0!==a.length%2)throw Error("Illegal argument: Not a hex encoded string");
c=new d(a.length/2,c);for(var e=0,b=a.length;e<b;e+=2)c.writeUint8(parseInt(a.substring(e,e+2),16));return c.flip()};d.encodeBinary=function(a){a instanceof d?a.length<a.offset&&(a=a.clone().flip()):a=d.wrap(a);var c=[],e=a.view,b=a.offset;for(a=a.length;b<a;++b)c.push(String.fromCharCode(e.getUint8(b)));return c.join("")};d.decodeBinary=function(a,c){if("string"!==typeof a)throw Error("Illegal argument: Not a string");for(var e=a.length,b=new ArrayBuffer(e),h=new DataView(b),m,f=0;f<e;++f){if(255<
(m=a.charCodeAt(f)))throw Error("Illegal argument: Not a binary string (char code "+m+")");h.setUint8(f,m)}a=new d(e,c,!0);a.array=b;a.view=h;a.length=e;return a};d.prototype.writeUTF8String=function(a,c){var e="undefined"===typeof c,b=c="undefined"!==typeof c?c:this.offset,h=d.calculateUTF8String(a);this.ensureCapacity(c+h);for(var h=0,m=a.length;h<m;++h)c+=d.encodeUTF8Char(a.charCodeAt(h),this,c);return e?(this.offset=c,this):c-b};d.prototype.readUTF8String=function(a,c){var e="undefined"===typeof c;
c="undefined"!==typeof c?c:this.offset;for(var b,h="",m=c,f=0;f<a;++f)b=d.decodeUTF8Char(this,c),c+=b.length,h+=String.fromCharCode(b["char"]);return e?(this.offset=c,h):{string:h,length:c-m}};d.prototype.readUTF8StringBytes=function(a,c){var e="undefined"===typeof c;c="undefined"!==typeof c?c:this.offset;var b,h="",m=c;for(a=c+a;c<a;)b=d.decodeUTF8Char(this,c),c+=b.length,h+=String.fromCharCode(b["char"]);if(c!=a)throw Error("Actual string length differs from the specified: "+((c>a?"+":"")+c-a)+
" bytes");return e?(this.offset=c,h):{string:h,length:c-m}};d.prototype.writeLString=function(a,c){a=""+a;var e="undefined"===typeof c;c="undefined"!==typeof c?c:this.offset;var b=d.encodeUTF8Char(a.length,this,c),b=b+this.writeUTF8String(a,c+b);return e?(this.offset+=b,this):b};d.prototype.readLString=function(a){var c="undefined"===typeof a;a="undefined"!==typeof a?a:this.offset;var e=d.decodeUTF8Char(this,a);a=this.readUTF8String(e["char"],a+e.length);return c?(this.offset+=e.length+a.length,a.string):
{string:a.string,length:e.length+a.length}};d.prototype.writeVString=function(a,c){a=""+a;var e="undefined"===typeof c;c="undefined"!==typeof c?c:this.offset;var b=this.writeVarint32(d.calculateUTF8String(a),c),b=b+this.writeUTF8String(a,c+b);return e?(this.offset+=b,this):b};d.prototype.readVString=function(a){var c="undefined"===typeof a;a="undefined"!==typeof a?a:this.offset;var e=this.readVarint32(a);a=this.readUTF8StringBytes(e.value,a+e.length);return c?(this.offset+=e.length+a.length,a.string):
{string:a.string,length:e.length+a.length}};d.prototype.writeCString=function(a,c){var e="undefined"===typeof c;c="undefined"!==typeof c?c:this.offset;a=this.writeUTF8String(""+a,c);this.writeUint8(0,c+a);return e?(this.offset+=a+1,this):a+1};d.prototype.readCString=function(a){var c="undefined"===typeof a;a="undefined"!==typeof a?a:this.offset;var e,b="",h=a;do e=d.decodeUTF8Char(this,a),a+=e.length,0!=e["char"]&&(b+=String.fromCharCode(e["char"]));while(0!=e["char"]);return c?(this.offset=a,b):
{string:b,length:a-h}};d.prototype.writeJSON=function(a,c,e){e="function"===typeof e?e:JSON.stringify;return this.writeLString(e(a),c)};d.prototype.readJSON=function(a,c){c="function"===typeof c?c:JSON.parse;a=this.readLString(a);return"string"===typeof a?c(a):{data:c(a.string),length:a.length}};d.prototype.toColumns=function(a){if(null===this.array)return"DESTROYED";a="undefined"!==typeof a?parseInt(a,10):16;1>a&&(a=16);for(var c="",e=[],b,h=this.view,c=0==this.offset&&0==this.length?c+"|":0==this.length?
c+"\x3e":0==this.offset?c+"\x3c":c+" ",d=0,m=this.array.byteLength;d<m;++d){if(0<d&&0==d%a){for(;c.length<3*a+1;)c+="   ";e.push(c);c=" "}b=h.getUint8(d).toString(16).toUpperCase();2>b.length&&(b="0"+b);c+=b;c=d+1==this.offset&&d+1==this.length?c+"|":d+1==this.offset?c+"\x3c":d+1==this.length?c+"\x3e":c+" "}" "!=c&&e.push(c);d=0;for(m=e.length;d<m;++d)for(;e[d].length<3*a+1;)e[d]+="   ";for(var f=0,c="",d=0,m=this.array.byteLength;d<m;++d)0<d&&0==d%a&&(e[f]+=" "+c,c="",f++),b=h.getUint8(d),c+=32<
b&&127>b?String.fromCharCode(b):".";""!=c&&(e[f]+=" "+c);return e.join("\n")};d.prototype.printDebug=function(a){"function"!==typeof a&&(a=console.log.bind(console));a((null!=this.array?"ByteBuffer(offset\x3d"+this.offset+",markedOffset\x3d"+this.markedOffset+",length\x3d"+this.length+",capacity\x3d"+this.array.byteLength+")":"ByteBuffer(DESTROYED)")+"\n-------------------------------------------------------------------\n"+this.toColumns()+"\n")};d.prototype.toHex=function(a){var c="",e=this.view,
b,h;if(a){if(null===this.array)return"DESTROYED";c=0==this.offset&&0==this.length?c+"|":0==this.length?c+"\x3e":0==this.offset?c+"\x3c":c+" ";b=0;for(h=this.array.byteLength;b<h;++b)a=e.getUint8(b).toString(16).toUpperCase(),2>a.length&&(a="0"+a),c+=a,c=b+1===this.offset&&b+1===this.length?c+"|":b+1==this.offset?c+"\x3c":b+1==this.length?c+"\x3e":c+" ";return c}return d.encodeHex(this)};d.prototype.toBinary=function(){return d.encodeBinary(this)};d.prototype.toBase64=function(){return null===this.array||
this.offset>=this.length?"":d.encode64(this)};d.prototype.toUTF8=function(){return null===this.array||this.offset>=this.length?"":this.readUTF8StringBytes(this.length-this.offset,this.offset).string};d.prototype.toString=function(a){switch(a||""){case "utf8":return this.toUTF8();case "base64":return this.toBase64();case "hex":return this.toHex();case "binary":return this.toBinary();case "debug":return this.toHex(!0);default:return null===this.array?"ByteBuffer(DESTROYED)":"ByteBuffer(offset\x3d"+
this.offset+",markedOffset\x3d"+this.markedOffset+",length\x3d"+this.length+",capacity\x3d"+this.array.byteLength+")"}};d.prototype.toArrayBuffer=function(a){if(null===this.array)return null;var c=this.clone();c.offset>c.length&&c.flip();var e=!1;if(0<c.offset||c.length<c.array.byteLength)c.compact(),e=!0;return a&&!e?c.copy().array:c.array};n&&(d.prototype.toBuffer=function(){if(null===this.array)return null;var a=this.offset,c=this.length;if(a>c)var e=a,a=c,c=e;return new n((new Uint8Array(this.array)).subarray(a,
c))});return d}(n.dcodeIO.Long)})(this)});C.when("ByteBuffer","Long").register("ProtoBuf",function(A,f){(function(f){n.dcodeIO||(n.dcodeIO={});n.dcodeIO.ProtoBuf=function(f){var d={VERSION:"2.2.1",WIRE_TYPES:{}};d.WIRE_TYPES.VARINT=0;d.WIRE_TYPES.BITS64=1;d.WIRE_TYPES.LDELIM=2;d.WIRE_TYPES.STARTGROUP=3;d.WIRE_TYPES.ENDGROUP=4;d.WIRE_TYPES.BITS32=5;d.TYPES={int32:{name:"int32",wireType:d.WIRE_TYPES.VARINT},uint32:{name:"uint32",wireType:d.WIRE_TYPES.VARINT},sint32:{name:"sint32",wireType:d.WIRE_TYPES.VARINT},
int64:{name:"int64",wireType:d.WIRE_TYPES.VARINT},uint64:{name:"uint64",wireType:d.WIRE_TYPES.VARINT},sint64:{name:"sint64",wireType:d.WIRE_TYPES.VARINT},bool:{name:"bool",wireType:d.WIRE_TYPES.VARINT},"double":{name:"double",wireType:d.WIRE_TYPES.BITS64},string:{name:"string",wireType:d.WIRE_TYPES.LDELIM},bytes:{name:"bytes",wireType:d.WIRE_TYPES.LDELIM},fixed32:{name:"fixed32",wireType:d.WIRE_TYPES.BITS32},sfixed32:{name:"sfixed32",wireType:d.WIRE_TYPES.BITS32},fixed64:{name:"fixed64",wireType:d.WIRE_TYPES.BITS64},
sfixed64:{name:"sfixed64",wireType:d.WIRE_TYPES.BITS64},"float":{name:"float",wireType:d.WIRE_TYPES.BITS32},"enum":{name:"enum",wireType:d.WIRE_TYPES.VARINT},message:{name:"message",wireType:d.WIRE_TYPES.LDELIM}};d.Long=f.Long;d.convertFieldsToCamelCase=!1;d.Util=function(){Object.create||(Object.create=function(a){function c(){}if(1<arguments.length)throw Error("Object.create implementation only accepts the first parameter.");c.prototype=a;return new c});var d={};d.IS_NODE=("undefined"===typeof n||
!n.window)&&"function"===typeof require&&"undefined"!==typeof process&&"function"===typeof process.nextTick;d.XHR=function(){for(var a=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],c=null,e=0;e<a.length;e++){try{c=a[e]()}catch(b){continue}break}if(!c)throw Error("XMLHttpRequest is not supported");return c};d.fetch=function(a,c){c&&"function"!=
typeof c&&(c=null);if(d.IS_NODE)if(c)module.require("fs").readFile(a,function(a,e){a?c(null):c(""+e)});else try{return module.require("fs").readFileSync(a)}catch(b){return null}else{var e=d.XHR();e.open("GET",a,c?!0:!1);e.setRequestHeader("Accept","text/plain");"function"===typeof e.overrideMimeType&&e.overrideMimeType("text/plain");if(c)e.onreadystatechange=function(){4==e.readyState&&(200==e.status||0==e.status&&"string"===typeof e.responseText?c(e.responseText):c(null))},4!=e.readyState&&e.send(null);
else return e.send(null),200==e.status||0==e.status&&"string"===typeof e.responseText?e.responseText:null}};d.isArray=function(a){return a?a instanceof Array?!0:Array.isArray?Array.isArray(a):"[object Array]"===Object.prototype.toString.call(a):!1};return d}();d.Lang={OPEN:"{",CLOSE:"}",OPTOPEN:"[",OPTCLOSE:"]",OPTEND:",",EQUAL:"\x3d",END:";",STRINGOPEN:'"',STRINGCLOSE:'"',STRINGOPEN_SQ:"'",STRINGCLOSE_SQ:"'",COPTOPEN:"(",COPTCLOSE:")",DELIM:/[\s\{\}=;\[\],'"\(\)]/g,KEYWORD:/^(?:package|option|import|message|enum|extend|service|syntax|extensions)$/,
RULE:/^(?:required|optional|repeated)$/,TYPE:/^(?:double|float|int32|uint32|sint32|int64|uint64|sint64|fixed32|sfixed32|fixed64|sfixed64|bool|string|bytes)$/,NAME:/^[a-zA-Z_][a-zA-Z_0-9]*$/,OPTNAME:/^(?:[a-zA-Z][a-zA-Z_0-9]*|\([a-zA-Z][a-zA-Z_0-9]*\))$/,TYPEDEF:/^[a-zA-Z][a-zA-Z_0-9]*$/,TYPEREF:/^(?:\.?[a-zA-Z][a-zA-Z_0-9]*)+$/,FQTYPEREF:/^(?:\.[a-zA-Z][a-zA-Z_0-9]*)+$/,NUMBER:/^-?(?:[1-9][0-9]*|0|0x[0-9a-fA-F]+|0[0-7]+|([0-9]*\.[0-9]+([Ee][+-]?[0-9]+)?))$/,NUMBER_DEC:/^(?:[1-9][0-9]*|0)$/,NUMBER_HEX:/^0x[0-9a-fA-F]+$/,
NUMBER_OCT:/^0[0-7]+$/,NUMBER_FLT:/^[0-9]*\.[0-9]+([Ee][+-]?[0-9]+)?$/,ID:/^(?:[1-9][0-9]*|0|0x[0-9a-fA-F]+|0[0-7]+)$/,NEGID:/^\-?(?:[1-9][0-9]*|0|0x[0-9a-fA-F]+|0[0-7]+)$/,WHITESPACE:/\s/,STRING:/['"]([^'"\\]*(\\.[^"\\]*)*)['"]/g,BOOL:/^(?:true|false)$/i,ID_MIN:1,ID_MAX:536870911};d.DotProto={};d.DotProto.Tokenizer=function(d){var a=function(a){this.source=""+a;this.index=0;this.line=1;this.stack=[];this.readingString=!1;this.stringEndsWith=d.STRINGCLOSE};a.prototype._readString=function(){d.STRING.lastIndex=
this.index-1;var a;if(null!==(a=d.STRING.exec(this.source)))return a=a[1],this.index=d.STRING.lastIndex,this.stack.push(this.stringEndsWith),a;throw Error("Illegal string value at line "+this.line+", index "+this.index);};a.prototype.next=function(){if(0<this.stack.length)return this.stack.shift();if(this.index>=this.source.length)return null;if(this.readingString)return this.readingString=!1,this._readString();var a,e;do{for(a=!1;d.WHITESPACE.test(e=this.source.charAt(this.index));)if(this.index++,
"\n"===e&&this.line++,this.index===this.source.length)return null;if("/"===this.source.charAt(this.index))if("/"===this.source.charAt(++this.index)){for(;"\n"!==this.source.charAt(this.index);)if(this.index++,this.index==this.source.length)return null;this.index++;this.line++;a=!0}else if("*"===this.source.charAt(this.index)){for(e="";"*/"!==e+(e=this.source.charAt(this.index));)if(this.index++,"\n"===e&&this.line++,this.index===this.source.length)return null;this.index++;a=!0}else throw Error("Invalid comment at line "+
this.line+": /"+this.source.charAt(this.index)+" ('/' or '*' expected)");}while(a);if(this.index===this.source.length)return null;a=this.index;d.DELIM.lastIndex=0;if(d.DELIM.test(this.source.charAt(a)))a++;else for(a++;a<this.source.length&&!d.DELIM.test(this.source.charAt(a));)a++;a=this.source.substring(this.index,this.index=a);a===d.STRINGOPEN?(this.readingString=!0,this.stringEndsWith=d.STRINGCLOSE):a===d.STRINGOPEN_SQ&&(this.readingString=!0,this.stringEndsWith=d.STRINGCLOSE_SQ);return a};a.prototype.peek=
function(){if(0===this.stack.length){var a=this.next();if(null===a)return null;this.stack.push(a)}return this.stack[0]};a.prototype.toString=function(){return"Tokenizer("+this.index+"/"+this.source.length+" at line "+this.line+")"};return a}(d.Lang);d.DotProto.Parser=function(d,a,c){d=function(a){this.tn=new c(a)};d.prototype.parse=function(){var a={name:"[ROOT]","package":null,messages:[],enums:[],imports:[],options:{},services:[]},b,c=!0;do{b=this.tn.next();if(null==b)break;if("package"==b){if(!c)throw Error("Illegal package definition at line "+
this.tn.line+": Must be declared before the first message or enum");if(null!==a["package"])throw Error("Illegal package definition at line "+this.tn.line+": Package already declared");a["package"]=this._parsePackage(b)}else if("import"==b){if(!c)throw Error("Illegal import definition at line "+this.tn.line+": Must be declared before the first message or enum");a.imports.push(this._parseImport(b))}else if("message"===b)this._parseMessage(a,b),c=!1;else if("enum"===b)this._parseEnum(a,b),c=!1;else if("option"===
b){if(!c)throw Error("Illegal option definition at line "+this.tn.line+": Must be declared before the first message or enum");this._parseOption(a,b)}else if("service"===b)this._parseService(a,b);else if("extend"===b)this._parseExtend(a,b);else if("syntax"===b)this._parseIgnoredStatement(a,b);else throw Error("Illegal top level declaration at line "+this.tn.line+": "+b);}while(1);delete a.name;return a};d.prototype._parseNumber=function(c){var b=1;"-"==c.charAt(0)&&(b=-1,c=c.substring(1));if(a.NUMBER_DEC.test(c))return b*
parseInt(c,10);if(a.NUMBER_HEX.test(c))return b*parseInt(c.substring(2),16);if(a.NUMBER_OCT.test(c))return b*parseInt(c.substring(1),8);if(a.NUMBER_FLT.test(c))return b*parseFloat(c);throw Error("Illegal number value at line "+this.tn.line+": "+(0>b?"-":"")+c);};d.prototype._parseId=function(c,b){var d,f=1;"-"==c.charAt(0)&&(f=-1,c=c.substring(1));if(a.NUMBER_DEC.test(c))d=parseInt(c);else if(a.NUMBER_HEX.test(c))d=parseInt(c.substring(2),16);else if(a.NUMBER_OCT.test(c))d=parseInt(c.substring(1),
8);else throw Error("Illegal ID value at line "+this.tn.line+": "+(0>f?"-":"")+c);d=f*d|0;if(!b&&0>d)throw Error("Illegal ID range at line "+this.tn.line+": "+(0>f?"-":"")+c);return d};d.prototype._parsePackage=function(c){c=this.tn.next();if(!a.TYPEREF.test(c))throw Error("Illegal package name at line "+this.tn.line+": "+c);var b=c;c=this.tn.next();if(c!=a.END)throw Error("Illegal end of package definition at line "+this.tn.line+": "+c+" ('"+a.END+"' expected)");return b};d.prototype._parseImport=
function(c){c=this.tn.next();"public"===c&&(c=this.tn.next());if(c!==a.STRINGOPEN&&c!==a.STRINGOPEN_SQ)throw Error("Illegal begin of import value at line "+this.tn.line+": "+c+" ('"+a.STRINGOPEN+"' or '"+a.STRINGOPEN_SQ+"' expected)");var b=this.tn.next();c=this.tn.next();if(c!==this.tn.stringEndsWith)throw Error("Illegal end of import value at line "+this.tn.line+": "+c+" ('"+this.tn.stringEndsWith+"' expected)");c=this.tn.next();if(c!==a.END)throw Error("Illegal end of import definition at line "+
this.tn.line+": "+c+" ('"+a.END+"' expected)");return b};d.prototype._parseOption=function(c,b){b=this.tn.next();var d=!1;b==a.COPTOPEN&&(d=!0,b=this.tn.next());if(!a.NAME.test(b)&&!/google\.protobuf\./.test(b))throw Error("Illegal option name in message "+c.name+" at line "+this.tn.line+": "+b);var f=b;b=this.tn.next();if(d){if(b!==a.COPTCLOSE)throw Error("Illegal custom option name delimiter in message "+c.name+", option "+f+" at line "+this.tn.line+": "+b+" ('"+a.COPTCLOSE+"' expected)");f="("+
f+")";b=this.tn.next();a.FQTYPEREF.test(b)&&(f+=b,b=this.tn.next())}if(b!==a.EQUAL)throw Error("Illegal option operator in message "+c.name+", option "+f+" at line "+this.tn.line+": "+b+" ('"+a.EQUAL+"' expected)");b=this.tn.next();if(b===a.STRINGOPEN||b===a.STRINGOPEN_SQ){if(d=this.tn.next(),b=this.tn.next(),b!==this.tn.stringEndsWith)throw Error("Illegal end of option value in message "+c.name+", option "+f+" at line "+this.tn.line+": "+b+" ('"+this.tn.stringEndsWith+"' expected)");}else if(a.NUMBER.test(b))d=
this._parseNumber(b,!0);else if(a.TYPEREF.test(b))d=b;else throw Error("Illegal option value in message "+c.name+", option "+f+" at line "+this.tn.line+": "+b);b=this.tn.next();if(b!==a.END)throw Error("Illegal end of option in message "+c.name+", option "+f+" at line "+this.tn.line+": "+b+" ('"+a.END+"' expected)");c.options[f]=d};d.prototype._parseIgnoredBlock=function(c,b){var d=this.tn.next();if(!a.TYPEREF.test(d))throw Error("Illegal "+b+" type in "+c.name+": "+d);var f=d,d=this.tn.next();if(d!==
a.OPEN)throw Error("Illegal OPEN in "+c.name+" after "+b+" "+f+" at line "+this.tn.line+": "+d);var m=1;do{d=this.tn.next();if(null===d)throw Error("Unexpected EOF in "+c.name+", "+b+" (ignored) at line "+this.tn.line+": "+f);if(d===a.OPEN)m++;else if(d===a.CLOSE&&(d=this.tn.peek(),d===a.END&&this.tn.next(),m--,0===m))break}while(1)};d.prototype._parseIgnoredStatement=function(c,b){var d;do{d=this.tn.next();if(null===d)throw Error("Unexpected EOF in "+c.name+", "+b+" (ignored) at line "+this.tn.line);
if(d===a.END)break}while(1)};d.prototype._parseService=function(c,b){b=this.tn.next();if(!a.NAME.test(b))throw Error("Illegal service name at line "+this.tn.line+": "+b);var d=b,f={name:d,rpc:{},options:{}};b=this.tn.next();if(b!==a.OPEN)throw Error("Illegal OPEN after service "+d+" at line "+this.tn.line+": "+b+" ('"+a.OPEN+"' expected)");do if(b=this.tn.next(),"option"===b)this._parseOption(f,b);else if("rpc"===b)this._parseServiceRPC(f,b);else if(b!==a.CLOSE)throw Error("Illegal type for service "+
d+" at line "+this.tn.line+": "+b);while(b!==a.CLOSE);c.services.push(f)};d.prototype._parseServiceRPC=function(c,b){var d=b;b=this.tn.next();if(!a.NAME.test(b))throw Error("Illegal RPC method name in service "+c.name+" at line "+this.tn.line+": "+b);var f=b,m={request:null,response:null,options:{}};b=this.tn.next();if(b!==a.COPTOPEN)throw Error("Illegal start of request type in RPC service "+c.name+"#"+f+" at line "+this.tn.line+": "+b+" ('"+a.COPTOPEN+"' expected)");b=this.tn.next();if(!a.TYPEREF.test(b))throw Error("Illegal request type in RPC service "+
c.name+"#"+f+" at line "+this.tn.line+": "+b);m.request=b;b=this.tn.next();if(b!=a.COPTCLOSE)throw Error("Illegal end of request type in RPC service "+c.name+"#"+f+" at line "+this.tn.line+": "+b+" ('"+a.COPTCLOSE+"' expected)");b=this.tn.next();if("returns"!==b.toLowerCase())throw Error("Illegal request/response delimiter in RPC service "+c.name+"#"+f+" at line "+this.tn.line+": "+b+" ('returns' expected)");b=this.tn.next();if(b!=a.COPTOPEN)throw Error("Illegal start of response type in RPC service "+
c.name+"#"+f+" at line "+this.tn.line+": "+b+" ('"+a.COPTOPEN+"' expected)");b=this.tn.next();m.response=b;b=this.tn.next();if(b!==a.COPTCLOSE)throw Error("Illegal end of response type in RPC service "+c.name+"#"+f+" at line "+this.tn.line+": "+b+" ('"+a.COPTCLOSE+"' expected)");b=this.tn.next();if(b===a.OPEN){do if(b=this.tn.next(),"option"===b)this._parseOption(m,b);else if(b!==a.CLOSE)throw Error("Illegal start of option in RPC service "+c.name+"#"+f+" at line "+this.tn.line+": "+b+" ('option' expected)");
while(b!==a.CLOSE);this.tn.peek()===a.END&&this.tn.next()}else if(b!==a.END)throw Error("Illegal method delimiter in RPC service "+c.name+"#"+f+" at line "+this.tn.line+": "+b+" ('"+a.END+"' or '"+a.OPEN+"' expected)");"undefined"===typeof c[d]&&(c[d]={});c[d][f]=m};d.prototype._parseMessage=function(c,b){var d={};b=this.tn.next();if(!a.NAME.test(b))throw Error("Illegal message name"+(c?" in message "+c.name:"")+" at line "+this.tn.line+": "+b);d.name=b;b=this.tn.next();if(b!=a.OPEN)throw Error("Illegal OPEN after message "+
d.name+" at line "+this.tn.line+": "+b+" ('"+a.OPEN+"' expected)");d.fields=[];d.enums=[];d.messages=[];d.options={};do if(b=this.tn.next(),b===a.CLOSE){b=this.tn.peek();b===a.END&&this.tn.next();break}else if(a.RULE.test(b))this._parseMessageField(d,b);else if("enum"===b)this._parseEnum(d,b);else if("message"===b)this._parseMessage(d,b);else if("option"===b)this._parseOption(d,b);else if("extensions"===b)d.extensions=this._parseExtensions(d,b);else if("extend"===b)this._parseExtend(d,b);else throw Error("Illegal token in message "+
d.name+" at line "+this.tn.line+": "+b+" (type or '"+a.CLOSE+"' expected)");while(1);c.messages.push(d);return d};d.prototype._parseMessageField=function(c,b){var d={};d.rule=b;b=this.tn.next();if(!a.TYPE.test(b)&&!a.TYPEREF.test(b))throw Error("Illegal field type in message "+c.name+" at line "+this.tn.line+": "+b);d.type=b;b=this.tn.next();if(!a.NAME.test(b))throw Error("Illegal field name in message "+c.name+" at line "+this.tn.line+": "+b);d.name=b;b=this.tn.next();if(b!==a.EQUAL)throw Error("Illegal field number operator in message "+
c.name+"#"+d.name+" at line "+this.tn.line+": "+b+" ('"+a.EQUAL+"' expected)");b=this.tn.next();try{d.id=this._parseId(b)}catch(f){throw Error("Illegal field id in message "+c.name+"#"+d.name+" at line "+this.tn.line+": "+b);}d.options={};b=this.tn.next();b===a.OPTOPEN&&(this._parseFieldOptions(c,d,b),b=this.tn.next());if(b!==a.END)throw Error("Illegal field delimiter in message "+c.name+"#"+d.name+" at line "+this.tn.line+": "+b+" ('"+a.END+"' expected)");c.fields.push(d)};d.prototype._parseFieldOptions=
function(c,b,d){var f=!0;do{d=this.tn.next();if(d===a.OPTCLOSE)break;else if(d===a.OPTEND){if(f)throw Error("Illegal start of message field options in message "+c.name+"#"+b.name+" at line "+this.tn.line+": "+d);d=this.tn.next()}this._parseFieldOption(c,b,d);f=!1}while(1)};d.prototype._parseFieldOption=function(c,b,d){var f=!1;d===a.COPTOPEN&&(d=this.tn.next(),f=!0);if(!a.NAME.test(d))throw Error("Illegal field option in message "+c.name+"#"+b.name+" at line "+this.tn.line+": "+d);var m=d;d=this.tn.next();
if(f){if(d!==a.COPTCLOSE)throw Error("Illegal custom field option name delimiter in message "+c.name+"#"+b.name+" at line "+this.tn.line+": "+d+" (')' expected)");m="("+m+")";d=this.tn.next();a.FQTYPEREF.test(d)&&(m+=d,d=this.tn.next())}if(d!==a.EQUAL)throw Error("Illegal field option operation in message "+c.name+"#"+b.name+" at line "+this.tn.line+": "+d+" ('\x3d' expected)");d=this.tn.next();if(d===a.STRINGOPEN||d===a.STRINGOPEN_SQ){if(f=this.tn.next(),d=this.tn.next(),d!=this.tn.stringEndsWith)throw Error("Illegal end of field value in message "+
c.name+"#"+b.name+", option "+m+" at line "+this.tn.line+": "+d+" ('"+this.tn.stringEndsWith+"' expected)");}else if(a.NUMBER.test(d,!0))f=this._parseNumber(d,!0);else if(a.BOOL.test(d))f="true"===d.toLowerCase();else if(a.TYPEREF.test(d))f=d;else throw Error("Illegal field option value in message "+c.name+"#"+b.name+", option "+m+" at line "+this.tn.line+": "+d);b.options[m]=f};d.prototype._parseEnum=function(c,b){var d={};b=this.tn.next();if(!a.NAME.test(b))throw Error("Illegal enum name in message "+
c.name+" at line "+this.tn.line+": "+b);d.name=b;b=this.tn.next();if(b!==a.OPEN)throw Error("Illegal OPEN after enum "+d.name+" at line "+this.tn.line+": "+b);d.values=[];d.options={};do{b=this.tn.next();if(b===a.CLOSE){b=this.tn.peek();b===a.END&&this.tn.next();break}if("option"==b)this._parseOption(d,b);else{if(!a.NAME.test(b))throw Error("Illegal enum value name in enum "+d.name+" at line "+this.tn.line+": "+b);this._parseEnumValue(d,b)}}while(1);c.enums.push(d)};d.prototype._parseEnumValue=function(c,
b){var d={};d.name=b;b=this.tn.next();if(b!==a.EQUAL)throw Error("Illegal enum value operator in enum "+c.name+" at line "+this.tn.line+": "+b+" ('"+a.EQUAL+"' expected)");b=this.tn.next();try{d.id=this._parseId(b,!0)}catch(f){throw Error("Illegal enum value id in enum "+c.name+" at line "+this.tn.line+": "+b);}c.values.push(d);b=this.tn.next();b===a.OPTOPEN&&(this._parseFieldOptions(c,{options:{}},b),b=this.tn.next());if(b!==a.END)throw Error("Illegal enum value delimiter in enum "+c.name+" at line "+
this.tn.line+": "+b+" ('"+a.END+"' expected)");};d.prototype._parseExtensions=function(c,b){var d=[];b=this.tn.next();"min"===b?d.push(a.ID_MIN):"max"===b?d.push(a.ID_MAX):d.push(this._parseNumber(b));b=this.tn.next();if("to"!==b)throw"Illegal extensions delimiter in message "+c.name+" at line "+this.tn.line+" ('to' expected)";b=this.tn.next();"min"===b?d.push(a.ID_MIN):"max"===b?d.push(a.ID_MAX):d.push(this._parseNumber(b));b=this.tn.next();if(b!==a.END)throw Error("Illegal extension delimiter in message "+
c.name+" at line "+this.tn.line+": "+b+" ('"+a.END+"' expected)");return d};d.prototype._parseExtend=function(c,b){b=this.tn.next();if(!a.TYPEREF.test(b))throw Error("Illegal extended message name at line "+this.tn.line+": "+b);var d={};d.ref=b;d.fields=[];b=this.tn.next();if(b!==a.OPEN)throw Error("Illegal OPEN in extend "+d.name+" at line "+this.tn.line+": "+b+" ('"+a.OPEN+"' expected)");do if(b=this.tn.next(),b===a.CLOSE){b=this.tn.peek();b==a.END&&this.tn.next();break}else if(a.RULE.test(b))this._parseMessageField(d,
b);else throw Error("Illegal token in extend "+d.name+" at line "+this.tn.line+": "+b+" (rule or '"+a.CLOSE+"' expected)");while(1);c.messages.push(d);return d};d.prototype.toString=function(){return"Parser"};return d}(d,d.Lang,d.DotProto.Tokenizer);d.Reflect=function(d){var a={},c=function(a,b){this.parent=a;this.name=b};c.prototype.fqn=function(){var a=this.name,b=this;do{b=b.parent;if(null==b)break;a=b.name+"."+a}while(1);return a};c.prototype.toString=function(a){var c=this.fqn();a&&(this instanceof
b?c="Message "+c:this instanceof b.Field?c="Message.Field "+c:this instanceof k?c="Enum "+c:this instanceof k.Value?c="Enum.Value "+c:this instanceof p?c="Service "+c:this instanceof p.Method?c=this instanceof p.RPCMethod?"Service.RPCMethod "+c:"Service.Method "+c:this instanceof e&&(c="Namespace "+c));return c};c.prototype.build=function(){throw Error(this.toString(!0)+" cannot be built directly");};a.T=c;var e=function(a,b,d){c.call(this,a,b);this.children=[];this.options=d||{}};e.prototype=Object.create(c.prototype);
e.prototype.getChildren=function(a){a=a||null;if(null==a)return this.children.slice();for(var b=[],c=0;c<this.children.length;c++)this.children[c]instanceof a&&b.push(this.children[c]);return b};e.prototype.addChild=function(a){var c;if(c=this.getChild(a.name))if(c instanceof b.Field&&c.name!==c.originalName&&!this.hasChild(c.originalName))c.name=c.originalName;else if(a instanceof b.Field&&a.name!==a.originalName&&!this.hasChild(a.originalName))a.name=a.originalName;else throw Error("Duplicate name in namespace "+
this.toString(!0)+": "+a.name);this.children.push(a)};e.prototype.hasChild=function(a){var b;if("number"==typeof a)for(b=0;b<this.children.length;b++){if("undefined"!==typeof this.children[b].id&&this.children[b].id==a)return!0}else for(b=0;b<this.children.length;b++)if("undefined"!==typeof this.children[b].name&&this.children[b].name==a)return!0;return!1};e.prototype.getChild=function(a){var b;if("number"==typeof a)for(b=0;b<this.children.length;b++){if("undefined"!==typeof this.children[b].id&&
this.children[b].id==a)return this.children[b]}else for(b=0;b<this.children.length;b++)if("undefined"!==typeof this.children[b].name&&this.children[b].name==a)return this.children[b];return null};e.prototype.resolve=function(b,c){var d=b.split("."),e=this,f=0;if(""==d[f]){for(;null!=e.parent;)e=e.parent;f++}do{do{e=e.getChild(d[f]);if(!(e&&e instanceof a.T)||c&&e instanceof a.Message.Field){e=null;break}f++}while(f<d.length);if(null!=e)break;if(null!==this.parent)return this.parent.resolve(b,c)}while(null!=
e);return e};e.prototype.build=function(){for(var a={},b=this.getChildren(),c,d=0;d<b.length;d++)c=b[d],c instanceof e&&(a[c.name]=c.build());Object.defineProperty&&Object.defineProperty(a,"$options",{value:this.buildOpt(),enumerable:!1,configurable:!1,writable:!1});return a};e.prototype.buildOpt=function(){for(var a={},b=Object.keys(this.options),c=0;c<b.length;c++)a[b[c]]=this.options[b[c]];return a};e.prototype.getOption=function(a){return"undefined"==typeof a?this.options:"undefined"!=typeof this.options[a]?
this.options[a]:null};a.Namespace=e;var b=function(a,b,c){e.call(this,a,b,c);this.extensions=[d.Lang.ID_MIN,d.Lang.ID_MAX];this.clazz=null};b.prototype=Object.create(e.prototype);b.prototype.build=function(c){if(this.clazz&&!c)return this.clazz;c=function(b,c){function d(a,b){var c={},e;for(e in a)a.hasOwnProperty(e)&&(null===a[e]||"object"!==typeof a[e]?c[e]=a[e]:a[e]instanceof f?b&&(c[e]=a.toBuffer()):c[e]=d(a[e],b));return c}var e=c.getChildren(a.Message.Field),g=function(a){b.Builder.Message.call(this);
var c,d;for(c=0;c<e.length;c++)d=e[c],this[d.name]=d.repeated?[]:null;for(c=0;c<e.length;c++)if(d=e[c],"undefined"!=typeof d.options["default"])try{this.$set(d.name,d.options["default"])}catch(g){throw Error("[INTERNAL] "+g);}if(1!=arguments.length||"object"!=typeof a||"function"==typeof a.encode||b.Util.isArray(a)||a instanceof f||a instanceof ArrayBuffer||b.Long&&a instanceof b.Long)for(c=0;c<arguments.length;c++)c<e.length&&this.$set(e[c].name,arguments[c]);else for(d=Object.keys(a),c=0;c<d.length;c++)this.$set(d[c],
a[d[c]])};g.prototype=Object.create(b.Builder.Message.prototype);g.prototype.add=function(a,d,e){var f=c.getChild(a);if(!f)throw Error(this+"#"+a+" is undefined");if(!(f instanceof b.Reflect.Message.Field))throw Error(this+"#"+a+" is not a field: "+f.toString(!0));if(!f.repeated)throw Error(this+"#"+a+" is not a repeated field");null===this[f.name]&&(this[f.name]=[]);this[f.name].push(e?d:f.verifyValue(d,!0))};g.prototype.$add=g.prototype.add;g.prototype.set=function(a,d,e){var f=c.getChild(a);if(!f)throw Error(this+
"#"+a+" is not a field: undefined");if(!(f instanceof b.Reflect.Message.Field))throw Error(this+"#"+a+" is not a field: "+f.toString(!0));this[f.name]=e?d:f.verifyValue(d)};g.prototype.$set=g.prototype.set;g.prototype.get=function(a){var d=c.getChild(a);if(!(d&&d instanceof b.Reflect.Message.Field))throw Error(this+"#"+a+" is not a field: undefined");if(!(d instanceof b.Reflect.Message.Field))throw Error(this+"#"+a+" is not a field: "+d.toString(!0));return this[d.name]};g.prototype.$get=g.prototype.get;
for(var h=0;h<e.length;h++)(function(a){var b=a.originalName.replace(/(_[a-zA-Z])/g,function(a){return a.toUpperCase().replace("_","")}),b=b.substring(0,1).toUpperCase()+b.substring(1),d=a.originalName.replace(/([A-Z])/g,function(a){return"_"+a});c.hasChild("set"+b)||(g.prototype["set"+b]=function(b){this.$set(a.name,b)});c.hasChild("set_"+d)||(g.prototype["set_"+d]=function(b){this.$set(a.name,b)});c.hasChild("get"+b)||(g.prototype["get"+b]=function(){return this.$get(a.name)});c.hasChild("get_"+
d)||(g.prototype["get_"+d]=function(){return this.$get(a.name)})})(e[h]);g.prototype.encode=function(a){var b=!1;a||(a=new f,b=!0);var d=a.littleEndian;try{return c.encode(this,a.LE()),(b?a.flip():a).LE(d)}catch(e){throw a.LE(d),e;}};g.prototype.encodeDelimited=function(a){var b=!1;a||(a=new f,b=!0);try{var d=(new f).LE();c.encode(this,d).flip();a.writeVarint32(d.remaining());a.append(d);return b?a.flip():a}catch(e){throw e;}};g.prototype.encodeAB=function(){try{return this.encode().toArrayBuffer()}catch(a){throw a.encoded&&
(a.encoded=a.encoded.toArrayBuffer()),a;}};g.prototype.toArrayBuffer=g.prototype.encodeAB;g.prototype.encodeNB=function(){try{return this.encode().toBuffer()}catch(a){throw a.encoded&&(a.encoded=a.encoded.toBuffer()),a;}};g.prototype.toBuffer=g.prototype.encodeNB;g.prototype.encode64=function(){try{return this.encode().toBase64()}catch(a){throw a.encoded&&(a.encoded=a.encoded.toBase64()),a;}};g.prototype.toBase64=g.prototype.encode64;g.prototype.encodeHex=function(){try{return this.encode().toHex()}catch(a){throw a.encoded&&
(a.encoded=a.encoded.toHex()),a;}};g.prototype.toHex=g.prototype.encodeHex;g.prototype.toRaw=function(a){return d(this,!!a)};g.decode=function(a,b){if(null===a)throw Error("buffer must not be null");"string"===typeof a&&(a=f.wrap(a,b?b:"base64"));a=a instanceof f?a:f.wrap(a);b=a.littleEndian;try{var d=c.decode(a.LE());a.LE(b);return d}catch(e){throw a.LE(b),e;}};g.decodeDelimited=function(a,b){if(null===a)throw Error("buffer must not be null");"string"===typeof a&&(a=f.wrap(a,b?b:"base64"));a=a instanceof
f?a:f.wrap(a);b=a.readVarint32();var d=c.decode(a.slice(a.offset,a.offset+b).LE());a.offset+=b;return d};g.decode64=function(a){return g.decode(a,"base64")};g.decodeHex=function(a){return g.decode(a,"hex")};g.prototype.toString=function(){return c.toString()};Object.defineProperty&&Object.defineProperty(g,"$options",{value:c.buildOpt(),enumerable:!1,configurable:!1,writable:!1});return g}(d,this);for(var e=this.getChildren(),h=0;h<e.length;h++)if(e[h]instanceof k)c[e[h].name]=e[h].build();else if(e[h]instanceof
b)c[e[h].name]=e[h].build();else if(!(e[h]instanceof b.Field))throw Error("Illegal reflect child of "+this.toString(!0)+": "+e[h].toString(!0));return this.clazz=c};b.prototype.encode=function(a,c){for(var d=this.getChildren(b.Field),e=null,f=0;f<d.length;f++){var h=a.$get(d[f].name);d[f].required&&null===h?null===e&&(e=d[f]):d[f].encode(h,c)}if(null!==e)throw a=Error("Missing at least one required field for "+this.toString(!0)+": "+e),a.encoded=c,a;return c};b.prototype.encodeDelimitied=function(a,
b){var c=new f;this.encode(a,c);c.flip();b.writeVarint32(c.remaining());b.append(c);return b};b.prototype.decode=function(a,b){b="number"===typeof b?b:-1;for(var c=a.offset,e=new this.clazz;a.offset<c+b||-1==b&&0<a.remaining();){var f=a.readVarint32(),h=f&7,f=f>>3,k=this.getChild(f);if(k)k.repeated&&!k.options.packed?e.$add(k.name,k.decode(h,a),!0):e.$set(k.name,k.decode(h,a),!0);else switch(h){case d.WIRE_TYPES.VARINT:a.readVarint32();break;case d.WIRE_TYPES.BITS32:a.offset+=4;break;case d.WIRE_TYPES.BITS64:a.offset+=
8;break;case d.WIRE_TYPES.LDELIM:h=a.readVarint32();a.offset+=h;break;default:throw Error("Illegal wire type of unknown field "+f+" in "+this.toString(!0)+"#decode: "+h);}}a=this.getChildren(d.Reflect.Field);for(b=0;b<a.length;b++)if(a[b].required&&null===e[a[b].name])throw a=Error("Missing at least one required field for "+this.toString(!0)+": "+a[b].name),a.decoded=e,a;return e};a.Message=b;var h=function(a,b,e,f,h,k){c.call(this,a,f);this.required="required"==b;this.repeated="repeated"==b;this.type=
e;this.resolvedType=null;this.id=h;this.options=k||{};this.originalName=this.name;d.convertFieldsToCamelCase&&(this.name=this.name.replace(/_([a-zA-Z])/g,function(a,b){return b.toUpperCase()}))};h.prototype=Object.create(c.prototype);h.prototype.verifyValue=function(a,b){b=b||!1;if(null===a){if(this.required)throw Error("Illegal value for "+this.toString(!0)+": "+a+" (required)");return null}var c;if(this.repeated&&!b){d.Util.isArray(a)||(a=[a]);b=[];for(c=0;c<a.length;c++)b.push(this.verifyValue(a[c],
!0));return b}if(!this.repeated&&d.Util.isArray(a))throw Error("Illegal value for "+this.toString(!0)+": "+a+" (no array expected)");if(this.type==d.TYPES.int32||this.type==d.TYPES.sint32||this.type==d.TYPES.sfixed32)return isNaN(c=parseInt(a,10))?c:c|0;if(this.type==d.TYPES.uint32||this.type==d.TYPES.fixed32)return isNaN(c=parseInt(a,10))?c:c>>>0;if(d.Long){if(this.type==d.TYPES.int64||this.type==d.TYPES.sint64||this.type==d.TYPES.sfixed64)return"object"==typeof a&&a instanceof d.Long?a.unsigned?
a.toSigned():a:d.Long.fromNumber(a,!1);if(this.type==d.TYPES.uint64||this.type==d.TYPES.fixed64)return"object"==typeof a&&a instanceof d.Long?a.unsigned?a:a.toUnsigned():d.Long.fromNumber(a,!0)}if(this.type==d.TYPES.bool)return"string"===typeof a?"true"===a:!!a;if(this.type==d.TYPES["float"]||this.type==d.TYPES["double"])return parseFloat(a);if(this.type==d.TYPES.string)return""+a;if(this.type==d.TYPES.bytes)return a&&a instanceof f?a:f.wrap(a);if(this.type==d.TYPES["enum"]){b=this.resolvedType.getChildren(k.Value);
for(c=0;c<b.length;c++)if(b[c].name==a||b[c].id==a)return b[c].id;throw Error("Illegal value for "+this.toString(!0)+": "+a+" (not a valid enum value)");}if(this.type==d.TYPES.message){if("object"!==typeof a)throw Error("Illegal value for "+this.toString(!0)+": "+a+" (object expected)");return a instanceof this.resolvedType.clazz?a:new this.resolvedType.clazz(a)}throw Error("[INTERNAL] Illegal value for "+this.toString(!0)+": "+a+" (undefined type "+this.type+")");};h.prototype.encode=function(a,
b){a=this.verifyValue(a);if(null==this.type||"object"!=typeof this.type)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===a||this.repeated&&0==a.length)return b;try{if(this.repeated){var c;if(this.options.packed){b.writeVarint32(this.id<<3|d.WIRE_TYPES.LDELIM);b.ensureCapacity(b.offset+=1);var e=b.offset;for(c=0;c<a.length;c++)this.encodeValue(a[c],b);var h=b.offset-e,k=f.calculateVarint32(h);if(1<k){var l=b.slice(e,b.offset),e=e+(k-1);b.offset=e;b.append(l)}b.writeVarint32(h,
e-k)}else for(c=0;c<a.length;c++)b.writeVarint32(this.id<<3|this.type.wireType),this.encodeValue(a[c],b)}else b.writeVarint32(this.id<<3|this.type.wireType),this.encodeValue(a,b)}catch(p){throw Error("Illegal value for "+this.toString(!0)+": "+a+" ("+p+")");}return b};h.prototype.encodeValue=function(a,b){if(null!==a){if(this.type==d.TYPES.int32)0>a?b.writeVarint64(a):b.writeVarint32(a);else if(this.type==d.TYPES.uint32)b.writeVarint32(a);else if(this.type==d.TYPES.sint32)b.writeZigZagVarint32(a);
else if(this.type==d.TYPES.fixed32)b.writeUint32(a);else if(this.type==d.TYPES.sfixed32)b.writeInt32(a);else if(this.type==d.TYPES.int64||this.type==d.TYPES.uint64)b.writeVarint64(a);else if(this.type==d.TYPES.sint64)b.writeZigZagVarint64(a);else if(this.type==d.TYPES.fixed64)b.writeUint64(a);else if(this.type==d.TYPES.sfixed64)b.writeInt64(a);else if(this.type==d.TYPES.bool)"string"===typeof a?b.writeVarint32("false"===a.toLowerCase()?0:!!a):b.writeVarint32(a?1:0);else if(this.type==d.TYPES["enum"])b.writeVarint32(a);
else if(this.type==d.TYPES["float"])b.writeFloat32(a);else if(this.type==d.TYPES["double"])b.writeFloat64(a);else if(this.type==d.TYPES.string)b.writeVString(a);else if(this.type==d.TYPES.bytes)a.offset>a.length&&(b=b.clone().flip()),b.writeVarint32(a.remaining()),b.append(a);else if(this.type==d.TYPES.message){var c=(new f).LE();this.resolvedType.encode(a,c);b.writeVarint32(c.offset);b.append(c.flip())}else throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+a+" (unknown type)");
return b}};h.prototype.decode=function(a,b,c){if(a!=this.type.wireType&&(c||a!=d.WIRE_TYPES.LDELIM||!this.repeated))throw Error("Illegal wire type for field "+this.toString(!0)+": "+a+" ("+this.type.wireType+" expected)");if(a==d.WIRE_TYPES.LDELIM&&this.repeated&&this.options.packed&&!c){a=b.readVarint32();a=b.offset+a;for(c=[];b.offset<a;)c.push(this.decode(this.type.wireType,b,!0));return c}if(this.type==d.TYPES.int32)return b.readVarint32()|0;if(this.type==d.TYPES.uint32)return b.readVarint32()>>>
0;if(this.type==d.TYPES.sint32)return b.readZigZagVarint32()|0;if(this.type==d.TYPES.fixed32)return b.readUint32()>>>0;if(this.type==d.TYPES.sfixed32)return b.readInt32()|0;if(this.type==d.TYPES.int64)return b.readVarint64();if(this.type==d.TYPES.uint64)return b.readVarint64().toUnsigned();if(this.type==d.TYPES.sint64)return b.readZigZagVarint64();if(this.type==d.TYPES.fixed64)return b.readUint64();if(this.type==d.TYPES.sfixed64)return b.readInt64();if(this.type==d.TYPES.bool)return!!b.readVarint32();
if(this.type==d.TYPES["enum"])return b.readVarint32();if(this.type==d.TYPES["float"])return b.readFloat();if(this.type==d.TYPES["double"])return b.readDouble();if(this.type==d.TYPES.string)return b.readVString();if(this.type==d.TYPES.bytes){a=b.readVarint32();if(b.remaining()<a)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+a+" required but got only "+b.remaining());c=b.clone();c.length=c.offset+a;b.offset+=a;return c}if(this.type==d.TYPES.message)return a=b.readVarint32(),this.resolvedType.decode(b,
a);throw Error("[INTERNAL] Illegal wire type for "+this.toString(!0)+": "+a);};a.Message.Field=h;var k=function(a,b,c){e.call(this,a,b,c);this.object=null};k.prototype=Object.create(e.prototype);k.prototype.build=function(){for(var a={},b=this.getChildren(k.Value),c=0;c<b.length;c++)a[b[c].name]=b[c].id;Object.defineProperty&&Object.defineProperty(a,"$options",{value:this.buildOpt(),enumerable:!1,configurable:!1,writable:!1});return this.object=a};a.Enum=k;h=function(a,b,d){c.call(this,a,b);this.id=
d};h.prototype=Object.create(c.prototype);a.Enum.Value=h;var p=function(a,b,c){e.call(this,a,b,c);this.clazz=null};p.prototype=Object.create(e.prototype);p.prototype.build=function(b){return this.clazz&&!b?this.clazz:this.clazz=function(b,c){var d=function(a){b.Builder.Service.call(this);this.rpcImpl=a||function(a,b,c){setTimeout(c.bind(this,Error("Not implemented, see: https://github.com/dcodeIO/ProtoBuf.js/wiki/Services")),0)}};d.prototype=Object.create(b.Builder.Service.prototype);Object.defineProperty&&
(Object.defineProperty(d,"$options",{value:c.buildOpt(),enumerable:!1,configurable:!1,writable:!1}),Object.defineProperty(d.prototype,"$options",{value:d.$options,enumerable:!1,configurable:!1,writable:!1}));for(var e=c.getChildren(a.Service.RPCMethod),f=0;f<e.length;f++)(function(a){d.prototype[a.name]=function(b,d){try{b&&b instanceof a.resolvedRequestType.clazz||setTimeout(d.bind(this,Error("Illegal request type provided to service method "+c.name+"#"+a.name))),this.rpcImpl(a.fqn(),b,function(b,
e){if(b)d(b);else{try{e=a.resolvedResponseType.clazz.decode(e)}catch(f){}e&&e instanceof a.resolvedResponseType.clazz?d(null,e):d(Error("Illegal response type received in service method "+c.name+"#"+a.name))}})}catch(e){setTimeout(d.bind(this,e),0)}};d[a.name]=function(b,c,e){(new d(b))[a.name](c,e)};Object.defineProperty&&(Object.defineProperty(d[a.name],"$options",{value:a.buildOpt(),enumerable:!1,configurable:!1,writable:!1}),Object.defineProperty(d.prototype[a.name],"$options",{value:d[a.name].$options,
enumerable:!1,configurable:!1,writable:!1}))})(e[f]);return d}(d,this)};a.Service=p;var l=function(a,b,d){c.call(this,a,b);this.options=d||{}};l.prototype=Object.create(c.prototype);l.prototype.buildOpt=e.prototype.buildOpt;a.Service.Method=l;h=function(a,b,c,d,e){l.call(this,a,b,e);this.requestName=c;this.responseName=d;this.resolvedResponseType=this.resolvedRequestType=null};h.prototype=Object.create(l.prototype);a.Service.RPCMethod=h;return a}(d);d.Builder=function(d,a,c){var e=function(){this.ptr=
this.ns=new c.Namespace(null,"");this.resolved=!1;this.result=null;this.files={};this.importRoot=null};e.prototype.reset=function(){this.ptr=this.ns};e.prototype.define=function(b,d){if("string"!==typeof b||!a.TYPEREF.test(b))throw Error("Illegal package name: "+b);b=b.split(".");var e;for(e=0;e<b.length;e++)if(!a.NAME.test(b[e]))throw Error("Illegal package name: "+b[e]);for(e=0;e<b.length;e++)this.ptr.hasChild(b[e])||this.ptr.addChild(new c.Namespace(this.ptr,b[e],d)),this.ptr=this.ptr.getChild(b[e]);
return this};e.isValidMessage=function(b){if("string"!==typeof b.name||!a.NAME.test(b.name)||"undefined"!==typeof b.values||"undefined"!==typeof b.rpc)return!1;var c;if("undefined"!==typeof b.fields){if(!d.Util.isArray(b.fields))return!1;var f=[],p;for(c=0;c<b.fields.length;c++){if(!e.isValidMessageField(b.fields[c]))return!1;p=parseInt(b.fields[c].id,10);if(0<=f.indexOf(p))return!1;f.push(p)}}if("undefined"!==typeof b.enums){if(!d.Util.isArray(b.enums))return!1;for(c=0;c<b.enums.length;c++)if(!e.isValidEnum(b.enums[c]))return!1}if("undefined"!==
typeof b.messages){if(!d.Util.isArray(b.messages))return!1;for(c=0;c<b.messages.length;c++)if(!e.isValidMessage(b.messages[c])&&!e.isValidExtend(b.messages[c]))return!1}return"undefined"===typeof b.extensions||d.Util.isArray(b.extensions)&&2===b.extensions.length&&"number"===typeof b.extensions[0]&&"number"===typeof b.extensions[1]?!0:!1};e.isValidMessageField=function(b){if("string"!==typeof b.rule||"string"!==typeof b.name||"string"!==typeof b.type||"undefined"===typeof b.id||!(a.RULE.test(b.rule)&&
a.NAME.test(b.name)&&a.TYPEREF.test(b.type)&&a.ID.test(""+b.id)))return!1;if("undefined"!=typeof b.options){if("object"!=typeof b.options)return!1;for(var c=Object.keys(b.options),d=0;d<c.length;d++)if(!a.OPTNAME.test(c[d])||"string"!==typeof b.options[c[d]]&&"number"!==typeof b.options[c[d]]&&"boolean"!==typeof b.options[c[d]])return!1}return!0};e.isValidEnum=function(b){if("string"!==typeof b.name||!a.NAME.test(b.name)||"undefined"===typeof b.values||!d.Util.isArray(b.values)||0==b.values.length)return!1;
for(var c=0;c<b.values.length;c++)if("object"!=typeof b.values[c]||"string"!==typeof b.values[c].name||"undefined"===typeof b.values[c].id||!a.NAME.test(b.values[c].name)||!a.NEGID.test(""+b.values[c].id))return!1;return!0};e.prototype.create=function(b){if(b&&(d.Util.isArray(b)||(b=[b]),0!=b.length)){var f=[],k,p,l,g,n;for(f.push(b);0<f.length;){b=f.pop();if(d.Util.isArray(b))for(;0<b.length;)if(k=b.shift(),e.isValidMessage(k)){p=new c.Message(this.ptr,k.name,k.options);if(k.fields&&0<k.fields.length)for(g=
0;g<k.fields.length;g++){if(p.hasChild(k.fields[g].id))throw Error("Duplicate field id in message "+p.name+": "+k.fields[g].id);if(k.fields[g].options)for(l=Object.keys(k.fields[g].options),n=0;n<l.length;n++){if(!a.OPTNAME.test(l[n]))throw Error("Illegal field option name in message "+p.name+"#"+k.fields[g].name+": "+l[n]);if("string"!==typeof k.fields[g].options[l[n]]&&"number"!==typeof k.fields[g].options[l[n]]&&"boolean"!==typeof k.fields[g].options[l[n]])throw Error("Illegal field option value in message "+
p.name+"#"+k.fields[g].name+"#"+l[n]+": "+k.fields[g].options[l[n]]);}p.addChild(new c.Message.Field(p,k.fields[g].rule,k.fields[g].type,k.fields[g].name,k.fields[g].id,k.fields[g].options))}l=[];if("undefined"!==typeof k.enums&&0<k.enums.length)for(g=0;g<k.enums.length;g++)l.push(k.enums[g]);if(k.messages&&0<k.messages.length)for(g=0;g<k.messages.length;g++)l.push(k.messages[g]);k.extensions&&(p.extensions=k.extensions,p.extensions[0]<d.Lang.ID_MIN&&(p.extensions[0]=d.Lang.ID_MIN),p.extensions[1]>
d.Lang.ID_MAX&&(p.extensions[1]=d.Lang.ID_MAX));this.ptr.addChild(p);0<l.length&&(f.push(b),b=l,this.ptr=p)}else if(e.isValidEnum(k)){p=new c.Enum(this.ptr,k.name,k.options);for(g=0;g<k.values.length;g++)p.addChild(new c.Enum.Value(p,k.values[g].name,k.values[g].id));this.ptr.addChild(p)}else if(e.isValidService(k)){p=new c.Service(this.ptr,k.name,k.options);for(g in k.rpc)k.rpc.hasOwnProperty(g)&&p.addChild(new c.Service.RPCMethod(p,g,k.rpc[g].request,k.rpc[g].response,k.rpc[g].options));this.ptr.addChild(p)}else if(e.isValidExtend(k))if(p=
this.ptr.resolve(k.ref))for(g=0;g<k.fields.length;g++){if(p.hasChild(k.fields[g].id))throw Error("Duplicate extended field id in message "+p.name+": "+k.fields[g].id);if(k.fields[g].id<p.extensions[0]||k.fields[g].id>p.extensions[1])throw Error("Illegal extended field id in message "+p.name+": "+k.fields[g].id+" ("+p.extensions.join(" to ")+" expected)");p.addChild(new c.Message.Field(p,k.fields[g].rule,k.fields[g].type,k.fields[g].name,k.fields[g].id,k.fields[g].options))}else{if(!/\.?google\.protobuf\./.test(k.ref))throw Error("Extended message "+
k.ref+" is not defined");}else throw Error("Not a valid message, enum, service or extend definition: "+JSON.stringify(k));else throw Error("Not a valid namespace definition: "+JSON.stringify(b));this.ptr=this.ptr.parent}this.resolved=!1;this.result=null;return this}};e.isValidImport=function(a){return!/google\/protobuf\//.test(a)};e.prototype["import"]=function(a,c){if("string"===typeof c){d.Util.IS_NODE&&(c=module.require("path").resolve(c));if(this.files[c])return this.reset(),this;this.files[c]=
!0}if(a.imports&&0<a.imports.length){var f,p="/",l=!1;if("object"===typeof c){if(this.importRoot=c.root,l=!0,f=this.importRoot,c=c.file,0<=f.indexOf("\\")||0<=c.indexOf("\\"))p="\\"}else"string"===typeof c?this.importRoot?f=this.importRoot:0<=c.indexOf("/")?(f=c.replace(/\/[^\/]*$/,""),""===f&&(f="/")):0<=c.indexOf("\\")?(f=c.replace(/\\[^\\]*$/,""),p="\\"):f=".":f=null;for(var g=0;g<a.imports.length;g++)if("string"===typeof a.imports[g]){if(!f)throw Error("Cannot determine import root: File name is unknown");
var n=f+p+a.imports[g];if(e.isValidImport(n)){/\.proto$/i.test(n)&&!d.DotProto&&(n=n.replace(/\.proto$/,".json"));var x=d.Util.fetch(n);if(null===x)throw Error("Failed to import '"+n+"' in '"+c+"': File not found");if(/\.json$/i.test(n))this["import"](JSON.parse(x+""),n);else this["import"]((new d.DotProto.Parser(x+"")).parse(),n)}}else if(c)if(/\.(\w+)$/.test(c))this["import"](a.imports[g],c.replace(/^(.+)\.(\w+)$/,function(a,b,c){return b+"_import"+g+"."+c}));else this["import"](a.imports[g],c+
"_import"+g);else this["import"](a.imports[g]);l&&(this.importRoot=null)}a.messages&&(a["package"]&&this.define(a["package"],a.options),this.create(a.messages),this.reset());a.enums&&(a["package"]&&this.define(a["package"],a.options),this.create(a.enums),this.reset());a.services&&(a["package"]&&this.define(a["package"],a.options),this.create(a.services),this.reset());a["extends"]&&(a["package"]&&this.define(a["package"],a.options),this.create(a["extends"]),this.reset());return this};e.isValidService=
function(b){return"string"===typeof b.name&&a.NAME.test(b.name)&&"object"===typeof b.rpc?!0:!1};e.isValidExtend=function(b){if("string"!==typeof b.ref||!a.TYPEREF.test(b.name))return!1;var c;if("undefined"!==typeof b.fields){if(!d.Util.isArray(b.fields))return!1;var f=[],n;for(c=0;c<b.fields.length;c++){if(!e.isValidMessageField(b.fields[c]))return!1;n=parseInt(b.id,10);if(0<=f.indexOf(n))return!1;f.push(n)}}return!0};e.prototype.resolveAll=function(){var b;if(null!=this.ptr&&"object"!==typeof this.ptr.type){if(this.ptr instanceof
c.Namespace){b=this.ptr.getChildren();for(var e=0;e<b.length;e++)this.ptr=b[e],this.resolveAll()}else if(this.ptr instanceof c.Message.Field)if(a.TYPE.test(this.ptr.type))this.ptr.type=d.TYPES[this.ptr.type];else{if(!a.TYPEREF.test(this.ptr.type))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);b=this.ptr.parent.resolve(this.ptr.type,!0);if(!b)throw Error("Unresolvable type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);this.ptr.resolvedType=b;if(b instanceof
c.Enum)this.ptr.type=d.TYPES["enum"];else if(b instanceof c.Message)this.ptr.type=d.TYPES.message;else throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);}else if(!(this.ptr instanceof d.Reflect.Enum.Value))if(this.ptr instanceof d.Reflect.Service.Method)if(this.ptr instanceof d.Reflect.Service.RPCMethod){b=this.ptr.parent.resolve(this.ptr.requestName);if(!(b&&b instanceof d.Reflect.Message))throw Error("Illegal request type reference in "+this.ptr.toString(!0)+": "+
this.ptr.requestName);this.ptr.resolvedRequestType=b;b=this.ptr.parent.resolve(this.ptr.responseName);if(!(b&&b instanceof d.Reflect.Message))throw Error("Illegal response type reference in "+this.ptr.toString(!0)+": "+this.ptr.responseName);this.ptr.resolvedResponseType=b}else throw Error("Illegal service method type in "+this.ptr.toString(!0));else throw Error("Illegal object type in namespace: "+typeof this.ptr+":"+this.ptr);this.reset()}};e.prototype.build=function(a){this.reset();this.resolved||
(this.resolveAll(),this.resolved=!0,this.result=null);null==this.result&&(this.result=this.ns.build());if(a){a=a.split(".");for(var c=this.result,d=0;d<a.length;d++)if(c[a[d]])c=c[a[d]];else{c=null;break}return c}return this.result};e.prototype.lookup=function(a){return a?this.ns.resolve(a):this.ns};e.prototype.toString=function(){return"Builder"};e.Message=function(){};e.Service=function(){};return e}(d,d.Lang,d.Reflect);d.loadProto=function(f,a,c){if("string"==typeof a||a&&"string"===typeof a.file&&
"string"===typeof a.root)c=a,a=null;return d.loadJson((new d.DotProto.Parser(f+"")).parse(),a,c)};d.protoFromString=d.loadProto;d.loadProtoFile=function(f,a,c){a&&"object"===typeof a?(c=a,a=null):a&&"function"===typeof a||(a=null);if(a)d.Util.fetch("object"===typeof f?f.root+"/"+f.file:f,function(b){a(d.loadProto(b,c,f))});else{var e=d.Util.fetch("object"===typeof f?f.root+"/"+f.file:f);return null!==e?d.protoFromString(e,c,f):null}};d.protoFromFile=d.loadProtoFile;d.newBuilder=function(f,a){var c=
new d.Builder;"undefined"!==typeof f&&null!==f&&c.define(f,a);return c};d.loadJson=function(f,a,c){if("string"===typeof a||a&&"string"===typeof a.file&&"string"===typeof a.root)c=a,a=null;a&&"object"===typeof a||(a=d.newBuilder());"string"===typeof f&&(f=JSON.parse(f));a["import"](f,c);a.resolveAll();a.build();return a};d.loadJsonFile=function(f,a,c){a&&"object"===typeof a?(c=a,a=null):a&&"function"===typeof a||(a=null);if(a)d.Util.fetch("object"===typeof f?f.root+"/"+f.file:f,function(b){try{a(d.loadJson(JSON.parse(b),
c,f))}catch(e){a(e)}});else{var e=d.Util.fetch("object"===typeof f?f.root+"/"+f.file:f);return null!==e?d.loadJson(JSON.parse(e),c,f):null}};return d}(n.dcodeIO.ByteBuffer)})(this)})});
/* ******** */
(function(x){var p=window.AmazonUIPageJS||window.P,C=p._namespace||p.attributeErrors,k=C?C("CampfireJSJaC_AUIBuild",""):p;k.guardFatal?k.guardFatal(x)(k,window):k.execute(function(){x(k,window)})})(function(x,p,C){x.when("3p-JSJaC-Config","3p-JSJaC-Crypt").register("3p-JSJaC",function(k,A){function e(){}function f(){}function d(a){a&&a.httpbase&&(this._httpbase=a.httpbase);this.oDbg=a&&a.oDbg&&a.oDbg.log?a.oDbg:{log:function(){}};a&&a.timerval?this.setPollInterval(a.timerval):this.setPollInterval(k.JSJAC_TIMERVAL);
this._cookie_prefix=a&&a.cookie_prefix?a.cookie_prefix:"";this._connected=!1;this._events=[];this._keys=null;this._ID=0;this._inQ=[];this._pQueue=[];this._regIDs=[];this._req=[];this._status="intialized";this._errcnt=0;this._inactivity=k.JSJAC_INACTIVITY;this._sendRawCallbacks=[];this._serverName=this._serverIP="unknown";this._latencyRecords={}}function g(a,b,c){if(p==this)return new g(a,b,c);this.code=a;this.type=b;this.cond=c}function q(a,b,c,h,d){if(p==this)return new q(a,b,c,h,d);this.name=a;
this.value=b;this.secs=c;this.domain=h;this.path=d;this.write=function(){var a;this.secs?(a=new Date,a.setTime(a.getTime()+1E3*this.secs),a="; expires\x3d"+a.toGMTString()):a="";var b=this.domain?"; domain\x3d"+this.domain:"",c=this.path?"; path\x3d"+this.path:"; path\x3d/";document.cookie=this.getName()+"\x3d"+q._escape(this.getValue())+a+b+c};this.erase=function(){(new q(this.getName(),"",-1)).write()};this.getName=function(){return this.name};this.setName=function(a){this.name=a;return this};this.getValue=
function(){return this.value};this.setValue=function(a){this.value=a;return this};this.setDomain=function(a){this.domain=a;return this};this.setPath=function(a){this.path=a;return this}}function M(a){this.message=a;this.name="CookieException"}function n(a,b,c,h){var d=f.create("error","jsjac");d.documentElement.setAttribute("code",a);d.documentElement.setAttribute("type",b);c&&d.documentElement.appendChild(d.createElement(c)).setAttribute("xmlns",L);if(h)for(h=Array.prototype.slice.call(h),a=0;a<
h.length;a++)d.documentElement.appendChild(h[a]);return d.documentElement}function F(a){a&&a.appID&&(this._appID=a.appID);a&&a.apiKey&&(this._apiKey=a.apiKey);a&&a.apiSecret&&(this._apiSecret=a.apiSecret);this._perms="";this._session=C}function u(a){this.base=d;this.base(a);this._hold=k.JSJACHBC_MAX_HOLD;this._inactivity=0;this._last_requests={};this._pause=this._min_polling=this._last_rid=0;this._wait=a.wait||k.JSJACHBC_MAX_WAIT}function w(a){this.base=d;this.base(a);J=!1}function v(a){this._resource=
this._domain=this._node="";"string"==typeof a?(-1!=a.indexOf("@")&&(this.setNode(a.substring(0,a.indexOf("@"))),a=a.substring(a.indexOf("@")+1)),-1!=a.indexOf("/")&&(this.setResource(a.substring(a.indexOf("/")+1)),a=a.substring(0,a.indexOf("/"))),this.setDomain(a)):(this.setNode(a.node),this.setDomain(a.domain),this.setResource(a.resource))}function x(a){this.message=a;this.name="JSJaCJIDInvalidException"}function G(){}function r(a,b){var c=Math.random();this._k=[];this._k[0]=c.toString();b?this.oDbg=
b:(this.oDbg={},this.oDbg.log=function(){});if(a)for(c=1;c<k.JSJAC_NKEYS;c++)this._k[c]=a(this._k[c-1]),b.log(c+": "+this._k[c],4);this._indexAt=k.JSJAC_NKEYS-1;this.getKey=function(){return this._k[this._indexAt--]};this.lastKey=function(){return 0==this._indexAt};this.size=function(){return this._k.length};this._getSuspendVars=function(){return["_k","_indexAt"]}}function m(a){this.name=a;this.doc="undefined"!=typeof J&&J?f.create(a,N):f.create(a,"")}function y(){this.base=m;this.base("presence")}
function z(){this.base=m;this.base("iq")}function B(){this.base=m;this.base("message")}function t(a){this.base=d;this.base(a);this._ws=null;this.registerHandler("onerror",l.bind(this._cleanupWebSocket,this))}p.XDomainRequest&&document.all&&!p.atob&&(p.ieXDRToXHR=function(a){var b=a.XMLHttpRequest;a.XMLHttpRequest=function(){this.onreadystatechange=Object;this.xdr=this.xhr=null;this.readyState=0;this.status="";this.send=this.abort=this.setRequestHeader=this.getAllResponseHeaders=this.getResponseHeader=
this.responseText=this.statusText=null;this.isxdr=!1;var a=this;a.xdrLoadedBinded=function(){a.xdrLoaded()};a.xdrErrorBinded=function(){a.xdrError()};a.xdrProgressBinded=function(){a.xdrProgress()};a.xhrReadyStateChangedBinded=function(){a.xhrReadyStateChanged()}};XMLHttpRequest.prototype.open=function(c,h,d,e,f){0>h.indexOf(document.domain)&&0<h.indexOf("http-bind")?(null===this.xdr&&(this.xdr=new a.XDomainRequest),this.isxdr=!0,this.setXDRActive(),this.xdr.open(c,h)):(null===this.xhr&&(this.xhr=
new b),this.isxdr=!1,this.setXHRActive(),this.xhr.open(c,h,d,e,f))};XMLHttpRequest.prototype.xdrGetResponseHeader=function(a){return"Content-Type"===a&&""<this.xdr.contentType?this.xdr.contentType:""};XMLHttpRequest.prototype.xdrGetAllResponseHeaders=function(){return""<this.xdr.contentType?"Content-Type: "+this.xdr.contentType:""};XMLHttpRequest.prototype.xdrSetRequestHeader=function(a,b){};XMLHttpRequest.prototype.xdrLoaded=function(){if(null!==this.onreadystatechange){this.readyState=4;this.status=
200;this.statusText="OK";this.responseText=this.xdr.responseText;if(a.ActiveXObject){var b=new ActiveXObject("Microsoft.XMLDOM");b.async="false";b.loadXML(this.responseText);this.responseXML=b}this.onreadystatechange()}};XMLHttpRequest.prototype.xdrError=function(){null!==this.onreadystatechange&&(this.readyState=4,this.status=0,this.responseText=this.statusText="",this.onreadystatechange())};XMLHttpRequest.prototype.xdrProgress=function(){null!==this.onreadystatechange&&3!==this.status&&(this.status=
this.readyState=3,this.statusText="",this.onreadystatechange())};XMLHttpRequest.prototype.finalXDRRequest=function(){var a=this.xdr;delete a.onload;delete a.onerror;delete a.onprogress};XMLHttpRequest.prototype.sendXDR=function(a){var b=this.xdr;b.onload=this.xdrLoadedBinded;b.onerror=this.xdr.ontimeout=this.xdrErrorBinded;b.onprogress=this.xdrProgressBinded;this.responseText=null;this.xdr.send(a)};XMLHttpRequest.prototype.abortXDR=function(){this.finalXDRRequest();this.xdr.abort()};XMLHttpRequest.prototype.setXDRActive=
function(){this.send=this.sendXDR;this.abort=this.abortXDR;this.getResponseHeader=this.xdrGetResponseHeader;this.getAllResponseHeaders=this.xdrGetAllResponseHeaders;this.setRequestHeader=this.xdrSetRequestHeader};XMLHttpRequest.prototype.xhrGetResponseHeader=function(a){return this.xhr.getResponseHeader(a)};XMLHttpRequest.prototype.xhrGetAllResponseHeaders=function(){return this.xhr.getAllResponseHeaders()};XMLHttpRequest.prototype.xhrSetRequestHeader=function(a,b){return this.xhr.setRequestHeader(a,
b)};XMLHttpRequest.prototype.xhrReadyStateChanged=function(){if(null!==this.onreadystatechange&&this.readyState!==this.xhr.readyState){var a=this.xhr;this.readyState=a.readyState;4===this.readyState&&(this.status=a.status,this.statusText=a.statusText,this.responseText=a.responseText,this.responseXML=a.responseXML);this.onreadystatechange()}};XMLHttpRequest.prototype.finalXHRRequest=function(){delete this.xhr.onreadystatechange};XMLHttpRequest.prototype.abortXHR=function(){this.finalXHRRequest();this.xhr.abort()};
XMLHttpRequest.prototype.sendXHR=function(a){this.xhr.onreadystatechange=this.xhrReadyStateChangedBinded;this.xhr.send(a)};XMLHttpRequest.prototype.setXHRActive=function(){this.send=this.sendXHR;this.abort=this.abortXHR;this.getResponseHeader=this.xhrGetResponseHeader;this.getAllResponseHeaders=this.xhrGetAllResponseHeaders;this.setRequestHeader=this.xhrSetRequestHeader};a.ieXDRToXHR=C},p.ieXDRToXHR(p));Object.defineProperty(String.prototype,"htmlEnc",{enumerable:!1,value:function(){if(!this)return this;
var a=this.replace(/&/g,"\x26amp;"),a=a.replace(/</g,"\x26lt;"),a=a.replace(/>/g,"\x26gt;"),a=a.replace(/\"/g,"\x26quot;");return a=a.replace(/\n/g,"\x3cbr /\x3e")}});Object.defineProperty(String.prototype,"revertHtmlEnc",{enumerable:!1,value:function(){if(!this)return this;var a=this.replace(/&amp;/gi,"\x26"),a=a.replace(/&lt;/gi,"\x3c"),a=a.replace(/&gt;/gi,"\x3e"),a=a.replace(/&quot;/gi,'"');return a=a.replace(/<br( )?(\/)?>/gi,"\n")}});Date.jab2date=function(a){var b=new Date(Date.UTC(a.substr(0,
4),a.substr(5,2)-1,a.substr(8,2),a.substr(11,2),a.substr(14,2),a.substr(17,2)));if("Z"!=a.substr(a.length-6,1)){var c=new Date;c.setTime(0);c.setUTCHours(a.substr(a.length-5,2));c.setUTCMinutes(a.substr(a.length-2,2));"+"==a.substr(a.length-6,1)?b.setTime(b.getTime()-c.getTime()):"-"==a.substr(a.length-6,1)&&b.setTime(b.getTime()+c.getTime())}return b};Date.hrTime=function(a){return Date.jab2date(a).toLocaleString()};Date.prototype.jabberDate=function(){var a=function(a){return 10>a?"0"+a:a},b=this.getUTCFullYear()+
"-",b=b+(a(this.getUTCMonth()+1)+"-"),b=b+(a(this.getUTCDate())+"T"),b=b+(a(this.getUTCHours())+":"),b=b+(a(this.getUTCMinutes())+":");return b+=a(this.getUTCSeconds())+"Z"};Number.max=function(a,b){return a>b?a:b};Number.min=function(a,b){return a<b?a:b};e.create=function(){try{if(p.XMLHttpRequest){var a=new XMLHttpRequest;null===a.readyState&&(a.readyState=1,a.addEventListener("load",function(){a.readyState=4;if("function"==typeof a.onreadystatechange)a.onreadystatechange()},!1));return a}if(p.ActiveXObject)return new ActiveXObject(e.getPrefix()+
".XmlHttp")}catch(b){}throw Error("Your browser does not support XmlHttp objects");};e.getPrefix=function(){if(e.prefix)return e.prefix;for(var a=["MSXML2","Microsoft","MSXML","MSXML3"],b=0;b<a.length;b++)try{return new ActiveXObject(a[b]+".XmlHttp"),e.prefix=a[b]}catch(c){}throw Error("Could not find an installed XML parser");};f.create=function(a,b){a=a||"foo";b=b||"";try{var c;document.implementation&&document.implementation.createDocument?(c=document.implementation.createDocument(b,a,null),null===
c.readyState&&(c.readyState=1,c.addEventListener("load",function(){c.readyState=4;if("function"==typeof c.onreadystatechange)c.onreadystatechange()},!1))):p.ActiveXObject&&(c=new ActiveXObject(f.getPrefix()+".DomDocument"));if(!c.documentElement||c.documentElement.tagName!=a||c.documentElement.namespaceURI&&c.documentElement.namespaceURI!=b)try{""!==b?c.appendChild(c.createElement(a)).setAttribute("xmlns",b):c.appendChild(c.createElement(a))}catch(h){c=document.implementation.createDocument(b,a,null),
null===c.documentElement&&c.appendChild(c.createElement(a)),""!==b&&c.documentElement.getAttribute("xmlns")!=b&&c.documentElement.setAttribute("xmlns",b)}return c}catch(h){}throw Error("Your browser does not support XmlDocument objects");};f.getPrefix=function(){if(f.prefix)return f.prefix;for(var a=["MSXML2","Microsoft","MSXML","MSXML3"],b=0;b<a.length;b++)try{return new ActiveXObject(a[b]+".DomDocument"),f.prefix=a[b]}catch(c){}throw Error("Could not find an installed XML parser");};"undefined"!=
typeof Document&&p.DOMParser&&(Document.prototype.loadXML=function(a){for(a=(new DOMParser).parseFromString(a,"text/xml");this.hasChildNodes();)this.removeChild(this.lastChild);for(var b=0;b<a.childNodes.length;b++)this.appendChild(this.importNode(a.childNodes[b],!0))});p.XMLSerializer&&p.Node&&Node.prototype&&Node.prototype.__defineGetter__&&(XMLDocument.prototype.__defineGetter__("xml",function(){return(new XMLSerializer).serializeToString(this)}),Document.prototype.__defineGetter__("xml",function(){return(new XMLSerializer).serializeToString(this)}),
Node.prototype.__defineGetter__("xml",function(){return(new XMLSerializer).serializeToString(this)}));var l={Version:"1.4",require:function(a){document.write('\x3cscript type\x3d"text/javascript" src\x3d"'+a+'"\x3e\x3c/script\x3e')},load:function(){var a="xmlextras jsextras crypt JSJaCConfig JSJaCConstants JSJaCCookie JSJaCJSON JSJaCJID JSJaCBuilder JSJaCPacket JSJaCError JSJaCKeys JSJaCConnection JSJaCHttpPollingConnection JSJaCHttpBindingConnection JSJaCConsoleLogger JSJaCFBApplication JSJaCWebSocketConnection".split(" "),
b=document.getElementsByTagName("script"),c="./",h;for(h=0;h<b.length;h++)if(b.item(h).src&&b.item(h).src.match(/JSJaC\.js$/)){c=b.item(h).src.replace(/JSJaC.js$/,"");break}for(h=0;h<a.length;h++)this.require(c+a[h]+".js")},bind:function(a,b,c){return function(h){return a.apply(b,[h,c])}}};"undefined"==typeof d&&l.load();var D={buildNode:function(a,b,c,h,d){if(c)if(D._isStringOrNumber(c)||c instanceof Array)b=this._createElement(a,b,d),D._children(a,b,c);else{d=c.xmlns||d;b=this._createElement(a,
b,d);for(var e in c)c.hasOwnProperty(e)&&"xmlns"!=e&&b.setAttribute(e,c[e])}else b=this._createElement(a,b,d);h&&D._children(a,b,h,d);return b},_createElement:function(a,b,c){try{if(c)return a.createElementNS(c,b)}catch(h){}a=a.createElement(b);c&&a.setAttribute("xmlns",c);return a},_text:function(a,b){return a.createTextNode(b)},_children:function(a,b,c,h){if("object"==typeof c)for(var d in c){if(c.hasOwnProperty(d)){var e=c[d];"object"==typeof e?(e instanceof Array&&(e=D.buildNode(a,e[0],e[1],e[2],
h)),b.appendChild(e)):D._isStringOrNumber(e)&&b.appendChild(D._text(a,e))}}else D._isStringOrNumber(c)&&b.appendChild(D._text(a,c))},_attributes:function(a){var b=[],c;for(c in a)a.hasOwnProperty(c)&&b.push(c+'\x3d"'+a[c].toString().htmlEnc()+'"');return b.join(" ")},_isStringOrNumber:function(a){return"string"==typeof a||"number"==typeof a}};d.prototype.ensureResponseXML=function(a){if(!a.responseXML||""===a.responseXML)try{a.responseXML=(new DOMParser).parseFromString(a.responseText)}catch(b){this.oDbg.log("Improper response XML error.",
1)}};d.prototype.connect=function(a){this._setStatus("connecting");if("x-facebook-platform"!=a.authtype)this.domain=a.domain||"localhost",this.username=a.username,this.resource=a.resource,this.pass=a.password||a.pass,this.register=a.register,this.authhost=a.authhost||a.host||a.domain,this.authtype=a.authtype||"sasl";else if(this.domain="chat.facebook.com",this.authtype=a.authtype,a.facebookApp!==C){this._facebookApp=a.facebookApp;if(!document.getElementById("fb-root")){var b=document.createElement("div");
b.id="fb-root";document.body.appendChild(b)}if(a.facebookApp.getSession()===C){this._facebookApp.Login(this,a);return}}else{this.oDbg.log("No Facebook application param specified!",1);return}this._xmllang=a.xmllang&&""!==a.xmllang?a.xmllang:"en";this._allow_plain=a.allow_plain?a.allow_plain:k.JSJAC_ALLOW_PLAIN;this.host=a.host;this.port=a.port||5222;this.secure=a.secure?"true":"false";this.jid=this.username+"@"+this.domain;this.fulljid=this.jid+"/"+this.resource;this._rid=Math.round(100000.5+799999.99999*
Math.random());var c=this._getFreeSlot();this._req[c]=this._setupRequest(!0);a=this._getInitialRequestString();this.oDbg.log(a,4);this._req[c].r.onreadystatechange=l.bind(function(){var a=this._req[c].r;4==a.readyState&&(this.oDbg.log("async recv: "+a.responseText,4),this.ensureResponseXML(a),this._handleInitialResponse(a))},this);"undefined"!=typeof this._req[c].r.onerror&&(this._req[c].r.onerror=l.bind(function(a){this.oDbg.log("XmlHttpRequest error",1)},this));this._req[c].r.send(a)};d.prototype.connected=
function(){return this._connected};d.prototype.disconnect=function(){this._setStatus("disconnecting");if(this.connected()){this._connected=!1;clearInterval(this._interval);clearInterval(this._inQto);this._timeout&&clearTimeout(this._timeout);var a=this._getFreeSlot();this._req[a]=this._setupRequest(!1);var b=this._getRequestString(!1,!0);this.oDbg.log("Disconnecting: "+b,4);try{this._req[a].r.send(b)}catch(c){}this.oDbg.log("disconnected");try{q.read(this._cookie_prefix+"JSJaC_State").erase()}catch(c){}this._handleEvent("ondisconnect")}};
d.prototype.getPollInterval=function(){return this._timerval};d.prototype.registerHandler=function(a){a=a.toLowerCase();var b={handler:arguments[arguments.length-1],childName:"*",childNS:"*",type:"*"};2<arguments.length&&(b.childName=arguments[1]);3<arguments.length&&(b.childNS=arguments[2]);4<arguments.length&&(b.type=arguments[3]);this._events[a]=this._events[a]?this._events[a].concat(b):Array(b);this._events[a]=this._events[a].sort(function(a,b){var d=0,e=0;"*"==a.type&&d++;"*"==a.childNS&&d++;
"*"==a.childName&&d++;"*"==b.type&&e++;"*"==b.childNS&&e++;"*"==b.childName&&e++;return d>e?1:d<e?-1:0});this.oDbg.log("registered handler for event '"+a+"'",2)};d.prototype.unregisterHandler=function(a,b){a=a.toLowerCase();if(this._events[a]){for(var c=this._events[a],h=[],d=0;d<c.length;d++)c[d].handler!=b&&h.push(c[d]);c.length!=h.length&&(this._events[a]=h,this.oDbg.log("unregistered handler for event '"+a+"'",2))}};d.prototype.registerIQGet=function(a,b,c){this.registerHandler("iq",a,b,"get",
c)};d.prototype.registerIQSet=function(a,b,c){this.registerHandler("iq",a,b,"set",c)};d.prototype.resume=function(){try{var a=q.read(this._cookie_prefix+"JSJaC_State").getValue();this.oDbg.log("read cookie: "+a,2);q.read(this._cookie_prefix+"JSJaC_State").erase();return this.resumeFromData(G.parse(a))}catch(b){}return!1};d.prototype.resumeFromData=function(a){try{this._setStatus("resuming");for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);if(this._keys){this._keys2=new r;var c=this._keys2._getSuspendVars();
for(a=0;a<c.length;a++)this._keys2[c[a]]=this._keys[c[a]];this._keys=this._keys2}this._connected&&(this._handleEvent("onresume"),setTimeout(l.bind(this._resume,this),this.getPollInterval()),this._interval=setInterval(l.bind(this._checkQueue,this),k.JSJAC_CHECKQUEUEINTERVAL),this._inQto=setInterval(l.bind(this._checkInQ,this),k.JSJAC_CHECKINQUEUEINTERVAL));return!0===this._connected}catch(h){return h.message?this.oDbg.log("Resume failed: "+h.message,1):this.oDbg.log("Resume failed: "+h,1),!1}};d.prototype.send=
function(a,b,c){if(!a||!a.pType)return this.oDbg.log("no packet: "+a,1),!1;if(!this.connected())return!1;b&&(a.getID()||a.setID("JSJaCID_"+this._ID++),this._registerPID(a.getID(),b,c));this._pQueue=this._pQueue.concat(a.xml());this._handleEvent(a.pType()+"_out",a);this._handleEvent("packet_out",a);return!0};d.prototype.sendIQ=function(a,b,c){if(!a||"iq"!=a.pType())return!1;b=b||{};var h=b.error_handler||l.bind(function(a){this.oDbg.log(a.xml(),1)},this),d=b.result_handler||l.bind(function(a){this.oDbg.log(a.xml(),
2)},this);return this.send(a,function(a,b){switch(a.getType()){case "error":h(a);break;case "result":d(a,b)}},c)};d.prototype.setPollInterval=function(a){a&&!isNaN(a)&&(this._timerval=a);return this._timerval};d.prototype.status=function(){return this._status};d.prototype.suspend=function(){var a=this.suspendToData();try{var b=new q(this._cookie_prefix+"JSJaC_State",G.toString(a));this.oDbg.log("writing cookie: "+b.getValue()+"\n(length:"+b.getValue().length+")",2);b.write();var c=q.get(this._cookie_prefix+
"JSJaC_State");return b.getValue()!=c?(this.oDbg.log("Suspend failed writing cookie.\nread: "+c,1),b.erase(),!1):!0}catch(h){this.oDbg.log("Failed creating cookie '"+this._cookie_prefix+"JSJaC_State': "+h.message,1)}return!1};d.prototype.suspendToData=function(){clearTimeout(this._timeout);clearInterval(this._interval);clearInterval(this._inQto);this._suspend();for(var a="_connected _keys _ID _xmllang _inQ _pQueue _regIDs _errcnt _inactivity domain username resource jid fulljid _sid _httpbase _timerval _is_polling".split(" "),
a=a.concat(this._getSuspendVars()),b={},c=0;c<a.length;c++)if(this[a[c]]){var h={};if(this[a[c]]._getSuspendVars)for(var d=this[a[c]]._getSuspendVars(),e=0;e<d.length;e++)h[d[e]]=this[a[c]][d[e]];else h=this[a[c]];b[a[c]]=h}this._connected=!1;this._setStatus("suspending");return b};d.prototype._abort=function(){clearTimeout(this._timeout);clearInterval(this._inQto);clearInterval(this._interval);this._connected=!1;this._setStatus("aborted");this.oDbg.log("Disconnected.",1);this._handleEvent("ondisconnect");
this._handleEvent("onerror",n("500","cancel","service-unavailable"))};d.prototype._checkInQ=function(){for(var a=0;a<this._inQ.length&&10>a;a++){var b=this._inQ[0];this._inQ=this._inQ.slice(1,this._inQ.length);b=m.wrapNode(b);if(!b)break;this._handleEvent("packet_in",b);b.pType&&!this._handlePID(b)&&(this._handleEvent(b.pType()+"_in",b),this._handleEvent(b.pType(),b))}};d.prototype._checkQueue=function(){0<this._pQueue.length&&this._process();return!0};d.prototype._doAuth=function(){this.has_sasl&&
"nonsasl"==this.authtype&&this.oDbg.log("Warning: SASL present but not used",1);return this._doSASLAuth()||this._doLegacyAuth()?!0:(this.oDbg.log("Auth failed for authtype "+this.authtype,1),this.disconnect(),!1)};d.prototype._doInBandReg=function(){if("saslanon"!=this.authtype&&"anonymous"!=this.authtype){var a=new z;a.setType("set");a.setID("reg1");a.appendNode("query",{xmlns:O},[["username",this.username],["password",this.pass]]);this.send(a,this._doInBandRegDone)}};d.prototype._doInBandRegDone=
function(a){a&&"error"==a.getType()?(this.oDbg.log("registration failed for "+this.username,0),this._handleEvent("onerror",a.getChild("error"))):(this.oDbg.log(this.username+" registered succesfully",0),this._doAuth())};d.prototype._doLegacyAuth=function(){if("nonsasl"!=this.authtype&&"anonymous"!=this.authtype)return!1;var a=new z;a.setIQ(null,"get","auth1");a.appendNode("query",{xmlns:H},[["username",this.username]]);this.send(a,this._doLegacyAuth2);return!0};d.prototype._doLegacyAuth2=function(a){if(a&&
"result"==a.getType()){a=null!==a.getChild("digest");var b=new z;b.setIQ(null,"set","auth2");var c=b.appendNode("query",{xmlns:H},[["username",this.username],["resource",this.resource]]);if(a)c.appendChild(b.buildNode("digest",{xmlns:H},A.hex_sha1(this.streamid+this.pass)));else if(this._allow_plain)c.appendChild(b.buildNode("password",{xmlns:H},this.pass));else{this.oDbg.log("no valid login mechanism found",1);this.disconnect();return}this.send(b,this._doLegacyAuthDone)}else a&&"error"==a.getType()&&
this._handleEvent("onerror",a.getChild("error")),this.disconnect()};d.prototype._doLegacyAuthDone=function(a){"result"!=a.getType()?("error"==a.getType()&&this._handleEvent("onerror",a.getChild("error")),this.disconnect()):this._handleEvent("onconnect")};d.prototype._doSASLAuth=function(){if("nonsasl"==this.authtype||"anonymous"==this.authtype)return!1;if("saslanon"==this.authtype){if(this.mechs.ANONYMOUS)return this.oDbg.log("SASL using mechanism 'ANONYMOUS'",2),this._sendRaw("\x3cauth xmlns\x3d'urn:ietf:params:xml:ns:xmpp-sasl' mechanism\x3d'ANONYMOUS'/\x3e",
this._doSASLAuthDone);this.oDbg.log("SASL ANONYMOUS requested but not supported",1)}else if("x-facebook-platform"==this.authtype){if(this.mechs["X-FACEBOOK-PLATFORM"])return this._sendRaw("\x3cauth xmlns\x3d'urn:ietf:params:xml:ns:xmpp-sasl' mechanism\x3d'X-FACEBOOK-PLATFORM' /\x3e",this._doFacebookAuth);this.oDbg.log("X-FACEBOOK-PLATFORM requested but not supported",1)}else{if(this.mechs["DIGEST-MD5"])return this.oDbg.log("SASL using mechanism 'DIGEST-MD5'",2),this._sendRaw("\x3cauth xmlns\x3d'urn:ietf:params:xml:ns:xmpp-sasl' mechanism\x3d'DIGEST-MD5'/\x3e",
this._doSASLAuthDigestMd5S1);if(this._allow_plain&&this.mechs.PLAIN){this.oDbg.log("SASL using mechanism 'PLAIN'",2);var a=this.username+"@"+this.domain+String.fromCharCode(0)+this.username+String.fromCharCode(0)+this.pass;this.oDbg.log("authenticating with '"+a+"'",2);a=A.b64encode(a);return this._sendRaw("\x3cauth xmlns\x3d'urn:ietf:params:xml:ns:xmpp-sasl' mechanism\x3d'PLAIN'\x3e"+a+"\x3c/auth\x3e",this._doSASLAuthDone)}this.oDbg.log("No SASL mechanism applied",1);this.authtype="nonsasl"}return!1};
d.prototype._doSASLAuthDigestMd5S1=function(a){if("challenge"!=a.nodeName)this.oDbg.log("challenge missing",1),this._handleEvent("onerror",n("401","auth","not-authorized")),this.disconnect();else if(a=A.b64decode(a.firstChild.nodeValue),this.oDbg.log("got challenge: "+a,2),this._nonce=a.substring(a.indexOf("nonce\x3d")+7),this._nonce=this._nonce.substring(0,this._nonce.indexOf('"')),this.oDbg.log("nonce: "+this._nonce,2),""===this._nonce||-1!=this._nonce.indexOf('"'))this.oDbg.log("nonce not valid, aborting",
1),this.disconnect();else{this._digest_uri="xmpp/";this._digest_uri+=this.domain;this._cnonce=cnonce(14);this._nc="00000001";a=str_md5(this.username+":"+this.domain+":"+this.pass)+":"+this._nonce+":"+this._cnonce;var b="AUTHENTICATE:"+this._digest_uri;a=hex_md5(hex_md5(a)+":"+this._nonce+":"+this._nc+":"+this._cnonce+":auth:"+hex_md5(b));a='username\x3d"'+this.username+'",realm\x3d"'+this.domain+'",nonce\x3d"'+this._nonce+'",cnonce\x3d"'+this._cnonce+'",nc\x3d"'+this._nc+'",qop\x3dauth,digest-uri\x3d"'+
this._digest_uri+'",response\x3d"'+a+'",charset\x3d"utf-8"';this.oDbg.log("response: "+a,2);this._sendRaw("\x3cresponse xmlns\x3d'urn:ietf:params:xml:ns:xmpp-sasl'\x3e"+binb2b64(str2binb(a))+"\x3c/response\x3e",this._doSASLAuthDigestMd5S2)}};d.prototype._doSASLAuthDigestMd5S2=function(a){if("failure"==a.nodeName)a.xml?this.oDbg.log("auth error: "+a.xml,1):this.oDbg.log("auth error",1),this._handleEvent("onerror",n("401","auth","not-authorized")),this.disconnect();else{var b=A.b64decode(a.firstChild.nodeValue);
this.oDbg.log("response: "+b,2);b=b.substring(b.indexOf("rspauth\x3d")+8);this.oDbg.log("rspauth: "+b,2);var c=str_md5(this.username+":"+this.domain+":"+this.pass)+":"+this._nonce+":"+this._cnonce,h=":"+this._digest_uri,c=hex_md5(hex_md5(c)+":"+this._nonce+":"+this._nc+":"+this._cnonce+":auth:"+hex_md5(h));this.oDbg.log("rsptest: "+c,2);c!=b?(this.oDbg.log("SASL Digest-MD5: server repsonse with wrong rspauth",1),this.disconnect()):"success"==a.nodeName?this._reInitStream(l.bind(this._doStreamBind,
this)):this._sendRaw("\x3cresponse xmlns\x3d'urn:ietf:params:xml:ns:xmpp-sasl'/\x3e",this._doSASLAuthDone)}};d.prototype._doSASLAuthDone=function(a){"success"!=a.nodeName?(this.oDbg.log("auth failed",1),this._handleEvent("onerror",n("401","auth","not-authorized")),this.disconnect()):this._reInitStream(l.bind(this._doStreamBind,this))};d.prototype._doFacebookAuth=function(a){if("challenge"!=a.nodeName)this.oDbg.log("challenge missing",1);else{a=A.b64decode(a.firstChild.nodeValue);this.oDbg.log("got challenge: "+
a,2);var b=a.split("\x26");a=[];for(var c=0;c<b.length;c++){var h=b[c].split("\x3d");a[h[0]]=h[1]}if(""!=a.nonce)return b=this._facebookApp.getSession(),a={api_key:this._facebookApp.getApiKey(),call_id:(new Date).getTime(),method:a.method,nonce:a.nonce,session_key:b.session_key,v:"1.0"},a.sig="api_key\x3d"+a.api_key+"call_id\x3d"+a.call_id+"method\x3d"+a.method+"nonce\x3d"+a.nonce+"session_key\x3d"+a.session_key+"v\x3d"+a.v,a.sig=hex_md5(a.sig+this._facebookApp.getApiSecret()),a="api_key\x3d"+a.api_key+
"\x26call_id\x3d"+a.call_id+"\x26method\x3d"+a.method+"\x26nonce\x3d"+a.nonce+"\x26session_key\x3d"+a.session_key+"\x26v\x3d"+a.v+"\x26sig\x3d"+a.sig,a=A.b64encode(a),this._sendRaw("\x3cresponse xmlns\x3d'urn:ietf:params:xml:ns:xmpp-sasl'\x3e"+a+"\x3c/response\x3e",this._doFacebookAuthDone);this.oDbg.log("nonce missing",1)}this._handleEvent("onerror",n("401","auth","not-authorized"));this.disconnect()};d.prototype._doFacebookAuthDone=function(a){"success"!=a.nodeName?(this.oDbg.log("auth failed",
1),this._handleEvent("onerror",n("401","auth","not-authorized")),this.disconnect()):this._reInitStream(l.bind(this._doStreamBind,this))};d.prototype._doStreamBind=function(){var a=new z;a.setIQ(null,"set","bind_1");a.appendNode("bind",{xmlns:I},[["resource",this.resource]]);this.oDbg.log(a.xml());this.send(a,this._doXMPPSess)};d.prototype._doXMPPSess=function(a){"result"!=a.getType()||"error"==a.getType()?(this.disconnect(),"error"==a.getType()&&this._handleEvent("onerror",a.getChild("error"))):(this.fulljid=
a.getChildVal("jid"),this.jid=this.fulljid.substring(0,this.fulljid.lastIndexOf("/")),this._stopTimer("doStreamBind"),this._handleEvent("onconnect"),a=new z,a.setIQ(null,"set","sess_1"),a.appendNode("session",{xmlns:P},[]),this.oDbg.log(a.xml()),this.send(a,this._doXMPPSessDone))};d.prototype._doXMPPSessDone=function(a){if("result"!=a.getType()||"error"==a.getType())this.disconnect(),"error"==a.getType()&&this._handleEvent("onerror",a.getChild("error"))};d.prototype._handleEvent=function(a,b){a=a.toLowerCase();
this.oDbg.log("incoming event '"+a+"'",3);if(this._events[a]){this.oDbg.log("handling event '"+a+"'",2);for(var c=0;c<this._events[a].length;c++){var h=this._events[a][c];if("function"==typeof h.handler)try{if(b){if(b.pType){if(!b.getNode().hasChildNodes()&&"*"!=h.childName||b.getNode().hasChildNodes()&&!b.getChild(h.childName,h.childNS))continue;if("*"!=h.type&&b.getType()!=h.type)continue;this.oDbg.log(h.childName+"/"+h.childNS+"/"+h.type+" \x3d\x3e match for handler "+h.handler,3)}if(h.handler(b))break}else if(h.handler())break}catch(d){d.fileName&&
d.lineNumber?this.oDbg.log(h.handler+"\n\x3e\x3e\x3e"+d.name+": "+d.message+" in "+d.fileName+" line "+d.lineNumber,1):this.oDbg.log(h.handler+"\n\x3e\x3e\x3e"+d.name+": "+d.message,1)}}}};d.prototype._handlePID=function(a){if(!a.getID())return!1;for(var b in this._regIDs)if(this._regIDs.hasOwnProperty(b)&&this._regIDs[b]&&b==a.getID()){var c=a.getID();this.oDbg.log("handling "+c,3);if(!1===this._regIDs[b].cb.call(this,a,this._regIDs[b].arg))break;else return this._unregisterPID(c),!0}return!1};d.prototype._handleResponse=
function(a){if(a=this._parseResponse(a))for(var b=0;b<a.childNodes.length;b++)if(this._sendRawCallbacks.length){var c=this._sendRawCallbacks[0];this._sendRawCallbacks=this._sendRawCallbacks.slice(1,this._sendRawCallbacks.length);c.fn.call(this,a.childNodes.item(b),c.arg)}else this._inQ=this._inQ.concat(a.childNodes.item(b))};d.prototype._parseStreamFeatures=function(a){if(!a)return this.oDbg.log("nothing to parse ... aborting",1),!1;var b;if(a.getElementsByTagNameNS)b=a.getElementsByTagNameNS(E,"error").item(0);
else for(var c=a.getElementsByTagName("error"),d=0;d<c.length;d++)if(c.item(d).namespaceURI==E||c.item(d).getAttribute("xmlns")==E){b=c.item(d);break}if(b)return this._setStatus("internal_server_error"),clearTimeout(this._timeout),clearInterval(this._interval),clearInterval(this._inQto),this._handleEvent("onerror",n("503","cancel","session-terminate")),this._connected=!1,this.oDbg.log("Disconnected.",1),this._handleEvent("ondisconnect"),!1;if(d=a.getElementsByTagName("amazon")[0]){if(b=d.getElementsByTagName("serverIP")[0])this._serverIP=
b.firstChild.nodeValue;if(d=d.getElementsByTagName("serverName")[0])this._serverName=d.firstChild.nodeValue}this.mechs={};a=a.getElementsByTagName("mechanisms");if(!a.length)return!1;this.has_sasl=!1;for(d=0;d<a.length;d++)if(a.item(d).getAttribute("xmlns")==Q){this.has_sasl=!0;a=a.item(d).getElementsByTagName("mechanism");for(d=0;d<a.length;d++)this.mechs[a.item(d).firstChild.nodeValue]=!0;break}this.has_sasl?this.oDbg.log("SASL detected",2):this.oDbg.log("No support for SASL detected",2);return!0};
d.prototype._process=function(a){if(this.connected()){this.setPollInterval(a);this._timeout&&clearTimeout(this._timeout);var b=this._getFreeSlot();if(!(0>b))if("undefined"!=typeof this._req[b]&&"undefined"!=typeof this._req[b].r&&4!=this._req[b].r.readyState)this.oDbg.log("Slot "+b+" is not ready");else if(!this.isPolling()&&0===this._pQueue.length&&this._req[(b+1)%2]&&4!=this._req[(b+1)%2].r.readyState)this.oDbg.log("all slots busy, standby ...",2);else{this.isPolling()||this.oDbg.log("Found working slot at "+
b,2);this._req[b]=this._setupRequest(!0);this._req[b].r.onreadystatechange=l.bind(function(){this.connected()&&4==this._req[b].r.readyState&&(this._setStatus("processing"),this.oDbg.log("async recv: "+this._req[b].r.responseText,4),this.ensureResponseXML(this._req[b].r),this._handleResponse(this._req[b]),this._pQueue.length?this._timeout=setTimeout(l.bind(this._process,this),100):(this.oDbg.log("scheduling next poll in "+this.getPollInterval()+" msec",4),this._timeout=setTimeout(l.bind(this._process,
this),this.getPollInterval())))},this);try{this._req[b].r.onerror=l.bind(function(){this.connected()&&(this._errcnt++,this.oDbg.log("XmlHttpRequest error ("+this._errcnt+")",1),this._errcnt>k.JSJAC_ERR_COUNT?this._abort():(this._setStatus("onerror_fallback"),setTimeout(l.bind(this._resume,this),k.JSJAC_RETRYDELAY)))},this)}catch(c){}a=this._getRequestString();"undefined"!=typeof this._rid&&(this._req[b].rid=this._rid);this.oDbg.log("sending: "+a,4);this._req[b].r.send(a)}}else this.oDbg.log("Connection lost ...",
1),this._interval&&clearInterval(this._interval)};d.prototype._registerPID=function(a,b,c){if(!a||!b)return!1;this._regIDs[a]={};this._regIDs[a].cb=b;c&&(this._regIDs[a].arg=c);this.oDbg.log("registered "+a,3);return!0};d.prototype._prepSendEmpty=function(a,b){return function(){b._sendEmpty(l.bind(a,b))}};d.prototype._sendEmpty=function(a){var b=this._getFreeSlot();this._req[b]=this._setupRequest(!0);this._req[b].r.onreadystatechange=l.bind(function(){4==this._req[b].r.readyState&&(this.oDbg.log("async recv: "+
this._req[b].r.responseText,4),this.ensureResponseXML(this._req[b].r),a(this._req[b].r))},this);"undefined"!=typeof this._req[b].r.onerror&&(this._req[b].r.onerror=l.bind(function(a){this.oDbg.log("XmlHttpRequest error",1)},this));var c=this._getRequestString();this.oDbg.log("sending: "+c,4);this._req[b].r.send(c)};d.prototype._sendRaw=function(a,b,c){b&&this._sendRawCallbacks.push({fn:b,arg:c});this._pQueue.push(a);this._process();return!0};d.prototype._setStatus=function(a){a&&""!==a&&a!=this._status&&
(this._status=a,this._handleEvent("onstatuschanged",a),this._handleEvent("status_changed",a))};d.prototype._unregisterPID=function(a){if(!this._regIDs[a])return!1;this._regIDs[a]=null;this.oDbg.log("unregistered "+a,3);return!0};d.prototype.getLatencyRecords=function(a){var b=this._latencyRecords;a&&(this._latencyRecords={});return b};d.prototype._startTimer=function(a){this._latencyRecords[a]={start:+new Date}};d.prototype._stopTimer=function(a,b){(a=this._latencyRecords[a])&&a.start&&!a.end&&(a.end=
+new Date,a.isFailed=!!b)};var H="jabber:iq:auth",O="jabber:iq:register",E="http://etherx.jabber.org/streams",N="jabber:client",L="urn:ietf:params:xml:ns:xmpp-stanzas",Q="urn:ietf:params:xml:ns:xmpp-sasl",P="urn:ietf:params:xml:ns:xmpp-session",I="urn:ietf:params:xml:ns:xmpp-bind";g("400","modify","bad-request");g("409","cancel","conflict");g("501","cancel","feature-not-implemented");g("403","auth","forbidden");g("302","modify","gone");g("500","wait","internal-server-error");g("404","cancel","item-not-found");
g("400","modify","jid-malformed");g("406","modify","not-acceptable");g("405","cancel","not-allowed");g("401","auth","not-authorized");g("402","auth","payment-required");g("404","wait","recipient-unavailable");g("302","modify","redirect");g("407","auth","registration-required");g("404","cancel","remote-server-not-found");g("504","wait","remote-server-timeout");g("500","wait","resource-constraint");g("503","cancel","service-unavailable");g("407","auth","subscription-required");g("400","wait","unexpected-request");
q.read=function(a){for(var b=a+"\x3d",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "==e.charAt(0);)e=e.substring(1,e.length);if(0==e.indexOf(b))return new q(a,q._unescape(e.substring(b.length,e.length)))}throw new M("Cookie not found");};q.get=function(a){return q.read(a).getValue()};q.remove=function(a){q.read(a).erase()};q._escape=function(a){return a.replace(/;/g,"%3AB")};q._unescape=function(a){return a.replace(/%3AB/g,";")};F.prototype.Login=function(a,b){var c=this;FB.init({appId:this._appID,
status:!0});FB.login(function(d){d.session&&d.perms&&(c._perms=d.perms,c._session=d.session,a.connect(b))},{perms:"xmpp_login"})};F.prototype.getAppID=function(){return this._appID};F.prototype.getApiKey=function(){return this._apiKey};F.prototype.getApiSecret=function(){return this._apiSecret};F.prototype.getSession=function(){return this._session};u.prototype=new d;u.prototype.inherit=function(a){if(a.jid){var b=new v(a.jid);this.domain=b.getDomain();this.username=b.getNode();this.resource=b.getResource()}else this.domain=
a.domain||"localhost",this.username=a.username,this.resource=a.resource;this._sid=a.sid;this._rid=a.rid;this._min_polling=a.polling;this._inactivity=a.inactivity;this._setHold(a.requests-1);this.setPollInterval(this._timerval);a.wait&&(this._wait=a.wait);this._connected=!0;this._handleEvent("onconnect");this._interval=setInterval(l.bind(this._checkQueue,this),k.JSJAC_CHECKQUEUEINTERVAL);this._inQto=setInterval(l.bind(this._checkInQ,this),k.JSJAC_CHECKINQUEUEINTERVAL);this._timeout=setTimeout(l.bind(this._process,
this),this.getPollInterval())};u.prototype.setPollInterval=function(a){a&&!isNaN(a)&&(this.isPolling()?this._timerval=this._min_polling&&a<1E3*this._min_polling?1E3*this._min_polling:this._inactivity&&a>1E3*this._inactivity?1E3*this._inactivity:a:this._timerval=100);return this._timerval};u.prototype.isPolling=function(){return 0===this._hold};u.prototype._getFreeSlot=function(){for(var a=0;a<this._hold+1;a++)if("undefined"==typeof this._req[a]||"undefined"==typeof this._req[a].r||4==this._req[a].r.readyState)return a;
return-1};u.prototype._getHold=function(){return this._hold};u.prototype._getRequestString=function(a,b){a=a||"";var c;if(this._rid<=this._last_rid&&"undefined"!=typeof this._last_requests[this._rid])c=this._last_requests[this._rid].xml;else{for(var d="";this._pQueue.length;)d+=this._pQueue[0],this._pQueue=this._pQueue.slice(1,this._pQueue.length);c="\x3cbody rid\x3d'"+this._rid+"' sid\x3d'"+this._sid+"' xmlns\x3d'http://jabber.org/protocol/httpbind' ";k.JSJAC_HAVEKEYS&&(c+="key\x3d'"+this._keys.getKey()+
"' ",this._keys.lastKey()&&(this._keys=new r(A.hex_sha1,this.oDbg),c+="newkey\x3d'"+this._keys.getKey()+"' "));b?c+="type\x3d'terminate'":this._reinit&&(k.JSJACHBC_USE_BOSH_VER&&(c+="xml:lang\x3d'"+this._xmllang+"' xmpp:restart\x3d'true' xmlns:xmpp\x3d'urn:xmpp:xbosh' to\x3d'"+this.domain+"'"),this._reinit=!1);c=""!=d||""!=a?c+("\x3e"+a+d+"\x3c/body\x3e"):c+"\x3e \x3c/body\x3e";this._last_requests[this._rid]={};this._last_requests[this._rid].xml=c;this._last_rid=this._rid;for(var e in this._last_requests)this._last_requests.hasOwnProperty(e)&&
e<this._rid-this._hold&&delete this._last_requests[e]}return c};u.prototype._getInitialRequestString=function(){var a="\x3cbody content\x3d'text/xml; charset\x3dutf-8' hold\x3d'"+this._hold+"' xmlns\x3d'http://jabber.org/protocol/httpbind' to\x3d'"+this.authhost+"' wait\x3d'"+this._wait+"' rid\x3d'"+this._rid+"'";this.host&&this.port&&(a+=" route\x3d'xmpp:"+this.host+":"+this.port+"'");this.secure&&(a+=" secure\x3d'"+this.secure+"'");if(k.JSJAC_HAVEKEYS){this._keys=new r(A.hex_sha1,this.oDbg);var b=
this._keys.getKey(),a=a+(" newkey\x3d'"+b+"'")}a+=" xml:lang\x3d'"+this._xmllang+"'";k.JSJACHBC_USE_BOSH_VER&&(a+=" ver\x3d'"+k.JSJACHBC_BOSH_VERSION+"'",a+=" xmlns:xmpp\x3d'urn:xmpp:xbosh'","sasl"==this.authtype||"saslanon"==this.authtype||"x-facebook-platform"==this.authtype)&&(a+=" xmpp:version\x3d'1.0'");return a+"/\x3e"};u.prototype._getStreamID=function(a){this.oDbg.log(a.responseText,4);a.responseXML&&a.responseXML.documentElement?(a=a.responseXML.documentElement,"terminate"==a.getAttribute("type")?
this._handleEvent("onerror",n("503","cancel","service-unavailable-JSJacHttpBindingConnection-Terminated")):(a.getAttribute("authid")&&(this.streamid=a.getAttribute("authid"),this.oDbg.log("got streamid: "+this.streamid,2)),this._parseStreamFeatures(a)?(this._timeout=setTimeout(l.bind(this._process,this),this.getPollInterval()),this.register?this._doInBandReg():this._doAuth()):this._sendEmpty(l.bind(this._getStreamID,this)))):this._handleEvent("onerror",n("503","cancel","service-unavailable-JSJacHttpBindingConnection-NoResponseXMLOrDocument"))};
u.prototype._getSuspendVars=function(){return"host port secure _rid _last_rid _wait _min_polling _inactivity _hold _last_requests _pause".split(" ")};u.prototype._handleInitialResponse=function(a){try{this.oDbg.log(a.getAllResponseHeaders(),4),this.oDbg.log(a.responseText,4)}catch(c){this.oDbg.log("No response",4)}if(200==a.status&&a.responseXML){var b=a.responseXML.documentElement;b&&"body"==b.tagName&&"http://jabber.org/protocol/httpbind"==b.namespaceURI?"terminate"==b.getAttribute("type")?(this.oDbg.log("invalid response:\n"+
a.responseText,1),clearTimeout(this._timeout),this._connected=!1,this.oDbg.log("Disconnected.",1),this._handleEvent("ondisconnect"),this._handleEvent("onerror",n("503","cancel","service-unavailable-JSJaCHttpBindingConnection-Type-Terminate"))):(this._sid=b.getAttribute("sid"),this.oDbg.log("got sid: "+this._sid,2),b.getAttribute("polling")&&(this._min_polling=b.getAttribute("polling")),b.getAttribute("inactivity")&&(this._inactivity=b.getAttribute("inactivity")),b.getAttribute("requests")&&this._setHold(b.getAttribute("requests")-
1),this.oDbg.log("set hold to "+this._getHold(),2),b.getAttribute("ver")&&(this._bosh_version=b.getAttribute("ver")),b.getAttribute("maxpause")&&(this._pause=Number.min(b.getAttribute("maxpause"),k.JSJACHBC_MAXPAUSE)),this.setPollInterval(this._timerval),this._connected=!0,this._inQto=setInterval(l.bind(this._checkInQ,this),k.JSJAC_CHECKINQUEUEINTERVAL),this._interval=setInterval(l.bind(this._checkQueue,this),k.JSJAC_CHECKQUEUEINTERVAL),this._getStreamID(a)):(this.oDbg.log("no body element or incorrect body in initial response",
1),this._handleEvent("onerror",n("500","wait","internal-service-error")))}else this.oDbg.log("initial response broken (status: "+a.status+")",1),this._handleEvent("onerror",n("503","cancel","service-unavailable-JSJaCHttpBindingConnection-HandleInitialResponse-Error"))};u.prototype._parseResponse=function(a){if(!this.connected()||!a)return null;var b=a.r;try{if(404==b.status||403==b.status)return this._abort(),null;if(200!=b.status||!b.responseXML){this._errcnt++;var c="invalid response ("+b.status+
"):\n"+b.getAllResponseHeaders()+"\n"+b.responseText;b.responseXML||(c+="\nResponse failed to parse!");this.oDbg.log(c,1);if(this._errcnt>k.JSJAC_ERR_COUNT)return this._abort(),null;this.connected()&&(this.oDbg.log("repeating ("+this._errcnt+")",1),this._setStatus("proto_error_fallback"),setTimeout(l.bind(this._resume,this),this.getPollInterval()));return null}}catch(d){return this.oDbg.log("XMLHttpRequest error: status not available",1),this._errcnt++,this._errcnt>k.JSJAC_ERR_COUNT?this._abort():
this.connected()&&(this.oDbg.log("repeating ("+this._errcnt+")",1),this._setStatus("proto_error_fallback"),setTimeout(l.bind(this._resume,this),this.getPollInterval())),null}c=b.responseXML.documentElement;if(!c||"body"!=c.tagName||"http://jabber.org/protocol/httpbind"!=c.namespaceURI)return this.oDbg.log("invalid response:\n"+b.responseText,1),clearTimeout(this._timeout),clearInterval(this._interval),clearInterval(this._inQto),this._connected=!1,this.oDbg.log("Disconnected.",1),this._handleEvent("ondisconnect"),
this._setStatus("internal_server_error"),this._handleEvent("onerror",n("500","wait","internal-server-error")),null;if("undefined"!=typeof a.rid&&this._last_requests[a.rid]){if(this._last_requests[a.rid].handled)return this.oDbg.log("already handled "+a.rid,2),null;this._last_requests[a.rid].handled=!0}if("terminate"==c.getAttribute("type")){a=c.getAttribute("condition");if("item-not-found"!=a){this.oDbg.log("session terminated:\n"+b.responseText,1);clearTimeout(this._timeout);clearInterval(this._interval);
clearInterval(this._inQto);try{q.read(this._cookie_prefix+"JSJaC_State").erase()}catch(d){}this._connected=!1;a=c.getAttribute("condition");"remote-stream-error"==a&&0<c.getElementsByTagName("conflict").length&&this._setStatus("session-terminate-conflict");null==a&&(a="session-terminate");this._handleEvent("onerror",n("503","cancel",a,c.children));this.oDbg.log("Aborting remaining connections",4);for(b=0;b<this._hold+1;b++)try{this._req[b].r.abort()}catch(d){this.oDbg.log(d,1)}this.oDbg.log("parseResponse done with terminating",
3);this.oDbg.log("Disconnected.",1);this._handleEvent("ondisconnect")}else this._errcnt++,this._errcnt>k.JSJAC_ERR_COUNT&&this._abort();return null}this._errcnt=0;return b.responseXML.documentElement};u.prototype._reInitStream=function(a){this._reinit=!0;this._sendEmpty(this._prepReInitStreamWait(a))};u.prototype._prepReInitStreamWait=function(a){return l.bind(function(b){this._reInitStreamWait(b,a)},this)};u.prototype._reInitStreamWait=function(a,b){this.oDbg.log("checking for stream features");
if(a.responseXML&&a.responseXML.documentElement){a=a.responseXML.documentElement;var c,d;this.oDbg.log(a);if(a.getElementsByTagNameNS)this.oDbg.log("checking with namespace"),(c=a.getElementsByTagNameNS(E,"features").item(0))&&(d=c.getElementsByTagNameNS(I,"bind").item(0));else{a=a.getElementsByTagName("stream:features");var e,f;e=0;for(f=a.length;e<f;e++)if(a.item(e).namespaceURI==E||a.item(e).getAttribute("xmlns")==E){c=a.item(e);break}if(c)for(d=c.getElementsByTagName("bind"),e=0,f=d.length;e<
f;e++)if(d.item(e).namespaceURI==I||d.item(e).getAttribute("xmlns")==I){d=d.item(e);break}}this.oDbg.log(c);this.oDbg.log(d);c?d?b():(this.oDbg.log("no bind feature - giving up",1),this._handleEvent("onerror",n("503","cancel","service-unavailable-JSJaCHttpBindingConnection-ReInitStreamWait-NoBindTag")),this._connected=!1,this.oDbg.log("Disconnected.",1),this._handleEvent("ondisconnect")):this._sendEmpty(this._prepReInitStreamWait(b))}else this._handleEvent("onerror",n("503","cancel","service-unavailable-JSJaCHttpBindingConnection-ReInitStreamWait-NoResponse"))};
u.prototype._resume=function(){0==this._pause&&this._rid>=this._last_rid&&(this._rid=this._last_rid-1);this._process()};u.prototype._setHold=function(a){!a||isNaN(a)||0>a?a=0:a>k.JSJACHBC_MAX_HOLD&&(a=k.JSJACHBC_MAX_HOLD);return this._hold=a};u.prototype._setupRequest=function(a){var b={},c=e.create();try{c.open("POST",this._httpbase,a),c.setRequestHeader("Content-Type","text/xml; charset\x3dutf-8")}catch(d){this.oDbg.log(d,1)}b.r=c;this._rid++;b.rid=this._rid;return b};u.prototype._suspend=function(){if(0!=
this._pause){var a=this._getFreeSlot();this._req[a]=this._setupRequest(!1);var b="\x3cbody pause\x3d'"+this._pause+"' xmlns\x3d'http://jabber.org/protocol/httpbind' sid\x3d'"+this._sid+"' rid\x3d'"+this._rid+"'";k.JSJAC_HAVEKEYS&&(b+=" key\x3d'"+this._keys.getKey()+"'",this._keys.lastKey()&&(this._keys=new r(A.hex_sha1,this.oDbg),b+=" newkey\x3d'"+this._keys.getKey()+"'"));for(b+="\x3e";this._pQueue.length;)b+=this._pQueue[0],this._pQueue=this._pQueue.slice(1,this._pQueue.length);b+="\x3c/body\x3e";
this.oDbg.log("Disconnecting: "+b,4);this._req[a].r.send(b)}};w.prototype=new d;w.prototype.isPolling=function(){return!0};w.prototype._getFreeSlot=function(){return"undefined"==typeof this._req[0]||"undefined"==typeof this._req[0].r||4==this._req[0].r.readyState?0:-1};w.prototype._getInitialRequestString=function(){var a="0";if(k.JSJAC_HAVEKEYS){this._keys=new r(b64_sha1,this.oDbg);var b=this._keys.getKey(),a=a+(";"+b)}b=this.domain;this.authhost&&(b=this.authhost);a+=",\x3cstream:stream to\x3d'"+
b+"' xmlns\x3d'jabber:client' xmlns:stream\x3d'http://etherx.jabber.org/streams'";if("sasl"==this.authtype||"saslanon"==this.authtype)a+=" version\x3d'1.0'";return a+"\x3e"};w.prototype._getRequestString=function(a,b){var c=this._sid;k.JSJAC_HAVEKEYS&&(c+=";"+this._keys.getKey(),this._keys.lastKey()&&(this._keys=new r(b64_sha1,this.oDbg),c+=";"+this._keys.getKey()));c+=",";for(a&&(c+=a);this._pQueue.length;)c+=this._pQueue[0],this._pQueue=this._pQueue.slice(1,this._pQueue.length);b&&(c+="\x3c/stream:stream\x3e");
return c};w.prototype._getStreamID=function(){if(""==this._req[0].r.responseText)this.oDbg.log("waiting for stream id",2),this._timeout=setTimeout(l.bind(this._sendEmpty,this),1E3);else{this.oDbg.log(this._req[0].r.responseText,4);this._req[0].r.responseText.match(/id=[\'\"]([^\'\"]+)[\'\"]/)&&(this.streamid=RegExp.$1);this.oDbg.log("got streamid: "+this.streamid,2);var a;try{var b=this._req[0].r.responseText;b.match(/<\/stream:stream>\s*$/)||(b+="\x3c/stream:stream\x3e");a=f.create("doc");a.loadXML(b);
if(!this._parseStreamFeatures(a)){this.authtype="nonsasl";return}}catch(c){this.oDbg.log("loadXML: "+c.toString(),1)}this._connected=!0;this.register?this._doInBandReg():this._doAuth();this._process(this._timerval)}};w.prototype._getSuspendVars=function(){return[]};w.prototype._handleInitialResponse=function(){this.oDbg.log(this._req[0].r.getAllResponseHeaders(),4);for(var a=this._req[0].r.getResponseHeader("Set-Cookie"),a=a.split(";"),b=0;b<a.length;b++){var c=a[b].split("\x3d");"ID"==c[0]&&(this._sid=
c[1])}this.oDbg.log("got sid: "+this._sid,2);this._connected=!0;this._interval=setInterval(l.bind(this._checkQueue,this),k.JSJAC_CHECKQUEUEINTERVAL);this._inQto=setInterval(l.bind(this._checkInQ,this),k.JSJAC_CHECKINQUEUEINTERVAL);this._getStreamID()};w.prototype._parseResponse=function(a){a=a.r;if(!this.connected())return null;if(200!=a.status)return this.oDbg.log("invalid response ("+a.status+"):"+a.responseText+"\n"+a.getAllResponseHeaders(),1),this._setStatus("internal_server_error"),clearTimeout(this._timeout),
clearInterval(this._interval),clearInterval(this._inQto),this._connected=!1,this.oDbg.log("Disconnected.",1),this._handleEvent("ondisconnect"),this._handleEvent("onerror",n("503","cancel","service-unavailable-JSJacHttpPollingConnection-ParseResponse-InvalidResponse")),null;this.oDbg.log(a.getAllResponseHeaders(),4);var b,c=a.getResponseHeader("Set-Cookie");if(null==c)b="-1:0";else for(var c=c.split(";"),d=0;d<c.length;d++){var e=c[d].split("\x3d");"ID"==e[0]&&(b=e[1])}if("undefined"!=typeof b&&-1!=
b.indexOf(":0")){switch(b.substring(0,b.indexOf(":0"))){case "0":this.oDbg.log("invalid response:"+a.responseText,1);break;case "-1":this.oDbg.log("Internal Server Error",1);break;case "-2":this.oDbg.log("Bad Request",1);break;case "-3":this.oDbg.log("Key Sequence Error",1)}this._setStatus("internal_server_error");clearTimeout(this._timeout);clearInterval(this._interval);clearInterval(this._inQto);this._handleEvent("onerror",n("500","wait","internal-server-error"));this._connected=!1;this.oDbg.log("Disconnected.",
1);this._handleEvent("ondisconnect");return null}if(!a.responseText||""==a.responseText)return null;try{var f=a.responseText.replace(/\<\?xml.+\?\>/,"");f.match(/<stream:stream/)&&(f+="\x3c/stream:stream\x3e");var g=w._parseTree("\x3cbody\x3e"+f+"\x3c/body\x3e");g&&"parsererror"!=g.tagName||(this.oDbg.log("parsererror",1),(g=w._parseTree("\x3cstream:stream xmlns:stream\x3d'http://etherx.jabber.org/streams'\x3e"+a.responseText))&&"parsererror"!=g.tagName?(this.oDbg.log("stream closed",1),0<g.getElementsByTagName("conflict").length&&
this._setStatus("session-terminate-conflict"),clearTimeout(this._timeout),clearInterval(this._interval),clearInterval(this._inQto),this._handleEvent("onerror",n("503","cancel","session-terminate")),this._connected=!1,this.oDbg.log("Disconnected.",1),this._handleEvent("ondisconnect")):this.oDbg.log("parsererror:"+g,1));return g}catch(k){this.oDbg.log("parse error:"+k.message,1)}return null};w.prototype._reInitStream=function(a,b,c){this._sendRaw("\x3cstream:stream xmlns:stream\x3d'http://etherx.jabber.org/streams' xmlns\x3d'jabber:client' to\x3d'"+
a+"' version\x3d'1.0'\x3e",b,c)};w.prototype._resume=function(){this._process(this._timerval)};w.prototype._setupRequest=function(a){var b=e.create();try{b.open("POST",this._httpbase,a),b.overrideMimeType&&b.overrideMimeType("text/plain; charset\x3dutf-8"),b.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}catch(c){this.oDbg.log(c,1)}a={};a.r=b;return a};w.prototype._suspend=function(){};w._parseTree=function(a){try{var b=f.create("body","foo");if("undefined"!=typeof b.loadXML)return b.loadXML(a),
b.documentElement;if(p.DOMParser)return(new DOMParser).parseFromString(a,"text/xml").documentElement}catch(c){}return null};var K="\" \x26'/:\x3c\x3e@".split("");v.prototype.getBareJID=function(){return this.getNode()+"@"+this.getDomain()};v.prototype.getNode=function(){return this._node};v.prototype.getDomain=function(){return this._domain};v.prototype.getResource=function(){return this._resource};v.prototype.setNode=function(a){v._checkNodeName(a);this._node=a||"";return this};v.prototype.setDomain=
function(a){if(!a||""==a)throw new x("domain name missing");v._checkNodeName(a);this._domain=a;return this};v.prototype.setResource=function(a){this._resource=a||"";return this};v.prototype.toString=function(){var a="";this.getNode()&&""!=this.getNode()&&(a=this.getNode()+"@");a+=this.getDomain();this.getResource()&&""!=this.getResource()&&(a+="/"+this.getResource());return a};v.prototype.removeResource=function(){return this.setResource()};v.prototype.clone=function(){return new v(this.toString())};
v.prototype.isEntity=function(a){"string"==typeof a&&(a=new v(a));a.removeResource();return this.clone().removeResource().toString()===a.toString()};v._checkNodeName=function(a){if(a&&""!=a)for(var b=0;b<K.length;b++)if(-1!=a.indexOf(K[b]))throw new x("forbidden char in nodename: "+K[b]);};G.toString=function(a){var b={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},c={array:function(a){var b=["["],d,e,f,g=a.length,k;for(f=0;f<g;f+=1)if(k=a[f],e=c[typeof k])try{k=e(k),
"string"==typeof k&&(d&&(b[b.length]=","),b[b.length]=k,d=!0)}catch(l){}b[b.length]="]";return b.join("")},"boolean":function(a){return String(a)},"null":function(a){return"null"},number:function(a){return isFinite(a)?String(a):"null"},object:function(a){if(a){if(a instanceof Array)return c.array(a);var b=["{"],d,e,f,g;for(f in a)if(a.hasOwnProperty(f)&&(g=a[f],e=c[typeof g]))try{g=e(g),"string"==typeof g&&(d&&(b[b.length]=","),b.push(c.string(f),":",g),d=!0)}catch(k){}b[b.length]="}";return b.join("")}return"null"},
string:function(a){/["\\\x00-\x1f]/.test(a)&&(a=a.replace(/([\x00-\x1f\\"])/g,function(a,c){if(a=b[c])return a;a=c.charCodeAt();return"\\u00"+Math.floor(a/16).toString(16)+(a%16).toString(16)}));return'"'+a+'"'}};switch(typeof a){case "object":return c.object(a);case "array":return c.array(a)}};G.parse=function(a){try{return!/[^,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]/.test(a.replace(/"(\\.|[^"\\])*"/g,""))&&eval("("+a+")")}catch(b){return!1}};var J=!0;m.prototype.pType=function(){return this.name};m.prototype.getDoc=
function(){return this.doc};m.prototype.getNode=function(){return this.getDoc()&&this.getDoc().documentElement?this.getDoc().documentElement:null};m.prototype.setTo=function(a){a&&""!=a?"string"==typeof a?this.getNode().setAttribute("to",a):this.getNode().setAttribute("to",a.toString()):this.getNode().removeAttribute("to");return this};m.prototype.setFrom=function(a){a&&""!=a?"string"==typeof a?this.getNode().setAttribute("from",a):this.getNode().setAttribute("from",a.toString()):this.getNode().removeAttribute("from");
return this};m.prototype.setID=function(a){a&&""!=a?this.getNode().setAttribute("id",a):this.getNode().removeAttribute("id");return this};m.prototype.setType=function(a){a&&""!=a?this.getNode().setAttribute("type",a):this.getNode().removeAttribute("type");return this};m.prototype.setXMLLang=function(a){a&&""!=a?this.getNode().setAttribute("xml:lang",a):this.getNode().removeAttribute("xml:lang");return this};m.prototype.getTo=function(){return this.getNode().getAttribute("to")};m.prototype.getFrom=
function(){return this.getNode().getAttribute("from")};m.prototype.getToJID=function(){return new v(this.getTo())};m.prototype.getFromJID=function(){return new v(this.getFrom())};m.prototype.getID=function(){return this.getNode().getAttribute("id")};m.prototype.getType=function(){return this.getNode().getAttribute("type")};m.prototype.getXMLLang=function(){return this.getNode().getAttribute("xml:lang")};m.prototype.getXMLNS=function(){return this.getNode().namespaceURI||this.getNode().getAttribute("xmlns")};
m.prototype.getChild=function(a,b){if(!this.getNode())return null;a=a||"*";b=b||"*";if(this.getNode().getElementsByTagNameNS)return this.getNode().getElementsByTagNameNS(b,a).item(0);a=this.getNode().getElementsByTagName(a);if("*"!=b)for(var c=0;c<a.length;c++){if(a.item(c).namespaceURI==b||a.item(c).getAttribute("xmlns")==b)return a.item(c)}else return a.item(0);return null};m.prototype.getChildVal=function(a,b){a=this.getChild(a,b);b="";if(a&&a.hasChildNodes())for(var c=0;c<a.childNodes.length;c++)a.childNodes.item(c).nodeValue&&
(b+=a.childNodes.item(c).nodeValue);return b};m.prototype.clone=function(){return m.wrapNode(this.getNode())};m.prototype.isError=function(){return"error"==this.getType()};m.prototype.errorReply=function(a){var b=this.clone();b.setTo(this.getFrom());b.setFrom();b.setType("error");b.appendNode("error",{code:a.code,type:a.type},[[a.cond,{xmlns:L}]]);return b};m.prototype.xml="undefined"!=typeof XMLSerializer?function(){var a=(new XMLSerializer).serializeToString(this.getNode());"undefined"==typeof a&&
(a=(new XMLSerializer).serializeToString(this.doc));return a}:function(){return this.getDoc().xml};m.prototype._getAttribute=function(a){return this.getNode().getAttribute(a)};null==document.ELEMENT_NODE&&(document.ELEMENT_NODE=1,document.ATTRIBUTE_NODE=2,document.TEXT_NODE=3,document.CDATA_SECTION_NODE=4,document.ENTITY_REFERENCE_NODE=5,document.ENTITY_NODE=6,document.PROCESSING_INSTRUCTION_NODE=7,document.COMMENT_NODE=8,document.DOCUMENT_NODE=9,document.DOCUMENT_TYPE_NODE=10,document.DOCUMENT_FRAGMENT_NODE=
11,document.NOTATION_NODE=12);m.prototype._importNode=function(a,b){switch(a.nodeType){case document.ELEMENT_NODE:var c;c=this.getDoc().createElementNS?this.getDoc().createElementNS(a.namespaceURI,a.nodeName):this.getDoc().createElement(a.nodeName);var d,e;if(a.attributes&&0<a.attributes.length)for(d=0,e=a.attributes.length;d<e;d++){var f=a.attributes.item(d);if("xmlns"!=f.nodeName||null===c.getAttribute("xmlns")&&!c.namespaceURI)c.setAttributeNS&&f.namespaceURI?c.setAttributeNS(f.namespaceURI,f.name,
f.value):c.setAttribute(f.name,f.value)}if(b&&a.childNodes&&0<a.childNodes.length)for(d=0,e=a.childNodes.length;d<e;d++)c.appendChild(this._importNode(a.childNodes.item(d),b));return c;case document.TEXT_NODE:case document.CDATA_SECTION_NODE:case document.COMMENT_NODE:return this.getDoc().createTextNode(a.nodeValue)}};m.prototype._setChildNode=function(a,b){var c=this.getChild(a);b=this.getDoc().createTextNode(b);if(c)try{c.replaceChild(b,c.firstChild)}catch(d){}else{try{c=this.getDoc().createElementNS(this.getNode().namespaceURI,
a)}catch(d){c=this.getDoc().createElement(a)}this.getNode().appendChild(c);c.appendChild(b)}return c};m.prototype.buildNode=function(a,b,c,d){return D.buildNode(this.getDoc(),a,b,c,d)};m.prototype.appendNode=function(a,b,c){return"object"==typeof a?this.getNode().appendChild(a):this.getNode().appendChild(this.buildNode(a,b,c,this.getNode().namespaceURI))};y.prototype=new m;y.prototype.setStatus=function(a){this._setChildNode("status",a);return this};y.prototype.setShow=function(a){"chat"!=a&&"away"!=
a&&"xa"!=a&&"dnd"!=a||this._setChildNode("show",a);return this};y.prototype.setPriority=function(a){this._setChildNode("priority",a);return this};y.prototype.setPresence=function(a,b,c){a&&this.setShow(a);b&&this.setStatus(b);c&&this.setPriority(c);return this};y.prototype.getStatus=function(){return this.getChildVal("status")};y.prototype.getShow=function(){return this.getChildVal("show")};y.prototype.getPriority=function(){return this.getChildVal("priority")};z.prototype=new m;z.prototype.setIQ=
function(a,b,c){a&&this.setTo(a);b&&this.setType(b);c&&this.setID(c);return this};z.prototype.setQuery=function(a){var b;try{b=this.getDoc().createElementNS(a,"query")}catch(c){b=this.getDoc().createElement("query"),b.setAttribute("xmlns",a)}this.getNode().appendChild(b);return b};z.prototype.getQuery=function(){return this.getNode().getElementsByTagName("query").item(0)};z.prototype.getQueryXMLNS=function(){return this.getQuery()?this.getQuery().namespaceURI||this.getQuery().getAttribute("xmlns"):
null};z.prototype.reply=function(a){var b=this.clone();b.setTo(this.getFrom());b.setFrom();b.setType("result");if(a)if("string"==typeof a)b.getChild().appendChild(b.getDoc().loadXML(a));else if(a.constructor==Array)for(var c=b.getChild(),d=0;d<a.length;d++)"string"==typeof a[d]?c.appendChild(b.getDoc().loadXML(a[d])):"object"==typeof a[d]&&c.appendChild(a[d]);else"object"==typeof a&&b.getChild().appendChild(a);return b};B.prototype=new m;B.prototype.setAmzAck=function(a){a&&""!=a?this.getNode().setAttribute("amz_ack",
a):this.getNode().removeAttribute("amz_ack");return this};B.prototype.setBody=function(a){this._setChildNode("body",a);return this};B.prototype.setSubject=function(a){this._setChildNode("subject",a);return this};B.prototype.setThread=function(a){this._setChildNode("thread",a);return this};B.prototype.getThread=function(){return this.getChildVal("thread")};B.prototype.getBody=function(){return this.getChildVal("body")};B.prototype.getSubject=function(){return this.getChildVal("subject")};B.prototype.getAmzAck=
function(){return this.getNode().getAttribute("amz_ack")};m.wrapNode=function(a){var b=null;switch(a.nodeName.toLowerCase()){case "presence":b=new y;break;case "message":b=new B;break;case "iq":b=new z}b&&b.getDoc().replaceChild(b._importNode(a,!0),b.getNode());return b};t.prototype=new d;t.prototype._cleanupWebSocket=function(){null!==this._ws&&(this._ws.onclose=null,this._ws.onerror=null,this._ws.onopen=null,this._ws.onmessage=null,this._ws.close(),this._ws=null)};t.prototype.connect=function(a){this._setStatus("connecting");
this.domain=a.domain||"localhost";this.username=a.username;this.resource=a.resource;this.pass=a.password||a.pass;this.authzid=a.authzid||"";this.register=a.register;this.authhost=a.authhost||this.domain;this.authtype=a.authtype||"sasl";this.jid=this.username+"@"+this.domain;this.fulljid=this.jid+"/"+this.resource;this._allow_plain=a.allow_plain?a.allow_plain:k.JSJAC_ALLOW_PLAIN;this._allow_scram=a.allow_scram?a.allow_scram:k.JSJAC_ALLOW_SCRAM;this._xmllang=a.xmllang&&""!==a.xmllang?a.xmllang:"en";
"undefined"===typeof WebSocket?this._handleEvent("onerror",n("503","cancel","service-unavailable-JSJaCWebSocketConnection-Connect-WebSocketUndefined")):(this._startTimer("openWebSocket"),this._ws=new WebSocket(this._httpbase,"xmpp"),this._ws.onclose=l.bind(this._onclose,this),this._ws.onerror=l.bind(this._onerror,this),this._ws.onopen=l.bind(this._onopen,this))};t.prototype._onopen=function(){this._stopTimer("openWebSocket");var a=this._getInitialRequestString();this.oDbg.log(a,4);this._ws.onmessage=
l.bind(this._doSASLAuthDone,this);this._ws.send(a);this._doAuth()};t.prototype._handleOpenStream=function(a){this.oDbg.log(a.data,4);a=a.data;a=a.substr(a.indexOf("\x3copen"));(a=this._parseXml(a))?(this.streamid=a.getAttribute("id"),this.oDbg.log("got streamid: "+this.streamid,2),this._ws.onmessage=l.bind(this._handleInitialResponse,this)):this._handleEvent("onerror",n("503","cancel","service-unavailable-JSJaCWebSocketConnection-HandleOpenStream-NoOpenHeader"))};t.prototype._handleInitialResponse=
function(a){a=this._parseXml(a.data);this._parseStreamFeatures(a)?(this._connected=!0,this.register?this._doInBandReg():this._doAuth()):this._handleEvent("onerror",n("503","cancel","service-unavailable-JSJaCWebSocketConnection-HandleInitialResponse-ErrorTag"))};t.prototype.disconnect=function(){this._setStatus("disconnecting");this.connected()&&(this._connected=!1,this.oDbg.log("Disconnecting",4),this._sendRaw('\x3cclose xmlns\x3d"urn:ietf:params:xml:ns:xmpp-framing"/\x3e',l.bind(this._cleanupWebSocket,
this)),this.oDbg.log("Disconnected",2),this._handleEvent("ondisconnect"))};t.prototype._onclose=function(){this.oDbg.log("websocket closed",2);"disconnecting"!==this._status&&(this._connected=!1,this._handleEvent("onerror",n("503","cancel","service-unavailable-JSJaCWebSocketConnection-OnClose-Error")))};t.prototype._onerror=function(){this.oDbg.log("websocket error",1);this._connected=!1;this._handleEvent("onerror",n("503","cancel","service-unavailable-JSJaCWebSocketConnection-OnError"))};t.prototype._onmessage=
function(a){var b;b=a.data;this._setStatus("processing");if(b&&""!==b&&(b=this._parseXml(b)))if(b.namespaceURI===E&&"error"===b.localName)0<b.getElementsByTagNameNS("urn:ietf:params:xml:ns:xmpp-streams","conflict").length&&this._setStatus("session-terminate-conflict"),this._connected=!1,this._handleEvent("onerror",n("503","cancel","remote-stream-error",b.children));else if(b=m.wrapNode(b))this.oDbg.log("async recv: "+a.data,4),this._handleEvent("packet_in",b),b.pType&&!this._handlePID(b)&&(this._handleEvent(b.pType()+
"_in",b),this._handleEvent(b.pType(),b))};t.prototype._parseXml=function(a){var b;this.oDbg.log("Parsing: "+a,4);try{if(b=f.create("stream",E),0===a.trim().indexOf("\x3cclose")&&-1!==a.indexOf("urn:ietf:params:xml:ns:xmpp-framing")){this.oDbg.log("session terminated",1);clearTimeout(this._timeout);clearInterval(this._interval);clearInterval(this._inQto);try{q.read(this._cookie_prefix+"JSJaC_State").erase()}catch(c){}this._connected=!1;this._handleEvent("onerror",n("503","cancel","session-terminate"));
this.oDbg.log("Disconnected.",1);this._handleEvent("ondisconnect")}else{if(-1===a.indexOf("\x3cstream:stream"))return b.loadXML("\x3cstream:stream xmlns:stream\x3d'"+E+"' xmlns\x3d'jabber:client'\x3e"+a+"\x3c/stream:stream\x3e"),b.documentElement.firstChild;b.loadXML(a);return b.documentElement}}catch(c){this.oDbg.log("Error: "+c),this._connected=!1,this._handleEvent("onerror",n("500","wait","internal-service-error"))}return null};t.prototype._getInitialRequestString=function(){var a;a=this.domain;
this.authhost&&(a=this.authhost);return'\x3copen xmlns\x3d"urn:ietf:params:xml:ns:xmpp-framing" to\x3d"'+a+'" version\x3d"1.0"/\x3e'};t.prototype.send=function(a,b,c){if(!this.connected())return!1;if(!a||!a.pType)return this.oDbg.log("no packet: "+a,1),!1;this._ws.onmessage=l.bind(this._onmessage,this);b&&(a.getID()||a.setID("JSJaCID_"+this._ID++),this._registerPID(a.getID(),b,c));try{this._handleEvent(a.pType()+"_out",a),this._handleEvent("packet_out",a),this._ws.send(a.xml())}catch(d){return this.oDbg.log(d.toString(),
1),!1}return!0};t.prototype.resume=function(){return!1};t.prototype.suspend=function(){return!1};t.prototype._doSASLAuthScramSha1S1=function(a){a=this._parseXml(a.data);return l.bind(d.prototype._doSASLAuthScramSha1S1,this)(a)};t.prototype._doSASLAuthScramSha1S2=function(a){a=this._parseXml(a.data);return l.bind(d.prototype._doSASLAuthScramSha1S2,this)(a)};t.prototype._doSASLAuthDigestMd5S1=function(a){a=this._parseXml(a.data);return l.bind(d.prototype._doSASLAuthDigestMd5S1,this)(a)};t.prototype._doSASLAuthDigestMd5S2=
function(a){a=this._parseXml(a.data);return l.bind(d.prototype._doSASLAuthDigestMd5S2,this)(a)};t.prototype._doSASLAuthDone=function(a){a=this._parseXml(a.data);return l.bind(d.prototype._doSASLAuthDone,this)(a)};t.prototype._reInitStream=function(a){a=this.domain;this.authhost&&(a=this.authhost);this._sendRaw('\x3copen xmlns\x3d"urn:ietf:params:xml:ns:xmpp-framing" to\x3d"'+a+'" version\x3d"1.0"/\x3e');this._startTimer("doStreamBind");this._doStreamBind()};t.prototype._sendRaw=function(a,b,c){if(!this._ws)return!1;
b&&(this._ws.onmessage=l.bind(b,this,c));this._ws.send(a);return!0};return{JSJaC:l,JSJaCConsoleLogger:function(a){this.level=a||4;this.start=function(){};this.log=function(a,c){c=c||0;if(!(c>this.level)&&"undefined"!=typeof console)try{switch(c){case 0:console.warn(a);break;case 1:console.error(a);break;case 2:console.info(a);break;case 4:console.debug(a);break;default:console.log(a)}}catch(d){try{console.log(a)}catch(e){}}};this.setLevel=function(a){this.level=a;return this};this.getLevel=function(){return this.level}},
JSJaCError:n,JSJaCHttpBindingConnection:u,JSJaCIQ:z,JSJaCJID:v,JSJaCMessage:B,JSJaCPacket:m,JSJaCPresence:y,JSJaCWebSocketConnection:t}});x.register("3p-JSJaC-Config",function(){return{JSJAC_HAVEKEYS:!0,JSJAC_NKEYS:16,JSJAC_INACTIVITY:300,JSJAC_ERR_COUNT:10,JSJAC_ALLOW_PLAIN:!0,JSJAC_ALLOW_SCRAM:!1,JSJAC_CHECKQUEUEINTERVAL:1,JSJAC_CHECKINQUEUEINTERVAL:1,JSJAC_TIMERVAL:2E3,JSJAC_RETRYDELAY:5E3,JSJACHBC_MAX_HOLD:1,JSJACHBC_MAX_WAIT:300,JSJACHBC_BOSH_VERSION:"1.6",JSJACHBC_USE_BOSH_VER:!0,JSJACHBC_MAXPAUSE:120}});
x.register("3p-JSJaC-Crypt",function(){function k(e,f){var d=(e&65535)+(f&65535);return(e>>16)+(f>>16)+(d>>16)<<16|d&65535}function p(){b64=[];f64=[];for(var e=0;64>e;e++)b64[e]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e),f64["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e)]=e}"undefined"!=typeof atob&&"undefined"!=typeof btoa||p();b64decode="undefined"==typeof atob?function(e){var f=[],d=0;e=e.replace(/\n|\r/g,"");for(e=e.replace(/=/g,
"");d<e.length;)f[f.length]=f64[e.charAt(d)]<<2|f64[e.charAt(d+1)]>>4,f[f.length]=(f64[e.charAt(d+1)]&15)<<4|f64[e.charAt(d+2)]>>2,f[f.length]=(f64[e.charAt(d+2)]&3)<<6|f64[e.charAt(d+3)],d+=4;2==e.length%4&&(f=f.slice(0,f.length-2));3==e.length%4&&(f=f.slice(0,f.length-1));d=[];for(e=0;e<f.length;)128>f[e]?(d[d.length]=String.fromCharCode(f[e]),e++):191<f[e]&&224>f[e]?(d[d.length]=String.fromCharCode((f[e]&31)<<6|f[e+1]&63),e+=2):(d[d.length]=String.fromCharCode((f[e]&15)<<12|(f[e+1]&63)<<6|f[e+
2]&63),e+=3);return d.join("")}:function(e){return decodeURIComponent(escape(atob(e)))};b64encode="undefined"==typeof btoa?function(e){var f;f=e.replace(/\r\n/g,"\n");e=[];if(0>String.fromCharCode(237).charCodeAt(0))for(var d=0;d<f.length;d++){var g=f.charCodeAt(d);0<g?e[e.length]=g:(e[e.length]=256+g>>6|192,e[e.length]=256+g&63|128)}else for(d=0;d<f.length;d++)g=f.charCodeAt(d),128>g?e[e.length]=g:(127<g&&2048>g?e[e.length]=g>>6|192:(e[e.length]=g>>12|224,e[e.length]=g>>6&63|128),e[e.length]=g&63|
128);f=[];d=0;g=e.length;1==g%3&&(e[e.length]=0,e[e.length]=0);for(2==g%3&&(e[e.length]=0);d<e.length;)f[f.length]=b64[e[d]>>2],f[f.length]=b64[(e[d]&3)<<4|e[d+1]>>4],f[f.length]=b64[(e[d+1]&15)<<2|e[d+2]>>6],f[f.length]=b64[e[d+2]&63],d+=3;1==g%3&&(f[f.length-1]=f[f.length-2]="\x3d");2==g%3&&(f[f.length-1]="\x3d");return f.join("")}:function(e){return btoa(unescape(encodeURIComponent(e)))};return{b64decode:b64decode,b64encode:b64encode,hex_sha1:function(e){for(var f=[],d=0;d<8*e.length;d+=8)f[d>>
5]|=(e.charCodeAt(d/8)&255)<<24-d%32;e=8*e.length;f[e>>5]|=128<<24-e%32;f[(e+64>>9<<4)+15]=e;e=Array(80);for(var d=1732584193,g=-271733879,q=-1732584194,p=271733878,n=-1009589776,x=0;x<f.length;x+=16){for(var u=d,w=g,v=q,A=p,C=n,r=0;80>r;r++){if(16>r)e[r]=f[x+r];else{var m=e[r-3]^e[r-8]^e[r-14]^e[r-16];e[r]=m<<1|m>>>31}var m=d<<5|d>>>27,y;y=20>r?g&q|~g&p:40>r?g^q^p:60>r?g&q|g&p|q&p:g^q^p;m=k(k(m,y),k(k(n,e[r]),20>r?1518500249:40>r?1859775393:60>r?-1894007588:-899497514));n=p;p=q;q=g<<30|g>>>2;g=d;
d=m}d=k(d,u);g=k(g,w);q=k(q,v);p=k(p,A);n=k(n,C)}f=[d,g,q,p,n];e="";for(d=0;d<4*f.length;d++)e+="0123456789abcdef".charAt(f[d>>2]>>8*(3-d%4)+4&15)+"0123456789abcdef".charAt(f[d>>2]>>8*(3-d%4)&15);return e}}})});
/* ******** */
/*
 2015 Amazon.com. All Rights Reserved.
 2015 Amazon.com. All Rights Reserved.
 2015 Amazon.com. All Rights Reserved.
 2016 Amazon.com. All Rights Reserved.
 2015 Amazon.com. All Rights Reserved.
 2015-2016 Amazon.com. All Rights Reserved.
 2015-2016 Amazon.com. All Rights Reserved.
 2015-2016 Amazon.com. All Rights Reserved.
 2016 Amazon.com. All Rights Reserved.
 2015 Amazon.com. All Rights Reserved.
 2016 Amazon.com. All Rights Reserved.
 2015-2016 Amazon.com. All Rights Reserved.
 2015-2016 Amazon.com. All Rights Reserved.
 2015 Amazon.com. All Rights Reserved.
 2015 Amazon.com. All Rights Reserved.
 2016 Amazon.com. All Rights Reserved.
 2015 Amazon.com. All Rights Reserved.
 2015 Amazon.com. All Rights Reserved.
 2015-2016 Amazon.com. All Rights Reserved.
 2015-2016 Amazon.com. All Rights Reserved.
 2015 Amazon.com. All Rights Reserved.
 2016 Amazon.com. All Rights Reserved.
 2015 Amazon.com. All Rights Reserved.
 2016 Amazon.com. All Rights Reserved.
 2015 Amazon.com. All Rights Reserved.
 2015-2016 Amazon.com. All Rights Reserved.
 2016 Amazon.com. All Rights Reserved.
 2016 Amazon.com. All Rights Reserved.
 2016 Amazon.com. All Rights Reserved.
 2016 Amazon.com. All Rights Reserved.
 2016 Amazon.com. All Rights Reserved.
 2016 Amazon.com. All Rights Reserved.
 2015 Amazon.com. All Rights Reserved.
 2015 Amazon.com. All Rights Reserved.
 2015-2016 Amazon.com. All Rights Reserved.
 2015 Amazon.com. All Rights Reserved.
 2015-2016 Amazon.com. All Rights Reserved.
 2016 Amazon.com. All Rights Reserved.
 2015 Amazon.com. All Rights Reserved.
 2015-2016 Amazon.com. All Rights Reserved.
 2015 Amazon.com. All Rights Reserved.
 2017 Amazon.com. All Rights Reserved.
 2015 Amazon.com. All Rights Reserved.
*/
(function(t){var v=window.AmazonUIPageJS||window.P,M=v._namespace||v.attributeErrors,d=M?M("CampfireJavaScriptSDK",""):v;d.guardFatal?d.guardFatal(t)(d,window):d.execute(function(){t(d,window)})})(function(t,v,M){t.when("AmazonComm/auth/cognito_auth_provider","AmazonComm/auth/cs_shared_key_auth_provider","AmazonComm/auth/shared_key_auth_provider","AmazonComm/common/person_class","AmazonComm/messaging/connection_strategy","AmazonComm/metrics/metrics_manager","AmazonComm/utils/build","AmazonComm/utils/common",
"AmazonComm/utils/config","AmazonComm/utils/error_codes","AmazonComm/utils/global_state","AmazonComm/utils/log").register("AmazonComm/comm_service",function(d,l,f,b,q,g,a,e,m,u,p,h){function k(k,b,u,q){X=k;m.setApiKey(X);m.setMarketplaceId(u);m.setDomainName(b);z=g.createMetricEvent("CommService",g.AGGREGATING_EVENT);h.l("comm_service","AmazonComm version ["+a.BUILD_VERSION+"] built ["+a.BUILD_TIME+"]");g.incrementCounter(z,"Version."+a.BUILD_VERSION);h.l("comm_service","API key ["+X+"]");h.l("comm_service",
"Marketplace Id: ["+m.getMarketplaceId()+"]");h.l("comm_service","HuddleId: ["+p.getHuddleId()+"]");m.disconnectOnUnload()&&v.addEventListener("beforeunload",c);C=e.isEmpty(q)?m.useCognitoAuth()?d:m.useCSSharedKeyAuth()?l:f:q;G={onConnected:function(c){var a=p.getCurrentAuthCredentialData(),e=p.getLocalUser();e.setJID(c.jid);e.setThirdPartyID(a.customerId);e.setName(a.customerName);e.setNameType(a.customerNameType);p.setLocalUser(e);n(!0,!1);for(c=0;c<E.length;c++)E[c].onConnected()},onDisconnected:function(){p.cleanup();
g.uploadRecordedMetrics();D=y=null;for(var c=0;c<E.length;c++)E[c].onDisconnected(F);F=null},onReconnecting:function(c){e.isEmpty(D)&&(g.incrementCounter(z,"CommService.ConnectionRetryCount"),n(!1,!1),D=new Date);for(var a=0;a<E.length;a++)E[a].onReconnecting(c)},onError:function(c){g.incrementCounter(z,"CommService.ConnectionError.ServiceErrorCount");n(!1,!0);for(var a=0;a<E.length;a++)E[a].onError(c)}};t={onGetAuthCredentialSuccess:function(c){h.l("comm_service","got auth token id: ["+c.customerId+
"], name: ["+c.customerName+"], authStatus: ["+c.authStatus+"]");p.setAuthCredentialData(c);c.marketplaceId!==m.getMarketplaceId()&&(g.incrementCounter(z,"CommService.AuthMarketplaceDifferentFromClient"),m.setMarketplaceId(c.marketplaceId));r.connect(X,c,G)||(g.incrementCounter(z,"CommService.ConnectionError.AlreadyConnectedCount"),y=null)},onGetAuthCredentialError:function(c){h.e("comm_service","error getting auth token: "+c.description);g.incrementCounter(z,"CommService.ConnectionError.AuthErrorCount");
n(!1,!0);F=c;e.isEmpty(r)||r.disconnect()}};w=!0}function c(){g.uploadRecordedMetrics();e.isEmpty(r)||r.disconnect()}function n(c,a){e.isEmpty(y)||(c?(g.addTimer(z,"CommService.ConnectionSuccessTimer",new Date-y),C.getEverRetryStatus()||g.addTimer(z,"CommService.ConnectionSuccessTimerWithoutAuthRetry",new Date-y)):g.addTimer(z,"CommService.ConnectionErrorTimer",new Date-y),y=null);!e.isEmpty(D)&&c&&(g.addTimer(z,"CommService.ReconnectionSuccessTimer",new Date-D),C.getEverRetryStatus()||g.addTimer(z,
"CommService.ReconnectionSuccessTimerWithoutAuthRetry",new Date-y),D=null);g.recordMetricEvent(z);a&&g.uploadRecordedMetrics()}var r=q.getConnection(),w=!1,X=null,E=[],G=null,C=null,t=null,F=null,z,y=null,D=null;return{VERSION:a.BUILD_VERSION,BUILD_TIME:a.BUILD_TIME,initialize:function(c,a,e,h){k(c,a,e,h)},registerCommObserver:function(c){E.push(c);return c},unregisterCommObserver:function(c){c=E.indexOf(c);-1<c&&E.splice(c,1)},connect:function(){if(w)y=new Date,C.getAuthCredential(t);else for(var c=
{code:u.COMM_SERVICE_ERRORS.ERROR_NOT_INITIALIZED,description:"Comm service is not initialized - call initialize() before calling connect()"},a=0;a<E.length;a++)E[a].onError(c)},disconnect:function(){c()},isConnected:function(){return!e.isEmpty(r)&&r.isConnected()},getMarketplaceId:function(){return m.getMarketplaceId()},getApiKey:function(){return X},getCommObservers:function(){return E},getAuthProvider:function(){return C},getConnectionObserver:function(){return G},getReconnectionRequestStartTime:function(){return D}}});
t.when("AmazonComm/comm_service").execute(function(d){v["AmazonComm/comm_service"]=d});t.when("AmazonComm/utils/common","AmazonComm/utils/config","3p-JSJaC-Crypt").register("AmazonComm/auth/auth_utils",function(d,l,f){var b=Object.freeze({Authenticated:"Authenticated",Recognized:"Recognized",Unrecognized:"Unrecognized",None:"None"}),q=Object.freeze({PenName:"PenName",RealName:"RealName",None:"None"});return{AmazonAuthStatus:b,parseAuthStatus:function(g){var a=b.None;d.isEmpty(g)||(g=g.toLowerCase(),
g===b.Authenticated.toLowerCase()?a=b.Authenticated:g===b.Recognized.toLowerCase()?a=b.Recognized:g===b.Unrecognized.toLowerCase()&&(a=b.Unrecognized));return a},AmazonNameType:q,parseNameType:function(b){var a=q.None;d.isEmpty(b)||(b=b.toLowerCase(),b===q.PenName.toLowerCase()?a=q.PenName:b===q.RealName.toLowerCase()&&(a=q.RealName));return a},getAuthenticationToken:function(d,a){var e="3|||";a=e=l.useCognitoAuth()?e+(f.b64encode(a)+"|||"+d.cognitoToken+"|||Cognito_SampleApp_TestRole"):e+(d.directedId+
"|||"+d.directedIdExpiration+"|||"+d.directedIdSignature);d="|||"+d.customerId+"|||"+f.b64encode(d.customerName)+"|||"+d.customerNameType+"|||"+d.customerSignature+"|||"+d.authStatus+"|||"+d.authStatusTimestamp+"|||"+d.authStatusSignature;return a+d}}});t.when("AmazonComm/auth/auth_utils").execute(function(d){v["AmazonComm/auth/auth_utils"]=d});t.when("AmazonComm/auth/auth_utils","AmazonComm/metrics/metrics_manager","AmazonComm/utils/common","AmazonComm/utils/config","AmazonComm/utils/error_codes",
"AmazonComm/utils/global_state","AmazonComm/utils/log","AmazonComm/utils/services").register("AmazonComm/auth/cognito_auth_provider",function(d,l,f,b,q,g,a,e){function m(){var c=f.createUUID(f.TAG_REQUEST),a=b.isAuthenticationCheckRequired(),e=b.getApiKey(),h=b.getMarketplaceId();return JSON.stringify({requestId:c,authenticationCheckRequired:a,apiKey:e,marketplaceId:h})}function u(e,k){f.isEmpty(e)||isNaN(e)?(a.w("cognito_auth_provider","received invalid Cognito credential expiration date : ["+e+
"], defaulting to expire in 3600s"),e=36E5+Date.now()):301E3>e-Date.now()&&(a.w("cognito_auth_provider","Cognito credential expiration date is too short : "+(new Date(e)).toString()+", changing to expire in 301s"),e=301E3+Date.now());w=e-3E5;h();a.l("cognito_auth_provider","credential is good until "+(new Date(e)).toString()+", we will validate the credential has not expired every "+r+"ms");n=setInterval(function(){Date.now()>=w&&p(k)},r);c=!0}function p(h){var n=l.createMetricEvent("CognitoAuthProvider",
l.AGGREGATING_EVENT);e.clearEverRetry();l.startTimer(n,"GetCognitoAuthPayloadForAmazonCookie.ApiTimer");l.startTimer(n,"GetCognitoAuthPayloadForAmazonCookie.ApiTimerWithoutRetry");var r=b.getInternalServiceHost(),p={url:r,api:"getCognitoAuthPayloadForAmazonCookie",payload:m(),withCredentials:!0},w={onXhrSendSuccess:function(b){b=JSON.parse(b.responseText);a.l("cognito_auth_provider","got response to getCognitoAuthPayloadForAmazonCookie from ["+b.serverName+"] ("+b.serverIP+")");var m={cognitoToken:b.cognitoToken,
authStatus:d.parseAuthStatus(b.authStatus),authStatusTimestamp:b.authStatusTimestamp,authStatusSignature:b.authStatusSignature,customerId:b.customerId,customerName:b.customerName,customerNameType:d.parseNameType(b.customerNameType),customerSignature:b.customerSignature,marketplaceId:b.marketplaceId},r=null;c&&!f.isEmpty(k)&&(m.authStatus!==k.authStatus?r={code:q.AUTH_ERRORS.ERROR_AUTH_STATUS_CHANGED_ON_REFRESH,description:"auth status changed during Cognito credential refresh"}:m.authStatus!==d.AmazonAuthStatus.Authenticated&&
m.authStatus!==d.AmazonAuthStatus.Recognized||m.customerId===k.customerId||(r={code:q.AUTH_ERRORS.ERROR_CUSTOMER_ID_CHANGED_ON_REFRESH,description:"customer id changed during Cognito credential refresh"}));l.stopTimer(n,"GetCognitoAuthPayloadForAmazonCookie.ApiTimer");e.getEverRetry()||l.stopTimer(n,"GetCognitoAuthPayloadForAmazonCookie.ApiTimerWithoutRetry");l.recordMetricEvent(n);if(f.isEmpty(r))r=g.getLocalUser(),r.setName(m.customerName),r.setNameType(m.customerNameType),g.setLocalUser(r),u(b.cognitoTokenExpiration,
h),k=m,h.onGetAuthCredentialSuccess(m);else h.onGetAuthCredentialError(r)},onXhrSendRetry:h.onGetAuthCredentialRetry,onXhrSendFailed:function(c){l.stopTimer(n,"GetCognitoAuthPayloadForAmazonCookie.ApiTimer");l.recordMetricEvent(n);h.onGetAuthCredentialError(c)}};a.l("cognito_auth_provider","exchanging amazon cookies for Cognito credential using ["+r+"]");e.sendRestXhrWithRetries(p,w)}function h(){a.l("cognito_auth_provider","clearing Cognito credential refresh timeout");clearInterval(n);n=0;c=!1;
k=null}var k=null,c=!1,n=0,r=3E4,w=0;g.registerCleanupObserver({cleanup:function(){a.l("cognito_auth_provider","cleaning up cognito_auth_provider");h()}});return{getAuthCredential:function(c){p(c)},stopCredentialRefresh:function(){h()},shouldRefreshCredential:function(){return Date.now()>=w},getTokenRefreshInterval:function(){return n},setTokenExpirationCheckPeriod:function(c){r=c},getRefreshTimeoutMillis:function(){return w},setRefreshTimeoutMillis:function(c){w=c},setIsRefresh:function(a){c=a},
setCurrentCredential:function(c){k=c},getEverRetryStatus:function(){return e.getEverRetry()}}});t.when("AmazonComm/auth/cognito_auth_provider").execute(function(d){v["AmazonComm/auth/cognito_auth_provider"]=d});t.when("AmazonComm/auth/auth_utils","AmazonComm/metrics/metrics_manager","AmazonComm/utils/common","AmazonComm/utils/config","AmazonComm/utils/error_codes","AmazonComm/utils/global_state","AmazonComm/utils/log","AmazonComm/utils/services").register("AmazonComm/auth/cs_shared_key_auth_provider",
function(d,l,f,b,q,g,a,e){function m(){var c=f.createUUID(f.TAG_REQUEST),a=b.getApiKey(),e=b.getMarketplaceId();return JSON.stringify({requestId:c,authenticationCheckRequired:!0,apiKey:a,marketplaceId:e})}function u(e,k){f.isEmpty(e)||isNaN(e)?(a.w("cs_shared_key_auth_provider","received invalid shared key credential expiration date : ["+e+"], defaulting to expire in 86400s"),e=864E5+Date.now()):1801E3>e-Date.now()&&(a.w("cs_shared_key_auth_provider","shared key credential expiration date is too short : "+
(new Date(e)).toString()+", changing to expire in 1801s"),e=1801E3+Date.now());w=e-18E5;h();a.l("cs_shared_key_auth_provider","credential is good until "+(new Date(e)).toString()+", we will validate the credential has not expired every "+r+"ms");n=setInterval(function(){Date.now()>=w&&p(k)},r);c=!0}function p(h){var n=l.createMetricEvent("CSSharedKeyAuthProvider",l.AGGREGATING_EVENT);e.clearEverRetry();l.startTimer(n,"GetSharedKeyAuthPayloadForCscCookie.ApiTimer");l.startTimer(n,"GetSharedKeyAuthPayloadForCscCookie.ApiTimerWithoutRetry");
var r=b.getInternalServiceHost(),p={url:r,api:"getSharedKeyAuthPayloadForCscCookie",payload:m(),withCredentials:!0},w={onXhrSendSuccess:function(b){var m=JSON.parse(b.responseText);a.l("cs_shared_key_auth_provider","got response to getSharedKeyAuthPayloadForCscCookie from ["+m.serverName+"] ("+m.serverIP+")");b={directedId:m.directedId,directedIdExpiration:m.directedIdExpiration,directedIdSignature:m.directedIdSignature,authStatus:d.parseAuthStatus(m.authStatus),authStatusTimestamp:m.authStatusTimestamp,
authStatusSignature:m.authStatusSignature,customerId:m.customerId,customerName:m.customerName,customerNameType:d.parseNameType(m.customerNameType),customerSignature:m.customerSignature,marketplaceId:m.marketplaceId};var r=null;b.authStatus!==d.AmazonAuthStatus.Authenticated?r={code:q.GENERIC_ERRORS.ERROR_UNKNOWN,description:"could not authenticate against CSC login"}:c&&!f.isEmpty(k)&&(b.authStatus!==k.authStatus?(r={code:q.AUTH_ERRORS.ERROR_AUTH_STATUS_CHANGED_ON_REFRESH,description:"auth status changed during CSC shared key credential refresh"},
l.incrementCounter(n,"GetSharedKeyAuthPayloadForCscCookie.AuthErrorCount.AuthStatusChanged")):b.authStatus===d.AmazonAuthStatus.Authenticated&&b.customerId!==k.customerId&&(r={code:q.AUTH_ERRORS.ERROR_CUSTOMER_ID_CHANGED_ON_REFRESH,description:"customer id changed during CSC shared key credential refresh"},l.incrementCounter(n,"GetSharedKeyAuthPayloadForCscCookie.AuthErrorCount.CustomerIdChanged")));l.stopTimer(n,"GetSharedKeyAuthPayloadForCscCookie.ApiTimer");e.getEverRetry()||l.stopTimer(n,"GetSharedKeyAuthPayloadForCscCookie.ApiTimerWithoutRetry");
l.recordMetricEvent(n);if(f.isEmpty(r))r=null,f.isEmpty(m.directedIdExpiration)||(r=m.directedIdExpiration),m=g.getLocalUser(),m.setName(b.customerName),m.setNameType(b.customerNameType),g.setLocalUser(m),u(r,h),k=b,h.onGetAuthCredentialSuccess(b);else h.onGetAuthCredentialError(r)},onXhrSendRetry:h.onGetAuthCredentialRetry,onXhrSendFailed:function(c){l.stopTimer(n,"GetSharedKeyAuthPayloadForCscCookie.ApiTimer");l.recordMetricEvent(n);h.onGetAuthCredentialError(c)}};a.l("cs_shared_key_auth_provider",
"exchanging csc cookies for shared key credential using ["+r+"]");e.sendRestXhrWithRetries(p,w)}function h(){a.l("cs_shared_key_auth_provider","clearing shared key credential refresh timeout");clearInterval(n);n=0;c=!1;k=null}var k=null,c=!1,n=0,r=3E4,w=0;g.registerCleanupObserver({cleanup:function(){a.l("cs_shared_key_auth_provider","cleaning up cs_shared_key_auth_provider");h()}});return{getAuthCredential:function(c){p(c)},stopCredentialRefresh:function(){h()},shouldRefreshCredential:function(){return Date.now()>=
w},getTokenRefreshInterval:function(){return n},setTokenExpirationCheckPeriod:function(c){r=c},getRefreshTimeoutMillis:function(){return w},setRefreshTimeoutMillis:function(c){w=c},setIsRefresh:function(a){c=a},setCurrentCredential:function(c){k=c},getEverRetryStatus:function(){return e.getEverRetry()}}});t.when("AmazonComm/auth/cs_shared_key_auth_provider").execute(function(d){v["AmazonComm/auth/cs_shared_key_auth_provider"]=d});t.when("AmazonComm/auth/auth_utils","AmazonComm/metrics/metrics_manager",
"AmazonComm/utils/common","AmazonComm/utils/config","AmazonComm/utils/error_codes","AmazonComm/utils/global_state","AmazonComm/utils/log","AmazonComm/utils/services").register("AmazonComm/auth/shared_key_auth_provider",function(d,l,f,b,q,g,a,e){function m(){var c=f.createUUID(f.TAG_REQUEST),a=b.isAuthenticationCheckRequired(),e=b.getApiKey(),h=b.getMarketplaceId(),k=b.getDomainName(),c={requestId:c,authenticationCheckRequired:a,apiKey:e,marketplaceId:h,domainName:k,messagingServiceDomain:b.getMessagingDomain(),
clusterName:b.getClusterName(),huddleId:g.getHuddleId()};return JSON.stringify(c)}function u(e,k){f.isEmpty(e)||isNaN(e)?(a.w("shared_key_auth_provider","received invalid shared key credential expiration date : ["+e+"], defaulting to expire in 86400s"),e=864E5+Date.now()):1801E3>e-Date.now()&&(a.w("shared_key_auth_provider","shared key credential expiration date is too short : "+(new Date(e)).toString()+", changing to expire in 1801s"),e=1801E3+Date.now());w=e-18E5;h();a.l("shared_key_auth_provider",
"credential is good until "+(new Date(e)).toString()+", we will validate the credential has not expired every "+r+"ms");n=setInterval(function(){Date.now()>=w&&p(k)},r);c=!0}function p(h){var n=l.createMetricEvent("SharedKeyAuthProvider",l.AGGREGATING_EVENT);e.clearEverRetry();l.startTimer(n,"GetCampfireConnectionPayloadForAmazonCookie.ApiTimer");l.startTimer(n,"GetCampfireConnectionPayloadForAmazonCookie.ApiTimerWithoutRetry");var r=b.getInternalServiceHost(),p={url:r,api:"getCampfireConnectionPayloadForAmazonCookie",
payload:m(),withCredentials:!0},w={onXhrSendSuccess:function(b){b=JSON.parse(b.responseText);a.l("shared_key_auth_provider","got response to getCampfireConnectionPayloadForAmazonCookie from ["+b.serverName+"] ("+b.serverIP+")");var m=b.directedId,r=b.directedIdExpiration,p=b.directedIdSignature,w=d.parseAuthStatus(b.authStatus),G=b.authStatusTimestamp,N=b.authStatusSignature,t=b.customerId,C=b.customerName,v=d.parseNameType(b.customerNameType),J=b.customerSignature,I=b.marketplaceId,A=null,K=b.messagingServiceHosts;
if(!f.isEmpty(K)&&!f.isEmpty(K[0])){for(var K=b.messagingServiceHosts[0].hostName,Q=null,S=null,x=b.messagingServiceHosts[0].protocols,B=0;B<x.length;++B)if("wss"===x[B].scheme){Q=x[B].scheme;S=x[B].port;break}f.isEmpty(K)||f.isEmpty(Q)||(A={hostName:K,protocol:Q,port:S})}m={directedId:m,directedIdExpiration:r,directedIdSignature:p,authStatus:w,authStatusTimestamp:G,authStatusSignature:N,customerId:t,customerName:C,customerNameType:v,customerSignature:J,marketplaceId:I,messagingHostInfo:A};r=null;
c&&!f.isEmpty(k)&&(m.authStatus!==k.authStatus?(r={code:q.AUTH_ERRORS.ERROR_AUTH_STATUS_CHANGED_ON_REFRESH,description:"auth status changed during shared key credential refresh"},l.incrementCounter(n,"GetCampfireConnectionPayloadForAmazonCookie.AuthErrorCount.AuthStatusChanged")):m.authStatus!==d.AmazonAuthStatus.Authenticated&&m.authStatus!==d.AmazonAuthStatus.Recognized||m.customerId===k.customerId||(r={code:q.AUTH_ERRORS.ERROR_CUSTOMER_ID_CHANGED_ON_REFRESH,description:"customer id changed during shared key credential refresh"},
l.incrementCounter(n,"GetCampfireConnectionPayloadForAmazonCookie.AuthErrorCount.CustomerIdChanged")));l.stopTimer(n,"GetCampfireConnectionPayloadForAmazonCookie.ApiTimer");e.getEverRetry()||l.stopTimer(n,"GetCampfireConnectionPayloadForAmazonCookie.ApiTimerWithoutRetry");l.recordMetricEvent(n);if(f.isEmpty(r))r=null,f.isEmpty(b.directedIdExpiration)||(r=b.directedIdExpiration),b=g.getLocalUser(),b.setName(m.customerName),b.setNameType(m.customerNameType),g.setLocalUser(b),u(r,h),k=m,h.onGetAuthCredentialSuccess(m);
else h.onGetAuthCredentialError(r)},onXhrSendRetry:h.onGetAuthCredentialRetry,onXhrSendFailed:function(c){l.stopTimer(n,"GetCampfireConnectionPayloadForAmazonCookie.ApiTimer");l.recordMetricEvent(n);h.onGetAuthCredentialError(c)}};a.l("shared_key_auth_provider","exchanging amazon cookies for shared key credential using ["+r+"]");e.sendRestXhrWithRetries(p,w)}function h(){a.l("shared_key_auth_provider","clearing shared key credential refresh timeout");clearInterval(n);n=0;c=!1;k=null}var k=null,c=
!1,n=0,r=3E4,w=0;g.registerCleanupObserver({cleanup:function(){a.l("shared_key_auth_provider","cleaning up shared_key_auth_provider");h()}});return{getAuthCredential:function(c){p(c)},stopCredentialRefresh:function(){h()},shouldRefreshCredential:function(){return Date.now()>=w},getTokenRefreshInterval:function(){return n},setTokenExpirationCheckPeriod:function(c){r=c},getRefreshTimeoutMillis:function(){return w},setRefreshTimeoutMillis:function(c){w=c},setIsRefresh:function(a){c=a},setCurrentCredential:function(c){k=
c},getEverRetryStatus:function(){return e.getEverRetry()}}});t.when("AmazonComm/auth/shared_key_auth_provider").execute(function(d){v["AmazonComm/auth/shared_key_auth_provider"]=d});t.when("AmazonComm/common/jid_class","AmazonComm/common/person_class","AmazonComm/messaging/chatroom/association_class","AmazonComm/messaging/chatroom/chat_room_user_class","AmazonComm/messaging/presence_class","AmazonComm/utils/common","AmazonComm/utils/global_state").register("AmazonComm/common/chatroom_class",function(d,
l,f,b,q,g,a){d=function(a,b){this.mJID=a;this.mName=b;this.mChatRoomUsers={};this.mChatRoomAssociationChangeObservers=[]};d.prototype.toString=function(){return"ChatRoom:{name:["+this.mName+"], JID:"+this.mJID.toString()+"}"};d.prototype.getJID=function(){return this.mJID};d.prototype.getName=function(){return this.mName};d.prototype.getDescription=function(){return null};d.prototype.getChatRoomUserCount=function(){return Object.keys(this.mChatRoomUsers).length};d.prototype.getChatRoomUsers=function(){for(var a=
[],b=Object.keys(this.mChatRoomUsers),d=0;d<b.length;d++)a.push(this.mChatRoomUsers[b[d]]);return a};d.prototype.registerAssociationChangeObserver=function(a){g.isEmpty(a)||-1!==this.mChatRoomAssociationChangeObservers.indexOf(a)||this.mChatRoomAssociationChangeObservers.push(a);return a};d.prototype.unregisterAssociationChangeObserver=function(a){-1!==this.mChatRoomAssociationChangeObservers.indexOf(a)&&this.mChatRoomAssociationChangeObservers.splice(this.mChatRoomAssociationChangeObservers.indexOf(a),
1)};d.prototype.onPresenceReceived=function(a){var d=a.getRoomPresence().getItems()[0],u=d.getJID(),p=a.getFrom().getNickname(),h=null;try{h=l.Person.fromJSONObject(JSON.parse(g.base32ToString(p)))}catch(k){try{h=l.Person.fromJSONObject(JSON.parse(g.base64ToString(p)))}catch(c){h=new l.Person(u)}}u=g.isEmpty(d.getRole())?f.Role.NONE:d.getRole();d=g.isEmpty(d.getAffiliation())?f.Affiliation.NONE:d.getAffiliation();d=new f.Association(u,d);h=new b.ChatRoomUser(h,d);a.getType()===q.PresenceType.AVAILABLE?
this.mChatRoomUsers[p]=h:a.getType()===q.PresenceType.UNAVAILABLE&&delete this.mChatRoomUsers[p];this.updateAssociationChangeObservers(h)};d.getLocalUserNickname=function(){return g.stringToBase32(JSON.stringify(a.getLocalUser().toJSONObject()))};d.prototype.updateAssociationChangeObservers=function(a){if(!g.isEmpty(this.mChatRoomAssociationChangeObservers))for(var b=0;b<this.mChatRoomAssociationChangeObservers.length;b++)this.mChatRoomAssociationChangeObservers[b].onAssociationChanged(a)};d.prototype.onLeaveRoom=
function(){this.mChatRoomAssociationChangeObservers=[]};return{ChatRoom:d}});t.when("AmazonComm/common/chatroom_class").execute(function(d){v["AmazonComm/common/chatroom_class"]=d});t.when("AmazonComm/utils/common","AmazonComm/utils/config").register("AmazonComm/common/jid_class",function(d,l){var f=function(b,f){d.isEmpty(b)&&(b=d.createUUID(d.TAG_JID));var g;g=-1===b.indexOf("@")?!1:!0;g||(b+="@",b=d.isEmpty(f)?b+l.getMessagingDomain():b+f);this.mJIDString=b};f.prototype.getJIDAsString=function(){return this.mJIDString};
f.prototype.getBareJID=function(){return-1===this.mJIDString.indexOf("/")?this.mJIDString:this.mJIDString.substring(0,this.mJIDString.indexOf("/"))};f.prototype.isGroupJID=function(){return-1!==this.mJIDString.indexOf(l.MUC_DOMAIN_PREFIX)};f.prototype.toString=function(){var b=this.mJIDString,d=b.substring(0,b.indexOf("@")),d="[..."+d.substring(d.length-20);return d=-1!==b.indexOf(l.MUC_DOMAIN_PREFIX)?d+"/group]":d+"]"};f.prototype.equals=function(b){return this.getBareJID().toLowerCase()===b.getBareJID().toLowerCase()};
f.prototype.isEqualsFullJID=function(b){return this.getResource()===b.getResource()&&this.equals(b)};f.prototype.setResource=function(b){if(d.isEmpty(b))return!1;var f=this.getResource();d.isEmpty(f)?this.mJIDString+="/"+b:this.mJIDString=this.mJIDString.replace("/"+f,"/"+b);return!0};f.prototype.setNickname=function(b){return this.isGroupJID()?this.setResource(b):!1};f.prototype.getResource=function(){return-1===this.mJIDString.indexOf("/")?null:this.mJIDString.substring(this.mJIDString.indexOf("/")+
1)};f.prototype.getNickname=function(){return this.isGroupJID()?this.getResource():null};f.prototype.toJSONObject=function(){return{mJIDString:this.mJIDString}};f.fromJSONObject=function(b){return new f(b.mJIDString)};return{JID:f}});t.when("AmazonComm/common/jid_class").execute(function(d){v["AmazonComm/common/jid_class"]=d});t.when("AmazonComm/utils/common","AmazonComm/common/jid_class").register("AmazonComm/common/person_class",function(d,l){var f=function(b,f,g,a,e,m,l){this.mBareJID=b;this.mName=
f;this.mThirdPartyID=g;this.mNameType=a;d.isEmpty(e)||(this.mMobile=e);d.isEmpty(m)||(this.mEmail=m);this.setUserExist(l)};f.prototype.toString=function(){return"Person:{name:["+this.mName+"], JID:"+this.mBareJID.toString()+", ThirdPartyID:["+this.mThirdPartyID+"], NameType:["+this.mNameType+"], Mobile:["+this.mMobile+"], Email:["+this.mEmail+"], User exists in Campfire:["+this.mUserExist+"]}"};f.prototype.getJID=function(){return this.mBareJID};f.prototype.setJID=function(b){this.mBareJID=b};f.prototype.getName=
function(){return this.mName};f.prototype.setName=function(b){this.mName=b};f.prototype.getThirdPartyID=function(){return this.mThirdPartyID};f.prototype.setThirdPartyID=function(b){this.mThirdPartyID=b};f.prototype.getNameType=function(){return this.mNameType};f.prototype.setNameType=function(b){this.mNameType=b};f.prototype.getMobile=function(){return this.mMobile};f.prototype.setMobile=function(b){this.mMobile=b};f.prototype.getEmail=function(){return this.mEmail};f.prototype.setEmail=function(b){this.mEmail=
b};f.prototype.isUserExist=function(){return this.mUserExist};f.prototype.setUserExist=function(b){if(!0===b||!1===b)this.mUserExist=b};f.prototype.equals=function(b){return this.mBareJID.equals(b.getJID())};f.prototype.toJSONObject=function(){return{mBareJID:this.mBareJID.toJSONObject(),mName:this.mName,mThirdPartyID:this.mThirdPartyID,mNameType:this.mNameType}};f.fromJSONObject=function(b){var d=new l.JID.fromJSONObject(b.mBareJID);return new f(d,b.mName,b.mThirdPartyID,b.mNameType)};return{Person:f}});
t.when("AmazonComm/common/person_class").execute(function(d){v["AmazonComm/common/person_class"]=d});t.when("AmazonComm/messaging/presence_manager","AmazonComm/utils/build","AmazonComm/utils/common","AmazonComm/utils/config","AmazonComm/utils/log","AmazonComm/utils/mash/campfire_cordova").register("AmazonComm/device/device_attributes",function(d,l,f,b,q,g){function a(a,e){if(f.isMashCordova())g.exec(a,[],e);else e.onError("Not in MASH context Or Cordova not defined")}function e(){f.isEmpty(document)||
(q.l("device_attributes","starting visibility change observer"),document.addEventListener("visibilitychange",function(){d.sendForegroundAppInfo(m())}))}function m(){var a={};a.isThisApp=!document.hidden;a.isThisApp&&(a.name=l.BUILD_VERSION);return a}function u(){f.isEmpty(navigator)||f.isEmpty(navigator.geolocation)||(q.l("device_attributes","starting geolocation observer"),navigator.geolocation.watchPosition(function(a){d.sendLocationInfo(p(a))}))}function p(a){var e={};e.latitude=a.coords.latitude;
e.longitude=a.coords.longitude;e.speed=a.coords.speed;return e}b.useWebDeviceAttributes()&&(e(),u());return{getBatteryInfo:function(e){a("getBatteryInfo",e)},getBluetoothInfo:function(e){a("getBluetoothInfo",e)},getLocationInfo:function(e){a("getLocationInfo",e)},getForegroundAppInfo:function(e){a("getForegroundAppInfo",e)},buildForegroundAppData:function(){return m()},buildLocationData:function(a){return p(a)}}});t.when("AmazonComm/device/device_attributes").execute(function(d){v["AmazonComm/device/device_attributes"]=
d});t.when("AmazonComm/auth/auth_utils","AmazonComm/metrics/metrics_manager","AmazonComm/utils/common","AmazonComm/utils/config","AmazonComm/utils/error_codes","AmazonComm/utils/global_state","AmazonComm/utils/log","AmazonComm/utils/services").register("AmazonComm/identity/customer_name_provider",function(d,l,f,b,q,g,a,e){function m(){var a=f.createUUID(f.TAG_REQUEST),e=b.getApiKey();return JSON.stringify({requestId:a,apiKey:e})}function u(u){var h=l.createMetricEvent("CustomerNameProvider",l.AGGREGATING_EVENT);
l.startTimer(h,"GetCustomerNameForAmazonCookie.ApiTimer");var k=b.getInternalServiceHost(),c={url:k,api:"getCustomerNameForAmazonCookie",payload:m(),withCredentials:!0},n={onXhrSendSuccess:function(c){c=JSON.parse(c.responseText);a.l("customer_name_provider","got response to getCustomerNameForAmazonCookie request from ["+c.serverName+"] ("+c.serverIP+")");c={customerId:c.customerId,customerName:c.customerName,customerNameType:d.parseNameType(c.customerNameType)};var e=g.getLocalUser(),b=e.getThirdPartyID(),
k=g.getAuthCredentialData().authStatus;f.isEmpty(b)||b===c.customerId||f.isEmpty(k)||k===d.AmazonAuthStatus.Unrecognized||k===d.AmazonAuthStatus.None?(a.l("customer_name_provider","setting local user name to ["+c.customerName+"["+c.customerNameType+"]]"),e.setName(c.customerName),e.setNameType(c.customerNameType),g.setLocalUser(e),l.stopTimer(h,"GetCustomerNameForAmazonCookie.ApiTimer"),l.recordMetricEvent(h),u.onGetCustomerNameForAmazonCookieSuccess(c)):(l.stopTimer(h,"GetCustomerNameForAmazonCookie.ApiTimer"),
l.incrementCounter(h,"GetCustomerNameForAmazonCookie.IdentityErrorCount"),l.recordMetricEvent(h),u.onGetCustomerNameForAmazonCookieError({code:q.IDENTITY_ERRORS.ERROR_CUSTOMER_ID_DIFFERENT_THAN_AUTH,description:"customer id is different than the one used for authentication"}))},onXhrSendRetry:u.onGetCustomerNameForAmazonCookieRetry,onXhrSendFailed:function(c){l.stopTimer(h,"GetCustomerNameForAmazonCookie.ApiTimer");l.recordMetricEvent(h);u.onGetCustomerNameForAmazonCookieError(c)}};a.l("customer_name_provider",
"exchanging amazon cookies for customer name info using ["+k+"]");e.sendRestXhrWithRetries(c,n)}return{getCustomerNameForAmazonCookie:function(a){u(a)}}});t.when("AmazonComm/identity/customer_name_provider").execute(function(d){v["AmazonComm/identity/customer_name_provider"]=d});t.when("AmazonComm/messaging/jsjac/connection","AmazonComm/messaging/native/connection","AmazonComm/utils/common","AmazonComm/utils/config","AmazonComm/utils/log").register("AmazonComm/messaging/connection_strategy",function(d,
l,f,b,q){var g=function(){var a;f.isMashCordova()&&!b.isProd()?(q.l("connection_strategy","mash context loaded, using NativeConnection"),a=l):(q.l("connection_strategy","mash context not found or running in prod, using JSJaCConnection"),a=d);return a}();return{getConnection:function(){return g}}});t.when("AmazonComm/messaging/connection_strategy").execute(function(d){v["AmazonComm/messaging/connection_strategy"]=d});t.when("AmazonComm/common/jid_class","AmazonComm/messaging/connection_strategy","AmazonComm/messaging/message_class",
"AmazonComm/messaging/receipt_class","AmazonComm/messaging/jsjac/node_utils","AmazonComm/utils/common","AmazonComm/metrics/metrics_manager","AmazonComm/utils/error_codes","AmazonComm/utils/global_state","AmazonComm/utils/log","3p-JSJaC").register("AmazonComm/messaging/conversation_class",function(d,l,f,b,q,g,a,e,m,u,p){function h(c){var a=new b.Receipt;g.isEmpty(c)||a.setCustomType(c);a.setSender(m.getLocalUser().getJID());a.setTime((new Date).getTime());return a}function k(c,a){var e=new f.Message,
b=m.getLocalUser();e.setID(c.getID());e.setFrom(b.getJID());e.setTo(c.getFrom());e.getTo().isGroupJID()?e.setType(f.TYPE_GROUPCHAT):e.setType(f.TYPE_CHAT);e.setAmzType(f.AMZ_TYPE_RECEIPT);e.setAmzSubType(a);e.setAmzSenderJID(b.getJID());e.setAmzSenderId(b.getThirdPartyID());return e}function c(c,a){for(var e=!1,b=0;b<c.length;b++){var h=c[b];if((g.isEmpty(a)||a===h.getCustomType())&&h.getSender().equals(m.getLocalUser().getJID())){e=!0;break}}return e}function n(c,a){var e=m.getLocalUser(),b=m.getPersonaName();
c.setFrom(e.getJID());c.setTo(a.getJID());a.getJID().isGroupJID()?c.setType(f.TYPE_GROUPCHAT):c.setType(f.TYPE_CHAT);c.setAmzSenderJID(e.getJID());c.setAmzSenderName(e.getName());c.setAmzSenderId(e.getThirdPartyID());g.isEmpty(b)||c.setAmzSenderPersona({name:b});return c}var r,w=l.getConnection();d=function(e){r=a.createMetricEvent("CampfireConversation",a.AGGREGATING_EVENT);this.mWith=e;this.mReadReceiptsEnabled=this.mDeliveryReceiptsEnabled=!1;this.mMessages=[];this.mMessageObserverList=[];var b=
this;w.addMessageHandler(f.AMZ_TYPE_MESSAGE,{onMessage:function(a){if(b.shouldContainMessage(a)&&(b.addMessage(a),b.areDeliveryReceiptsEnabled()&&!a.wasSentByUs())){var e=a.getAmzDeliveryReceipts();c(e)||(a=k(a,f.AMZ_SUBTYPE_RECEIPT_DELIVERY),a.setAmzDeliveryReceipts([h()]),w.sendMessage(a))}},onError:function(c){b.shouldContainMessage(c)&&b.addMessage(c)}});w.addMessageHandler(f.AMZ_TYPE_RECEIPT,{onMessage:function(c){if(b.shouldContainMessage(c)){var a=b.findMessageById(c.getID());if(!g.isEmpty(a)){var e=
c.getAmzDeliveryReceipts();g.isEmpty(e)||a.addAmzDeliveryReceipts(e);e=c.getAmzReadReceipts();g.isEmpty(e)||a.addAmzReadReceipts(e);c=c.getAmzCustomReceipts();g.isEmpty(c)||a.addAmzCustomReceipts(c);for(c=0;c<b.mMessageObserverList.length;c++)b.mMessageObserverList[c].onMessage(a)}}}});w.addMessageHandler(f.AMZ_TYPE_DATA,{onMessage:function(c){b.shouldContainMessage(c)&&b.addMessage(c)},onError:function(c){b.shouldContainMessage(c)&&b.addMessage(c)}})};d.prototype.shouldContainMessage=function(c){return c.getWith().equals(this.getWith().getJID())};
d.prototype.findMessageById=function(c){for(var a=this.mMessages.length-1;0<=a;a--)if(this.mMessages[a].getID()===c)return this.mMessages[a];return null};d.prototype.getWith=function(){return this.mWith};d.prototype.sendTextMessage=function(c){var a=new f.Message;a.setAmzType(f.AMZ_TYPE_MESSAGE);a.setAmzSubType(f.AMZ_SUBTYPE_MESSAGE_TEXT);a.setAmzContent(c);a=n(a,this.mWith);w.sendMessage(a,this.mMessageTimeout);this.mComposingSent=!1;return a};d.prototype.sendDataMessage=function(c,a){m.getLocalUser();
var e=new f.Message;e.setAmzType(f.AMZ_TYPE_DATA);a?e.setAmzSubType(f.AMZ_SUBTYPE_DATA_OBJECT_ARCHIVABLE):e.setAmzSubType(f.AMZ_SUBTYPE_DATA_OBJECT_NON_ARCHIVABLE);e.setAmzData(c);e=n(e,this.mWith);w.sendMessage(e,this.mMessageTimeout);return e};d.prototype.sendReadReceipt=function(a){if(this.areReadReceiptsEnabled()&&!a.wasSentByUs()){var e=a.getAmzReadReceipts();c(e)||(a=k(a,f.AMZ_SUBTYPE_RECEIPT_READ),a.setAmzReadReceipts([h()]),w.sendMessage(a))}};d.prototype.sendCustomReceipt=function(a,e){if(!a.wasSentByUs()){var b=
a.getAmzCustomReceipts();c(b,e)||(a=k(a,f.AMZ_SUBTYPE_RECEIPT_CUSTOM),a.setAmzCustomReceipts([h(e)]),w.sendMessage(a))}};d.prototype.setMessageTimeout=function(c){this.mMessageTimeout=c};d.prototype.setDeliveryReceiptsEnabled=function(c){this.mDeliveryReceiptsEnabled=c};d.prototype.areDeliveryReceiptsEnabled=function(){return this.mDeliveryReceiptsEnabled};d.prototype.setReadReceiptsEnabled=function(c){this.mReadReceiptsEnabled=c};d.prototype.areReadReceiptsEnabled=function(){return this.mReadReceiptsEnabled};
d.prototype.sendUpdatedMessage=function(c){c.setAmzIsUpdated(!0);c.setTo(this.mWith.getJID());w.sendMessage(c)};d.prototype.sendRetryMessage=function(c){c.hasBeenReceivedByServer()||(a.incrementCounter(r,"Conversation.MessageRetryCount"),a.recordMetricEvent(r),c.setError(!1),c.setTo(this.mWith.getJID()),w.sendMessage(c,this.mMessageTimeout));return c};d.prototype.sendComposingChatState=function(){var c=f.CHAT_STATE_COMPOSING,a=this.mWith,e=new f.Message;e.setAmzType(f.AMZ_TYPE_CHATSTATE);e.setChatStateComposing(c===
f.CHAT_STATE_COMPOSING);e.setChatStatePaused(c===f.CHAT_STATE_PAUSED);e=n(e,a);w.sendMessage(e)};d.prototype.addIncomingMessageObserver=function(c){var a=this.mWith.getJID(),e=w.addMessageHandler(f.AMZ_TYPE_MESSAGE,{onMessage:function(e){if(e.getWith().equals(a))c.onMessage(e)},onError:function(e){if(e.getWith().equals(a))c.onError(e)}});this.mMessageObserverList.push(e);return e};d.prototype.removeIncomingMessageObserver=function(c){var a=this.mMessageObserverList.indexOf(c);-1<a&&this.mMessageObserverList.splice(a,
1);w.removeMessageHandler(f.AMZ_TYPE_MESSAGE,c)};d.prototype.addIncomingDataObserver=function(c){var a=this.mWith.getJID();return w.addMessageHandler(f.AMZ_TYPE_DATA,{onMessage:function(e){if(e.getWith().equals(a))c.onMessage(e)},onError:function(e){if(e.getWith().equals(a))c.onError(e)}})};d.prototype.removeIncomingDataObserver=function(c){w.removeMessageHandler(f.AMZ_TYPE_DATA,c)};d.prototype.addIncomingReceiptObserver=function(c){var a=this.mWith.getJID();return w.addMessageHandler(f.AMZ_TYPE_RECEIPT,
{onMessage:function(e){if(e.getWith().equals(a))c.onMessage(e)}})};d.prototype.removeIncomingReceiptObserver=function(c){w.removeMessageHandler(f.AMZ_TYPE_RECEIPT,c)};d.prototype.addIncomingChatStateObserver=function(c){var a=this.mWith.getJID();return w.addMessageHandler(f.AMZ_TYPE_CHATSTATE,{onMessage:function(e){if(e.getWith().equals(a))c.onChatState(e)}})};d.prototype.removeIncomingChatStateObserver=function(c){w.removeMessageHandler(f.AMZ_TYPE_CHATSTATE,c)};d.prototype.removeLocalMessage=function(c){for(var a=
this.mMessages.length-1;0<=a;a--)if(this.mMessages[a].getID()===c){this.mMessages.splice(a,1);break}};d.prototype.buildLoadMessagesIQ=function(c,a){var e=new p.JSJaCIQ;e.setType("set");e.setID(g.createUUID(g.TAG_IQ));var b=q.appendNodeWithAttribute(e,e,"query","xmlns","urn:xmpp:mam:1"),h=q.appendNodeWithAttribute(e,b,"x","xmlns","jabber:x:data"),d=q.appendNodeWithAttribute(e,h,"field","var","FORM_TYPE");q.appendNodeWithText(e,d,"value","urn:xmpp:mam:1");d=q.appendNodeWithAttribute(e,h,"field","var",
"with");q.appendNodeWithText(e,d,"value",this.mWith.getJID().getJIDAsString());g.isEmpty(a)||(d=q.appendNodeWithAttribute(e,h,"field","var","includeBorder"),q.appendNodeWithText(e,d,"value",a));g.isEmpty(c)||(a=q.appendNodeWithAttribute(e,b,"set","xmlns","http://jabber.org/protocol/rsm"),q.appendNodeWithText(e,a,"max",c.count.toString()),g.isEmpty(c.last)||q.appendNodeWithText(e,a,"before",c.last),g.isEmpty(c.mediaType)||(h=q.appendNodeWithAttribute(e,h,"field","var","mediaType"),q.appendNodeWithText(e,
h,"value",c.mediaType)));return e};d.prototype.handleLoadMessagesResult=function(c){var a=c.getChild();c={};if(g.isEmpty(a))u.l("conversation","Received message history not paginated."),c.count=0,c.isComplete=!0;else{var e=a.getAttribute("complete");c.isComplete=!g.isEmpty(e)&&"true"===e;e=a.getAttribute("mediaType");g.isEmpty(e)||(c.mediaType=e);a=q.getChildNode(a,"set");e=q.getChildNode(a,"first");g.isEmpty(e)||(c.first=e.textContent);e=q.getChildNode(a,"last");g.isEmpty(e)||(c.last=e.textContent);
e=q.getChildNode(a,"count");c.count=parseInt(e.textContent,10);a=q.getChildNode(a,"max");c.max=parseInt(a.textContent,10)}return c};d.prototype.loadMessages=function(c,a,e){c=this.buildLoadMessagesIQ(c,e);var b=this;w.sendPacket(c,!1,function(c){c.isError()?(c=q.getCampfireErrorFromPacket(c),a.onError(c)):(c=b.handleLoadMessagesResult(c),a.onPage(c,b))})};d.prototype.addMessage=function(c){c.getAck()&&c.wasSentByUs()&&this.removeLocalMessage(c.getAck());if(0===this.mMessages.length)this.mMessages.push(c);
else for(var a=this.mMessages.length-1;0<=a;a--){if(this.mMessages[a].getAmzSortTime()<c.getAmzSortTime()||this.mMessages[a].getAmzSortTime()===c.getAmzSortTime()&&this.mMessages[a].getSecondaryAmzSortTime()<=c.getSecondaryAmzSortTime()){this.mMessages.splice(a+1,0,c);break}0===a&&this.mMessages.unshift(c)}2500<this.mMessages.length&&this.mMessages.splice(0,1)};d.prototype.getMessages=function(){return this.mMessages};d.prototype.getNewestMessage=function(){return g.isEmpty(this.mMessages)?null:this.mMessages[this.mMessages.length-
1]};d.prototype.toString=function(){return"Conversation:{with:"+this.mWith.toString()+"}"};return{Conversation:d}});t.when("AmazonComm/messaging/conversation_class").execute(function(d){v["AmazonComm/messaging/conversation_class"]=d});t.when("AmazonComm/common/chatroom_class","AmazonComm/common/jid_class","AmazonComm/common/person_class","AmazonComm/messaging/connection_strategy","AmazonComm/messaging/conversation_class","AmazonComm/messaging/message_class","AmazonComm/messaging/chatroom/chat_room_manager",
"AmazonComm/messaging/jsjac/node_utils","AmazonComm/utils/common","AmazonComm/utils/log","3p-JSJaC").register("AmazonComm/messaging/conversation_manager",function(d,l,f,b,q,g,a,e,m,u,p){function h(){for(var c in C)if(C.hasOwnProperty(c)){var e=C[c],b={onJoined:function(){u.l("conversation_manager","Joined room ["+e.getWith()+"]")},onError:function(c){u.e("conversation_manager","error joining room ["+e.getWith()+"]")}};e.getWith()instanceof d.ChatRoom&&a.joinRoom(e.getWith(),b)}}function k(c){var a=
c.getWith();if(m.isEmpty(C[a])){var e=c.getType();if(e===g.TYPE_CHAT){a=w(new f.Person(a,c.getAmzSenderName(),c.getAmzSenderId()));a.addMessage(c);for(c=0;c<I.length;c++)I[c].onNewConversation(a);return!0}u.e("conversation_manager","Invalid state: Unexpected message type ["+e+"].")}return!1}function c(c){var a=c.getJID();m.isEmpty(C[a])&&w(c);return C[a]}function n(){var c=new p.JSJaCIQ;c.setType("set");c.setID(m.createUUID(m.TAG_IQ));e.appendNodeWithAttribute(c,c,"query","xmlns","urn:xmpp:amazon:inbox");
return c}function r(a){a=a.getChild().childNodes;for(var e=[],b,h=0;h<a.length;h++){b=a[h];var k=b.getAttribute("type");k===g.TYPE_GROUPCHAT?b=c(new d.ChatRoom(new l.JID(b.getAttribute("with")),b.getAttribute("name"))):k===g.TYPE_CHAT?b=c(new f.Person(new l.JID(b.getAttribute("with")),b.getAttribute("name"),"")):(u.e("conversation_manager","unknown conversation type ["+k+"]"),b=null);m.isEmpty(b)||e.push(b)}return e}function w(c){var a=new q.Conversation(c);return C[c.getJID()]=a}function t(c){G.sendPacket(n(),
!1,function(a){a=r(a);u.l("conversation_manager","loaded "+a.length+" conversations");c(a)})}function v(c){u.l("conversation_manager","loading inbox");t(function(e){for(var b=0;b<e.length;b++){var h=e[b];if(h.getWith()instanceof d.ChatRoom){var k=F.bind({conversation:h,observer:c});a.joinRoom(h.getWith(),{onJoined:k,onError:function(a){c.onError(a)}},{maxMessages:0})}else h.loadMessages({count:1},{onPage:function(a,e){c.onConversation({conversation:e})}})}})}var G=b.getConnection(),C={},I=[],F=function(){var c=
this.observer;this.conversation.loadMessages({count:1},{onPage:function(a,e){c.onConversation({conversation:e})}})};(function(){G.addMessageHandler(g.AMZ_TYPE_MESSAGE,{onMessage:function(c){k(c)},onError:function(c){k(c)}});G.addMessageHandler(g.AMZ_TYPE_DATA,{onMessage:function(c){k(c)},onError:function(c){k(c)}});G.addObserver({onError:function(c){u.e("conversation_manager","error connecting to Openfire.")},onReconnecting:function(){},onDisconnected:function(){C={}},onConnected:function(c){u.l("conversation_manager",
"on connected. trying to join rooms.["+c+"]");h()}})})();return{loadInbox:function(c){v(c)},getConversation:function(a,e){a=c(a);e.onSuccess({conversation:a})},getOrCreateConversation:function(a){return c(a)},addNewConversationHandler:function(c){I.push(c)},handleNewMessage:function(c){return k(c)},buildInboxIQ:function(){return n()},handleInboxResult:function(c){return r(c)},loadConversationList:function(c){return t(c)},getConversations:function(){return C}}});t.when("AmazonComm/messaging/conversation_manager").execute(function(d){v["AmazonComm/messaging/conversation_manager"]=
d});t.when("AmazonComm/common/jid_class","AmazonComm/messaging/receipt_class","AmazonComm/utils/build","AmazonComm/utils/common","AmazonComm/utils/config","AmazonComm/utils/global_state").register("AmazonComm/messaging/message_class",function(d,l,f,b,q,g){var a=function(){this.mID=b.createUUID(b.TAG_MESSAGE);this.mTo=this.mFrom="";this.mBody={};this.mError=!1;this.mBody.amz_time_created=(new Date).getTime();this.mBody.amz_marketplace_id=q.getMarketplaceId();q.isExtendedMessageMetadataEnabled()&&(this.mBody.amz_version=
f.BUILD_VERSION,this.mBody.amz_time_sent=0,this.mBody.amz_time_server_received=0,this.mBody.amz_time_received=0,this.mBody.amz_sender_location={},this.mBody.amz_keep_until=-1,this.mBody.amz_delivery_receipts=[],this.mBody.amz_read_receipts=[],this.mBody.amz_custom_receipts=[],this.mBody.amz_filter_details=[],this.mBody.amz_sender_profile={})};a.prototype.getID=function(){return this.mID};a.prototype.setID=function(a){this.mID=a};a.prototype.getAck=function(){return this.mAck};a.prototype.setAck=function(a){this.mAck=
a};a.prototype.getError=function(){return this.mError};a.prototype.setError=function(a){this.mError=a};a.prototype.getFrom=function(){return this.mFrom};a.prototype.setFrom=function(a){this.mFrom=a};a.prototype.getTo=function(){return this.mTo};a.prototype.setTo=function(a){this.mTo=a};a.prototype.getType=function(){return this.mType};a.prototype.setType=function(a){this.mType=a};a.prototype.getBody=function(){return this.mBody};a.prototype.setBody=function(a){this.mBody=a;b.isEmpty(this.mBody.amz_time_created)&&
(this.mBody.amz_time_created=(new Date).getTime());if(q.isExtendedMessageMetadataEnabled()){b.isEmpty(this.mBody.amz_version)&&(this.mBody.amz_version=f.BUILD_VERSION);b.isEmpty(this.mBody.amz_time_sent)&&(this.mBody.amz_time_sent=0);b.isEmpty(this.mBody.amz_time_server_received)&&(this.mBody.amz_time_server_received=0);b.isEmpty(this.mBody.amz_time_received)&&(this.mBody.amz_time_received=0);b.isEmpty(this.mBody.amz_sender_location)&&(this.mBody.amz_sender_location={});b.isEmpty(this.mBody.amz_keep_until)&&
(this.mBody.amz_keep_until=-1);b.isEmpty(this.mBody.amz_delivery_receipts)&&(this.mBody.amz_delivery_receipts=[]);b.isEmpty(this.mBody.amz_read_receipts)&&(this.mBody.amz_read_receipts=[]);b.isEmpty(this.mBody.amz_custom_receipts)&&(this.mBody.amz_custom_receipts=[]);b.isEmpty(this.mBody.amz_sender_profile)&&(this.mBody.amz_sender_profile={});for(a=0;a<this.mBody.amz_delivery_receipts.length;a++)this.mBody.amz_delivery_receipts[a]=new l.Receipt(this.mBody.amz_delivery_receipts[a]);for(a=0;a<this.mBody.amz_read_receipts.length;a++)this.mBody.amz_read_receipts[a]=
new l.Receipt(this.mBody.amz_read_receipts[a]);for(a=0;a<this.mBody.amz_custom_receipts.length;a++)this.mBody.amz_custom_receipts[a]=new l.Receipt(this.mBody.amz_custom_receipts[a]);b.isEmpty(this.mBody.amz_filter_details)&&(this.mBody.amz_filter_details=[])}};a.prototype.getSubject=function(){return this.mSubject};a.prototype.setSubject=function(a){this.mSubject=a};a.prototype.getAmzType=function(){return this.mBody.amz_type};a.prototype.setAmzType=function(a){this.mBody.amz_type=a};a.prototype.getAmzSubType=
function(){return this.mBody.amz_subtype};a.prototype.setAmzSubType=function(a){this.mBody.amz_subtype=a};a.prototype.getAmzVersion=function(){return this.mBody.amz_version};a.prototype.getAmzTimeCreated=function(){return this.mBody.amz_time_created};a.prototype.setAmzTimeCreated=function(a){this.mBody.amz_time_created=a};a.prototype.getAmzTimeSent=function(){return this.mBody.amz_time_sent};a.prototype.setAmzTimeSent=function(a){this.mBody.amz_time_sent=a};a.prototype.getAmzTimeServerReceived=function(){return this.mBody.amz_time_server_received};
a.prototype.setAmzTimeServerReceived=function(a){this.mBody.amz_time_server_received=a};a.prototype.getAmzTimeServerFirstProcessed=function(){var a=this.mBody.amz_time_server_received;b.isEmpty(this.mBody.amz_time_server_first_processed)||(a=this.mBody.amz_time_server_first_processed);return a};a.prototype.setAmzTimeServerFirstProcessed=function(a){this.mBody.amz_time_server_first_processed=a};a.prototype.getAmzTimeReceived=function(){return this.mBody.amz_time_received};a.prototype.setAmzTimeReceived=
function(a){this.mBody.amz_time_received=a};a.prototype.getAmzSenderJID=function(){return b.isEmpty(this.mBody.amz_sender_jid)?null:new d.JID(this.mBody.amz_sender_jid)};a.prototype.setAmzSenderJID=function(a){this.mBody.amz_sender_jid=a.getJIDAsString()};a.prototype.getAmzSenderName=function(){return this.mBody.amz_sender_name};a.prototype.setAmzSenderName=function(a){this.mBody.amz_sender_name=a};a.prototype.getAmzSenderId=function(){return this.mBody.amz_sender_id};a.prototype.setAmzSenderId=function(a){this.mBody.amz_sender_id=
a};a.prototype.getAmzSenderRole=function(){return this.mBody.amz_sender_role};a.prototype.setAmzSenderRole=function(a){this.mBody.amz_sender_role=a};a.prototype.getAmzSenderLocation=function(){return this.mBody.amz_sender_location};a.prototype.getAmzSenderLocationLatitude=function(){return this.mBody.amz_sender_location.latitude};a.prototype.setAmzSenderLocationLatitude=function(a){this.mBody.amz_sender_location.latitude=a};a.prototype.getAmzSenderLocationLongitude=function(){return this.mBody.amz_sender_location.longitude};
a.prototype.setAmzSenderLocationLongitude=function(a){this.mBody.amz_sender_location.longitude=a};a.prototype.getAmzDeliveryReceipts=function(){return this.mBody.amz_delivery_receipts};a.prototype.setAmzDeliveryReceipts=function(a){this.mBody.amz_delivery_receipts=a};a.prototype.getAmzReadReceipts=function(){return this.mBody.amz_read_receipts};a.prototype.setAmzReadReceipts=function(a){this.mBody.amz_read_receipts=a};a.prototype.getAmzCustomReceipts=function(){return this.mBody.amz_custom_receipts};
a.prototype.setAmzCustomReceipts=function(a){this.mBody.amz_custom_receipts=a};a.prototype.getAmzResponsePrediction=function(){return this.mBody.amz_response_prediction};a.prototype.setAmzResponsePrediction=function(a){this.mBody.amz_response_prediction=a};a.prototype.getAmzKeepUntil=function(){return this.mBody.amz_keep_until};a.prototype.setAmzKeepUntil=function(a){this.mBody.amz_keep_until=a};a.prototype.getAmzContent=function(){return this.mBody.amz_content};a.prototype.setAmzContent=function(a){this.mBody.amz_content=
a};a.prototype.getAmzAlternateContent=function(){return this.mBody.amz_alternate_content};a.prototype.setAmzAlternateContent=function(a){this.mBody.amz_alternate_content=a};a.prototype.getAmzData=function(){return this.mBody.amz_data};a.prototype.setAmzData=function(a){this.mBody.amz_data=a};a.prototype.getAmzCaption=function(){return this.mBody.amz_caption};a.prototype.setAmzCaption=function(a){this.mBody.amz_caption=a};a.prototype.getAmzCallId=function(){return this.mBody.amz_call_id};a.prototype.setAmzCallId=
function(a){this.mBody.amz_call_id=a};a.prototype.getAmzCallData=function(){return this.mBody.amz_call_data};a.prototype.setAmzCallData=function(a){this.mBody.amz_call_data=a};a.prototype.getAmzUserData=function(){return this.mBody.amz_user_data};a.prototype.setAmzUserData=function(a){this.mBody.amz_user_data=a};a.prototype.getAmzAccept=function(){return this.mBody.amz_accept};a.prototype.setAmzAccept=function(a){this.mBody.amz_accept=a};a.prototype.getAmzSignalData=function(){return this.mBody.amz_signal_data};
a.prototype.setAmzSignalData=function(a){this.mBody.amz_signal_data=a};a.prototype.getChatStateComposing=function(){return this.composing};a.prototype.setChatStateComposing=function(a){this.composing=a};a.prototype.getChatStatePaused=function(){return this.paused};a.prototype.setChatStatePaused=function(a){this.paused=a};a.prototype.getAmzGroupInviteJID=function(){return b.isEmpty(this.mBody.amz_group_invite_jid)?null:new d.JID(this.mBody.amz_group_invite_jid)};a.prototype.setAmzGroupInviteJID=function(a){this.mBody.amz_group_invite_jid=
a.getJIDAsString()};a.prototype.getAmzGroupModifiedJID=function(){return b.isEmpty(this.mBody.amz_group_modified_jid)?null:new d.JID(this.mBody.amz_group_modified_jid)};a.prototype.setAmzGroupModifiedJID=function(a){this.mBody.amz_group_modified_jid=a.getJIDAsString()};a.prototype.getAmzIsFiltered=function(){return this.mBody.amz_is_filtered||!1};a.prototype.setAmzIsFiltered=function(a){this.mBody.amz_is_filtered=a};a.prototype.getAmzFilterDetails=function(){return this.mBody.amz_filter_details};
a.prototype.setAmzFilterDetails=function(a){this.mBody.amz_filter_details=a};a.prototype.getAmzIsReported=function(){return this.mBody.amz_is_reported||!1};a.prototype.setAmzIsReported=function(a){this.mBody.amz_is_reported=a};a.prototype.getAmzReporterDetails=function(){return this.mBody.amz_reporter_details};a.prototype.setAmzReporterDetails=function(a){this.mBody.amz_reporter_details=a};a.prototype.getAmzIsUpdated=function(){return this.mBody.amz_is_updated||!1};a.prototype.setAmzIsUpdated=function(a){this.mBody.amz_is_updated=
a};a.prototype.setAmzSenderProfile=function(a){this.mBody.amz_sender_profile=a};a.prototype.getAmzSenderProfile=function(){return this.mBody.amz_sender_profile};a.prototype.setAmzSenderPersona=function(a){this.mBody.amz_sender_persona=a};a.prototype.getAmzSenderPersona=function(){return this.mBody.amz_sender_persona};a.prototype.addAmzDeliveryReceipts=function(a){for(var b=0;b<a.length;b++)this.containsAmzDeliveryReceipt(a[b])||this.mBody.amz_delivery_receipts.push(a[b])};a.prototype.containsAmzDeliveryReceipt=
function(a){for(var b=0;b<this.mBody.amz_delivery_receipts.length;b++)if(this.mBody.amz_delivery_receipts[b].getSender().equals(a.getSender()))return!0;return!1};a.prototype.hasAmzDeliveryReceipts=function(){return!b.isEmpty(this.mBody.amz_delivery_receipts)};a.prototype.addAmzReadReceipts=function(a){for(var b=0;b<a.length;b++)this.containsAmzReadReceipt(a[b])||this.mBody.amz_read_receipts.push(a[b])};a.prototype.containsAmzReadReceipt=function(a){for(var b=0;b<this.mBody.amz_read_receipts.length;b++)if(this.mBody.amz_read_receipts[b].getSender().equals(a.getSender()))return!0;
return!1};a.prototype.hasAmzReadReceipts=function(){return!b.isEmpty(this.mBody.amz_read_receipts)};a.prototype.addAmzCustomReceipts=function(a){for(var b=0;b<a.length;b++)this.containsAmzCustomReceipt(a[b])||this.mBody.amz_custom_receipts.push(a[b])};a.prototype.containsAmzCustomReceipt=function(a){for(var b=0;b<this.mBody.amz_custom_receipts.length;b++)if(this.mBody.amz_custom_receipts[b].getSender().equals(a.getSender())&&this.mBody.amz_custom_receipts[b].getCustomType()===a.getCustomType())return!0;
return!1};a.prototype.hasAmzCustomReceipts=function(){return!b.isEmpty(this.mBody.amz_custom_receipts)};a.prototype.getShortId=function(){return"[..."+this.mID.substring(this.mID.length-5)+"]"};a.prototype.getWith=function(){var a=null;this.mFrom.equals(g.getLocalUser().getJID())?this.mTo.equals(g.getLocalUser().getJID())||(a=this.mTo):a=this.mFrom;return a};a.prototype.getSender=function(){return b.isEmpty(this.getAmzSenderJID())?this.getFrom():this.getAmzSenderJID()};a.prototype.wasSentByUs=function(){return this.mFrom.equals(g.getLocalUser().getJID())||
(new d.JID(this.mBody.amz_sender_jid)).equals(g.getLocalUser().getJID())?!0:!1};a.prototype.getAmzSortTime=function(){return 0===this.getAmzTimeServerFirstProcessed()?this.hasBeenSent()?this.getAmzTimeSent():this.getAmzTimeCreated():this.getAmzTimeServerFirstProcessed()};a.prototype.getSecondaryAmzSortTime=function(){return 0===this.getAmzTimeServerReceived()?this.hasBeenSent()?this.getAmzTimeSent():this.getAmzTimeCreated():this.getAmzTimeServerReceived()};a.prototype.getAmzDisplayTime=function(){return this.hasBeenSent()?
this.getAmzTimeSent():this.getAmzTimeCreated()};a.prototype.hasSubject=function(){return!b.isEmpty(this.mSubject)};a.prototype.hasAmzContent=function(){return!b.isEmpty(this.mBody.amz_content)};a.prototype.hasAmzAlternateContent=function(){return!b.isEmpty(this.mBody.amz_alternate_content)};a.prototype.hasBeenSent=function(){return!b.isEmpty(this.mBody.amz_time_sent)&&0!==this.mBody.amz_time_sent};a.prototype.hasBeenReceivedByServer=function(){return!b.isEmpty(this.mBody.amz_time_server_received)&&
0!==this.mBody.amz_time_server_received};a.prototype.hasBeenReceived=function(){return!b.isEmpty(this.mBody.amz_time_received)&&0!==this.mBody.amz_time_received};a.prototype.isRead=function(){var a;if(this.wasSentByUs())return!0;for(a=0;a<this.mBody.amz_read_receipts.length;a++)if(this.mBody.amz_read_receipts[a].getSender().equals(g.getLocalUser().getJID()))return!0;return!1};a.prototype.getRecipientCount=function(a){for(var b=[],d=0,g=0;g<a.length;g++){var h=a[g].getSender().getJIDAsString();-1===
b.indexOf(h)&&(b.push(h),d++)}return d};a.prototype.getMinReceiptTime=function(a){for(var b=Number.MAX_VALUE,d=0;d<a.length;d++)a[d].getTime()<b&&(b=a[d].getTime());return b};a.prototype.getAmzDeliveryReceiptJIDCount=function(){return this.getRecipientCount(this.mBody.amz_delivery_receipts)};a.prototype.getAmzDeliveryReceiptMinTime=function(){return this.getMinReceiptTime(this.mBody.amz_delivery_receipts)};a.prototype.getAmzReadReceiptJIDCount=function(){return this.getRecipientCount(this.mBody.amz_read_receipts)};
a.prototype.getAmzReadReceiptMinTime=function(){return this.getMinReceiptTime(this.mBody.amz_read_receipts)};a.prototype.addFilter=function(a,d,g){a={name:a,confidence:d};b.isEmpty(g)||(a.metadata=g);b.isEmpty(this.getAmzFilterDetails())&&this.setAmzFilterDetails([]);this.getAmzFilterDetails().push(a);this.setAmzIsFiltered(!0)};a.prototype.addReporter=function(a,d){a={reporter:a};b.isEmpty(d)||(a.metadata=d);b.isEmpty(this.getAmzReporterDetails())&&this.setAmzReporterDetails([]);this.getAmzReporterDetails().push(a);
this.setAmzIsReported(!0)};a.prototype.getAmzMarketplaceId=function(){return this.mBody.amz_marketplace_id};a.prototype.setAmzMarketplaceId=function(a){this.mBody.amz_marketplace_id=a};a.prototype.equals=function(a){return b.deepEquals(this,a)};a.prototype.toString=function(){return"Message:{id:["+this.mID+"], from:"+this.mFrom.toString()+", to:"+this.mTo.toString()+", type:["+this.mType+"], error:["+this.mError+"], subject:["+this.mSubject+"], paused:["+this.paused+"], composing:["+this.composing+
"], body:["+JSON.stringify(this.mBody)+"]}"};return{Message:a,TYPE_CHAT:"chat",TYPE_GROUPCHAT:"groupchat",TYPE_NORMAL:"normal",TYPE_ERROR:"error",AMZ_TYPE_MESSAGE:"message",AMZ_TYPE_RECEIPT:"receipt",AMZ_TYPE_CHATSTATE:"chatstate",AMZ_TYPE_GROUP_MODIFIED:"group_modified",AMZ_TYPE_SIGNAL:"signal",AMZ_TYPE_CAPTION:"caption",AMZ_TYPE_GROUP_INVITE:"group_invite",AMZ_TYPE_GROUP_INVITE_DECLINE:"group_invite_decline",AMZ_TYPE_DATA:"data",AMZ_SUBTYPE_MESSAGE_TEXT:"text",AMZ_SUBTYPE_MESSAGE_VIDEOCALL:"videocall",
AMZ_SUBTYPE_MESSAGE_VOICEMAIL:"voicemail",AMZ_SUBTYPE_RECEIPT_DELIVERY:"delivery",AMZ_SUBTYPE_RECEIPT_READ:"read",AMZ_SUBTYPE_RECEIPT_CUSTOM:"custom",AMZ_SUBTYPE_JID_ADDED:"jid_added",AMZ_SUBTYPE_JID_REMOVED:"jid_removed",AMZ_SUBTYPE_SIGNAL_INVITE:"invite",AMZ_SUBTYPE_SIGNAL_ACK:"ack",AMZ_SUBTYPE_SIGNAL_BYE:"bye",AMZ_SUBTYPE_SIGNAL_OFFER:"offer",AMZ_SUBTYPE_SIGNAL_MCU_INFO:"mcuInfo",AMZ_SUBTYPE_SIGNAL_CANDIDATE:"candidate",AMZ_SUBTYPE_SIGNAL_ANSWER:"answer",AMZ_SUBTYPE_DATA_OBJECT_ARCHIVABLE:"data_object_archivable",
AMZ_SUBTYPE_DATA_OBJECT_NON_ARCHIVABLE:"data_object_non_archivable",CHAT_STATE_COMPOSING:"composing",CHAT_STATE_PAUSED:"paused",createFromJSONString:function(b){b=JSON.parse(b);var g=new a;g.setID(b.id);g.setAck(b.ack);g.setError(b.error);g.setFrom(new d.JID(b.from));g.setTo(new d.JID(b.to));g.setType(b.type);g.setBody(b.body);g.setSubject(b.subject);g.setChatStateComposing(b.composing);g.setChatStatePaused(b.paused);return g},createFromNode:function(b){var g=new a;g.setID(b.getAttribute("id"));g.setAck(b.getAttribute("amz_ack"));
g.setFrom(new d.JID(b.getAttribute("from")));g.setTo(new d.JID(b.getAttribute("to")));g.setType("chat");b=b.getElementsByTagName("body")[0];g.setBody(JSON.parse(b.textContent));return g},createChatMessageObject:function(b,d,g,f){var h=new a;h.setID(b);h.setFrom(d);h.setTo(g);d.isGroupJID()||g.isGroupJID()?h.setType("groupchat"):h.setType("chat");h.setBody(JSON.parse(f));return h},convertMessageToJSONObject:function(a){return{id:a.getID(),ack:a.getAck(),error:a.getError(),from:a.getFrom().getJIDAsString(),
to:a.getTo().getJIDAsString(),type:a.getType(),subject:a.getSubject(),body:a.getBody(),paused:a.getChatStatePaused(),composing:a.getChatStateComposing()}}}});t.when("AmazonComm/messaging/message_class").execute(function(d){v["AmazonComm/messaging/message_class"]=d});t.when("AmazonComm/common/jid_class","AmazonComm/common/person_class","AmazonComm/utils/common","3p-JSJaC").register("AmazonComm/messaging/presence_class",function(d,l,f,b){var q=Object.freeze({AVAILABLE:"available",ERROR:"error",PROBE:"probe",
SUBSCRIBE:"subscribe",SUBSCRIBED:"subscribed",UNAVAILABLE:"unavailable",UNSUBSCRIBE:"unsubscribe",UNSUBSCRIBED:"unsubscribed"}),g=Object.freeze({AWAY:"away",CHAT:"chat",DO_NOT_DISTURB:"dnd",EXTENDED_AWAY:"xa",ONLINE:"online"});d=Object.freeze({ROOM_OCCUPANT:"110",ROOM_LOGGING_ENABLED:"170",ROOM_CREATED:"201",PERSON_NICK_MODIFIED:"210",BANNED_FROM_ROOM:"301",ROOM_NICK_MODIFIED:"303",KICKED_FROM_ROOM:"307",AFFILIATION_CHANGED:"321",MEMBERS_ONLY:"322",SHUTDOWN:"332"});l=Object.freeze({ACTIVATED:"ACTIVATED",
DEACTIVATED:"DEACTIVATED"});var a=q.AVAILABLE;b=function(){this.mID=f.createUUID(f.TAG_PRESENCE);this.mTo=this.mFrom=null;this.mType=a;this.mShow=g.ONLINE;this.mPriority=this.mStatus=this.mError=this.mMucPresence=null;this.mHasReachableAddress=!1;this.mChatability=this.mSenderCustomerId=this.mSenderName=null};var e=function(){this.mStatusCodes=[];this.mItems=[];this.mRoomStatus=null},m=function(){this.mReason=this.mActor=this.mJID=this.mAffiliation=this.mRole=this.mNick=null};b.prototype.getID=function(){return this.mID};
b.prototype.setID=function(a){this.mID=a};b.prototype.getFrom=function(){return this.mFrom};b.prototype.setFrom=function(a){this.mFrom=a};b.prototype.getTo=function(){return this.mTo};b.prototype.setTo=function(a){this.mTo=a};b.prototype.getType=function(){return this.mType};b.prototype.setType=function(a){this.mType=a};b.prototype.isError=function(){return this.mType===q.ERROR};b.prototype.getError=function(){return this.mError};b.prototype.setError=function(a){this.mError=a};b.prototype.getShow=
function(){return this.mShow};b.prototype.setShow=function(a){this.mShow=a};b.prototype.getStatus=function(){return this.mStatus};b.prototype.setStatus=function(a){this.mStatus=a};b.prototype.hasRoomPresence=function(){return!f.isEmpty(this.mMucPresence)};b.prototype.getRoomPresence=function(){return this.mMucPresence};b.prototype.setRoomPresence=function(a){this.mMucPresence=a};b.prototype.getPriority=function(){return this.mPriority};b.prototype.setPriority=function(a){this.mPriority=a};b.prototype.hasReachableAddress=
function(){return this.mHasReachableAddress};b.prototype.setHasReachableAddress=function(a){this.mHasReachableAddress=a};b.prototype.getChatability=function(){return this.mChatability};b.prototype.setChatability=function(a){this.mChatability=a};b.prototype.getSenderName=function(){return this.mSenderName};b.prototype.setSenderName=function(a){this.mSenderName=a};b.prototype.getSenderCustomerId=function(){return this.mSenderCustomerId};b.prototype.setSenderCustomerId=function(a){this.mSenderCustomerId=
a};b.prototype.equals=function(a){return f.deepEquals(this,a)};b.prototype.toString=function(){return"Presence:{ID:["+this.mID+"], from:"+this.mFrom.toString()+", to:"+this.mTo.toString()+", type:["+this.mType+"], show:["+this.mShow+"], status:["+this.mStatus+"], muc:["+this.hasRoomPresence()+"], error:["+this.mError+"], priority:["+this.mPriority+"]}"};e.prototype.getStatusCodes=function(){return this.mStatusCodes};e.prototype.setStatusCodes=function(a){this.mStatusCodes=a};e.prototype.getRoomStatus=
function(){return this.mRoomStatus};e.prototype.setRoomStatus=function(a){this.mRoomStatus=a};e.prototype.getItems=function(){return this.mItems};e.prototype.setItems=function(a){this.mItems=a};m.prototype.getNick=function(){return this.mNick};m.prototype.setNick=function(a){this.mNick=a};m.prototype.getRole=function(){return this.mRole};m.prototype.setRole=function(a){this.mRole=a};m.prototype.getAffiliation=function(){return this.mAffiliation};m.prototype.setAffiliation=function(a){this.mAffiliation=
a};m.prototype.getJID=function(){return this.mJID};m.prototype.setJID=function(a){this.mJID=a};m.prototype.getActor=function(){return this.mActor};m.prototype.setActor=function(a){this.mActor=a};m.prototype.getReason=function(){return this.mReason};m.prototype.setReason=function(a){this.mReason=a};return{PresenceType:q,ShowState:g,MucPresenceStatusCode:d,Presence:b,MucPresence:e,MucPresenceItem:m,MucRoomStatus:l,isValidPresenceType:function(a){a:{for(var b in q)if(q[b]===a){a=!0;break a}a=!1}return a}}});
t.when("AmazonComm/messaging/presence_class").execute(function(d){v["AmazonComm/messaging/presence_class"]=d});t.when("AmazonComm/messaging/presence_class","AmazonComm/messaging/jsjac/connection","AmazonComm/messaging/jsjac/node_utils","AmazonComm/utils/common","AmazonComm/utils/global_state","AmazonComm/utils/location","AmazonComm/utils/log","3p-JSJaC").register("AmazonComm/messaging/presence_manager",function(d,l,f,b,q,g,a,e){function m(a,c){d.isValidPresenceType(a)&&!b.isEmpty(c)&&l.addPresenceHandler(a,
{onPresence:function(a){c(a)}})}function u(){c=0;p()}function p(){if(!b.isEmpty(q.getLocalUser().getJID()))if(0!==c)a.l("presence_manager","we are already waiting to send a presence update");else{var d=Date.now()-k;if(1E4>d)d=1E4-d,a.l("presence_manager","we will wait "+d+"ms to send presence update"),c=setTimeout(u,d);else{var g=q.getLocalUser().getJID().getJIDAsString(),m=new e.JSJaCPresence,p=f.appendNodeWithAttribute(m,m,"device","xmlns","urn:xmpp:amazon:device:attributes");f.appendNodeWithAttributeAndText(m,
p,"json","xmlns","urn:xmpp:json:0",JSON.stringify(h));m.setFrom(g);0===k?a.l("presence_manager","this is the first presence update - sending presence"):a.l("presence_manager","it has been "+d+"ms since the last presence update - sending presence");k=Date.now();l.sendPacket(m)}}}var h={},k=0,c=0;return{subscribe:function(a,c){m(a,c)},sendBatteryInfo:function(a){h.battery=a;p()},sendBluetoothInfo:function(a){h.bluetooth=a;p()},sendLocationInfo:function(a){g.isSignificantLocationChange(h.location,a)&&
(h.location=a,p())},sendForegroundAppInfo:function(a){h.foregroundApp=a;p()},sendAttributes:function(){p()},setLastPresenceSentTime:function(a){k=a},getPresenceSendTimeout:function(){return c}}});t.when("AmazonComm/messaging/presence_manager").execute(function(d){v["AmazonComm/messaging/presence_manager"]=d});t.when("AmazonComm/common/jid_class","AmazonComm/utils/common").register("AmazonComm/messaging/receipt_class",function(d,l){var f=function(b){this.mLocation={};l.isEmpty(b)||(b instanceof f?
this.mSender=b.mSender:l.isEmpty(b.mSender)||(this.mSender=new d.JID(b.mSender.mJIDString)),this.mCustomType=b.mCustomType,this.mTime=b.mTime,l.isEmpty(b.mLocation)||(this.mLocation.latitude=b.mLocation.latitude,this.mLocation.longitude=b.mLocation.longitude))};f.prototype.getSender=function(){return this.mSender};f.prototype.setSender=function(b){this.mSender=b};f.prototype.getTime=function(){return this.mTime};f.prototype.setTime=function(b){this.mTime=b};f.prototype.getCustomType=function(){return this.mCustomType};
f.prototype.setCustomType=function(b){this.mCustomType=b};f.prototype.getLatitude=function(){return this.mLocation.latitude};f.prototype.setLatitude=function(b){this.mLocation.latitude=b};f.prototype.getLongitude=function(){return this.mLocation.longitude};f.prototype.setLongitude=function(b){this.mLocation.longitude=b};f.prototype.toString=function(){return"receipt type: "+this.mType+"sender: "+this.mSender.toString()+", customType: "+this.mCustomType+", time: "+this.mTime+", location: "+this.mLocation.latitude+
", "+this.mLocation.longitude};f.prototype.equals=function(b){return l.deepEquals(this,b)};return{Receipt:f}});t.when("AmazonComm/messaging/receipt_class").execute(function(d){v["AmazonComm/messaging/receipt_class"]=d});t.register("AmazonComm/messaging/chatroom/association_class",function(){var d=Object.freeze({NONE:"none",VISITOR:"visitor",PARTICIPANT:"participant",MODERATOR:"moderator"}),l=Object.freeze({NONE:"none",OUTCAST:"outcast",MEMBER:"member",ADMIN:"admin",OWNER:"owner"}),f=function(b,d){this.mRole=
b;this.mAffiliation=d};f.prototype.getRole=function(){return this.mRole};f.prototype.getAffiliation=function(){return this.mAffiliation};f.prototype.equals=function(b){return this.mRole===b.getRole()&&this.mAffiliation===b.getAffiliation()};return{Role:d,Affiliation:l,Association:f}});t.when("AmazonComm/common/chatroom_class","AmazonComm/common/jid_class","AmazonComm/common/person_class","AmazonComm/messaging/chatroom/association_class","AmazonComm/messaging/chatroom/chat_room_user_class","AmazonComm/messaging/jsjac/connection",
"AmazonComm/messaging/jsjac/node_utils","AmazonComm/messaging/jsjac/packet_converter","AmazonComm/messaging/message_class","AmazonComm/messaging/presence_class","AmazonComm/metrics/metrics_manager","AmazonComm/utils/common","AmazonComm/utils/config","AmazonComm/utils/error_codes","AmazonComm/utils/global_state","AmazonComm/utils/log","3p-JSJaC").register("AmazonComm/messaging/chatroom/chat_room_manager",function(d,l,f,b,q,g,a,e,m,u,p,h,k,c,n,r,w){function t(a){r.l("chat_room_manager","discovering rooms");
var c=new w.JSJaCIQ;c.setIQ(k.getMUCDomain(),"get",h.createUUID(h.TAG_IQ));c.setQuery("http://jabber.org/protocol/disco#items");g.sendPacket(c,!1,function(c){c=c.getQuery().getElementsByTagName("item");r.l("chat_room_manager","discovered "+c.length+" rooms");for(var b,k,e=[],n=0;n<c.length;n++)b=c.item(n),k=new l.JID(b.getAttribute("jid")),b=b.getAttribute("name"),k=new d.ChatRoom(k,b),e.push(k);if(!h.isEmpty(a))a.onDiscovered({chatrooms:e})})}function v(a,c){r.l("chat_room_manager","searching for rooms containing ["+
a+"]");var b=new w.JSJaCIQ;b.setIQ(k.getMUCDomain(),"set",h.createUUID(h.TAG_IQ));var e=b.setQuery("jabber:iq:search"),n=b.buildNode("x",{xmlns:"jabber:x:data",type:"submit"}),f=b.buildNode("field");f.setAttribute("type","hidden");f.setAttribute("var","FORM_TYPE");var m=b.buildNode("value");m.textContent="jabber:iq:search";f.appendChild(m);n.appendChild(f);f=b.buildNode("field");f.setAttribute("var","name");m=b.buildNode("value");m.textContent=a;f.appendChild(m);n.appendChild(f);e.appendChild(n);
g.sendPacket(b,!1,function(a){a=a.getQuery().getElementsByTagName("item");r.l("chat_room_manager","search returned "+a.length+" rooms");for(var b=null,k=null,e=[],n=0;n<a.length;n++){for(var g=a.item(n).getElementsByTagName("field"),f=0;f<g.length;f++){var m=g.item(f),q=m.getAttribute("var");"name"===q?k=m.firstChild.textContent:"jid"===q&&(b=new l.JID(m.firstChild.textContent))}e.push(new d.ChatRoom(b,k))}if(!h.isEmpty(c))c.onResults({chatrooms:e})})}function G(a,c){r.l("chat_room_manager","querying for room info for ["+
a.toString()+"]");var b=new w.JSJaCIQ;b.setIQ(a.getJID().getJIDAsString(),"get",h.createUUID(h.TAG_IQ));b.setQuery("http://jabber.org/protocol/disco#info");g.sendPacket(b,!1,function(a){var b={},d=a.getQuery();a=a.getChild("identity");b.name=a.getAttribute("name");d=d.getElementsByTagName("field");for(a=0;a<d.length;a++){var h=d.item(a),k=h.getAttribute("var");"muc#roominfo_description"===k?b.description=h.firstChild.textContent:"muc#roominfo_occupants"===k?b.numUsers=Number(h.firstChild.textContent):
"muc#roominfo_membercount"===k?b.numMembers=Number(h.firstChild.textContent):"muc#roominfo_admincount"===k?b.numAdmins=Number(h.firstChild.textContent):"muc#roominfo_ownercount"===k&&(b.numOwners=Number(h.firstChild.textContent))}c(b)})}function C(d,k){r.l("chat_room_manager","querying for room member list for ["+d.toString()+"]");var e=new w.JSJaCIQ;e.setIQ(d.getJID().getJIDAsString(),"get",h.createUUID(h.TAG_IQ));d=e.setQuery("http://jabber.org/protocol/muc#admin");var n=e.buildNode("item",{affiliation:b.Affiliation.MEMBER});
d.appendChild(n);if(!g.sendPacket(e,!1,function(c){if(c.isError()){var d=a.getCampfireErrorFromPacket(c);r.error("chat_room_manager","error when getting members from room",d);if(!h.isEmpty(k))k.onError(d)}else{d=[];c=c.getQuery().getElementsByTagName("item");for(var e=0;e<c.length;e++){var n=c.item(e),g=n.getAttribute("jid"),m=n.getAttribute("nick"),n=n.getAttribute("role");h.isEmpty(n)&&(n=b.Role.NONE);var p;try{p=f.Person.fromJSONObject(JSON.parse(h.base32ToString(m.toUpperCase())))}catch(u){try{p=
f.Person.fromJSONObject(JSON.parse(h.base64ToString(m)))}catch(w){p=new f.Person(new l.JID(g))}}g=new b.Association(n,b.Affiliation.Member);g=new q.ChatRoomUser(p,g);d.push(g)}if(!h.isEmpty(k))k.onGetMemberListSuccess(d)}})&&(r.e("chat_room_manager","failed to get members list"),!h.isEmpty(k)))k.onError({code:c.CHAT_ROOM_ERRORS.ERROR_FAILED_TO_GET_MEMBERS_LIST,description:"failed to get members list"})}function I(a,b,k){r.l("chat_room_manager","joining room "+a.toString());var e=p.createMetricEvent("ChatRoomManager",
p.AGGREGATING_EVENT);p.startTimer(e,"JoinRoom.RequestTimer");var f=new w.JSJaCPresence,m=d.ChatRoom.getLocalUserNickname(),l=a.getJID().getJIDAsString();f.setTo(l+"/"+m);m=f.buildNode("x",{xmlns:"http://jabber.org/protocol/muc"});if(!h.isEmpty(k)){var q=f.buildNode("history"),J=!1;h.isEmpty(k.maxMessages)||(r.l("chat_room_manager","  maxstanzas\x3d"+k.maxMessages),q.setAttribute("maxstanzas",k.maxMessages),J=!0);h.isEmpty(k.seconds)||(r.l("chat_room_manager","  seconds\x3d"+k.seconds),q.setAttribute("seconds",
k.seconds),J=!0);h.isEmpty(k.since)||isNaN(k.since.getTime())||(r.l("chat_room_manager","  messages since\x3d"+k.since),q.setAttribute("since",k.since.toISOString()),J=!0);J&&m.appendChild(q)}f.appendNode(m);Q[l]=function(c){if(c.isError()){p.stopTimer(e,"JoinRoom.RequestTimer");p.incrementCounter(e,"JoinRoom.RequestErrorCount");p.recordMetricEvent(e);c=c.getError();r.error("chat_room_manager","error joining room",c);if(!h.isEmpty(b))b.onError(c);delete Q[l]}else{if(c.getRoomPresence().getItems()[0].getJID().isEqualsFullJID(n.getLocalUserFullJID())&&
u.PresenceType.AVAILABLE===c.getType()&&(p.stopTimer(e,"JoinRoom.RequestTimer"),p.incrementCounter(e,"JoinRoom.RequestSuccessCount"),p.recordMetricEvent(e),!h.isEmpty(b)))b.onJoined({presence:c});a.onPresenceReceived(c)}};if(!g.sendPacket(f)&&(p.stopTimer(e,"JoinRoom.RequestTimer"),p.incrementCounter(e,"JoinRoom.RequestErrorCount"),p.recordMetricEvent(e),delete Q[l],!h.isEmpty(b)))b.onError({code:c.CHAT_ROOM_ERRORS.ERROR_FAILED_TO_JOIN_ROOM,description:"failed to join room"})}function F(b,d,k){r.l("chat_room_manager",
"requesting registration with room ["+b.toString()+"]");var e=b.getJID().getJIDAsString();b=new w.JSJaCIQ;b.setIQ(e,"get",h.createUUID(h.TAG_IQ));b.setQuery("jabber:iq:register");if(!g.sendPacket(b,!1,function(c){if(c.isError()){if(c=a.getCampfireErrorFromPacket(c),r.error("chat_room_manager","error registering with room",c),!h.isEmpty(k))k.onError(c)}else if(h.isEmpty(c.getChild("registered")))z(e,d,k);else if(c=c.getChild("username").textContent,r.l("chat_room_manager","user already registered with nickname: ["+
c+"]"),!h.isEmpty(k))k.onRegistered({nickname:c,newRegistration:!1})})&&(r.e("chat_room_manager","failed to send registration requirements request"),!h.isEmpty(k)))k.onError({code:c.CHAT_ROOM_ERRORS.ERROR_FAILED_TO_REGISTER_WITH_ROOM,description:"failed to send registration requirements request"})}function z(b,d,k){var e=new w.JSJaCIQ;e.setIQ(b,"set",h.createUUID(h.TAG_IQ));b=e.setQuery("jabber:iq:register");var n=e.buildNode("x",{xmlns:"jabber:x:data",type:"submit"}),f=a.appendNodeWithAttribute(e,
n,"field","var","FORM_TYPE");a.appendNodeWithText(e,f,"value","http://jabber.org/protocol/muc#register");f=a.appendNodeWithAttribute(e,n,"field","var","muc#register_roomnick");a.appendNodeWithText(e,f,"value",d);b.appendChild(n);if(!g.sendPacket(e,!1,function(c){if(c.isError()){if(c=a.getCampfireErrorFromPacket(c),r.error("chat_room_manager","error registering with room",c),!h.isEmpty(k))k.onError(c)}else if(r.l("chat_room_manager","registered successfully with room using nickname: ["+d+"]"),!h.isEmpty(k))k.onRegistered({nickname:d,
newRegistration:!0})})&&(r.e("chat_room_manager","failed to submit room registration request"),!h.isEmpty(k)))k.onError({code:c.CHAT_ROOM_ERRORS.ERROR_FAILED_TO_REGISTER_WITH_ROOM,description:"failed to submit room registration request"})}function y(b,d){r.l("chat_room_manager","requesting to remove registration from room: ["+b.toString()+"]");var k=new w.JSJaCIQ;k.setIQ(b.getJID().getJIDAsString(),"set",h.createUUID(h.TAG_IQ));b=k.setQuery("jabber:iq:register");a.appendNode(k,b,"remove");if(!g.sendPacket(k,
!1,function(c){if(c.isError()){if(c=a.getCampfireErrorFromPacket(c),r.error("chat_room_manager","error removing room registration",c),!h.isEmpty(d))d.onError(c)}else if(r.l("chat_room_manager","removed room registration"),!h.isEmpty(d))d.onRegistrationRemoved()})&&(r.e("chat_room_manager","failed to send request to remove room registration"),!h.isEmpty(d)))d.onError({code:c.CHAT_ROOM_ERRORS.ERROR_FAILED_TO_REMOVE_REGISTRATION,description:"failed to send request to remove room registration"})}function D(b,
d){r.l("chat_room_manager","enable mute notification for room ["+b.toString()+"]");var k=new w.JSJaCIQ;k.setIQ(b.getJID().getJIDAsString(),"set",h.createUUID(h.TAG_IQ));b=k.setQuery("jabber:iq:amazon-mute-notification");a.appendNodeWithAttribute(k,b,"action","name","add");if(!g.sendPacket(k,!1,function(c){if(c.isError()){if(c=a.getCampfireErrorFromPacket(c),r.error("chat_room_manager","error when enable mute room notification",c),!h.isEmpty(d))d.onError(c)}else if(r.l("chat_room_manager","enable mute room notification success"),
!h.isEmpty(d))d.onEnableMuteRoomNotificationSuccess()})&&(r.e("chat_room_manager","failed to enable mute room notification"),!h.isEmpty(d)))d.onError({code:c.CHAT_ROOM_ERRORS.ERROR_FAILED_TO_ENABLE_MUTE_NOTIFICATION,description:"failed to enable mute room notification"})}function R(b,d){r.l("chat_room_manager","unMute notification for room ["+b.toString()+"]");var k=new w.JSJaCIQ;k.setIQ(b.getJID().getJIDAsString(),"set",h.createUUID(h.TAG_IQ));b=k.setQuery("jabber:iq:amazon-mute-notification");a.appendNodeWithAttribute(k,
b,"action","name","remove");if(!g.sendPacket(k,!1,function(c){if(c.isError()){if(c=a.getCampfireErrorFromPacket(c),r.error("chat_room_manager","error when disable mute room notification",c),!h.isEmpty(d))d.onError(c)}else if(r.l("chat_room_manager","disable mute room notification success"),!h.isEmpty(d))d.onDisableMuteRoomNotificationSuccess()})&&(r.e("chat_room_manager","failed to disable mute room notification"),!h.isEmpty(d)))d.onError({code:c.CHAT_ROOM_ERRORS.ERROR_FAILED_TO_DISABLE_MUTE_NOTIFICATION,
description:"failed to disable mute room notification"})}function H(b,d){var k=new w.JSJaCIQ;k.setIQ(b.getJID().getJIDAsString(),"get",h.createUUID(h.TAG_IQ));k.setQuery("jabber:iq:amazon-mute-notification");if(!g.sendPacket(k,!1,function(c){if(c.isError()){if(c=a.getCampfireErrorFromPacket(c),r.error("chat_room_manager","error when getting mute notification state",c),!h.isEmpty(d))d.onError(c)}else if(c=c.getQuery().getElementsByTagName("item").item(0).getAttribute("mute-notification-status"),c=
"true"===c,r.l("chat_room_manager","successfully got mute notificaiton state. chatroom: ["+b.toString()+"] mute notification status: ["+c+"]"),!h.isEmpty(d))d.onGetMuteRoomNotificationStatusSuccess(c)})&&(r.e("chat_room_manager","Failed to get mute notification state"),!h.isEmpty(d)))d.onError({code:c.CHAT_ROOM_ERRORS.ERROR_FAILED_TO_GET_MUTE_NOTIFICATION_STATE,description:"Failed to get mute notification state"})}function N(a,c,b,d){b=a.buildNode("field",{"var":b});if(Array.isArray(d))for(var k=
0;k<d.length;k++){var e=a.buildNode("value");e.textContent=d[k];b.appendChild(e)}else e=a.buildNode("value"),e.textContent=d,b.appendChild(e);c.appendChild(b)}function O(a,b,e){var n=p.createMetricEvent("ChatRoomManager",p.AGGREGATING_EVENT);if(h.isEmpty(a)||h.isEmpty(a.name)){if(r.l("chat_room_manager","Error in creating room, incorrect input."),p.incrementCounter(n,"CreateRoom.InvalidParametersErrorCount"),p.recordMetricEvent(n),!h.isEmpty(b))b.onError({code:c.CHAT_ROOM_ERRORS.ERROR_INVALID_PARAMETER,
description:"Invalid request parameters. Failed to create room"})}else{p.startTimer(n,"CreateRoom.RequestTimer");var f=h.createUUID(h.TAG_ROOM),m=new l.JID(f,k.getMUCDomain()),q=new d.ChatRoom(m,a.name);q.registerAssociationChangeObserver(a.associationChangeObserver);B=m.getJIDAsString();r.l("chat_room_manager","creating room "+q.toString());I(q,{onJoined:function(){var d=new w.JSJaCIQ;d.setIQ(m.getJIDAsString(),"set",h.createUUID(h.TAG_IQ));var k=d.setQuery("http://jabber.org/protocol/muc#owner"),
f=d.buildNode("x",{xmlns:"jabber:x:data",type:"submit"});N(d,f,U.FORM_TYPE,"http://jabber.org/protocol/muc#roomconfig");N(d,f,U.ROOM_DESC,a.description);N(d,f,U.ROOM_NAME,q.getName());h.isEmpty(e)&&(e=new K);for(var r in U)e.hasOwnProperty(r)&&N(d,f,U[r],e[r]);k.appendChild(f);if(!g.sendPacket(d,!1,function(a){p.stopTimer(n,"CreateRoom.RequestTimer");p.incrementCounter(n,"CreateRoom.RequestSuccessCount");p.recordMetricEvent(n);if(!h.isEmpty(b))b.onCreated({chatroom:q})})&&(p.stopTimer(n,"CreateRoom.RequestTimer"),
p.incrementCounter(n,"CreateRoom.RequestErrorCount"),p.recordMetricEvent(n),!h.isEmpty(b)))b.onError({code:c.CHAT_ROOM_ERRORS.ERROR_FAILED_TO_CREATE_ROOM,description:"failed to create room"})},onError:function(a){p.stopTimer(n,"CreateRoom.RequestTimer");p.incrementCounter(n,"CreateRoom.RequestErrorCount");p.recordMetricEvent(n);if(!h.isEmpty(b))b.onError(a)}})}}function L(b,d){var k=b.roomJID.getJIDAsString(),e=b.inviteeJID.getJIDAsString();b=b.reason;r.l("chat_room_manager","inviting ["+e+"] to room + ["+
k+"]");var n=new w.JSJaCMessage;n.setID(h.createUUID(h.TAG_MESSAGE));n.setTo(k);k=a.appendNodeWithAttribute(n,n,"x","xmlns","http://jabber.org/protocol/muc#user");e=a.appendNodeWithAttribute(n,k,"invite","to",e);h.isEmpty(b)||a.appendNodeWithText(n,e,"reason",b);if(g.sendPacket(n,!1,function(c){if(c.isError()&&(c=a.getCampfireErrorFromPacket(c),r.error("chat_room_manager","error sending invitation",c),!h.isEmpty(d)))d.onError(c)})){if(r.l("chat_room_manager","invitation message sent to service"),
!h.isEmpty(d))d.onInvitationSent()}else if(e={code:c.GENERIC_ERRORS.ERROR_UNKNOWN,description:"error sending invitation message to service"},r.error("chat_room_manager","error sending invitation",e),!h.isEmpty(d))d.onError(e)}function Y(d,k,e,n){if(e!==b.Role.MODERATOR&&e!==b.Role.NONE&&e!==b.Role.PARTICIPANT&&e!==b.Role.VISITOR)r.e("chat_room_manager","invalid role ["+e+"]"),n.onError({code:c.CHAT_ROOM_ERRORS.ERROR_INVALID_PARAMETER,description:"invalid role"});else{r.l("chat_room_manager","setting role to ["+
e+"] for nick ["+k+"] in room "+d.toString());var f=new w.JSJaCIQ;f.setIQ(d.getJID().getJIDAsString(),"set",h.createUUID(h.TAG_IQ));d=f.setQuery("http://jabber.org/protocol/muc#admin");k=f.buildNode("item",{nick:k,role:e});d.appendChild(k);if(!g.sendPacket(f,!1,function(c){if(c.isError())c=a.getCampfireErrorFromPacket(c),r.error("chat_room_manager","error setting role",c),n.onError(c);else n.onSetRoleSuccess()}))n.onError({code:c.CHAT_ROOM_ERRORS.ERROR_FAILED_TO_SET_ROLE,description:"failed to set role"})}}
function J(d,k,e,n){if(e!==b.Affiliation.OWNER&&e!==b.Affiliation.ADMIN&&e!==b.Affiliation.MEMBER&&e!==b.Affiliation.OUTCAST&&e!==b.Affiliation.NONE)r.e("chat_room_manager","invalid affiliation ["+e+"]"),n.onError({code:c.CHAT_ROOM_ERRORS.ERROR_INVALID_PARAMETER,description:"invalid affiliation"});else{r.l("chat_room_manager","setting affiliation to ["+e+"] for JID ["+k.toString()+"] in room "+d.toString());var f=new w.JSJaCIQ;f.setIQ(d.getJID().getJIDAsString(),"set",h.createUUID(h.TAG_IQ));d=f.setQuery("http://jabber.org/protocol/muc#admin");
e=f.buildNode("item",{jid:k.getJIDAsString(),affiliation:e});d.appendChild(e);if(!g.sendPacket(f,!1,function(c){if(c.isError())c=a.getCampfireErrorFromPacket(c),r.error("chat_room_manager","error setting affiliation",c),n.onError(c);else n.onSetAffiliationSuccess(k)}))n.onError({code:c.CHAT_ROOM_ERRORS.ERROR_FAILED_TO_SET_AFFILIATION,description:"failed to set affiliation"})}}var U={FORM_TYPE:"FORM_TYPE",ALLOW_INVITES:"muc#roomconfig_allowinvites",AUTO_MODERATOR_ID:"muc#amzroomconfig_automoderatorid",
CAN_CHANGE_NICK:"x-muc#roomconfig_canchangenick",CHANGE_SUBJECT:"muc#roomconfig_changesubject",ENABLE_LOGGING:"muc#roomconfig_enablelogging",MAX_USERS:"muc#roomconfig_maxusers",MEMBERS_ONLY:"muc#roomconfig_membersonly",MODERATED_ROOM:"muc#roomconfig_moderatedroom",ROOM_OWNERS:"muc#roomconfig_roomowners",PASSWORD_PROTECTED_ROOM:"muc#roomconfig_passwordprotectedroom",PERSISTENT_ROOM:"muc#roomconfig_persistentroom",PRESENCE_BROADCAST:"muc#roomconfig_presencebroadcast",PUBLIC_ROOM:"muc#roomconfig_publicroom",
PUSH_NOTIFICATION_CONTROLLER_ID:"muc#amzroomconfig_pushnotificationcontrollerid",REGISTRATION:"x-muc#roomconfig_registration",RESERVED_NICK:"x-muc#roomconfig_reservednick",ROOM_DESC:"muc#roomconfig_roomdesc",ROOM_NAME:"muc#roomconfig_roomname",WHOIS:"muc#roomconfig_whois"},A={FALSE:"0",TRUE:"1",ANYONE:"anyone",MODERATOR:"moderator",MODERATORS:"moderators",NONE:"none",PARTICIPANT:"participant",VISITOR:"visitor"},K=function(){return{ALLOW_INVITES:A.FALSE,CAN_CHANGE_NICK:A.FALSE,CHANGE_SUBJECT:A.FALSE,
ENABLE_LOGGING:A.TRUE,MAX_USERS:A.FALSE,MEMBERS_ONLY:A.FALSE,MODERATED_ROOM:A.FALSE,PASSWORD_PROTECTED_ROOM:A.FALSE,PRESENCE_BROADCAST:[],PERSISTENT_ROOM:A.TRUE,PUBLIC_ROOM:A.TRUE,REGISTRATION:A.FALSE,RESERVED_NICK:A.FALSE,WHOIS:A.ANYONE}},Q={},S=[],x=[],B="";e=function(a){if((a.hasRoomPresence()||a.isError())&&!h.isEmpty(a.getFrom())){var c=a.getFrom().getBareJID(),c=Q[c];h.isEmpty(c)||c(a)}};g.addPresenceHandler(u.PresenceType.AVAILABLE,{onPresence:e});g.addPresenceHandler(u.PresenceType.ERROR,
{onPresence:e});g.addPresenceHandler(u.PresenceType.UNAVAILABLE,{onPresence:e});g.addMessageHandler(m.AMZ_TYPE_GROUP_INVITE,{onMessage:function(a){var c={};c.roomJID=a.getAmzGroupInviteJID();c.senderJID=a.getAmzSenderJID();c.reason=a.getAmzContent();for(a=0;a<S.length;a++)S[a].onNewInvite(c)}});g.addMessageHandler(m.AMZ_TYPE_GROUP_INVITE_DECLINE,{onMessage:function(a){var c={};c.roomJID=a.getAmzGroupInviteJID();c.senderJID=a.getAmzSenderJID();c.reason=a.getAmzContent();for(a=0;a<x.length;a++)x[a].onInviteDeclined(c)}});
return{MUC_CONFIG_VALUES:A,ChatRoomConfig:K,createRoom:function(a,c,b){O(a,c,b)},joinRoom:function(a,c,b){I(a,c,b)},leaveRoom:function(a){r.l("chat_room_manager","leaving room "+a.toString());var c=new w.JSJaCPresence,b=a.getJID().getJIDAsString()+"/"+d.ChatRoom.getLocalUserNickname();c.setTo(b);c.setType("unavailable");g.sendPacket(c);delete Q[a.getJID().getJIDAsString()];a.onLeaveRoom()},getRoomInfo:function(a,c){G(a,c)},getRoomMemberList:function(a,c){C(a,c)},registerWithRoom:function(a,c,b){F(a,
c,b)},removeRoomRegistration:function(a,c){y(a,c)},enableMuteRoomNotification:function(a,c){D(a,c)},disableMuteRoomNotification:function(a,c){R(a,c)},getMuteRoomNotificationStatus:function(a,c){H(a,c)},discoverRooms:function(a){t(a)},searchRooms:function(a,c){return v(a,c)},requestVoiceInRoom:function(a){r.l("chat_room_manager","requesting voice in room "+a.toString());var c=new w.JSJaCMessage;c.setID(h.createUUID(h.TAG_MESSAGE));c.setTo(a.getJID().getJIDAsString());a=c.buildNode("x",{xmlns:"jabber:x:data",
type:"submit"});var d=c.buildNode("field",{"var":"FORM_TYPE"}),e=c.buildNode("value");e.textContent="http://jabber.org/protocol/muc#request";d.appendChild(e);a.appendChild(d);d=c.buildNode("field",{"var":"muc#role",type:"text-single",label:"Requested role"});e=c.buildNode("value");e.textContent=b.Role.PARTICIPANT;d.appendChild(e);a.appendChild(d);d=n.getAuthCredentialData();if(!h.isEmpty(d)){var e=c.buildNode("field",{"var":"amznAuth#authStatus",type:"text-single"}),f=c.buildNode("value");f.textContent=
d.authStatus;e.appendChild(f);a.appendChild(e);e=c.buildNode("field",{"var":"amznAuth#authStatusSignature",type:"text-single"});f=c.buildNode("value");f.textContent=d.authStatusSignature;e.appendChild(f);a.appendChild(e);k.useCognitoAuth()?(e=c.buildNode("field",{"var":"amznAuth#cognitoToken",type:"text-single"}),f=c.buildNode("value"),f.textContent=d.cognitoToken):(e=c.buildNode("field",{"var":"amznAuth#authStatusTimestamp",type:"text-single"}),f=c.buildNode("value"),f.textContent=d.authStatusTimestamp);
e.appendChild(f);a.appendChild(e)}c.appendNode(a);g.sendPacket(c)},inviteToRoom:function(a,c){L(a,c)},declineRoomInvitation:function(c){var b=c.roomJID.getJIDAsString(),d=c.inviterJID.getJIDAsString();c=c.reason;r.l("chat_room_manager","declining invitation from ["+d+"] to join room + ["+b+"]");var e=new w.JSJaCMessage;e.setID(h.createUUID(h.TAG_MESSAGE));e.setTo(b);b=a.appendNodeWithAttribute(e,e,"x","xmlns","http://jabber.org/protocol/muc#user");d=a.appendNodeWithAttribute(e,b,"decline","to",d);
h.isEmpty(c)||a.appendNodeWithText(e,d,"reason",c);g.sendPacket(e)},registerRoomInvitationHandler:function(a){h.isEmpty(a)||-1!==S.indexOf(a)||S.push(a)},registerDeclinedInvitationHandler:function(a){h.isEmpty(a)||-1!==x.indexOf(a)||x.push(a)},setRoleInRoom:function(a,c,b,d){Y(a,c,b,d)},setAffiliationInRoom:function(a,c,b,d){J(a,c,b,d)},getInvitationHandlersLength:function(){return S.length},getDeclinedInvitationHandlersLength:function(){return x.length},getCreateRoomJIDString:function(){return B}}});
t.when("AmazonComm/messaging/chatroom/chat_room_manager").execute(function(d){v["AmazonComm/messaging/chatroom/chat_room_manager"]=d});t.register("AmazonComm/messaging/chatroom/chat_room_user_class",function(){var d=function(d,f){this.mPerson=d;this.mAssociation=f};d.prototype.getJID=function(){return this.mPerson.getJID()};d.prototype.getPerson=function(){return this.mPerson};d.prototype.getAssociation=function(){return this.mAssociation};d.prototype.equals=function(d){return this.mPerson.equals(d.getPerson())&&
this.mAssociation.equals(d.getAssociation())};return{ChatRoomUser:d}});t.when("3p-JSJaC","3p-JSJaC-Crypt","AmazonComm/auth/auth_utils","AmazonComm/common/jid_class","AmazonComm/messaging/jsjac/packet_converter","AmazonComm/messaging/message_class","AmazonComm/utils/messaging_service_host_provider","AmazonComm/metrics/metrics_manager","AmazonComm/utils/common","AmazonComm/utils/config","AmazonComm/utils/error_codes","AmazonComm/utils/global_state","AmazonComm/utils/log","AmazonComm/utils/services").register("AmazonComm/messaging/jsjac/connection",
function(d,l,f,b,q,g,a,e,m,u,p,h,k,c){function n(){return!m.isEmpty(B)&&B.connected()}function r(a){var c=u.getMessagingHostOverride();if(m.isEmpty(c)){if(m.isEmpty(a))return w();V=a}else{var b=/^((https?|wss?):\/\/)?([\-a-zA-Z0-9.]{2,256})(:([0-9]+))?$/.exec(c);null===b?a=null:(a={protocol:b[2]!==M?b[2]:"https",hostName:b[3]},a.port=b[5]!==M?b[5]:"https"===a.protocol||"wss"===a.protocol?443:80);V=a;if(m.isEmpty(V)){for(a=0;a<x.length;a++)x[a].onError({code:p.CONNECTION_ERRORS.ERROR_INVALID_URL,description:"Override URL ["+
c+"] is invalid"});return!1}}"Disconnected"===P||"NewHostOrSessionTerminationReconnecting"===P?(ba=1,P="Connecting"):ba++;c="wss://"+V.hostName+":"+V.port+"/ws/";h.setMessagingServerUrl(c);k.l("jsjac/connection","connecting to server: ["+JSON.stringify(V)+"], domain: ["+u.getMessagingDomain()+"], resource: ["+h.getResource()+"]");B=new d.JSJaCWebSocketConnection({httpbase:c});B.registerHandler("onconnect",v);B.registerHandler("ondisconnect",G);B.registerHandler("onerror",C);B.registerHandler("message",
y);B.registerHandler("presence_in",D);B.registerHandler("iq",R);B.registerIQGet("query",d.NS_VERSION,L);B.registerIQGet("query",d.NS_TIME,Y);K=new Date;h.setCurrentAuthCredentialData(Q);B.connect({domain:u.getMessagingDomain(),resource:h.getResource()});return!0}function w(){a.getMessagingServiceHostFromInternalService({onGetMessagingServiceHostSuccess:function(a){r(a)},onGetMessagingServiceHostError:function(a){k.e("jsjac/connection","Failed to get host from CampfireInternalService. ErrorCode: ["+
a.code+"] Error Description: ["+a.description+"]");for(var c=0;c<x.length;c++)x[c].onError(a)},onGetMessagingServiceHostRetry:function(a,c){k.e("jsjac/connection","Failed to get host from CampfireInternalService. MessagingServiceHostProvider is going to retry. ErrorCode: ["+a.code+"] Error Description: ["+a.description+"]")}},ea);return!0}function t(){m.isEmpty(B)||(P="Disconnecting",B.disconnect())}function v(){P="Connected";ba=1;m.isEmpty(K)||(e.addTimer(A,"ConnectionRequest.SuccessTimer",new Date-
K),e.recordMetricEvent(A),K=null,J());clearTimeout(ha);ea=[];k.l("jsjac/connection","sending initial presence to server ["+B._serverName+"] ("+B._serverIP+") from JID "+Z);B.send(new d.JSJaCPresence);for(var a={jid:Z},c=0;c<x.length;c++)x[c].onConnected(a);for(;0<fa.length;)a=fa.shift(),c=new b.JID(a.packet.getFrom()),c.equals(Z)?H(a.packet,!1,a.callback):k.l("jsjac/connection","not sending queued packet because JID changed from "+c.toString()+" to "+Z.toString())}function G(){k.l("jsjac/connection",
"disconnected from server");m.isEmpty(B)||(B.unregisterHandler("onconnect",v),B.unregisterHandler("ondisconnect",G),B.unregisterHandler("onerror",C),B.unregisterHandler("message",y),B.unregisterHandler("presence_in",D));if("Disconnecting"===P){k.l("jsjac/connection","explicit disconnect - not trying to reconnect");P="Disconnected";e.recordMetricEvent(A);for(var a=0;a<x.length;a++)x[a].onDisconnected()}else if("NewHostOrSessionTerminationReconnecting"===P)for(var c={code:p.CONNECTION_ERRORS.ERROR_SESSION_TERMINATED,
description:"session terminated from server."},a=0;a<x.length;a++)x[a].onReconnecting(c);else if("Disconnected"!==P){e.incrementCounter(A,"ConnectionRequest.Error.ConnectionLostCount");c={code:p.CONNECTION_ERRORS.ERROR_CONNECTION_LOST,description:"connection to server lost"};for(a=0;a<x.length;a++)x[a].onReconnecting(c);I()}else k.e("jsjac/connection","Already disconnected or Unexpected connection state: ["+P+"]")}function C(a){m.isEmpty(K)||(e.addTimer(A,"ConnectionRequest.ErrorTimer",new Date-K),
K=null,J());var c=p.GENERIC_ERRORS.ERROR_UNKNOWN,b=null,d=ga,h=0,n="";try{if(m.isEmpty(a.firstChild.textContent)){if(c=a.getAttribute("code"),b=a.firstChild.nodeName,d=ga,n=c+"ClientErrorCount",0<a.getElementsByTagName("system-shutdown").length){var g=a.getElementsByTagName("delay")[0].getAttribute("value");m.isEmpty(g)||(n=c+"ServerReconnectCount",P="NewHostOrSessionTerminationReconnecting",h=g)}}else var f=JSON.parse(a.firstChild.textContent),c=f.status_code,b=f.status_string,d=f.retry_after_seconds,
n=c+"ServiceErrorCount"}catch(l){k.ex("jsjac/connection","unknown error (server down?)",l),c=p.GENERIC_ERRORS.ERROR_UNKNOWN,b="unknown error (server down?)",d=ga}a="ConnectionRequest.Error.UnknownErrorCount";m.isEmpty(n)||(a="ConnectionRequest.Error.__METRIC_ERROR_NAME_PLACEHOLDER__".replace("__METRIC_ERROR_NAME_PLACEHOLDER__",n),m.isEmpty(b)||e.incrementCounter(A,a+"."+b));e.incrementCounter(A,a);e.recordMetricEvent(A);k.e("jsjac/connection","statusCode: "+c+", statusString: "+b);c={code:c,description:b};
if(0<h)setTimeout(r,h),G();else if(0<d&&"NewHostOrSessionTerminationReconnecting"!==P){for(h=0;h<x.length;h++)x[h].onReconnecting(c);I(1E3*d)}else for(h=0;h<x.length;h++)x[h].onError(c)}function I(a){P="Reconnecting";e.incrementCounter(A,"ConnectionRequest.RetryCount");clearTimeout(ha);1===ba&&(da=m.isEmpty(a)?ca=1E3:ca=a);ca=Math.floor(da+.1*da*Math.random());k.l("jsjac/connection","trying to reconnect in "+ca+" ms");ha=setTimeout(r,ca);da*=2;1E4<=da&&(k.l("jsjac/connection","Messaging service host: ["+
JSON.stringify(V)+"] is bad. Will try to reconnect with different host."),-1===ea.indexOf(V.hostName)&&ea.push(V.hostName),P="NewHostOrSessionTerminationReconnecting",e.incrementCounter(A,"ConnectionRequest.ServerSwitchedOnReconnectCount"))}function F(a,c){var b=(new Date).getTime();c=null!=c?setTimeout(function(){a.getAmzType()===g.AMZ_TYPE_RECEIPT?e.incrementCounter(A,"MessageDelivery.ReceiptTimeOutCount"):e.incrementCounter(A,"MessageDelivery.MessageTimeOutCount");e.recordMetricEvent(A);k.e("jsjac/connection",
"Message ["+a.getAmzContent()+"] timed out");for(var c=T.length-1;0<=c;c--)if(T[c].message.getID()===a.getID()){T.splice(c,1);break}a.setError(!0);var b=W[a.getAmzType()];if(!m.isEmpty(b))for(c=0;c<b.length;c++)b[c].onError(a)},c):null;T.push({message:a,sentTime:b,timeoutId:c})}function z(a){a=a.getAck();for(var c=0;c<T.length;c++){var b=T[c];if(b.message.getID()===a){T.splice(c,1);null!=b.timeoutId&&clearTimeout(b.timeoutId);a=(new Date).getTime()-b.sentTime;e.addTimer(A,"MessageDelivery.RoundTripTimer",
a);e.recordMetricEvent(A);break}}}function y(a){var c=q.packetToMessage(a);if(c.getType()===g.TYPE_ERROR){if(!m.isEmpty(a.getChild("error"))){var b=a.getChild("error");a=b.getAttribute("code");var d=b.getAttribute("type"),b="error packet - code: "+a+", type: "+d+", message: "+b.firstChild.nodeName;"406"===a&&(b+=", explanation: you are not an occupant of this room or you tried to perform a disallowed operation");k.e("jsjac/connection",b)}for(var h,b=T.length-1;0<=b;b--)if(T[b].message.getID()===c.getAck()){h=
T[b];h.message.setError(!0);T.splice(b,1);null!=h.timeoutId&&clearTimeout(h.timeoutId);break}if(null!=h&&(a=W[h.message.getAmzType()],h.message.getAmzType()===g.AMZ_TYPE_RECEIPT&&(e.incrementCounter(A,"MessageDelivery.ReceiptMessageErrorCount"),e.recordMetricEvent(A)),!m.isEmpty(a)))for(c=0;c<a.length;c++)a[c].onError(h.message)}else if(c.wasSentByUs()?(0===c.getAmzTimeSent()&&c.setAmzTimeSent(c.getAmzTimeCreated()),z(c)):c.setAmzTimeReceived((new Date).getTime()),a=W[c.getAmzType()],!m.isEmpty(a))for(b=
0;b<a.length;b++)a[b].onMessage(c)}function D(a){a=q.packetToPresence(a);var c=aa[a.getType()];if(!m.isEmpty(c))for(var b=0;b<c.length;b++)c[b].onPresence(a)}function R(a){if("result"===a.getType()||"set"===a.getType()){var c=a.getChild();if(!m.isEmpty(c)&&(c=ia[c.namespaceURI],!m.isEmpty(c)))c.onIq(a)}else"error"===a.getType()?k.e("jsjac/connection","Received IQ error response: "+a.xml()):k.e("jsjac/connection","Unknown IQ type:"+a.getType())}function H(a,c,b){if(n())return B.send(a,b);c||fa.push({packet:a,
callback:b});return!1}function N(){var a,c;u.useCognitoAuth()?(a=ja,c=l.b64encode(S)):(a=ka,c=f.getAuthenticationToken(Q),c=l.b64encode(c));return'\x3cauth xmlns\x3d"urn:ietf:params:xml:ns:xmpp-sasl" mechanism\x3d"'+a+'"\x3e'+c+"\x3c/auth\x3e"}function O(a){m.isEmpty(K)||(e.addTimer(A,"ConnectionRequest.ErrorTimer",new Date-K),K=null,J());for(var c,b=0;b<a.childNodes.length;b++){var d=a.childNodes[b];if("json"===d.nodeName.toLowerCase()){c=JSON.parse(d.textContent);break}}if(!m.isEmpty(c))if(a={code:c.status_code,
description:c.status_string},k.e("jsjac/connection","SASL error encountered: ["+a+"]"),e.incrementCounter(A,a.code+"ServiceErrorCount"),e.recordMetricEvent(A),c=c.retry_after_seconds,0<c){for(b=0;b<x.length;b++)x[b].onReconnecting(a);I(1E3*c)}else{k.l("jsjac/connection","Not reconnecting due to non-retryable SASL error");for(b=0;b<x.length;b++)x[b].onError(a);t()}}function L(a){k.l("jsjac/connection","handleIqVersion");a=a.reply([a.buildNode("name","AmazonComm"),a.buildNode("version",d.JSJaC.Version),
a.buildNode("os",navigator.userAgent)]);B.send(a);return!0}function Y(a){k.l("jsjac/connection","handleIqTime");var c=new Date;a=a.reply([a.buildNode("display",c.toLocaleString()),a.buildNode("utc",c.jabberDate()),a.buildNode("tz",c.toLocaleString().substring(c.toLocaleString().lastIndexOf(" ")+1))]);B.send(a);return!0}function J(){var a=B.getLatencyRecords(!0);if(!m.isEmpty(a))for(var c in a){var b=a[c],d=U[c+(b.isFailed?".error":"")];d&&b.start&&b.end&&b.start<=b.end&&e.addTimer(A,d,b.end-b.start)}}
var U={openWebSocket:"OpenWebSocket.Timer",doSASLAuth:"SASL.SuccessTimer","doSASLAuth.error":"SASL.ErrorTimer",doStreamBind:"BindResource.Timer"},A,K,Q=null,S=null,x=[],B=null,Z=null,W={},ia={},aa={},V=null,ea=[],fa=[],ha=null,ba=1,ca=1E3,da=1E3,ga=2,T=[],P="Disconnected";h.registerCleanupObserver({cleanup:function(){k.l("jsjac/connection","cleaning up jsjac/connection");x=[]}});d.JSJaCWebSocketConnection.prototype._doSASLAuth=function(){this._startTimer("doSASLAuth");return this._sendRaw(N(),this._doSASLAuthDone)};
var ja="COGNITO_OPENID_CONNECT",ka="CAMPFIRE_SHARED_KEY";d.JSJaCWebSocketConnection.prototype._doSASLAuthDone=function(a){a=a.data;a.includes("\x3copen")&&(a=a.substr(a.indexOf("\x3copen")));a=this._parseXml(a);a?a.nodeName.startsWith("open")?(this.streamid=a.getAttribute("id"),this._connected=!0):a.nodeName.startsWith("stream")?this._parseStreamFeatures(a)||this._handleEvent("onerror",d.JSJaCError("503","cancel","service-unavailable-JSJaCWebSocketConnection-DoSASLAuthDone-ParseStreamFeaturesFail")):
"success"===a.nodeName.toLowerCase()?(a=l.b64decode(a.firstChild.nodeValue),Z=new b.JID(a),this._stopTimer("doSASLAuth"),this._reInitStream()):"failure"===a.nodeName.toLowerCase()&&(this._stopTimer("doSASLAuth",!0),O(a)):this._handleEvent("onerror",d.JSJaCError("503","cancel","service-unavailable-JSJaCWebSocketConnection-DoSASLAuthDone-XMLParseFail"))};return{connect:function(a,c,b){Q=c;m.isEmpty(A)&&(A=e.createMetricEvent("JSJaCConnection",e.AGGREGATING_EVENT));u.useCognitoAuth()&&(S=f.getAuthenticationToken(c,
a));n()?(k.l("jsjac/connection","already connected - ignoring connect request"),a=!1):(m.isEmpty(b)||x.unshift(b),a=r(c.messagingHostInfo));return a},disconnect:function(){t()},isConnected:function(){return n()},sendPacket:function(a,c,b){return H(a,c,b)},sendMessage:function(a,c,b){var d=null!=c;F(a,c);a.setAmzTimeSent((new Date).getTime());a=q.messageToPacket(a);return H(a,d,b)},addMessageHandler:function(a,c){var b=W[a];m.isEmpty(b)&&(b=[]);-1===b.indexOf(c)&&(b.push(c),W[a]=b);return c},removeMessageHandler:function(a,
c){var b=W[a];m.isEmpty(b)||(c=b.indexOf(c),-1<c&&(b.splice(c,1),W[a]=b))},addPresenceHandler:function(a,c){var b=aa[a];m.isEmpty(b)&&(b=[]);-1===b.indexOf(c)&&(b.push(c),aa[a]=b);return c},removePresenceHandler:function(a,c){var b=aa[a];m.isEmpty(b)||(c=b.indexOf(c),-1<c&&(b.splice(c,1),aa[a]=b))},addIQHandler:function(a,c){ia[a]=c},getConnection:function(){return B},setCredential:function(a){Q=a},setToken:function(a){S=a},setJID:function(a){Z=a},buildSASLAuthString:function(){return N()},handleSASLError:function(a){return O(a)},
handleIqVersion:function(a){return L(a)},handleIqTime:function(a){return Y(a)},handleMessage:function(a){return y(a)},handlePresence:function(a){return D(a)},handleIq:function(a){return R(a)},handleError:function(a){return C(a)},handleDisconnected:function(){return G()},getMessageHandlerCount:function(a){var c=0;a=W[a];m.isEmpty(a)||(c=a.length);return c},getPresenceHandlerCount:function(a){var c=0;a=aa[a];m.isEmpty(a)||(c=a.length);return c},startReconnecting:function(a){return I(a)},isFirstReconnectAttempt:function(){return 1===
ba},setConnectionAttempt:function(a){ba=a},getReconnectDelayMillis:function(){return ca},getCurrentMessagingServiceHost:function(){return V},setCurrentMessagingServiceHost:function(a){V=a},getServersToExclude:function(){return ea},getPendingMessageQueue:function(){return fa},setDefaultRetryAfter:function(a){ga=a},setObserver:function(a){x.unshift(a)},addObserver:function(a){x.push(a)},getObservers:function(){return x},addToRoundTripList:function(a,c){F(a,c)},logRoundTripMetric:function(a){z(a)},getMessagesWeSent:function(){return T},
setConnectionState:function(a){P=a},getConnectionState:function(){return P}}});t.when("AmazonComm/messaging/jsjac/connection").execute(function(d){v["AmazonComm/messaging/jsjac/connection"]=d});t.when("AmazonComm/utils/common","AmazonComm/utils/error_codes").register("AmazonComm/messaging/jsjac/node_utils",function(d,l){function f(b,d,a){d===b?b.appendNode(a):d.appendChild(a)}function b(b){d.isEmpty(b)&&(b={});return b}return{appendNode:function(b,d,a){a=b.buildNode(a);f(b,d,a);return a},appendNodeWithAttribute:function(b,
d,a,e,m){var l={};l[e]=m;a=b.buildNode(a,l);f(b,d,a);return a},appendNodeWithAttributeMap:function(b,d,a,e){a=b.buildNode(a,e);f(b,d,a);return a},appendNodeWithText:function(d,g,a,e){a=d.buildNode(a);a=b(a);a.textContent=e;f(d,g,a);return a},appendNodeWithAttributeAndText:function(d,g,a,e,m,l){var p={};p[e]=m;a=d.buildNode(a,p);a=b(a);a.textContent=l;f(d,g,a);return a},getCampfireErrorFromPacket:function(b){var g={code:l.GENERIC_ERRORS.ERROR_UNKNOWN,description:"unknown"};b=b.getChild("error","*");
d.isEmpty(b)||(g.code=b.getAttribute("code"),g.description=b.firstChild.nodeName);return g},getChildNode:function(b,d){a:{d=d.split(".");var a=b;for(b=0;b<d.length;b++){a=a.getElementsByTagName(d[b]);if(0===a.length){d=null;break a}a=a[0]}d=a}return d},modifyNullObject:b}});t.when("AmazonComm/messaging/jsjac/node_utils").execute(function(d){v["AmazonComm/messaging/jsjac/node_utils"]=d});t.when("AmazonComm/common/jid_class","AmazonComm/common/person_class","AmazonComm/messaging/message_class","AmazonComm/messaging/presence_class",
"AmazonComm/messaging/jsjac/node_utils","AmazonComm/utils/common","AmazonComm/utils/log","3p-JSJaC").register("AmazonComm/messaging/jsjac/packet_converter",function(d,l,f,b,q,g,a,e){function m(a){var b=new d.JID(a.getNode(),a.getDomain());a=a.getResource();g.isEmpty(a)||b.setNickname(a);return b}function u(a){for(var e=new b.MucPresence,c=a.getElementsByTagName("status"),n=[],f=0;f<c.length;f++)n.push(c.item(f).getAttribute("code"));e.setStatusCodes(n);f=a.getElementsByTagName("roomstatus")[0];g.isEmpty(f)||
e.setRoomStatus(f.textContent);a=a.getElementsByTagName("item");c=[];for(f=0;f<a.length;f++){var m=a.item(f),n=new b.MucPresenceItem;n.setAffiliation(m.getAttribute("affiliation"));n.setRole(m.getAttribute("role"));var q=m.getAttribute("jid");g.isEmpty(q)||n.setJID(new d.JID(q));n.setNick(m.getAttribute("nick"));var p=m.getElementsByTagName("actor")[0];g.isEmpty(p)||(q=new d.JID(p.getAttribute("jid")),p=p.getAttribute("nick"),n.setActor(new l.Person(q,p)));m=m.getElementsByTagName("reason")[0];g.isEmpty(m)||
n.setReason(m.nodeValue);c.push(n)}e.setItems(c);return e}var p=b.PresenceType.AVAILABLE;return{messageToPacket:function(b,d){var c;try{var n=new e.JSJaCMessage;n.setID(b.getID());n.setFrom(new e.JSJaCJID(b.getFrom().getJIDAsString()));n.setTo(new e.JSJaCJID(b.getTo().getJIDAsString()));n.setType(b.getType());n.setBody(JSON.stringify(b.getBody()));b.hasSubject()&&n.setSubject(b.getSubject());d=null;b.getChatStateComposing()?d=f.CHAT_STATE_COMPOSING:b.getChatStatePaused()&&(d=f.CHAT_STATE_PAUSED);
if(!g.isEmpty(d)){var m=n.buildNode(d,{xmlns:"http://jabber.org/protocol/chatstates"});n.appendNode(m)}c=n}catch(l){a.ex("packet_converter","error creating JSJaCMessage",l),c=null}return c},packetToMessage:function(b){var k=b;b=new f.Message;if(k.getChild("result")){var c=k.getChild("result"),c=c.getElementsByTagName("forwarded")[0],c=c.getElementsByTagName("message")[0],n=new e.JSJaCMessage;n.setID(c.getAttribute("id"));n.setFrom(c.getAttribute("from"));n.setTo(c.getAttribute("to"));n.setType(c.getAttribute("type"));
n.setAmzAck(c.getAttribute("amz_ack"));n.setBody(k.getBody());k=n}g.isEmpty(k.getID())?(a.w("packet_converter","got message with empty ID - assigning new ID"),b.setID(g.createUUID(g.TAG_MESSAGE))):b.setID(k.getID());g.isEmpty(k.getFrom())||(c=k.getFromJID(),b.setFrom(new d.JID(c.getNode(),c.getDomain())));g.isEmpty(k.getTo())||(c=k.getToJID(),b.setTo(new d.JID(c.getNode(),c.getDomain())));g.isEmpty(k.getAmzAck)||b.setAck(k.getAmzAck());b.setType(k.getType());if(b.getType()!==f.TYPE_ERROR)if(b.setChatStateComposing(!g.isEmpty(k.getChild(f.CHAT_STATE_COMPOSING,
"http://jabber.org/protocol/chatstates"))),b.setChatStatePaused(!g.isEmpty(k.getChild(f.CHAT_STATE_PAUSED,"http://jabber.org/protocol/chatstates"))),g.isEmpty(k.getChild("x","http://jabber.org/protocol/muc#user")))if(g.isEmpty(k.getChild("x","jabber:x:conference"))){c=null;try{c=JSON.parse(k.getBody())}catch(m){g.isEmpty(k.getBody)?a.l("packet_converter","received non-JSON packet"):a.l("packet_converter","received non-JSON message: "+k.getBody())}g.isEmpty(c)||b.setBody(c)}else k=k.getChild("x","jabber:x:conference"),
k=new d.JID(k.getAttribute("jid")),b.setAmzType(f.AMZ_TYPE_GROUP_INVITE),b.setAmzGroupInviteJID(k);else n=k,k=n.getChild("x","http://jabber.org/protocol/muc#user").firstElementChild,"decline"===k.nodeName?b.setAmzType(f.AMZ_TYPE_GROUP_INVITE_DECLINE):b.setAmzType(f.AMZ_TYPE_GROUP_INVITE),c=new d.JID(k.getAttribute("from")),n=new d.JID(n.getFrom()),b.setAmzGroupInviteJID(n),b.setAmzSenderJID(c),g.isEmpty(k.firstElementChild)||b.setAmzContent(k.firstElementChild.textContent);return b},packetToPresence:function(a){var d,
c;d=new b.Presence;d.setID(a.getID());g.isEmpty(a.getFrom())||d.setFrom(m(a.getFromJID()));g.isEmpty(a.getTo())||d.setTo(m(a.getToJID()));c=a.getType();g.isEmpty(c)?d.setType(p):d.setType(c);d.setShow(a.getShow());d.setStatus(a.getStatus());g.isEmpty(a.getPriority())?d.setPriority(0):d.setPriority(a.getPriority());a.isError()&&(c=q.getCampfireErrorFromPacket(a),d.setError(c));c=a.getChild("x","http://jabber.org/protocol/muc#user");g.isEmpty(c)||d.setRoomPresence(u(c));c=a.getChild("reach","urn:xmpp:reach:0");
g.isEmpty(c)||d.setHasReachableAddress(!g.isEmpty(c.getElementsByTagName("addr")));c=a.getChild("sender","urn:xmpp:amazon:user");g.isEmpty(c)||(d.setSenderName(c.getAttribute("name")),d.setSenderCustomerId(c.getAttribute("amazonCustomerId")));a=a.getChild("chatability","urn:xmpp:amazon:presence:chatability");g.isEmpty(a)||d.setChatability(parseInt(a.textContent,10));return d}}});t.when("AmazonComm/messaging/jsjac/packet_converter").execute(function(d){v["AmazonComm/messaging/jsjac/packet_converter"]=
d});t.when("AmazonComm/common/jid_class","AmazonComm/messaging/message_class","AmazonComm/utils/common","AmazonComm/utils/config","AmazonComm/utils/global_state","AmazonComm/utils/log","AmazonComm/utils/mash/campfire_cordova").register("AmazonComm/messaging/native/connection",function(d,l,f,b,q,g,a){var e=!1,m=null,u={},p={connected:function(a){e=!0;var b=a.authCredentialData;f.isEmpty(b)||(g.l("native/connection","got auth credential data used by native connection"),q.setAuthCredentialData(b));f.isEmpty(m)||
(a=d.JID.fromJSONObject(a.jid),g.l("native/connection","server assigned jid: ["+a.toString()+"]"),m.onConnected({jid:a}))},disconnected:function(a){e=!1;if(!f.isEmpty(m))m.onDisconnected()},reconnecting:function(a){e=!1;if(!f.isEmpty(m))m.onReconnecting({code:a.errorCode,description:a.errorDescription})},error:function(a){e=!1;if(!f.isEmpty(m))m.onError({code:a.errorCode,description:a.errorDescription})},message:function(a){a=l.createFromJSONString(a.messageString);var b=u[a.getAmzType()];if(!f.isEmpty(b))for(var d=
0;d<b.length;d++)b[d].onMessage(a)}},h={onSuccess:function(a){var b=a.status;g.l("native/connection","handling ["+b+"] event");p[b](a)},onError:function(a){g.l("native/connection","error calling the native connection");p.error(a)}},k={onSuccess:function(a){g.l("native/connection","message successfully sent.")},onError:function(a){g.l("native/connection","error sending message.")}};return{connect:function(c,d,e){g.l("native/connection","connecting to server natively");m=e;c=[{apiKey:c,stage:b.getStage(),
isAuthenticationCheckRequired:b.isAuthenticationCheckRequired(),messagingServiceHostCount:b.getMessagingHostCount(),messagingServiceDomain:b.getMessagingDomain(),messagingServiceMucDomain:b.getMUCDomain(),messagingServiceFormat:b.getMessagingHostFormat()},d];q.setCurrentAuthCredentialData(d);a.exec("nativeConnect",c,h)},disconnect:function(){g.l("native/connection","disconnecting native server connection");a.exec("nativeDisconnect",[],h)},isConnected:function(){return e},sendPacket:function(a,b){g.e("native/connection",
"api not implemented")},sendMessage:function(c,b){c=[l.convertMessageToJSONObject(c)];a.exec("sendMessage",c,k);return!0},addMessageHandler:function(a,b){var d=u[a];f.isEmpty(d)&&(d=[]);-1===d.indexOf(b)&&(d.push(b),u[a]=d);return b},removeMessageHandler:function(a,b){var d=u[a];f.isEmpty(d)||(b=d.indexOf(b),-1<b&&(d.splice(b,1),u[a]=d))},addPresenceHandler:function(a,b){g.e("native/connection","api not implemented")},removePresenceHandler:function(a,b){g.e("native/connection","api not implemented")},
setNativeConnectionObserver:function(a){m=a},setNativeSendMessageCallbacks:function(a){k=a},getMessageHandlerCount:function(a){var b=0;a=u[a];f.isEmpty(a)||(b=a.length);return b}}});t.when("AmazonComm/messaging/native/connection").execute(function(d){v["AmazonComm/messaging/native/connection"]=d});t.when("AmazonComm/utils/config","AmazonComm/utils/log","AmazonComm/utils/common","3p-Dcm").register("AmazonComm/metrics/metrics_manager",function(d,l,f,b){b.MetricsConfiguration.configureNormalPipeline(65536,
2048,12E4);b.MetricsConfiguration.configureHighPipeline(32768,1024,6E4);b.MetricsConfiguration.setLogEnabled(!1);b.MetricsFactory.setDeviceTypeId("APBG3C9M6ERTI");b.MetricsFactory.setDeviceSerialNumber("0");b.MetricsFactory.setOAuthTokenProvider(function(){return null});return{AGGREGATING_EVENT:b.MetricEventType.AGGREGATING,AVERAGING_EVENT:b.MetricEventType.AVERAGING,NORMAL_PRIORITY:b.MetricPriority.NORMAL,HIGH_PRIORITY:b.MetricPriority.HIGH,createMetricEvent:function(q,g){f.isEmpty(q)&&(q="CampfireJavaScriptSDKDefaultSource",
l.w("metrics_manager","Invalid sourceName. Using default source name."));var a=null;try{b.MetricsFactory.addMetadata("MarketplaceID",d.getMarketplaceId()),a=b.MetricsFactory.createMetricEvent(f.createUUID(f.TAG_METRIC),d.getStage()+".CampfireJavaScriptSDK."+d.getApiKey(),q,g,!0)}catch(e){l.error("metrics_manager","error creating metrics event",e)}return a},incrementCounter:function(b,d,a){try{return b.incrementCounter(d,a),!0}catch(e){return l.error("metrics_manager","error incrementing counter",
e),!1}},startTimer:function(b,d,a){try{return b.startTimer(d,a),!0}catch(e){return l.error("metrics_manager","error starting timer",e),!1}},stopTimer:function(b,d){try{return b.stopTimer(d),!0}catch(a){return l.error("metrics_manager","error stopping timer",a),!1}},addTimer:function(b,d,a,e){try{if(f.isEmpty(e)||0>=e)e=1;b.addTimer(d,a,e);return!0}catch(m){return l.error("metrics_manager","error adding timer",m),!1}},setDeviceSerialNumber:function(d){if(f.isEmpty(d))return l.w("metrics_manager","Invalid device serial number. Using default DSN."),
!1;b.MetricsFactory.setDeviceSerialNumber(d);return!0},recordMetricEvent:function(d,f){try{return b.MetricsFactory.recordMetricEvent(d,f),!0}catch(a){return l.error("metrics_manager","error recording metric event",a),!1}},uploadRecordedMetrics:function(){try{l.l("metrics_manager","forcing metrics upload"),b.MetricsFactory.uploadMetrics()}catch(d){l.error("metrics_manager","error uploading metrics",d)}}}});t.when("AmazonComm/common/jid_class","AmazonComm/common/person_class","AmazonComm/messaging/presence_class",
"AmazonComm/messaging/presence_manager","AmazonComm/messaging/jsjac/connection","AmazonComm/messaging/jsjac/node_utils","AmazonComm/utils/common","AmazonComm/utils/config","AmazonComm/utils/constants","AmazonComm/utils/error_codes","AmazonComm/utils/global_state","AmazonComm/utils/log","3p-JSJaC").register("AmazonComm/roster/roster_class",function(d,l,f,b,q,g,a,e,m,u,p,h,k){function c(a){var c=new l.Person(a.getFrom(),a.getSenderName(),a.getSenderCustomerId());h.l("roster","received presence type ["+
a.getType()+"] from "+c);for(var b=0;b<z.length;b++)if(a.getType()===f.PresenceType.SUBSCRIBE)z[b].onSubscribe({person:c});else if(a.getType()===f.PresenceType.SUBSCRIBED)z[b].onSubscribed({person:c});else if(a.getType()===f.PresenceType.UNSUBSCRIBED)z[b].onUnsubscribed({person:c});else h.e("roster","unexpected presence type ["+a.getType()+"]")}function n(c){if(c.isError())c=g.getCampfireErrorFromPacket(c),h.error("roster","error fetching roster",c),I.onError(c);else{c=c.getNode().getElementsByTagName("item");
h.l("roster","roster update has "+c.length+" items");for(var b=0;b<c.length;b++)r(c.item(b));y.sort(w);D.sort(w);if(F)for(c=0;c<z.length;c++)z[c].onChange({rosterItems:y,sentInvites:D});else if(F=!0,!a.isEmpty(I))I.onSuccess({rosterItems:y,sentInvites:D})}}function r(c){var b=new d.JID(c.getAttribute("jid")),e;b.isGroupJID()?e=!0:(e=p.getLocalUser(),e=a.isEmpty(e)||a.isEmpty(e.getJID())||!e.getJID().equals(b)?void 0:!0);if(!e){e=c.getAttribute("name");a.isEmpty(e)&&(e=b.toString());var k=c.getAttribute("amazonCustomerId"),
b=new l.Person(b,e,k);c=c.getAttribute("ask");if(a.isEmpty(c)||"subscribe"!==c){c=!1;for(e=0;e<y.length;e++)if(y[e].getJID().equals(b.getJID())){y[e]=b;c=!0;break}c||y.push(b);for(e=0;e<D.length;e++)if(D[e].getJID().equals(b.getJID())){D.splice(e,1);break}}else{c=!1;for(e=0;e<D.length;e++)if(D[e].getJID().equals(b.getJID())){D[e]=b;c=!0;break}c||D.push(b)}}}function w(a,c){return a.getName().localeCompare(c.getName())}function t(c,b){h.l("roster","sending presence type ["+c+"] to "+b.getJID());var d=
new k.JSJaCPresence;d.setTo(b.getJID().getJIDAsString());d.setType(c);d.setID(a.createUUID(a.TAG_PRESENCE));return q.sendPacket(d)}function v(c){I=c;c=new k.JSJaCIQ;c.setType("get");c.setID(a.createUUID(a.TAG_IQ));c.setQuery("jabber:iq:roster");if(!q.sendPacket(c,!1,function(a){n(a);q.sendPacket(new k.JSJaCPresence)}))I.onError({code:u.GENERIC_ERRORS.ERROR_UNKNOWN,description:"failed to send roster IQ"})}function G(a){for(var c={},b=0;b<R.length;b++){var d=R[b];a.hasOwnProperty(d)&&(c[d]=a[d])}return c}
function C(c,b){var n=new k.JSJaCIQ;n.setIQ(e.getSearchDomain(),"set",a.createUUID(a.TAG_IQ));var f=n.setQuery("jabber:iq:search");if(!a.isEmpty(c.searchString)&&!a.isEmpty(c.searchType)){var r=c.searchString,w=c.searchType,t=G(c);g.appendNodeWithText(n,f,w,r);f=g.appendNodeWithAttribute(n,f,"search",m.XMLNS,"urn:xmpp:amazon:search:attributes");g.appendNodeWithAttributeAndText(n,f,m.ELEMENT_JSON,m.XMLNS,m.NS_JSON,JSON.stringify(t));h.l("roster","searching for users matching ["+JSON.stringify(c)+"]");
if(!q.sendPacket(n,!1,function(e){var k=!1;a.isEmpty(c.excludeSelf)||!0!==c.excludeSelf||(k=!0);if(e.isError())k=g.getCampfireErrorFromPacket(e),h.error("roster","error searching for users",k),b.onError(k);else{var n,f,m,r,q,u=[],w=e.getNode().getElementsByTagName("item");h.l("roster","user search returned "+w.length+" items");for(var J=p.getLocalUser().getJID(),t=0;t<w.length;t++)n=w.item(t),e=new d.JID(n.getAttribute("jid")),f=g.getChildNode(n,"name").textContent,m=g.getChildNode(n,"amazonCustomerId").textContent,
q=g.getChildNode(n,"mobile").textContent,r=g.getChildNode(n,"email").textContent,n="true"===g.getChildNode(n,"userExist").textContent?!0:!1,!1!==k&&e.getBareJID()===J.getBareJID()||u.push(new l.Person(e,f,m,null,q,r,n));b.onSuccess({rosterItems:u})}}))b.onError({code:u.GENERIC_ERRORS.ERROR_UNKNOWN,description:"failed to send search IQ"})}}var I,F=!1,z=[],y=[],D=[],R=["maxSize","prefix","sortField","substring"],H=function(){this.mRosterLoadCallbacks=null;this.mRosterLoaded=!1;this.mRosterObservers=
[];this.mCurrentRoster=[];this.mSentInvites=[];q.addIQHandler("jabber:iq:roster",{onIq:n});b.subscribe(f.PresenceType.SUBSCRIBE,c);b.subscribe(f.PresenceType.SUBSCRIBED,c);b.subscribe(f.PresenceType.UNSUBSCRIBED,c)};H.prototype.loadRoster=function(a){v(a)};H.prototype.searchForUsers=function(a,c){C(a,c)};H.prototype.registerObserver=function(a){z.push(a)};H.prototype.unregisterObserver=function(a){a=z.indexOf(a);return-1<a?(z=z.splice(a,1),!0):!1};H.prototype.invitePerson=function(a){return t(f.PresenceType.SUBSCRIBE,
a)};H.prototype.acceptInvite=function(a){t(f.PresenceType.SUBSCRIBED,a)};H.prototype.rejectInvite=function(a){t(f.PresenceType.UNSUBSCRIBED,a)};H.prototype.getSize=function(){return this.mCurrentRoster.length};H.prototype.toString=function(){return"Roster:{size:"+this.mCurrentRoster.length+"}"};H.prototype.handlePresence=function(a){return c(a)};H.prototype.handleRosterResponseItem=function(a){return r(a)};H.prototype.getRosterItems=function(){return y};H.prototype.getSentInvites=function(){return D};
H.prototype.compare=function(a,c){return w(a,c)};return{Roster:H,AMAZON_CUSTOMER_ID:"amazonCustomerId",EMAIL:"email",MOBILE:"mobile",NAME:"name",SOCIAL_GRAPH:"socialGraph"}});t.when("AmazonComm/roster/roster_class").execute(function(d){v["AmazonComm/roster/roster_class"]=d});t.register("AmazonComm/roster/roster_item_interface",function(){var d=function(){};d.prototype.getThirdPartyID=function(){throw Error("must be implemented by subclass!");};return{RosterItem:d}});t.when("AmazonComm/roster/roster_item_interface").execute(function(d){v["AmazonComm/roster/roster_item_interface"]=
d});t.when("AmazonComm/common/chatroom_class","AmazonComm/common/jid_class","AmazonComm/common/person_class","AmazonComm/messaging/chatroom/association_class","AmazonComm/messaging/chatroom/chat_room_manager","AmazonComm/rtc/call_peer_class","AmazonComm/rtc/call_signaler","AmazonComm/utils/common","AmazonComm/utils/global_state","AmazonComm/utils/log").register("AmazonComm/rtc/call_class",function(d,l,f,b,q,g,a,e,m,u){var p=Object.freeze({NONE:"none",INCOMING:"incoming",OUTGOING:"outgoing"}),h=Object.freeze({NONE:"none",
REQUEST_SENT:"request_sent",REQUEST_DELIVERED:"request_delivered",PENDING_RESPONSE:"pending_response",CONNECTING:"connecting",IN_PROGRESS:"in_progress",ENDED:"ended",ERROR:"error"});l=function(){this.mID=e.createUUID(e.TAG_CALL);this.mDirection=p.NONE;this.mCallState=h.NONE;this.mCallStateObservers=[];this.mRequestedParticipants=[];this.mParticipantsCurrentlyInCall=[];this.mMcuInfo=this.mRemoteVideo=this.mSelfVideo=this.mCallPeer=this.mSignalingDestination=null};l.prototype.getID=function(){return this.mID};
l.prototype.setID=function(a){this.mID=a};l.prototype.getDirection=function(){return this.mDirection};l.prototype.setDirection=function(a){this.mDirection=a};l.prototype.addCallStateObserver=function(a){-1===this.mCallStateObservers.indexOf(a)&&this.mCallStateObservers.push(a);return a};l.prototype.removeCallStateObserver=function(a){a=this.mCallStateObservers.indexOf(a);-1<a&&this.mCallStateObservers.splice(a,1)};l.prototype.notifyObservers=function(){for(var a=0;a<this.mCallStateObservers.length;a++)this.mCallStateObservers[a].onStateChange(this.mCallState)};
l.prototype.getCallState=function(){return this.mCallState};l.prototype.setCallState=function(a){this.mCallState=a;this.notifyObservers()};l.prototype.getRequestedParticipants=function(){return this.mRequestedParticipants};l.prototype.setVideoElements=function(a,c){this.mSelfVideo=a;this.mRemoteVideo=c};l.prototype.isEnded=function(){return this.mCallState===h.ENDED||this.mCallState===h.ERROR};l.prototype.equals=function(a){return e.deepEquals(this,a)};l.prototype.toString=function(){return"Call: {\nID: ["+
this.mID+"]\ndirection: ["+this.mDirection+"]\ncallState: ["+this.mCallState+"]\nrequested participants: ["+this.mRequestedParticipants.length+"]\nparticipants in call: ["+this.mParticipantsCurrentlyInCall.length+"]\nobservers: ["+this.mCallStateObservers.length+"]\n}"};l.prototype.placeCall=function(d){this.setDirection(p.OUTGOING);this.mRequestedParticipants=d;this.addCallParticipant(m.getLocalUser());if(1<this.mRequestedParticipants.length){d=new q.ChatRoomConfig;d.ENABLE_LOGGING=q.MUC_CONFIG_VALUES.FALSE;
d.MEMBERS_ONLY=q.MUC_CONFIG_VALUES.TRUE;d.PERSISTENT_ROOM=q.MUC_CONFIG_VALUES.FALSE;d.PUBLIC_ROOM=q.MUC_CONFIG_VALUES.FALSE;var c=this;q.createRoom({name:"chat room for call "+this.getID()},{onCreated:function(d){var e=d.chatroom;c.mSignalingDestination=e;u.l("call_class","chat room created: "+e.toString());for(d=0;d<c.mRequestedParticipants.length;d++)q.setAffiliationInRoom(e,c.mRequestedParticipants[d].getJID(),b.Affiliation.MEMBER,{onSetAffiliationSuccess:function(b){a.sendInvite(c.getID(),new f.Person(b,
c.findParticipantNameForJID(b)),e)},onError:function(a){u.e("call_class","error adding participant to member list: "+a.description)}});c.setCallState(h.REQUEST_SENT)},onError:function(a){u.e("call_class","error creating chat room: "+a.description);c.setCallState(h.ERROR)}},d)}else this.mSignalingDestination=this.mRequestedParticipants[0],a.sendInvite(this.getID(),this.mSignalingDestination),this.setCallState(h.REQUEST_SENT)};l.prototype.findParticipantNameForJID=function(a){for(var c=0;c<this.mRequestedParticipants.length;c++){var b=
this.mRequestedParticipants[c];if(b.getJID().equals(a))return b.getName()}return""};l.prototype.handleIncomingCall=function(a){var c=this.makePersonFromSignal(a);u.l("call_class","incoming call from ["+c.getName()+"]");this.setDirection(p.INCOMING);this.setID(a.getAmzCallId());this.addCallParticipant(c);this.setCallState(h.PENDING_RESPONSE);e.isEmpty(a.getAmzGroupInviteJID())?this.mSignalingDestination=c:(this.mSignalingDestination=a=new d.ChatRoom(a.getAmzGroupInviteJID(),a.getAmzCallId()),q.joinRoom(a,
{onJoined:function(a){},onError:function(a){u.e("call_class","error joining chat room: "+a.description)}},{maxMessages:1}))};l.prototype.accept=function(){this.addCallParticipant(m.getLocalUser());this.setCallState(h.CONNECTING);a.sendAccept(this.getID(),this.mSignalingDestination);this.createPeer(!1)};l.prototype.handleAccept=function(a){u.l("call_class","["+a.getAmzSenderName()+"] accepted the call");a=this.makePersonFromSignal(a);this.addCallParticipant(a);this.getDirection()===p.OUTGOING?(this.getCallState()===
h.REQUEST_SENT?this.setCallState(h.CONNECTING):this.notifyObservers(),this.createPeer(!0)):this.notifyObservers()};l.prototype.reject=function(){a.sendReject(this.getID(),this.mSignalingDestination);this.endCall()};l.prototype.handleReject=function(a){u.l("call_class","["+a.getAmzSenderName()+"] rejected the call");a=this.makePersonFromSignal(a);this.endCallIfNoMoreParticipants(a)};l.prototype.hangup=function(){a.sendHangup(this.getID(),this.mSignalingDestination);this.endCall()};l.prototype.handleHangup=
function(a){u.l("call_class","["+a.getAmzSenderName()+"] hung up");a=this.makePersonFromSignal(a);this.endCallIfNoMoreParticipants(a)};l.prototype.endCallIfNoMoreParticipants=function(a){this.removeCallParticipant(a);1>=this.mParticipantsCurrentlyInCall.length?this.endCall():this.notifyObservers()};l.prototype.endCall=function(){this.setCallState(h.ENDED);this.closePeer()};l.prototype.addCallParticipant=function(a){for(var c=!1,b=0;b<this.mParticipantsCurrentlyInCall.length;b++)if(this.mParticipantsCurrentlyInCall[b].equals(a)){c=
!0;break}c||this.mParticipantsCurrentlyInCall.push(a)};l.prototype.removeCallParticipant=function(a){for(var c=0;c<this.mParticipantsCurrentlyInCall.length;c++)if(this.mParticipantsCurrentlyInCall[c].equals(a)){this.mParticipantsCurrentlyInCall.splice(c,1);break}};l.prototype.getCurrentCallParticipants=function(){return this.mParticipantsCurrentlyInCall};l.prototype.makePersonFromSignal=function(a){return new f.Person(a.getAmzSenderJID(),a.getAmzSenderName(),a.getAmzSenderId())};l.prototype.createPeer=
function(a){if(e.isEmpty(this.mCallPeer)){var c=this,b=1<this.mRequestedParticipants.length;this.mCallPeer=new g.CallPeer(this.getID(),a,b,this.mSignalingDestination,this.mSelfVideo,this.mRemoteVideo,function(){c.setCallState(h.IN_PROGRESS)});this.mCallPeer.initialize();e.isEmpty(this.mMcuInfo)||this.mCallPeer.handleMcuInfo(this.mMcuInfo)}};l.prototype.closePeer=function(){e.isEmpty(this.mCallPeer)||this.mCallPeer.close()};l.prototype.handleOffer=function(a){e.isEmpty(this.mCallPeer)||(a=a.getAmzSignalData(),
this.mCallPeer.handleOffer(a))};l.prototype.handleMcuInfo=function(a){a=a.getAmzSignalData();e.isEmpty(this.mCallPeer)?this.mMcuInfo=a:this.mCallPeer.handleMcuInfo(a)};l.prototype.handleAnswer=function(a){e.isEmpty(this.mCallPeer)||(a=a.getAmzSignalData(),this.mCallPeer.handleAnswer(a))};l.prototype.handleCandidate=function(a){e.isEmpty(this.mCallPeer)||(a=a.getAmzSignalData(),this.mCallPeer.handleCandidate(a))};l.prototype.getCallStateObservers=function(){return this.mCallStateObservers};l.prototype.setRequestedParticipants=
function(a){this.mRequestedParticipants=a};l.prototype.setCurrentCallParticipants=function(a){this.mParticipantsCurrentlyInCall=a};l.prototype.getCallPeer=function(){return this.mCallPeer};l.prototype.getSelfVideo=function(){return this.mSelfVideo};l.prototype.getRemoteVideo=function(){return this.mRemoteVideo};return{CallState:h,CallDirection:p,Call:l}});t.when("AmazonComm/rtc/call_class").execute(function(d){v["AmazonComm/rtc/call_class"]=d});t.when("AmazonComm/messaging/connection_strategy","AmazonComm/messaging/message_class",
"AmazonComm/rtc/call_class","AmazonComm/utils/common","AmazonComm/utils/log").register("AmazonComm/rtc/call_manager",function(d,l,f,b,q){function g(b){if(!b.wasSentByUs())if(b.getAmzSubType()===l.AMZ_SUBTYPE_SIGNAL_INVITE){m=new f.Call;m.handleIncomingCall(b);b=m;for(var d=0;d<a.length;d++)a[d].onIncomingCall(b)}else b.getAmzSubType()===l.AMZ_SUBTYPE_SIGNAL_ACK?b.getAmzAccept()?m.handleAccept(b):m.handleReject(b):b.getAmzSubType()===l.AMZ_SUBTYPE_SIGNAL_BYE?m.handleHangup(b):b.getAmzSubType()===l.AMZ_SUBTYPE_SIGNAL_OFFER?
m.handleOffer(b):b.getAmzSubType()===l.AMZ_SUBTYPE_SIGNAL_ANSWER?m.handleAnswer(b):b.getAmzSubType()===l.AMZ_SUBTYPE_SIGNAL_CANDIDATE?m.handleCandidate(b):b.getAmzSubType()===l.AMZ_SUBTYPE_SIGNAL_MCU_INFO?m.handleMcuInfo(b):q.w("call_manager","unknown signal type: ["+b.getAmzSubType()+"]")}var a=[],e=d.getConnection(),m;(function(){e.addMessageHandler(l.AMZ_TYPE_SIGNAL,{onMessage:function(a){g(a)}})})();return{addIncomingCallObserver:function(b){-1===a.indexOf(b)&&a.push(b);return b},removeIncomingCallObserver:function(b){b=
a.indexOf(b);-1<b&&a.splice(b,1)},placeCall:function(a){m=new f.Call;m.placeCall(a);return m},getIncomingCallObservers:function(){return a},setCurrentCall:function(a){m=a},handleSignal:function(a){return g(a)}}});t.when("AmazonComm/rtc/call_manager").execute(function(d){v["AmazonComm/rtc/call_manager"]=d});t.when("AmazonComm/messaging/message_class","AmazonComm/rtc/call_signaler","AmazonComm/rtc/mcu_controller","AmazonComm/utils/common","AmazonComm/utils/global_state","AmazonComm/utils/log").register("AmazonComm/rtc/call_peer_class",
function(d,l,f,b,q,g){var a={iceServers:[{urls:["turn:54.86.0.80"],username:"kurento",credential:"kurento"}],iceTransportPolicy:"relay"},e={},m={audio:!0,video:!0},u={offerToReceiveAudio:!0,offerToReceiveVideo:!0},p={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}};q=function(d,k,c,n,f,g,l){this.mPeerConfiguration=a;this.mPeerConstraints=e;this.mMediaConstraints=m;b.isEmpty(navigator.mozGetUserMedia)?this.mOfferOptions=p:this.mOfferOptions=u;this.mPeerConnection=null;this.mCallId=d;this.mIsCaller=
k;this.mIsGroupCall=c;this.mRemoteParticipant=n;this.mSelfView=f;this.mRemoteView=g;this.mLocalStream=null;this.mCallConnectedCallback=l;this.mRemoteMcuInfo=null;this.mUseMcu=!0;navigator.getUserMedia=navigator.getUserMedia||navigator.mozGetUserMedia||navigator.webkitGetUserMedia;v.RTCPeerConnection=v.RTCPeerConnection||v.mozRTCPeerConnection||v.webkitRTCPeerConnection;v.RTCSessionDescription=v.RTCSessionDescription||v.mozRTCSessionDescription||v.webkitRTCSessionDescription;v.RTCIceCandidate=v.RTCIceCandidate||
v.mozRTCIceCandidate||v.webkitRTCIceCandidate};q.prototype.initialize=function(){g.l("call_peer_class","initializing "+(this.mUseMcu?"MCU":"direct")+" peer connection");var a=this;this.mIsCaller&&this.mUseMcu?f.initialize(function(b){g.l("call_peer_class","sending MCU info to ["+a.mRemoteParticipant.getName()+"]: "+JSON.stringify(b));l.sendSignal(a.mCallId,a.mRemoteParticipant,d.AMZ_SUBTYPE_SIGNAL_MCU_INFO,b);a.createPeerConnection();a.startLocalStream()},function(b){a.onMcuAnswer(b)},function(b){a.onMcuCandidate(b)},
function(b){a.onMcuError(b)},{isGroupCall:a.mIsGroupCall}):this.mUseMcu||(this.createPeerConnection(),this.startLocalStream())};q.prototype.createPeerConnection=function(){if(!b.isEmpty(v.RTCPeerConnection)){this.mPeerConnection=new v.RTCPeerConnection(this.mPeerConfiguration,this.mPeerConstraints);var a=this;this.mPeerConnection.onicecandidate=function(b){a.sendCandidate(b.candidate)};this.mPeerConnection.onaddstream=function(b){a.remoteStreamAdded(b.stream)}}};q.prototype.close=function(){g.l("call_peer_class",
"closing peer connection");this.mUseMcu&&f.close();b.isEmpty(this.mLocalStream)||(this.mLocalStream.getAudioTracks()[0].stop(),this.mLocalStream.getVideoTracks()[0].stop());this.mSelfView.src="";this.mRemoteView.src="";b.isEmpty(this.mPeerConnection)||this.mPeerConnection.close()};q.prototype.handleMcuInfo=function(a){g.l("call_peer_class","got MCU info: "+JSON.stringify(a));this.mRemoteMcuInfo=a;this.mIsGroupCall=a.isGroupCall;var b=this;f.initialize(function(){b.createPeerConnection();b.startLocalStream()},
function(a){b.onMcuAnswer(a)},function(a){b.onMcuCandidate(a)},function(a){b.onMcuError(a)},{remoteMcuInfo:b.mRemoteMcuInfo})};q.prototype.onMcuAnswer=function(a){this.handleAnswer(a)};q.prototype.onMcuCandidate=function(a){this.handleCandidate(a)};q.prototype.onMcuError=function(a){g.e("call_peer_class","got MCU error: "+JSON.stringify(a))};q.prototype.sendOffer=function(a){g.l("call_peer_class","sending offer to "+(this.mUseMcu?"MCU":"["+this.mRemoteParticipant.getName()+"]")+this.sessionDescriptionToString(a));
b.isEmpty(this.mPeerConnection)||this.mPeerConnection.setLocalDescription(a);this.mUseMcu?f.sendOffer(a.sdp):l.sendSignal(this.mCallId,this.mRemoteParticipant,d.AMZ_SUBTYPE_SIGNAL_OFFER,a)};q.prototype.handleOffer=function(a){g.l("call_peer_class","got offer from ["+this.mRemoteParticipant.getName()+"]"+this.sessionDescriptionToString(a));if(!b.isEmpty(this.mPeerConnection)&&(this.mPeerConnection.setRemoteDescription(new v.RTCSessionDescription(a)),!this.mUseMcu)){var d=this;this.mPeerConnection.createAnswer(function(a){d.sendAnswer(a)},
d.handleError,d.mOfferOptions)}};q.prototype.sendAnswer=function(a){g.l("call_peer_class","sending answer to ["+this.mRemoteParticipant.getName()+"] "+this.sessionDescriptionToString(a));b.isEmpty(this.mPeerConnection)||this.mPeerConnection.setLocalDescription(a);this.mUseMcu||l.sendSignal(this.mCallId,this.mRemoteParticipant,d.AMZ_SUBTYPE_SIGNAL_ANSWER,a)};q.prototype.handleAnswer=function(a){g.l("call_peer_class","got answer from "+(this.mUseMcu?"MCU":"["+this.mRemoteParticipant.getName()+"]")+
this.sessionDescriptionToString(a));b.isEmpty(this.mPeerConnection)||this.mPeerConnection.setRemoteDescription(new v.RTCSessionDescription(a))};q.prototype.sendCandidate=function(a){b.isEmpty(a)||-1===a.candidate.indexOf("relay")||(g.l("call_peer_class","sending candidate to "+(this.mUseMcu?"MCU ":"["+this.mRemoteParticipant.getName()+"] ")+this.candidateToString(a)),this.mUseMcu?f.sendCandidate(a):l.sendSignal(this.mCallId,this.mRemoteParticipant,d.AMZ_SUBTYPE_SIGNAL_CANDIDATE,a))};q.prototype.handleCandidate=
function(a){b.isEmpty(a)||(g.l("call_peer_class","got candidate from "+(this.mUseMcu?"MCU ":"["+this.mRemoteParticipant.getName()+"] ")+this.candidateToString(a)),b.isEmpty(this.mPeerConnection)||this.mPeerConnection.addIceCandidate(new v.RTCIceCandidate(a)))};q.prototype.startLocalStream=function(){var a=this;g.l("call_peer_class","starting local stream");b.isEmpty(navigator.getUserMedia)||navigator.getUserMedia(a.mMediaConstraints,function(b){a.mLocalStream=b;a.mIsGroupCall?a.mSelfView.style.display=
"none":(a.mSelfView.style.display="initial",a.connectStreamToElement(b,a.mSelfView));a.mPeerConnection.addStream(b);(a.mIsCaller||a.mUseMcu)&&a.mPeerConnection.createOffer(function(c){a.sendOffer(c)},a.handleError,a.mOfferOptions)},a.handleError)};q.prototype.remoteStreamAdded=function(a){g.l("call_peer_class","adding remote stream");this.connectStreamToElement(a,this.mRemoteView);this.mCallConnectedCallback()};q.prototype.connectStreamToElement=function(a,d){b.isEmpty(navigator.mozGetUserMedia)?
(v.URL=v.URL||v.webkitURL,d.autoplay=!0,d.src=v.URL.createObjectURL(a)):(d.mozSrcObject=a,d.play())};q.prototype.handleError=function(a){g.e("call_peer_class","got error: "+a.name+" "+a.message)};q.prototype.sessionDescriptionToString=function(a){return"\n"+a.sdp};q.prototype.candidateToString=function(a){return"["+a.candidate+"]"};q.prototype.getCallId=function(){return this.mCallId};q.prototype.getIsCaller=function(){return this.mIsCaller};q.prototype.getRemoteParticipant=function(){return this.mRemoteParticipant};
q.prototype.getSelfView=function(){return this.mSelfView};q.prototype.getRemoteView=function(){return this.mRemoteView};q.prototype.getRemoteMcuInfo=function(){return this.mRemoteMcuInfo};q.prototype.setUseMcu=function(a){this.mUseMcu=a};return{CallPeer:q}});t.when("AmazonComm/rtc/call_peer_class").execute(function(d){v["AmazonComm/rtc/call_peer_class"]=d});t.when("AmazonComm/common/chatroom_class","AmazonComm/messaging/connection_strategy","AmazonComm/messaging/message_class","AmazonComm/utils/common",
"AmazonComm/utils/global_state","AmazonComm/utils/log").register("AmazonComm/rtc/call_signaler",function(d,l,f,b,q,g){function a(a,b,e){var g=q.getLocalUser(),k=new f.Message;k.setFrom(g.getJID());k.setTo(b.getJID());b instanceof d.ChatRoom?k.setType(f.TYPE_GROUPCHAT):k.setType(f.TYPE_NORMAL);k.setAmzType(f.AMZ_TYPE_SIGNAL);k.setAmzCallId(a);k.setAmzSubType(e);k.setAmzSenderJID(g.getJID());k.setAmzSenderName(g.getName());k.setAmzSenderId(g.getThirdPartyID());return k}var e=l.getConnection();return{sendInvite:function(d,
l,p){var h=f.AMZ_SUBTYPE_SIGNAL_INVITE;d=a(d,l,h);b.isEmpty(p)||d.setAmzGroupInviteJID(p.getJID());g.l("call_signaler","sending ["+h+"] to ["+l.getName()+"]");e.sendMessage(d)},sendAccept:function(b,d){var l=f.AMZ_SUBTYPE_SIGNAL_ACK;b=a(b,d,l);b.setAmzAccept(!0);g.l("call_signaler","sending ["+l+"] accept\x3dtrue to ["+d.getName()+"]");e.sendMessage(b)},sendReject:function(b,d){var l=f.AMZ_SUBTYPE_SIGNAL_ACK;b=a(b,d,l);b.setAmzAccept(!1);g.l("call_signaler","sending ["+l+"] accept\x3dfalse to ["+
d.getName()+"]");e.sendMessage(b)},sendHangup:function(b,d){var l=f.AMZ_SUBTYPE_SIGNAL_BYE;b=a(b,d,l);g.l("call_signaler","sending ["+l+"] to ["+d.getName()+"]");e.sendMessage(b)},sendSignal:function(b,d,f,g){b=a(b,d,f);b.setAmzSignalData(g);e.sendMessage(b)}}});t.when("AmazonComm/rtc/call_signaler").execute(function(d){v["AmazonComm/rtc/call_signaler"]=d});t.when("AmazonComm/utils/common","AmazonComm/utils/log").register("AmazonComm/rtc/mcu_controller",function(d,l){function f(f,k,g,u,x){q();E=f;
G=k;C=g;I=u;w=!0;d.isEmpty(x)||(d.isEmpty(x.isGroupCall)||(t=x.isGroupCall),d.isEmpty(x.filterName)||(c=x.filterName),d.isEmpty(x.remoteMcuInfo)||(w=!1,r=x.remoteMcuInfo.mcuSocketUrl,z=x.remoteMcuInfo.mediaPipelineId,M=x.remoteMcuInfo.sourceEndpointId,J=x.remoteMcuInfo.sinkEndpointId,t=x.remoteMcuInfo.isGroupCall));d.isEmpty(r)&&(r="wss://mcu.turn.amazon-comm.com:443/kurento");f=d.isEmpty(U)?v.WebSocket:U;l.l("mcu_controller","opening websocket to ["+r+"]");n=new f(r);n.onopen=function(){l.l("mcu_controller",
"opened websocket to ["+r+"]");w?b({jsonrpc:"2.0",id:"ID_CREATE_MEDIA_PIPELINE",method:"create",params:{type:"MediaPipeline"}}):a()};n.onmessage=function(n){n=JSON.parse(n.data);d.isEmpty(n.error)?"onEvent"===n.method?"OnIceCandidate"===n.params.value.type&&C(n.params.value.data.candidate):"ID_CREATE_MEDIA_PIPELINE"===n.id?(F=n.result.sessionId,z=n.result.value,l.l("mcu_controller","created media pipeline - mMediaPipelineId: ["+z+"]"),a()):"ID_CREATE_WEBRTC_ENDPOINT"===n.id?(F=n.result.sessionId,
y=n.result.value,l.l("mcu_controller","created endpoint - mWebRtcEndpointId: ["+y+"]"),d.isEmpty(c)?p():b({jsonrpc:"2.0",id:"ID_CREATE_CUSTOM_FILTER",method:"create",params:{type:c,constructorParams:{mediaPipeline:z}},sessionId:F})):"ID_CREATE_COMPOSITE"===n.id?(N=n.result.value,l.l("mcu_controller","created composite - mCompositeEndpointId: ["+N+"]"),e()):"ID_CREATE_HUB_PORT"===n.id?(O=n.result.value,l.l("mcu_controller","created hub port - mHubPortId: ["+O+"]"),d.isEmpty(L)?m("ID_CONNECT_LOCAL_TO_HUB_PORT",
y,O):m("ID_CONNECT_LOCAL_TO_HUB_PORT",L,O),m("ID_CONNECT_HUB_PORT_TO_LOCAL",O,y)):"ID_CREATE_CUSTOM_FILTER"===n.id?(L=n.result.value,l.l("mcu_controller","created custom filter - mCustomFilterId: ["+L+"]"),m("ID_CONNECT_LOCAL_TO_CUSTOM",y,L)):"ID_CONNECT_LOCAL_TO_CUSTOM"===n.id?(l.l("mcu_controller","connected local endpoint to custom filter"),p()):"ID_CONNECT_LOCAL_TO_HUB_PORT"===n.id?(R=!0,l.l("mcu_controller","connected local endpoint to hub port"),h()):"ID_CONNECT_HUB_PORT_TO_LOCAL"===n.id?(H=
!0,l.l("mcu_controller","connected hub port to local endpoint"),h()):"ID_CONNECT_LOCAL_TO_REMOTE"===n.id?(R=!0,l.l("mcu_controller","connected local endpoint to remote endpoint"),h()):"ID_CONNECT_REMOTE_TO_LOCAL"===n.id?(H=!0,l.l("mcu_controller","connected remote endpoint to local endpoint"),h()):"ID_PROCESS_OFFER"===n.id?(G({sdp:n.result.value,type:"answer"}),b({jsonrpc:"2.0",id:"ID_SUBSCRIBE_ON_ICE_CANDIDATE",method:"subscribe",params:{object:y,type:"OnIceCandidate",sessionId:F}})):"ID_SUBSCRIBE_ON_ICE_CANDIDATE"===
n.id&&(D=n.result.value,l.l("mcu_controller","subscribed to ICE candidates - mOnIceCandidateSubscriptionId: ["+D+"]"),b({jsonrpc:"2.0",id:"ID_GATHER_CANDIDATES",method:"invoke",params:{object:y,operation:"gatherCandidates"},sessionId:F})):(l.e("mcu_controller","got error from kurento: ["+n.error.message+"]"),I({code:n.error.code,description:n.error.message}))}}function b(a){a=JSON.stringify(a);n.send(a)}function q(){if(d.isEmpty(n))g();else{var a=!1;d.isEmpty(D)||(l.l("mcu_controller","unsubscribing from ice candidate events"),
b({jsonrpc:"2.0",id:"ID_UNSUBSCRIBE_ON_ICE_CANDIDATE",method:"unsubscribe",params:{object:y,subscription:D,sessionId:F}}),a=!0);d.isEmpty(O)||(l.l("mcu_controller","disconnecting hub port"),d.isEmpty(L)?u("ID_DISCONNECT_LOCAL_FROM_HUB_PORT",y,O):u("ID_DISCONNECT_LOCAL_FROM_HUB_PORT",L,O),u("ID_DISCONNECT_HUB_PORT_FROM_LOCAL",O,y),a=!0);a?(l.l("mcu_controller","closing websocket to ["+r+"] in 1000ms"),setTimeout(function(){n.close();g()},1E3)):(l.l("mcu_controller","closing websocket to ["+r+"]"),
n.close(),g())}}function g(){r=n=c=null;t=w=!1;D=y=z=F=I=C=G=E=null;H=R=!1;J=M=L=O=N=null}function a(){b({jsonrpc:"2.0",id:"ID_CREATE_WEBRTC_ENDPOINT",method:"create",params:{type:"WebRtcEndpoint",constructorParams:{mediaPipeline:z}},sessionId:F})}function e(){b({jsonrpc:"2.0",id:"ID_CREATE_HUB_PORT",method:"create",params:{type:"HubPort",constructorParams:{mediaPipeline:z,hub:w?N:J}},sessionId:F})}function m(a,c,d){b({jsonrpc:"2.0",id:a,method:"invoke",params:{object:c,operation:"connect",operationParams:{sink:d}},
sessionId:F})}function u(a,c,d){b({jsonrpc:"2.0",id:a,method:"invoke",params:{object:c,operation:"disconnect",operationParams:{sink:d}},sessionId:F})}function p(){t?w?b({jsonrpc:"2.0",id:"ID_CREATE_COMPOSITE",method:"create",params:{type:"Composite",constructorParams:{mediaPipeline:z}},sessionId:F}):e():w?k():(d.isEmpty(L)?m("ID_CONNECT_LOCAL_TO_REMOTE",y,J):m("ID_CONNECT_LOCAL_TO_REMOTE",L,J),m("ID_CONNECT_REMOTE_TO_LOCAL",M,y))}function h(){R&&H&&k()}function k(){if(w){var a,b;t?a=b=N:(b=d.isEmpty(c)?
y:L,a=y);E({mcuSocketUrl:r,mediaPipelineId:z,sourceEndpointId:b,sinkEndpointId:a,isGroupCall:t})}else E()}var c=null,n=null,r=null,w=!1,t=!1,E=null,G=null,C=null,I=null,F=null,z=null,y=null,D=null,R=!1,H=!1,N=null,O=null,L=null,M=null,J=null,U;return{FILTER_EDGE_DETECTION:"CannyEdge",initialize:function(a,c,b,d,e){f(a,c,b,d,e)},close:function(){q()},sendOffer:function(a){b({jsonrpc:"2.0",id:"ID_PROCESS_OFFER",method:"invoke",params:{object:y,operation:"processOffer",operationParams:{offer:a}},sessionId:F})},
sendCandidate:function(a){b({jsonrpc:"2.0",id:"ID_ADD_ICE_CANDIDATE",method:"invoke",params:{object:y,operation:"addIceCandidate",operationParams:{candidate:a}},sessionId:F})},setTestWebSocketClass:function(a){U=a}}});t.when("AmazonComm/rtc/mcu_controller").execute(function(d){v["AmazonComm/rtc/mcu_controller"]=d});t.when("AmazonComm/utils/common","AmazonComm/utils/log").register("AmazonComm/utils/mash/campfire_cordova",function(d,l){function f(b,f,g){d.isEmpty(v.cordova)?(l.e("campfire_cordova",
"Cordova undefined"),g.onError("Cordova undefined")):v.cordova.exec(function(a){g.onSuccess(a)},function(a){l.e("campfire_cordova","Error executing "+b+": "+a);g.onError(a)},"CampfireSMASHPlugin",b,f)}return{exec:function(b,d,g){f(b,d,g)}}});t.when("AmazonComm/utils/mash/campfire_cordova").execute(function(d){v["AmazonComm/utils/mash/campfire_cordova"]=d});t.when("AmazonComm/utils/common","AmazonComm/utils/log").register("AmazonComm/utils/browser_storage",function(d,l){var f=[];return{add:function(b,
d){a:{try{localStorage.setItem(b,d)}catch(a){l.l("BrowserStorage","adding to localStorage failed - try to clean up");for(var g=0;g<f.length;g++)f[g]();try{localStorage.setItem(b,d)}catch(e){l.ex("BrowserStorage","adding to localStorage failed after clean up",e);b=!1;break a}}b=!0}return b},get:function(b){return localStorage.getItem(b)},remove:function(b){localStorage.removeItem(b)},clear:function(){localStorage.clear()},getLength:function(){return localStorage.length},keyAt:function(b){return localStorage.key(b)},
registerStorageFullObserver:function(b){f.push(b)},unregisterStorageFullObserver:function(b){-1!==f.indexOf(b)&&f.splice(f.indexOf(b),1)},getObserverCount:function(){return f.length}}});t.when("AmazonComm/utils/browser_storage").execute(function(d){v["AmazonComm/utils/browser_storage"]=d});t.register("AmazonComm/utils/build",function(){return{BUILD_VERSION:"CampfireJavaScriptSDK-2.2.215519.0",BUILD_TIME:"2022-02-03 20:22:17"}});t.when("AmazonComm/utils/build").execute(function(d){v["AmazonComm/utils/build"]=
d});t.register("AmazonComm/utils/common",function(){function d(a){if(void 0===a||null===a)return!0;if("number"===typeof a||"boolean"===typeof a||"function"===typeof a)return!1;if("string"===typeof a)return""===a.trim();if(Array.isArray(a)||void 0!==a.length)return 0===a.length;if(Object.getPrototypeOf(a)!==Object.prototype)return!1;for(var b in a)if(a.hasOwnProperty(b)&&void 0!==a[b])return!1;return!0}function l(a,b){if("number"===typeof a||"string"===typeof a||"boolean"===typeof a)return a===b;if(a===
M&&b===M)return!0;if(a===M&&b!==M||a!==M&&b===M)return!1;if(null===a&&null===b)return!0;if(null===a&&null!==b||null!==a&&null===b)return!1;if(d(a)&&d(b))return!0;if(d(a)&&!d(b)||!d(a)&&d(b))return!1;if(a instanceof Node&&b instanceof Node)return a.isEqualNode(b);var e=[],f=null;for(f in a)if(a.hasOwnProperty(f)&&"function"!==typeof a[f]&&(e.push(f),!l(a[f],b[f])))return!1;for(f in b)if(b.hasOwnProperty(f)&&"function"!==typeof b[f]&&-1===e.indexOf(f))return!1;return!0}function f(a){var b=document.cookie.trim().split(/\s*;\s*/);
a+="\x3d";for(var d=0;d<b.length;++d)if(0===b[d].indexOf(a))return b[d].substring(a.length);return null}function b(a){for(var b="",d=0;d<a.length;d++){for(var f=a[d].toString(2);8>f.length;)f="0"+f;b+=f}f="";for(d=0;d<5-a.length;++d)f+="00000000";b+=f;f="";for(d=0;d<b.length;d+=5)var k=parseInt(b.slice(d,d+5),2),f=f+e[k];1===a.length?f=f.replace(/(.{6})$/,"\x3d\x3d\x3d\x3d\x3d\x3d"):2===a.length?f=f.replace(/(.{4})$/,"\x3d\x3d\x3d\x3d"):3===a.length?f=f.replace(/(.{3})$/,"\x3d\x3d\x3d"):4===a.length&&
(f=f.replace(/(.{1})$/,"\x3d"));return f}function q(a){for(var b="",d=0;d<a.length;++d){for(var e=m[a[d]].toString(2);5>e.length;)e="0"+e;b+=e}a="";for(d=0;d<b.length;d+=8)e=b.slice(d,d+8),8===e.length&&(a+=String.fromCharCode(parseInt(e,2)));return a}for(var g=/[0-9]{9}[0-9X]|[A-Z][A-Z0-9]{9}/g,a=/(http(s)?:\/\/|www\.)?([\da-zA-Z\.-]+)\.(com|ru|net|org|de|jp|uk|cn|in|fr|de|it|nl|es|ca|mx|au|br)(:\d+)?(\/[a-zA-Z0-9\-\+\.\?\/\=@:;%_~#&]+)?\/?/g,e="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567".split(""),m={},u=
0;u<e.length;++u)m[e[u]]=u;var p={};t.when("mash").execute(function(a){p=a});var h="mr mrs ms miss dr fr rev prof judge hon".split(" "),k="i ii iii iv jr sr md phd esq".split(" ");return{isDataUri:function(a){a=d(a)?!1:"string"!==typeof a?!1:0===a.indexOf("data:");return a},TAG_CALL:"call",TAG_PRESENCE:"presence",TAG_IQ:"iq",TAG_MESSAGE:"message",TAG_ROOM:"room",TAG_REQUEST:"request",TAG_JID:"jid",TAG_RESOURCE:"resource",TAG_METRIC:"metric",createUUID:function(a){return("xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,
function(a){var b=16*Math.random()|0;return("x"===a?b:b&3|8).toString(16)})+("-"+a)).toLowerCase()},getChromeMajorVersion:function(){var a=-1,b=navigator.userAgent,d=b.indexOf("Chrome/");-1!==d&&(a=b.substring(d+7),a=a.substring(0,a.indexOf(" ")),a=parseInt(a,10));return a},isChrome:function(){return!d(v.chrome)},isNativeApp:function(){return!d(v.NativeWrapper)||!d(v.AndroidClipboard)},isMashCordova:function(){return!d(p)&&!d(v.cordova)||!d(f("amzn-app-ctxt"))},getMash:function(){return p},deepEquals:function(a,
b){return l(a,b)},shortString:function(a,b){if(d(a))return"[]";d(b)&&(b=5);return a.length>b?"[..."+a.substring(a.length-b)+"]":a},xmppDateToJSDate:function(a){if(d(a))throw Error("null input string");if(20>a.length)throw Error("input string too short");var b=a.substr(0,4),e=a.substr(5,2)-1,f=a.substr(8,2),k=a.substr(11,2),g=a.substr(14,2),h=a.substr(17,2),l=parseInt(b,10);if(1970>l||3E3<l)throw Error("invalid year");l=parseInt(e,10);if(0>l||11<l)throw Error("invalid month");l=parseInt(f,10);if(0>
l||31<l)throw Error("invalid day");l=parseInt(k,10);if(0>l||24<l)throw Error("invalid hour");l=parseInt(g,10);if(0>l||59<l)throw Error("invalid minute");l=parseInt(h,10);if(0>l||59<l)throw Error("invalid second");b=new Date(Date.UTC(b,e,f,k,g,h));f=a.length;if("Z"!==a.substr(f-1,1)){e=new Date;e.setTime(0);k=a.substr(f-5,2);g=parseInt(k,10);if(0>g||24<g)throw Error("invalid offset hour");g=a.substr(f-2,2);h=parseInt(g,10);if(0>h||59<h)throw Error("invalid offset minute");e.setUTCHours(k);e.setUTCMinutes(g);
a=a.substr(f-6,1);if("+"===a)b.setTime(b.getTime()-e.getTime());else if("-"===a)b.setTime(b.getTime()+e.getTime());else throw Error("invalid offset sign");}return b},escapeHtml:function(a){a=a.replace(/&/g,"\x26amp;");a=a.replace(/</g,"\x26lt;");a=a.replace(/>/g,"\x26gt;");a=a.replace(/"/g,"\x26quot;");return a=a.replace(/'/g,"\x26#39;")},unescapeHtml:function(a){a=a.replace(/&amp;/g,"\x26");a=a.replace(/&lt;/g,"\x3c");a=a.replace(/&gt;/g,"\x3e");a=a.replace(/&quot;/g,'"');return a=a.replace(/&#39;/g,
"'")},stringToBase64:function(a){a=encodeURIComponent(a).replace(/%([0-9A-F]{2})/g,function(a,b){return String.fromCharCode(parseInt(b,16))});return v.btoa(a)},stringToBase32:function(a){var d=encodeURIComponent(a).replace(/%([0-9A-F]{2})/g,function(a,b){return String.fromCharCode(parseInt(b,16))});a=[];for(var e=0;e<d.length;++e)a.push(d.charCodeAt(e));d="";for(e=0;e<a.length;e+=5)d+=b(a.slice(e,e+5));return d},base32ToString:function(a){a=a.replace(/(=*)$/,"");for(var b="",d=0;d<a.length;d+=8)b+=
q(a.slice(d,d+8));a=b.replace(/(.)/g,function(a,b){a=b.charCodeAt(0).toString(16).toUpperCase();2>a.length&&(a="0"+a);return"%"+a});return decodeURIComponent(a)},base64ToString:function(a){a=v.atob(a).replace(/(.)/g,function(a,b){a=b.charCodeAt(0).toString(16).toUpperCase();2>a.length&&(a="0"+a);return"%"+a});return decodeURIComponent(a)},isEmpty:function(a){return d(a)},getRandomWithExclusion:function(a,b,e){a=Math.floor(a);b=Math.floor(b)-a;for(var f=0,k=!1,g=0;1E3>f&&!k;)f++,g=Math.round(Math.random()*
b)+a,k=d(e)||-1===e.indexOf(g);if(!k)throw Error("failed to generate random after 1000 tries - giving up");return g},shortenName:function(a){var b;if(d(a))b="";else if(b=a.trim().split(/\s+/),1===b.length)b=a;else{a=b[0].toLowerCase().replace(/\./g,"");-1!==h.indexOf(a)&&b.shift();for(a=b.shift().trim();1<b.length&&-1!==k.indexOf(b[b.length-1].toLowerCase().replace(/\./g,""));)b.pop();b=b.pop().trim().substring(0,1).toUpperCase();b=a+" "+b}return b},getGlobalRegEx:function(a){return new RegExp(a,
"g")},getAsinRegEx:function(){return g},getUrlRegEx:function(){return a},ellipsize:function(a,b){return a.length<=b?a:a.substring(0,b)+"..."},dayOfWeek:function(a){switch(a){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";case 6:return"Saturday";default:return""}},getRelativeTimeFormatForTimestamp:function(a,b){if(d(a))return"";a=new Date(a);var e=new Date;d(b)||(e=new Date(b));b=(e.getTime()-a.getTime())/1E3;
if(86400>b){b="am";var f=e=a.getHours();0===e?f="12":11<e&&(b="pm",12<e&&(f=e-12));return f+":"+(10>a.getMinutes()?"0":"")+a.getMinutes()+" "+b}return 604800>b?this.dayOfWeek(a.getDay()):1209600>b?"Last "+this.dayOfWeek(a.getDay()):a.toLocaleDateString()},setMash:function(a){p=a},getCookieValue:function(a){return f(a)}}});t.when("AmazonComm/utils/common").execute(function(d){v["AmazonComm/utils/common"]=d});t.when("AmazonComm/utils/common","AmazonComm/utils/log").register("AmazonComm/utils/config",
function(d,l){function f(a){e="PROD"===a||"GAMMA"===a||"BETA"===a||"ALPHA"===a||"DEV"===a?a:"PROD"}var b="SharedKey",q=!1,g={Default:{}};g.Default.PROD={MESSAGING_SERVICE:"https://campfire__SERVER_INDEX__.prod.xmpp.amazon-comm.com",MESSAGING_SERVICE_HOST_COUNT:4,MESSAGING_SERVICE_DOMAIN:"campfire.prod.xmpp.amazon-comm.com",MESSAGING_SERVICE_MUC_DOMAIN:"groups.campfire.prod.xmpp.amazon-comm.com",MESSAGING_SERVICE_SEARCH_DOMAIN:"search.campfire.prod.xmpp.amazon-comm.com",CORE_SERVICE:"https://prod.core.amazon-comm.com",
TURN_SERVICE:"wss://turn.amazon-comm.com",EXTENDED_MESSAGE_METADATA:!0,DISCONNECT_ON_UNLOAD:!0};g.Default.GAMMA={MESSAGING_SERVICE:"https://campfire__SERVER_INDEX__.gamma.xmpp.amazon-comm.com",MESSAGING_SERVICE_HOST_COUNT:4,MESSAGING_SERVICE_DOMAIN:"campfire.gamma.xmpp.amazon-comm.com",MESSAGING_SERVICE_MUC_DOMAIN:"groups.campfire.gamma.xmpp.amazon-comm.com",MESSAGING_SERVICE_SEARCH_DOMAIN:"search.campfire.gamma.xmpp.amazon-comm.com",CORE_SERVICE:"https://gamma.core.amazon-comm.com",TURN_SERVICE:"wss://gamma.turn.amazon-comm.com",
EXTENDED_MESSAGE_METADATA:!0,DISCONNECT_ON_UNLOAD:!0};g.Default.BETA={MESSAGING_SERVICE:"https://campfire-xmpp-beta__SERVER_INDEX__.aka.pdx.corp.amazon.com:4569",MESSAGING_SERVICE_HOST_COUNT:2,MESSAGING_SERVICE_DOMAIN:"campfire.beta.xmpp.amazon-comm.com",MESSAGING_SERVICE_MUC_DOMAIN:"groups.campfire.beta.xmpp.amazon-comm.com",MESSAGING_SERVICE_SEARCH_DOMAIN:"search.campfire.beta.xmpp.amazon-comm.com",CORE_SERVICE:"https://campfire.integ.amazon.com:4281",TURN_SERVICE:"wss://campfire-turn.integ.amazon.com:443",
EXTENDED_MESSAGE_METADATA:!0,DISCONNECT_ON_UNLOAD:!0};g.Default.ALPHA={MESSAGING_SERVICE:"https://campfire-xmpp-alpha__SERVER_INDEX__.aka.pdx.corp.amazon.com:4569",MESSAGING_SERVICE_HOST_COUNT:2,MESSAGING_SERVICE_DOMAIN:"campfire.alpha.xmpp.amazon-comm.com",MESSAGING_SERVICE_MUC_DOMAIN:"groups.campfire.alpha.xmpp.amazon-comm.com",MESSAGING_SERVICE_SEARCH_DOMAIN:"search.campfire.alpha.xmpp.amazon-comm.com",CORE_SERVICE:"https://campfire.integ.amazon.com:4281",TURN_SERVICE:"wss://campfire-turn.integ.amazon.com:443",
EXTENDED_MESSAGE_METADATA:!0,DISCONNECT_ON_UNLOAD:!0};g.Default.DEV={MESSAGING_SERVICE:"https://campfire-xmpp-beta__SERVER_INDEX__.aka.pdx.corp.amazon.com:4569",MESSAGING_SERVICE_HOST_COUNT:2,MESSAGING_SERVICE_DOMAIN:"campfire.beta.xmpp.amazon-comm.com",MESSAGING_SERVICE_MUC_DOMAIN:"groups.campfire.beta.xmpp.amazon-comm.com",MESSAGING_SERVICE_SEARCH_DOMAIN:"search.campfire.beta.xmpp.amazon-comm.com",CORE_SERVICE:"https://campfire.integ.amazon.com:4281",TURN_SERVICE:"wss://campfire-turn.integ.amazon.com:443",
EXTENDED_MESSAGE_METADATA:!0,DISCONNECT_ON_UNLOAD:!0};g.Huddles=g.Default;g.Poppin=g.Default;g.IntegrationTestDefault=g.Default;g.IntegrationTestPoppin=g.Poppin;var a={},e="PROD",m="LIVE",u="Default",p=v.CAMPFIRE_APOLLO_STAGE;void 0!==p&&(p=p.toLowerCase(),"beta"===p?f("BETA"):"alpha"===p?f("ALPHA"):"gamma"===p&&f("GAMMA"));var h,k,c=/((fr|de|es|nl|uk|it|in|ae|sa|tr)+-+)|(-+(fr|de|es|nl|uk|it|in|ae|sa|tr)+[^a-z])|(amazon(.)*(fr|de|es|nl|uk|it|in|ae|sa|tr))/i,n=/((jp|sg|au)+-+)|(amazon(.)*(jp|sg|au))/i,
r=/(amazon(.)*(fr))/i,t=/(amazon(.)*(de))/i,X=/(amazon(.)*(es))/i,E=/(amazon(.)*(nl))/i,G=/(amazon(.)*(uk))/i,C=/(amazon(.)*(it))/i,I=/(amazon(.)*(in))/i,F=/(amazon(.)*(ae))/i,z=/(amazon(.)*(sa))/i,y=/(amazon(.)*(tr))/i,D=/(amazon(.)*(jp))/i,M=/(amazon(.)*(au))/i,H=/(amazon(.)*(sg))/i,N=/(amazon(.)*(ca))/i,O=/(amazon(.)*(br))/i,L=/(amazon(.)*(mx))/i,Y=/(.+.)*primevideo.com/i;return{STAGE_PROD:"PROD",STAGE_GAMMA:"GAMMA",STAGE_BETA:"BETA",STAGE_ALPHA:"ALPHA",STAGE_DEV:"DEV",MUC_DOMAIN_PREFIX:"groups.",
setApiKey:function(a){"Poppin"===a||"Huddles"===a||"Default"===a||"IntegrationTestPoppin"===a||"IntegrationTestDefault"===a?(u=a,a=!0):(u="Default",l.e("config","Invalid API key: ["+a+"] - using default"),a=!1);return a},getStage:function(){return e},setStage:function(a){f(a)},isDev:function(){return"DEV"===e},isAlpha:function(){return"ALPHA"===e},isBeta:function(){return"BETA"===e},isGamma:function(){return"GAMMA"===e},isProd:function(){return"PROD"===e},getMessagingHost:function(b){var c=b=d.isEmpty(b)||
0>b?"":"-"+b;d.isEmpty(m)||"STAGING"!==m||(c=b+"-"+m.toLowerCase());return(a.MESSAGING_SERVICE||g[u][e].MESSAGING_SERVICE).replace(/__SERVER_INDEX__/g,c)},getMessagingHostOverride:function(){return a.MESSAGING_SERVICE},getMessagingHostFormat:function(){return a.MESSAGING_SERVICE||g[u][e].MESSAGING_SERVICE},getMessagingHostCount:function(){return a.MESSAGING_SERVICE_HOST_COUNT||g[u][e].MESSAGING_SERVICE_HOST_COUNT},getMessagingDomain:function(){return a.MESSAGING_SERVICE_DOMAIN||g[u][e].MESSAGING_SERVICE_DOMAIN},
getMUCDomain:function(){return a.MESSAGING_SERVICE_MUC_DOMAIN||g[u][e].MESSAGING_SERVICE_MUC_DOMAIN},getSearchDomain:function(){return a.MESSAGING_SERVICE_SEARCH_DOMAIN||g[u][e].MESSAGING_SERVICE_SEARCH_DOMAIN},getCoreServiceHost:function(){return a.CORE_SERVICE||g[u][e].CORE_SERVICE},getTURNHost:function(){return a.TURN_SERVICE||g[u][e].TURN_SERVICE},getInternalServiceHost:function(){l.l("config","Marketplace Id: ["+h+"]");if(!d.isEmpty(a.INTERNAL_SERVICE))return l.l("config","Using Internal Service host Override: ["+
a.INTERNAL_SERVICE+"]"),a.INTERNAL_SERVICE;var b;l.l("config","Domain Name: ["+k+"]");b=c.test(k);"PROD"===e?Y.test(k)?(b="https://internal.campfire.primevideo.com","A2MFUE2XK8ZSSY"===h||"A3K6Y4MI8GDYMT"===h?b="https://internal-campfire-eu.primevideo.com":"A15PK738MTQHSO"===h&&(b="https://internal-campfire-fe.primevideo.com")):b?(b="https://internal-campfire-eu.amazon.com",r.test(k)?b="https://internal-campfire-eu.amazon.fr":t.test(k)?b="https://internal-campfire-eu.amazon.de":X.test(k)?b="https://internal-campfire-eu.amazon.es":
E.test(k)?b="https://internal-campfire-eu.amazon.nl":G.test(k)?b="https://internal-campfire-eu.amazon.co.uk":C.test(k)?b="https://internal-campfire-eu.amazon.it":I.test(k)?b="https://internal-campfire-eu.amazon.in":F.test(k)?b="https://internal-campfire-eu.amazon.ae":z.test(k)?b="https://internal-campfire-eu.amazon.sa":y.test(k)&&(b="https://internal-campfire-eu.amazon.com.tr")):n.test(k)?(b="https://internal-campfire-fe.amazon.com",D.test(k)?b="https://internal-campfire-fe.amazon.co.jp":H.test(k)?
b="https://internal-campfire-fe.amazon.sg":M.test(k)&&(b="https://internal-campfire-fe.amazon.com.au")):(b="https://internal.campfire.amazon.com",N.test(k)?b="https://internal.campfire.amazon.ca":O.test(k)?b="https://internal.campfire.amazon.com.br":L.test(k)&&(b="https://internal.campfire.amazon.com.mx")):b="GAMMA"===e?b?"https://internal-campfire-eu-gamma.amazon.com":n.test(k)?"https://internal-campfire-fe-gamma.amazon.com":"https://internal-gamma.campfire.amazon.com":b?"https://campfire-eu.integ.amazon.com:11343":
n.test(k)?"https://campfire-fe.integ.amazon.com:11343":"https://campfire.integ.amazon.com:11343";l.l("config","Internal Service Host: ["+b+"]");return b},isExtendedMessageMetadataEnabled:function(){return d.isEmpty(a.EXTENDED_MESSAGE_METADATA)?g[u][e].EXTENDED_MESSAGE_METADATA:a.EXTENDED_MESSAGE_METADATA},getMapThumbnailBase:function(a){return a?"http://image.maps.api.here.com/mia/1.6/mapview?app_id\x3doOnEEaBPJEG9JTqwTyjZ\x26app_code\x3dWV2t5lCfD0NGpQMEjS2VBw\x26w\x3d120\x26h\x3d80\x26z\x3d15\x26style\x3dflame":
"http://image.maps.api.here.com/mia/1.6/mapview?app_id\x3doOnEEaBPJEG9JTqwTyjZ\x26app_code\x3dWV2t5lCfD0NGpQMEjS2VBw\x26w\x3d240\x26h\x3d160\x26z\x3d15\x26style\x3dflame"},getMapThumbnailWidth:function(a){return a?120:240},getMapThumbnailHeight:function(a){return a?80:160},getMapUrl:function(a,b){return"http://here.com/"+a+","+b+",13,0,0,normal.day"},useWebDeviceAttributes:function(){return!d.isMashCordova()&&("DEV"===e||"ALPHA"===e||"BETA"===e)},disconnectOnUnload:function(){return d.isEmpty(a.DISCONNECT_ON_UNLOAD)?
g[u][e].DISCONNECT_ON_UNLOAD:a.DISCONNECT_ON_UNLOAD},AUTH_COGNITO:"Cognito",AUTH_CS_SHARED_KEY:"CSSharedKey",AUTH_SHARED_KEY:"SharedKey",setAuthProvider:function(a){b=a},useCognitoAuth:function(){return"Cognito"===b},useCSSharedKeyAuth:function(){return"CSSharedKey"===b},useSharedKeyAuth:function(){return"SharedKey"===b},isAuthenticationCheckRequired:function(){return q},setAuthenticationCheckRequired:function(a){q=a},CLUSTER_LIVE:"LIVE",CLUSTER_STAGING:"STAGING",setClusterName:function(a){m=a},getClusterName:function(){return m},
setMarketplaceId:function(a){h=a},getMarketplaceId:function(){return h},setDomainName:function(a){l.l("config","Setting Domain Name: ["+a+"]");k=a},getDomainName:function(){return k},getApiKey:function(){return u},setMessagingHost:function(b){d.isEmpty(b)?l.w("config","Empty value passed to setMessagingHost()"):a.MESSAGING_SERVICE=b},setMessagingDomain:function(b){d.isEmpty(b)?l.w("config","Empty value passed to setMessagingDomain()"):(a.MESSAGING_SERVICE_DOMAIN=b,a.MESSAGING_SERVICE_MUC_DOMAIN="groups."+
b,a.MESSAGING_SERVICE_SEARCH_DOMAIN="search."+b)},setMUCDomain:function(b){d.isEmpty(b)?l.w("config","Empty value passed to setMUCDomain()"):a.MESSAGING_SERVICE_MUC_DOMAIN=b},setCoreServiceHost:function(b){d.isEmpty(b)?l.w("config","Empty value passed to setCampfireCoreServiceHost()"):a.CORE_SERVICE=b},setTURNHost:function(b){d.isEmpty(b)?l.w("config","Empty value passed to setTURNHost()"):a.TURN_SERVICE=b},setInternalServiceHost:function(b){d.isEmpty(b)?l.w("config","Empty value passed to setCampfireInternalServiceHost()"):
a.INTERNAL_SERVICE=b},setExtendedMessageMetadataEnabled:function(b){a.EXTENDED_MESSAGE_METADATA=b},setDisconnectOnUnload:function(b){a.DISCONNECT_ON_UNLOAD=b},resetServers:function(){a={}}}});t.when("AmazonComm/utils/config").execute(function(d){v["AmazonComm/utils/config"]=d});t.register("AmazonComm/utils/constants",function(){return{ELEMENT_JSON:"json",NS_JSON:"urn:xmpp:json:0",XMLNS:"xmlns"}});t.when("AmazonComm/utils/constants").execute(function(d){v["AmazonComm/utils/constants"]=d});t.when("AmazonComm/utils/common").register("AmazonComm/utils/location",
function(d){function l(b,d,g,a){var e=(g-b)*f;d=(a-d)*f;b=Math.sin(e/2)*Math.sin(e/2)+Math.cos(b*f)*Math.cos(g*f)*Math.sin(d/2)*Math.sin(d/2);return 12742E3*Math.atan2(Math.sqrt(b),Math.sqrt(1-b))}var f=Math.PI/180;return{getDistanceBetweenLatLongPoints:function(b,d,f,a){return l(b,d,f,a)},isSignificantLocationChange:function(b,f){return d.isEmpty(b)||200<l(b.latitude,b.longitude,f.latitude,f.longitude)||9<Math.abs(b.speed-f.speed)}}});t.when("AmazonComm/utils/location").execute(function(d){v["AmazonComm/utils/location"]=
d});t.register("AmazonComm/utils/error_codes",function(){return{GENERIC_ERRORS:{ERROR_UNKNOWN:1001},AUTH_ERRORS:{ERROR_AUTH_STATUS_CHANGED_ON_REFRESH:2001,ERROR_CUSTOMER_ID_CHANGED_ON_REFRESH:2002},COMM_SERVICE_ERRORS:{ERROR_NOT_INITIALIZED:3001},CONNECTION_ERRORS:{ERROR_CONNECTION_LOST:4001,ERROR_SESSION_TERMINATED:4002,ERROR_GET_MESSAGING_SERVICE_HOST_FAILURE:4003,ERROR_INVALID_URL:4004},IDENTITY_ERRORS:{ERROR_CUSTOMER_ID_DIFFERENT_THAN_AUTH:5001},SERVICE_ERRORS:{ERROR_XHR_RESPONSE:6001},CHAT_ROOM_ERRORS:{ERROR_INVALID_PARAMETER:7001,
ERROR_FAILED_TO_CREATE_ROOM:7002,ERROR_FAILED_TO_JOIN_ROOM:7003,ERROR_FAILED_TO_SET_AFFILIATION:7004,ERROR_FAILED_TO_SET_ROLE:7005,ERROR_FAILED_TO_REGISTER_WITH_ROOM:7006,ERROR_FAILED_TO_REMOVE_REGISTRATION:7007,ERROR_FAILED_TO_GET_MEMBERS_LIST:7008,ERROR_FAILED_TO_ENABLE_MUTE_NOTIFICATION:7009,ERROR_FAILED_TO_DISABLE_MUTE_NOTIFICATION:7010,ERROR_FAILED_TO_GET_MUTE_NOTIFICATION_STATE:7011}}});t.when("AmazonComm/utils/error_codes").execute(function(d){v["AmazonComm/utils/error_codes"]=d});t.when("AmazonComm/common/person_class",
"AmazonComm/common/jid_class","AmazonComm/utils/common","AmazonComm/utils/log").register("AmazonComm/utils/global_state",function(d,l,f,b){var q=new d.Person(null),g={},a={},e=[],m=null,u=null,p=null,h=null,k=[],c=null;return{addCookie:function(a){k.push(a)},getCookies:function(){return k},getLocalUser:function(){return q},getLocalUserFullJID:function(){return c},setLocalUser:function(a){q=a;f.isEmpty(a.getJID())||(c=new l.JID.fromJSONObject(a.getJID()),c.setResource(this.getResource()))},getPersonaName:function(){return u},
setPersonaName:function(a){u=a},getHuddleId:function(){return p},setHuddleId:function(a){p=a},getResource:function(){f.isEmpty(m)&&(m=f.createUUID(f.TAG_RESOURCE));return m},setAuthCredentialData:function(a){g=a},setCurrentAuthCredentialData:function(b){a=b},getAuthCredentialData:function(){return g},getCurrentAuthCredentialData:function(){return a},setAuthStatus:function(a){f.isEmpty(g)?g={authStatus:a}:g.authStatus=a},getAuthStatus:function(){return f.isEmpty(g)?null:g.authStatus},registerCleanupObserver:function(a){e.push(a);
return a},unregisterCleanupObserver:function(a){a=e.indexOf(a);-1<a&&e.splice(a,1)},cleanup:function(){b.l("global_state","cleaning up global state");for(var c=0;c<e.length;c++)e[c].cleanup();q=new d.Person(null);g={};a={};m=null},setMessagingServerUrl:function(a){h=a},getMessagingServerUrl:function(){return h},getCleanupObservers:function(){return Object.freeze(e)},setResource:function(a){m=a;c.setResource(a)}}});t.when("AmazonComm/utils/global_state").execute(function(d){v["AmazonComm/utils/global_state"]=
d});t.register("AmazonComm/utils/log",function(){function d(a){return 10>a?"0"+a:""+a}function l(a){return 10>a?"00"+a:100>a?"0"+a:""+a}function f(a,b){v.ueLogError&&ueLogError(Error(a),{logLevel:b,attribution:"CampfireJavaScriptSDK-2.2",message:a})}function b(a,b,m){if(q||-1===navigator.userAgent.indexOf("PhantomJS/")){var u=new Date,p=u.getFullYear()+"-"+d(u.getMonth()+1)+"-"+d(u.getDate()),p=p+(" "+d(u.getHours())+":"+d(u.getMinutes())+":"+d(u.getSeconds())+"."+l(u.getMilliseconds())+" ");if(g){u=
p;a:{p=Error().stack;if(void 0===p||!p){try{throw Error();}catch(c){p=c.stack}if(void 0===p||!p){p="NO_STACK";break a}}var h=p.split("\n"),p="unknown",k=3;"Error"===h[0].trim()&&(k=4);if(h.length>k){p=h[k];p=p.trim();try{0<=p.indexOf("@")?p=p.substring(p.indexOf("@")+1):(p=0<=p.indexOf(" (")?p.split(" (")[1].substring(0,p.length-1):p.split("at ")[1],-1!==p.indexOf(")")&&(p=p.substring(0,p.lastIndexOf(")")))),p=p.substring(p.lastIndexOf("/")+1)}catch(c){p="unknown"}}h=p.indexOf("sha1\x3d");-1!==h&&
(p=p.substring(0,h+5)+"..."+p.substr(-10));p="["+p+"]"}p=u+p}p+="["+b+"] "+m;2===a?(console.error(p),f(p,"ERROR")):1===a?(console.warn(p),f(p,"WARNING")):console.log(p)}}var q=!1,g=!1;return{l:function(a,d){b(0,a,d)},w:function(a,d){b(1,a,"[WARNING] "+d)},e:function(a,d){b(2,a,"[ERROR] "+d)},error:function(a,d,f){b(2,a,"[ERROR] "+d+" - code: ["+f.code+"], description: ["+f.description+"]")},ex:function(a,d,f){b(2,a,"[EXCEPTION] "+d+", name: "+f.name+(void 0===f.stack?"":", stack: "+f.stack))},setIncludeCallingLocation:function(a){g=
a},setPhantomJSLoggingEnabled:function(a){q=a},pad:function(a){return d(a)},pad2:function(a){return l(a)}}});t.when("AmazonComm/utils/log").execute(function(d){v["AmazonComm/utils/log"]=d});t.when("AmazonComm/metrics/metrics_manager","AmazonComm/utils/common","AmazonComm/utils/config","AmazonComm/utils/error_codes","AmazonComm/utils/log","AmazonComm/utils/services").register("AmazonComm/utils/messaging_service_host_provider",function(d,l,f,b,q,g){function a(a){var b={requestId:l.createUUID(l.TAG_REQUEST),
authenticationCheckRequired:!1,apiKey:f.getApiKey(),marketplaceId:f.getMarketplaceId(),domainName:f.getDomainName(),messagingServiceDomain:f.getMessagingDomain(),clusterName:f.getClusterName()};l.isEmpty(a)||(b.unreachableHosts=a);return JSON.stringify(b)}function e(e,u){var p=d.createMetricEvent("GetMessagingServiceHost",d.AGGREGATING_EVENT);d.startTimer(p,"GetMessagingServiceHost.InternalService.ApiTimer");var h=f.getInternalServiceHost();q.l("messaging_service_host_provider","Connecting to internal service : ["+
h+"]");u={url:h,api:"getCampfireConnectionPayloadForAmazonCookie",payload:a(u),withCredentials:!1};g.sendRestXhrWithRetries(u,{onXhrSendSuccess:function(a){d.stopTimer(p,"GetMessagingServiceHost.InternalService.ApiTimer");d.incrementCounter(p,"GetMessagingServiceHost.InternalService.SuccessCount");var c=JSON.parse(a.responseText);a=null;var f=c.messagingServiceHosts;if(!l.isEmpty(f)&&!l.isEmpty(f[0])){for(var f=c.messagingServiceHosts[0].hostName,g=null,h=null,c=c.messagingServiceHosts[0].protocols,
q=0;q<c.length;++q)if("wss"===c[q].scheme){g=c[q].scheme;h=c[q].port;break}l.isEmpty(f)||l.isEmpty(g)||(a={hostName:f,protocol:g,port:h})}if(l.isEmpty(a))e.onGetMessagingServiceHostError({code:b.CONNECTION_ERRORS.ERROR_GET_MESSAGING_SERVICE_HOST_FAILURE,description:"The host doesn't support required protocol"});else e.onGetMessagingServiceHostSuccess(a)},onXhrSendRetry:function(a,c){d.stopTimer(p,"GetMessagingServiceHost.InternalService.ApiTimer");d.incrementCounter(p,"GetMessagingServiceHost.InternalService.RetryCount");
q.l("messaging_service_host_provider","Reconnecting to internal service in "+c+" ms. ErrorCode : ["+a.code+"] Description : ["+a.description+"]");a.code=b.CONNECTION_ERRORS.ERROR_GET_MESSAGING_SERVICE_HOST_FAILURE;e.onGetMessagingServiceHostRetry(a,c)},onXhrSendFailed:function(a){d.stopTimer(p,"GetMessagingServiceHost.InternalService.ApiTimer");d.incrementCounter(p,"GetMessagingServiceHost.InternalService.FailureCount");q.l("messaging_service_host_provider","The request to internal service failed. ErrorCode : ["+
a.code+"] Description : ["+a.description+"]");a.code=b.CONNECTION_ERRORS.ERROR_GET_MESSAGING_SERVICE_HOST_FAILURE;e.onGetMessagingServiceHostError(a)}})}return{getMessagingServiceHost:function(a,b){getMessagingServiceHost(a,b)},createGetMessagingServiceHostRequest:function(a){var b=l.createUUID(l.TAG_REQUEST),d=f.getApiKey(),e=f.getMessagingDomain(),b={requestId:b,apiKey:d,messagingServiceDomain:e,clusterName:f.getClusterName()};l.isEmpty(a)||(b.unreachableHosts=a);return JSON.stringify(b)},getMessagingServiceHostFromInternalService:function(a,
b){return e(a,b)}}});t.when("AmazonComm/utils/messaging_service_host_provider").execute(function(d){v["AmazonComm/utils/messaging_service_host_provider"]=d});t.when("AmazonComm/metrics/metrics_manager","AmazonComm/utils/common","AmazonComm/utils/error_codes","AmazonComm/utils/global_state","AmazonComm/utils/log").register("AmazonComm/utils/services",function(d,l,f,b,q){function g(a){var c=b.getCookies();if(!l.isEmpty(c)){a.setDisableHeaderCheck&&a.setDisableHeaderCheck(!0);for(var d="",e=0;e<c.length;e++)d+=
c[e]+";";a.setRequestHeader("cookie",d)}}function a(a,b,d){var e=new XMLHttpRequest;e.open("POST",a+"/"+b,!0);e.setRequestHeader("Accept","application/json");e.setRequestHeader("Content-Type","text/plain");!0===d?(e.withCredentials=!0,g(e)):e.withCredentials=!1;return e}function e(a,b,e,f){var g=e+".",h=d.createMetricEvent("ServiceUtils",d.AGGREGATING_EVENT);0===a.status?(q.e("services",e+" XHR status 0 [cross domain call?]\n  URL: "+b+"\n  document.domain:"+document.domain),d.incrementCounter(h,
g+"XhrRequestStatusUnsent"),f(e+" failed with status 0")):(q.e("services",e+" failed\n  status: "+a.status+"\n  response: "+a.responseText),d.incrementCounter(h,g+"XhrRequestErrorStatus."+a.status),f(e+" failed with status "+a.status+": ["+a.responseText+"]"));d.recordMetricEvent(h)}function m(b,c,g){function m(){try{d.startTimer(E,v+"XhrRequestTimer");var g=a(b.url,b.api,b.withCredentials);g.send(b.payload);g.onreadystatechange=function(){4===g.readyState&&(d.stopTimer(E,v+"XhrRequestTimer"),200===
g.status?(d.recordMetricEvent(E),c.onXhrSendSuccess(g)):e(g,b.url,b.api,function(a){w({code:f.SERVICE_ERRORS.ERROR_XHR_RESPONSE,description:a})}))}}catch(h){d.stopTimer(E,v+"XhrRequestTimer"),d.incrementCounter(E,v+"XhrRequestExceptionCount"),w({code:f.GENERIC_ERRORS.ERROR_UNKNOWN,description:h.message})}}function w(a){if(p)d.incrementCounter(E,v+"XhrRequestFailureCount"),d.recordMetricEvent(E),q.l("services","All XHR sends failed.\n  URL: "+b.url+"\n  API: "+b.api),c.onXhrSendFailed(a);else{h=!0;
d.incrementCounter(E,v+"XhrRequestRetryCount");var e=G,e=Math.floor(e+e*g.jitterRatio*Math.random());G=Math.min(g.backoffFactor*G,C);q.l("services","Scheduling XHR send retry in "+e+" milliseconds\n  URL: "+b.url+"\n  API: "+b.api);if(!l.isEmpty(c.onXhrSendRetry))c.onXhrSendRetry(a,e);setTimeout(m,e)}}var v=b.api+".",E=d.createMetricEvent("ServiceUtils",d.AGGREGATING_EVENT);l.isEmpty(g)&&(g=t);var G=g.startIntervalMs,C=g.maxDelayMs;m()}var t={startIntervalMs:1E3,maxDelayMs:3E4,backoffFactor:2,jitterRatio:.1},
p=!1,h=!1;return{HTTP_POST:"POST",CONTENT_TYPE:"Content-Type",CONTENT_TYPE_FORM:"application/x-www-form-urlencoded",INTERNAL_SERVICE_NAME:"com.amazon.campfireinternal.CampfireInternalService",createCoralRequest:function(a,b){var d=new XMLHttpRequest;d.open("POST",a,!0);d.setRequestHeader("Content-Type","application/json");d.setRequestHeader("Content-Encoding","amz-1.0");d.setRequestHeader("X-Amz-Target",b);g(d);return d},createRestRequest:function(b,c,d){return a(b,c,d)},isXhrDone:function(a){return 4===
a.readyState},isXhrOk:function(a){return 200===a.status},handleXhrNotOk:function(a,b,d,f){e(a,b,d,f)},sendRestXhrWithRetries:function(a,b,d){m(a,b,d)},disableRetries:function(){p=!0},clearEverRetry:function(){h=!1},getEverRetry:function(){return h}}});t.when("AmazonComm/utils/services").execute(function(d){v["AmazonComm/utils/services"]=d})});
/* ******** */
